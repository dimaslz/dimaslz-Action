(()=>{var __webpack_modules__={7351:function(t,r,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,r,n,i){if(i===undefined)i=n;Object.defineProperty(t,i,{enumerable:true,get:function(){return r[n]}})}:function(t,r,n,i){if(i===undefined)i=n;t[i]=r[n]});var o=this&&this.__setModuleDefault||(Object.create?function(t,r){Object.defineProperty(t,"default",{enumerable:true,value:r})}:function(t,r){t["default"]=r});var s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var r={};if(t!=null)for(var n in t)if(n!=="default"&&Object.hasOwnProperty.call(t,n))i(r,t,n);o(r,t);return r};Object.defineProperty(r,"__esModule",{value:true});r.issue=r.issueCommand=void 0;const l=s(n(2087));const u=n(5278);function issueCommand(t,r,n){const i=new Command(t,r,n);process.stdout.write(i.toString()+l.EOL)}r.issueCommand=issueCommand;function issue(t,r=""){issueCommand(t,{},r)}r.issue=issue;const h="::";class Command{constructor(t,r,n){if(!t){t="missing.command"}this.command=t;this.properties=r;this.message=n}toString(){let t=h+this.command;if(this.properties&&Object.keys(this.properties).length>0){t+=" ";let r=true;for(const n in this.properties){if(this.properties.hasOwnProperty(n)){const i=this.properties[n];if(i){if(r){r=false}else{t+=","}t+=`${n}=${escapeProperty(i)}`}}}}t+=`${h}${escapeData(this.message)}`;return t}}function escapeData(t){return u.toCommandValue(t).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function escapeProperty(t){return u.toCommandValue(t).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}},2186:function(t,r,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,r,n,i){if(i===undefined)i=n;Object.defineProperty(t,i,{enumerable:true,get:function(){return r[n]}})}:function(t,r,n,i){if(i===undefined)i=n;t[i]=r[n]});var o=this&&this.__setModuleDefault||(Object.create?function(t,r){Object.defineProperty(t,"default",{enumerable:true,value:r})}:function(t,r){t["default"]=r});var s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var r={};if(t!=null)for(var n in t)if(n!=="default"&&Object.hasOwnProperty.call(t,n))i(r,t,n);o(r,t);return r};var l=this&&this.__awaiter||function(t,r,n,i){function adopt(t){return t instanceof n?t:new n((function(r){r(t)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(t){try{step(i.next(t))}catch(t){o(t)}}function rejected(t){try{step(i["throw"](t))}catch(t){o(t)}}function step(t){t.done?n(t.value):adopt(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};Object.defineProperty(r,"__esModule",{value:true});r.getIDToken=r.getState=r.saveState=r.group=r.endGroup=r.startGroup=r.info=r.notice=r.warning=r.error=r.debug=r.isDebug=r.setFailed=r.setCommandEcho=r.setOutput=r.getBooleanInput=r.getMultilineInput=r.getInput=r.addPath=r.setSecret=r.exportVariable=r.ExitCode=void 0;const u=n(7351);const h=n(717);const p=n(5278);const g=s(n(2087));const m=s(n(5622));const _=n(8041);var E;(function(t){t[t["Success"]=0]="Success";t[t["Failure"]=1]="Failure"})(E=r.ExitCode||(r.ExitCode={}));function exportVariable(t,r){const n=p.toCommandValue(r);process.env[t]=n;const i=process.env["GITHUB_ENV"]||"";if(i){const r="_GitHubActionsFileCommandDelimeter_";const i=`${t}<<${r}${g.EOL}${n}${g.EOL}${r}`;h.issueCommand("ENV",i)}else{u.issueCommand("set-env",{name:t},n)}}r.exportVariable=exportVariable;function setSecret(t){u.issueCommand("add-mask",{},t)}r.setSecret=setSecret;function addPath(t){const r=process.env["GITHUB_PATH"]||"";if(r){h.issueCommand("PATH",t)}else{u.issueCommand("add-path",{},t)}process.env["PATH"]=`${t}${m.delimiter}${process.env["PATH"]}`}r.addPath=addPath;function getInput(t,r){const n=process.env[`INPUT_${t.replace(/ /g,"_").toUpperCase()}`]||"";if(r&&r.required&&!n){throw new Error(`Input required and not supplied: ${t}`)}if(r&&r.trimWhitespace===false){return n}return n.trim()}r.getInput=getInput;function getMultilineInput(t,r){const n=getInput(t,r).split("\n").filter((t=>t!==""));return n}r.getMultilineInput=getMultilineInput;function getBooleanInput(t,r){const n=["true","True","TRUE"];const i=["false","False","FALSE"];const o=getInput(t,r);if(n.includes(o))return true;if(i.includes(o))return false;throw new TypeError(`Input does not meet YAML 1.2 "Core Schema" specification: ${t}\n`+`Support boolean input list: \`true | True | TRUE | false | False | FALSE\``)}r.getBooleanInput=getBooleanInput;function setOutput(t,r){process.stdout.write(g.EOL);u.issueCommand("set-output",{name:t},r)}r.setOutput=setOutput;function setCommandEcho(t){u.issue("echo",t?"on":"off")}r.setCommandEcho=setCommandEcho;function setFailed(t){process.exitCode=E.Failure;error(t)}r.setFailed=setFailed;function isDebug(){return process.env["RUNNER_DEBUG"]==="1"}r.isDebug=isDebug;function debug(t){u.issueCommand("debug",{},t)}r.debug=debug;function error(t,r={}){u.issueCommand("error",p.toCommandProperties(r),t instanceof Error?t.toString():t)}r.error=error;function warning(t,r={}){u.issueCommand("warning",p.toCommandProperties(r),t instanceof Error?t.toString():t)}r.warning=warning;function notice(t,r={}){u.issueCommand("notice",p.toCommandProperties(r),t instanceof Error?t.toString():t)}r.notice=notice;function info(t){process.stdout.write(t+g.EOL)}r.info=info;function startGroup(t){u.issue("group",t)}r.startGroup=startGroup;function endGroup(){u.issue("endgroup")}r.endGroup=endGroup;function group(t,r){return l(this,void 0,void 0,(function*(){startGroup(t);let n;try{n=yield r()}finally{endGroup()}return n}))}r.group=group;function saveState(t,r){u.issueCommand("save-state",{name:t},r)}r.saveState=saveState;function getState(t){return process.env[`STATE_${t}`]||""}r.getState=getState;function getIDToken(t){return l(this,void 0,void 0,(function*(){return yield _.OidcClient.getIDToken(t)}))}r.getIDToken=getIDToken},717:function(t,r,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,r,n,i){if(i===undefined)i=n;Object.defineProperty(t,i,{enumerable:true,get:function(){return r[n]}})}:function(t,r,n,i){if(i===undefined)i=n;t[i]=r[n]});var o=this&&this.__setModuleDefault||(Object.create?function(t,r){Object.defineProperty(t,"default",{enumerable:true,value:r})}:function(t,r){t["default"]=r});var s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var r={};if(t!=null)for(var n in t)if(n!=="default"&&Object.hasOwnProperty.call(t,n))i(r,t,n);o(r,t);return r};Object.defineProperty(r,"__esModule",{value:true});r.issueCommand=void 0;const l=s(n(5747));const u=s(n(2087));const h=n(5278);function issueCommand(t,r){const n=process.env[`GITHUB_${t}`];if(!n){throw new Error(`Unable to find environment variable for file command ${t}`)}if(!l.existsSync(n)){throw new Error(`Missing file at path: ${n}`)}l.appendFileSync(n,`${h.toCommandValue(r)}${u.EOL}`,{encoding:"utf8"})}r.issueCommand=issueCommand},8041:function(t,r,n){"use strict";var i=this&&this.__awaiter||function(t,r,n,i){function adopt(t){return t instanceof n?t:new n((function(r){r(t)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(t){try{step(i.next(t))}catch(t){o(t)}}function rejected(t){try{step(i["throw"](t))}catch(t){o(t)}}function step(t){t.done?n(t.value):adopt(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};Object.defineProperty(r,"__esModule",{value:true});r.OidcClient=void 0;const o=n(9925);const s=n(3702);const l=n(2186);class OidcClient{static createHttpClient(t=true,r=10){const n={allowRetries:t,maxRetries:r};return new o.HttpClient("actions/oidc-client",[new s.BearerCredentialHandler(OidcClient.getRequestToken())],n)}static getRequestToken(){const t=process.env["ACTIONS_ID_TOKEN_REQUEST_TOKEN"];if(!t){throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_TOKEN env variable")}return t}static getIDTokenUrl(){const t=process.env["ACTIONS_ID_TOKEN_REQUEST_URL"];if(!t){throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_URL env variable")}return t}static getCall(t){var r;return i(this,void 0,void 0,(function*(){const n=OidcClient.createHttpClient();const i=yield n.getJson(t).catch((t=>{throw new Error(`Failed to get ID Token. \n \n        Error Code : ${t.statusCode}\n \n        Error Message: ${t.result.message}`)}));const o=(r=i.result)===null||r===void 0?void 0:r.value;if(!o){throw new Error("Response json body do not have ID Token field")}return o}))}static getIDToken(t){return i(this,void 0,void 0,(function*(){try{let r=OidcClient.getIDTokenUrl();if(t){const n=encodeURIComponent(t);r=`${r}&audience=${n}`}l.debug(`ID token url is ${r}`);const n=yield OidcClient.getCall(r);l.setSecret(n);return n}catch(t){throw new Error(`Error message: ${t.message}`)}}))}}r.OidcClient=OidcClient},5278:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:true});r.toCommandProperties=r.toCommandValue=void 0;function toCommandValue(t){if(t===null||t===undefined){return""}else if(typeof t==="string"||t instanceof String){return t}return JSON.stringify(t)}r.toCommandValue=toCommandValue;function toCommandProperties(t){if(!Object.keys(t).length){return{}}return{title:t.title,file:t.file,line:t.startLine,endLine:t.endLine,col:t.startColumn,endColumn:t.endColumn}}r.toCommandProperties=toCommandProperties},3702:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:true});class BasicCredentialHandler{constructor(t,r){this.username=t;this.password=r}prepareRequest(t){t.headers["Authorization"]="Basic "+Buffer.from(this.username+":"+this.password).toString("base64")}canHandleAuthentication(t){return false}handleAuthentication(t,r,n){return null}}r.BasicCredentialHandler=BasicCredentialHandler;class BearerCredentialHandler{constructor(t){this.token=t}prepareRequest(t){t.headers["Authorization"]="Bearer "+this.token}canHandleAuthentication(t){return false}handleAuthentication(t,r,n){return null}}r.BearerCredentialHandler=BearerCredentialHandler;class PersonalAccessTokenCredentialHandler{constructor(t){this.token=t}prepareRequest(t){t.headers["Authorization"]="Basic "+Buffer.from("PAT:"+this.token).toString("base64")}canHandleAuthentication(t){return false}handleAuthentication(t,r,n){return null}}r.PersonalAccessTokenCredentialHandler=PersonalAccessTokenCredentialHandler},9925:(t,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:true});const i=n(8605);const o=n(7211);const s=n(6443);let l;var u;(function(t){t[t["OK"]=200]="OK";t[t["MultipleChoices"]=300]="MultipleChoices";t[t["MovedPermanently"]=301]="MovedPermanently";t[t["ResourceMoved"]=302]="ResourceMoved";t[t["SeeOther"]=303]="SeeOther";t[t["NotModified"]=304]="NotModified";t[t["UseProxy"]=305]="UseProxy";t[t["SwitchProxy"]=306]="SwitchProxy";t[t["TemporaryRedirect"]=307]="TemporaryRedirect";t[t["PermanentRedirect"]=308]="PermanentRedirect";t[t["BadRequest"]=400]="BadRequest";t[t["Unauthorized"]=401]="Unauthorized";t[t["PaymentRequired"]=402]="PaymentRequired";t[t["Forbidden"]=403]="Forbidden";t[t["NotFound"]=404]="NotFound";t[t["MethodNotAllowed"]=405]="MethodNotAllowed";t[t["NotAcceptable"]=406]="NotAcceptable";t[t["ProxyAuthenticationRequired"]=407]="ProxyAuthenticationRequired";t[t["RequestTimeout"]=408]="RequestTimeout";t[t["Conflict"]=409]="Conflict";t[t["Gone"]=410]="Gone";t[t["TooManyRequests"]=429]="TooManyRequests";t[t["InternalServerError"]=500]="InternalServerError";t[t["NotImplemented"]=501]="NotImplemented";t[t["BadGateway"]=502]="BadGateway";t[t["ServiceUnavailable"]=503]="ServiceUnavailable";t[t["GatewayTimeout"]=504]="GatewayTimeout"})(u=r.HttpCodes||(r.HttpCodes={}));var h;(function(t){t["Accept"]="accept";t["ContentType"]="content-type"})(h=r.Headers||(r.Headers={}));var p;(function(t){t["ApplicationJson"]="application/json"})(p=r.MediaTypes||(r.MediaTypes={}));function getProxyUrl(t){let r=s.getProxyUrl(new URL(t));return r?r.href:""}r.getProxyUrl=getProxyUrl;const g=[u.MovedPermanently,u.ResourceMoved,u.SeeOther,u.TemporaryRedirect,u.PermanentRedirect];const m=[u.BadGateway,u.ServiceUnavailable,u.GatewayTimeout];const _=["OPTIONS","GET","DELETE","HEAD"];const E=10;const b=5;class HttpClientError extends Error{constructor(t,r){super(t);this.name="HttpClientError";this.statusCode=r;Object.setPrototypeOf(this,HttpClientError.prototype)}}r.HttpClientError=HttpClientError;class HttpClientResponse{constructor(t){this.message=t}readBody(){return new Promise((async(t,r)=>{let n=Buffer.alloc(0);this.message.on("data",(t=>{n=Buffer.concat([n,t])}));this.message.on("end",(()=>{t(n.toString())}))}))}}r.HttpClientResponse=HttpClientResponse;function isHttps(t){let r=new URL(t);return r.protocol==="https:"}r.isHttps=isHttps;class HttpClient{constructor(t,r,n){this._ignoreSslError=false;this._allowRedirects=true;this._allowRedirectDowngrade=false;this._maxRedirects=50;this._allowRetries=false;this._maxRetries=1;this._keepAlive=false;this._disposed=false;this.userAgent=t;this.handlers=r||[];this.requestOptions=n;if(n){if(n.ignoreSslError!=null){this._ignoreSslError=n.ignoreSslError}this._socketTimeout=n.socketTimeout;if(n.allowRedirects!=null){this._allowRedirects=n.allowRedirects}if(n.allowRedirectDowngrade!=null){this._allowRedirectDowngrade=n.allowRedirectDowngrade}if(n.maxRedirects!=null){this._maxRedirects=Math.max(n.maxRedirects,0)}if(n.keepAlive!=null){this._keepAlive=n.keepAlive}if(n.allowRetries!=null){this._allowRetries=n.allowRetries}if(n.maxRetries!=null){this._maxRetries=n.maxRetries}}}options(t,r){return this.request("OPTIONS",t,null,r||{})}get(t,r){return this.request("GET",t,null,r||{})}del(t,r){return this.request("DELETE",t,null,r||{})}post(t,r,n){return this.request("POST",t,r,n||{})}patch(t,r,n){return this.request("PATCH",t,r,n||{})}put(t,r,n){return this.request("PUT",t,r,n||{})}head(t,r){return this.request("HEAD",t,null,r||{})}sendStream(t,r,n,i){return this.request(t,r,n,i)}async getJson(t,r={}){r[h.Accept]=this._getExistingOrDefaultHeader(r,h.Accept,p.ApplicationJson);let n=await this.get(t,r);return this._processResponse(n,this.requestOptions)}async postJson(t,r,n={}){let i=JSON.stringify(r,null,2);n[h.Accept]=this._getExistingOrDefaultHeader(n,h.Accept,p.ApplicationJson);n[h.ContentType]=this._getExistingOrDefaultHeader(n,h.ContentType,p.ApplicationJson);let o=await this.post(t,i,n);return this._processResponse(o,this.requestOptions)}async putJson(t,r,n={}){let i=JSON.stringify(r,null,2);n[h.Accept]=this._getExistingOrDefaultHeader(n,h.Accept,p.ApplicationJson);n[h.ContentType]=this._getExistingOrDefaultHeader(n,h.ContentType,p.ApplicationJson);let o=await this.put(t,i,n);return this._processResponse(o,this.requestOptions)}async patchJson(t,r,n={}){let i=JSON.stringify(r,null,2);n[h.Accept]=this._getExistingOrDefaultHeader(n,h.Accept,p.ApplicationJson);n[h.ContentType]=this._getExistingOrDefaultHeader(n,h.ContentType,p.ApplicationJson);let o=await this.patch(t,i,n);return this._processResponse(o,this.requestOptions)}async request(t,r,n,i){if(this._disposed){throw new Error("Client has already been disposed.")}let o=new URL(r);let s=this._prepareRequest(t,o,i);let l=this._allowRetries&&_.indexOf(t)!=-1?this._maxRetries+1:1;let h=0;let p;while(h<l){p=await this.requestRaw(s,n);if(p&&p.message&&p.message.statusCode===u.Unauthorized){let t;for(let r=0;r<this.handlers.length;r++){if(this.handlers[r].canHandleAuthentication(p)){t=this.handlers[r];break}}if(t){return t.handleAuthentication(this,s,n)}else{return p}}let r=this._maxRedirects;while(g.indexOf(p.message.statusCode)!=-1&&this._allowRedirects&&r>0){const l=p.message.headers["location"];if(!l){break}let u=new URL(l);if(o.protocol=="https:"&&o.protocol!=u.protocol&&!this._allowRedirectDowngrade){throw new Error("Redirect from HTTPS to HTTP protocol. This downgrade is not allowed for security reasons. If you want to allow this behavior, set the allowRedirectDowngrade option to true.")}await p.readBody();if(u.hostname!==o.hostname){for(let t in i){if(t.toLowerCase()==="authorization"){delete i[t]}}}s=this._prepareRequest(t,u,i);p=await this.requestRaw(s,n);r--}if(m.indexOf(p.message.statusCode)==-1){return p}h+=1;if(h<l){await p.readBody();await this._performExponentialBackoff(h)}}return p}dispose(){if(this._agent){this._agent.destroy()}this._disposed=true}requestRaw(t,r){return new Promise(((n,i)=>{let callbackForResult=function(t,r){if(t){i(t)}n(r)};this.requestRawWithCallback(t,r,callbackForResult)}))}requestRawWithCallback(t,r,n){let i;if(typeof r==="string"){t.options.headers["Content-Length"]=Buffer.byteLength(r,"utf8")}let o=false;let handleResult=(t,r)=>{if(!o){o=true;n(t,r)}};let s=t.httpModule.request(t.options,(t=>{let r=new HttpClientResponse(t);handleResult(null,r)}));s.on("socket",(t=>{i=t}));s.setTimeout(this._socketTimeout||3*6e4,(()=>{if(i){i.end()}handleResult(new Error("Request timeout: "+t.options.path),null)}));s.on("error",(function(t){handleResult(t,null)}));if(r&&typeof r==="string"){s.write(r,"utf8")}if(r&&typeof r!=="string"){r.on("close",(function(){s.end()}));r.pipe(s)}else{s.end()}}getAgent(t){let r=new URL(t);return this._getAgent(r)}_prepareRequest(t,r,n){const s={};s.parsedUrl=r;const l=s.parsedUrl.protocol==="https:";s.httpModule=l?o:i;const u=l?443:80;s.options={};s.options.host=s.parsedUrl.hostname;s.options.port=s.parsedUrl.port?parseInt(s.parsedUrl.port):u;s.options.path=(s.parsedUrl.pathname||"")+(s.parsedUrl.search||"");s.options.method=t;s.options.headers=this._mergeHeaders(n);if(this.userAgent!=null){s.options.headers["user-agent"]=this.userAgent}s.options.agent=this._getAgent(s.parsedUrl);if(this.handlers){this.handlers.forEach((t=>{t.prepareRequest(s.options)}))}return s}_mergeHeaders(t){const lowercaseKeys=t=>Object.keys(t).reduce(((r,n)=>(r[n.toLowerCase()]=t[n],r)),{});if(this.requestOptions&&this.requestOptions.headers){return Object.assign({},lowercaseKeys(this.requestOptions.headers),lowercaseKeys(t))}return lowercaseKeys(t||{})}_getExistingOrDefaultHeader(t,r,n){const lowercaseKeys=t=>Object.keys(t).reduce(((r,n)=>(r[n.toLowerCase()]=t[n],r)),{});let i;if(this.requestOptions&&this.requestOptions.headers){i=lowercaseKeys(this.requestOptions.headers)[r]}return t[r]||i||n}_getAgent(t){let r;let u=s.getProxyUrl(t);let h=u&&u.hostname;if(this._keepAlive&&h){r=this._proxyAgent}if(this._keepAlive&&!h){r=this._agent}if(!!r){return r}const p=t.protocol==="https:";let g=100;if(!!this.requestOptions){g=this.requestOptions.maxSockets||i.globalAgent.maxSockets}if(h){if(!l){l=n(4294)}const t={maxSockets:g,keepAlive:this._keepAlive,proxy:{...(u.username||u.password)&&{proxyAuth:`${u.username}:${u.password}`},host:u.hostname,port:u.port}};let i;const o=u.protocol==="https:";if(p){i=o?l.httpsOverHttps:l.httpsOverHttp}else{i=o?l.httpOverHttps:l.httpOverHttp}r=i(t);this._proxyAgent=r}if(this._keepAlive&&!r){const t={keepAlive:this._keepAlive,maxSockets:g};r=p?new o.Agent(t):new i.Agent(t);this._agent=r}if(!r){r=p?o.globalAgent:i.globalAgent}if(p&&this._ignoreSslError){r.options=Object.assign(r.options||{},{rejectUnauthorized:false})}return r}_performExponentialBackoff(t){t=Math.min(E,t);const r=b*Math.pow(2,t);return new Promise((t=>setTimeout((()=>t()),r)))}static dateTimeDeserializer(t,r){if(typeof r==="string"){let t=new Date(r);if(!isNaN(t.valueOf())){return t}}return r}async _processResponse(t,r){return new Promise((async(n,i)=>{const o=t.message.statusCode;const s={statusCode:o,result:null,headers:{}};if(o==u.NotFound){n(s)}let l;let h;try{h=await t.readBody();if(h&&h.length>0){if(r&&r.deserializeDates){l=JSON.parse(h,HttpClient.dateTimeDeserializer)}else{l=JSON.parse(h)}s.result=l}s.headers=t.message.headers}catch(t){}if(o>299){let t;if(l&&l.message){t=l.message}else if(h&&h.length>0){t=h}else{t="Failed request: ("+o+")"}let r=new HttpClientError(t,o);r.result=s.result;i(r)}else{n(s)}}))}}r.HttpClient=HttpClient},6443:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:true});function getProxyUrl(t){let r=t.protocol==="https:";let n;if(checkBypass(t)){return n}let i;if(r){i=process.env["https_proxy"]||process.env["HTTPS_PROXY"]}else{i=process.env["http_proxy"]||process.env["HTTP_PROXY"]}if(i){n=new URL(i)}return n}r.getProxyUrl=getProxyUrl;function checkBypass(t){if(!t.hostname){return false}let r=process.env["no_proxy"]||process.env["NO_PROXY"]||"";if(!r){return false}let n;if(t.port){n=Number(t.port)}else if(t.protocol==="http:"){n=80}else if(t.protocol==="https:"){n=443}let i=[t.hostname.toUpperCase()];if(typeof n==="number"){i.push(`${i[0]}:${n}`)}for(let t of r.split(",").map((t=>t.trim().toUpperCase())).filter((t=>t))){if(i.some((r=>r===t))){return true}}return false}r.checkBypass=checkBypass},9348:t=>{t.exports={newInvalidAsn1Error:function(t){var r=new Error;r.name="InvalidAsn1Error";r.message=t||"";return r}}},194:(t,r,n)=>{var i=n(9348);var o=n(2473);var s=n(290);var l=n(3200);t.exports={Reader:s,Writer:l};for(var u in o){if(o.hasOwnProperty(u))t.exports[u]=o[u]}for(var h in i){if(i.hasOwnProperty(h))t.exports[h]=i[h]}},290:(t,r,n)=>{var i=n(2357);var o=n(5118).Buffer;var s=n(2473);var l=n(9348);var u=l.newInvalidAsn1Error;function Reader(t){if(!t||!o.isBuffer(t))throw new TypeError("data must be a node Buffer");this._buf=t;this._size=t.length;this._len=0;this._offset=0}Object.defineProperty(Reader.prototype,"length",{enumerable:true,get:function(){return this._len}});Object.defineProperty(Reader.prototype,"offset",{enumerable:true,get:function(){return this._offset}});Object.defineProperty(Reader.prototype,"remain",{get:function(){return this._size-this._offset}});Object.defineProperty(Reader.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}});Reader.prototype.readByte=function(t){if(this._size-this._offset<1)return null;var r=this._buf[this._offset]&255;if(!t)this._offset+=1;return r};Reader.prototype.peek=function(){return this.readByte(true)};Reader.prototype.readLength=function(t){if(t===undefined)t=this._offset;if(t>=this._size)return null;var r=this._buf[t++]&255;if(r===null)return null;if((r&128)===128){r&=127;if(r===0)throw u("Indefinite length not supported");if(r>4)throw u("encoding too long");if(this._size-t<r)return null;this._len=0;for(var n=0;n<r;n++)this._len=(this._len<<8)+(this._buf[t++]&255)}else{this._len=r}return t};Reader.prototype.readSequence=function(t){var r=this.peek();if(r===null)return null;if(t!==undefined&&t!==r)throw u("Expected 0x"+t.toString(16)+": got 0x"+r.toString(16));var n=this.readLength(this._offset+1);if(n===null)return null;this._offset=n;return r};Reader.prototype.readInt=function(){return this._readTag(s.Integer)};Reader.prototype.readBoolean=function(){return this._readTag(s.Boolean)===0?false:true};Reader.prototype.readEnumeration=function(){return this._readTag(s.Enumeration)};Reader.prototype.readString=function(t,r){if(!t)t=s.OctetString;var n=this.peek();if(n===null)return null;if(n!==t)throw u("Expected 0x"+t.toString(16)+": got 0x"+n.toString(16));var i=this.readLength(this._offset+1);if(i===null)return null;if(this.length>this._size-i)return null;this._offset=i;if(this.length===0)return r?o.alloc(0):"";var l=this._buf.slice(this._offset,this._offset+this.length);this._offset+=this.length;return r?l:l.toString("utf8")};Reader.prototype.readOID=function(t){if(!t)t=s.OID;var r=this.readString(t,true);if(r===null)return null;var n=[];var i=0;for(var o=0;o<r.length;o++){var l=r[o]&255;i<<=7;i+=l&127;if((l&128)===0){n.push(i);i=0}}i=n.shift();n.unshift(i%40);n.unshift(i/40>>0);return n.join(".")};Reader.prototype._readTag=function(t){i.ok(t!==undefined);var r=this.peek();if(r===null)return null;if(r!==t)throw u("Expected 0x"+t.toString(16)+": got 0x"+r.toString(16));var n=this.readLength(this._offset+1);if(n===null)return null;if(this.length>4)throw u("Integer too long: "+this.length);if(this.length>this._size-n)return null;this._offset=n;var o=this._buf[this._offset];var s=0;for(var l=0;l<this.length;l++){s<<=8;s|=this._buf[this._offset++]&255}if((o&128)===128&&l!==4)s-=1<<l*8;return s>>0};t.exports=Reader},2473:t=>{t.exports={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128}},3200:(t,r,n)=>{var i=n(2357);var o=n(5118).Buffer;var s=n(2473);var l=n(9348);var u=l.newInvalidAsn1Error;var h={size:1024,growthFactor:8};function merge(t,r){i.ok(t);i.equal(typeof t,"object");i.ok(r);i.equal(typeof r,"object");var n=Object.getOwnPropertyNames(t);n.forEach((function(n){if(r[n])return;var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i)}));return r}function Writer(t){t=merge(h,t||{});this._buf=o.alloc(t.size||1024);this._size=this._buf.length;this._offset=0;this._options=t;this._seq=[]}Object.defineProperty(Writer.prototype,"buffer",{get:function(){if(this._seq.length)throw u(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}});Writer.prototype.writeByte=function(t){if(typeof t!=="number")throw new TypeError("argument must be a Number");this._ensure(1);this._buf[this._offset++]=t};Writer.prototype.writeInt=function(t,r){if(typeof t!=="number")throw new TypeError("argument must be a Number");if(typeof r!=="number")r=s.Integer;var n=4;while(((t&4286578688)===0||(t&4286578688)===4286578688>>0)&&n>1){n--;t<<=8}if(n>4)throw u("BER ints cannot be > 0xffffffff");this._ensure(2+n);this._buf[this._offset++]=r;this._buf[this._offset++]=n;while(n-- >0){this._buf[this._offset++]=(t&4278190080)>>>24;t<<=8}};Writer.prototype.writeNull=function(){this.writeByte(s.Null);this.writeByte(0)};Writer.prototype.writeEnumeration=function(t,r){if(typeof t!=="number")throw new TypeError("argument must be a Number");if(typeof r!=="number")r=s.Enumeration;return this.writeInt(t,r)};Writer.prototype.writeBoolean=function(t,r){if(typeof t!=="boolean")throw new TypeError("argument must be a Boolean");if(typeof r!=="number")r=s.Boolean;this._ensure(3);this._buf[this._offset++]=r;this._buf[this._offset++]=1;this._buf[this._offset++]=t?255:0};Writer.prototype.writeString=function(t,r){if(typeof t!=="string")throw new TypeError("argument must be a string (was: "+typeof t+")");if(typeof r!=="number")r=s.OctetString;var n=o.byteLength(t);this.writeByte(r);this.writeLength(n);if(n){this._ensure(n);this._buf.write(t,this._offset);this._offset+=n}};Writer.prototype.writeBuffer=function(t,r){if(typeof r!=="number")throw new TypeError("tag must be a number");if(!o.isBuffer(t))throw new TypeError("argument must be a buffer");this.writeByte(r);this.writeLength(t.length);this._ensure(t.length);t.copy(this._buf,this._offset,0,t.length);this._offset+=t.length};Writer.prototype.writeStringArray=function(t){if(!t instanceof Array)throw new TypeError("argument must be an Array[String]");var r=this;t.forEach((function(t){r.writeString(t)}))};Writer.prototype.writeOID=function(t,r){if(typeof t!=="string")throw new TypeError("argument must be a string");if(typeof r!=="number")r=s.OID;if(!/^([0-9]+\.){3,}[0-9]+$/.test(t))throw new Error("argument is not a valid OID string");function encodeOctet(t,r){if(r<128){t.push(r)}else if(r<16384){t.push(r>>>7|128);t.push(r&127)}else if(r<2097152){t.push(r>>>14|128);t.push((r>>>7|128)&255);t.push(r&127)}else if(r<268435456){t.push(r>>>21|128);t.push((r>>>14|128)&255);t.push((r>>>7|128)&255);t.push(r&127)}else{t.push((r>>>28|128)&255);t.push((r>>>21|128)&255);t.push((r>>>14|128)&255);t.push((r>>>7|128)&255);t.push(r&127)}}var n=t.split(".");var i=[];i.push(parseInt(n[0],10)*40+parseInt(n[1],10));n.slice(2).forEach((function(t){encodeOctet(i,parseInt(t,10))}));var o=this;this._ensure(2+i.length);this.writeByte(r);this.writeLength(i.length);i.forEach((function(t){o.writeByte(t)}))};Writer.prototype.writeLength=function(t){if(typeof t!=="number")throw new TypeError("argument must be a Number");this._ensure(4);if(t<=127){this._buf[this._offset++]=t}else if(t<=255){this._buf[this._offset++]=129;this._buf[this._offset++]=t}else if(t<=65535){this._buf[this._offset++]=130;this._buf[this._offset++]=t>>8;this._buf[this._offset++]=t}else if(t<=16777215){this._buf[this._offset++]=131;this._buf[this._offset++]=t>>16;this._buf[this._offset++]=t>>8;this._buf[this._offset++]=t}else{throw u("Length too long (> 4 bytes)")}};Writer.prototype.startSequence=function(t){if(typeof t!=="number")t=s.Sequence|s.Constructor;this.writeByte(t);this._seq.push(this._offset);this._ensure(3);this._offset+=3};Writer.prototype.endSequence=function(){var t=this._seq.pop();var r=t+3;var n=this._offset-r;if(n<=127){this._shift(r,n,-2);this._buf[t]=n}else if(n<=255){this._shift(r,n,-1);this._buf[t]=129;this._buf[t+1]=n}else if(n<=65535){this._buf[t]=130;this._buf[t+1]=n>>8;this._buf[t+2]=n}else if(n<=16777215){this._shift(r,n,1);this._buf[t]=131;this._buf[t+1]=n>>16;this._buf[t+2]=n>>8;this._buf[t+3]=n}else{throw u("Sequence too long")}};Writer.prototype._shift=function(t,r,n){i.ok(t!==undefined);i.ok(r!==undefined);i.ok(n);this._buf.copy(this._buf,t+n,t,t+r);this._offset+=n};Writer.prototype._ensure=function(t){i.ok(t);if(this._size-this._offset<t){var r=this._size*this._options.growthFactor;if(r-this._offset<t)r+=t;var n=o.alloc(r);this._buf.copy(n,0,0,this._offset);this._buf=n;this._size=r}};t.exports=Writer},970:(t,r,n)=>{var i=n(194);t.exports={Ber:i,BerReader:i.Reader,BerWriter:i.Writer}},5447:(t,r,n)=>{"use strict";var i=n(8729).lowlevel.crypto_hash;var o=0;var Blowfish=function(){this.S=[new Uint32Array([3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946]),new Uint32Array([1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055]),new Uint32Array([3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504]),new Uint32Array([976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462])];this.P=new Uint32Array([608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731])};function F(t,r,n){return(t[0][r[n+3]]+t[1][r[n+2]]^t[2][r[n+1]])+t[3][r[n]]}Blowfish.prototype.encipher=function(t,r){if(r===undefined){r=new Uint8Array(t.buffer);if(t.byteOffset!==0)r=r.subarray(t.byteOffset)}t[0]^=this.P[0];for(var n=1;n<16;n+=2){t[1]^=F(this.S,r,0)^this.P[n];t[0]^=F(this.S,r,4)^this.P[n+1]}var i=t[0];t[0]=t[1]^this.P[17];t[1]=i};Blowfish.prototype.decipher=function(t){var r=new Uint8Array(t.buffer);if(t.byteOffset!==0)r=r.subarray(t.byteOffset);t[0]^=this.P[17];for(var n=16;n>0;n-=2){t[1]^=F(this.S,r,0)^this.P[n];t[0]^=F(this.S,r,4)^this.P[n-1]}var i=t[0];t[0]=t[1]^this.P[0];t[1]=i};function stream2word(t,r){var n,i=0;for(n=0;n<4;n++,o++){if(o>=r)o=0;i=i<<8|t[o]}return i}Blowfish.prototype.expand0state=function(t,r){var n=new Uint32Array(2),i,s;var l=new Uint8Array(n.buffer);for(i=0,o=0;i<18;i++){this.P[i]^=stream2word(t,r)}o=0;for(i=0;i<18;i+=2){this.encipher(n,l);this.P[i]=n[0];this.P[i+1]=n[1]}for(i=0;i<4;i++){for(s=0;s<256;s+=2){this.encipher(n,l);this.S[i][s]=n[0];this.S[i][s+1]=n[1]}}};Blowfish.prototype.expandstate=function(t,r,n,i){var s=new Uint32Array(2),l,u;for(l=0,o=0;l<18;l++){this.P[l]^=stream2word(n,i)}for(l=0,o=0;l<18;l+=2){s[0]^=stream2word(t,r);s[1]^=stream2word(t,r);this.encipher(s);this.P[l]=s[0];this.P[l+1]=s[1]}for(l=0;l<4;l++){for(u=0;u<256;u+=2){s[0]^=stream2word(t,r);s[1]^=stream2word(t,r);this.encipher(s);this.S[l][u]=s[0];this.S[l][u+1]=s[1]}}o=0};Blowfish.prototype.enc=function(t,r){for(var n=0;n<r;n++){this.encipher(t.subarray(n*2))}};Blowfish.prototype.dec=function(t,r){for(var n=0;n<r;n++){this.decipher(t.subarray(n*2))}};var s=8,l=32;function bcrypt_hash(t,r,n){var i=new Blowfish,o=new Uint32Array(s),l,u=new Uint8Array([79,120,121,99,104,114,111,109,97,116,105,99,66,108,111,119,102,105,115,104,83,119,97,116,68,121,110,97,109,105,116,101]);i.expandstate(r,64,t,64);for(l=0;l<64;l++){i.expand0state(r,64);i.expand0state(t,64)}for(l=0;l<s;l++)o[l]=stream2word(u,u.byteLength);for(l=0;l<64;l++)i.enc(o,o.byteLength/8);for(l=0;l<s;l++){n[4*l+3]=o[l]>>>24;n[4*l+2]=o[l]>>>16;n[4*l+1]=o[l]>>>8;n[4*l+0]=o[l]}}function bcrypt_pbkdf(t,r,n,o,s,u,h){var p=new Uint8Array(64),g=new Uint8Array(64),m=new Uint8Array(l),_=new Uint8Array(l),E=new Uint8Array(o+4),b,y,w,I,C,R,B=u;if(h<1)return-1;if(r===0||o===0||u===0||u>m.byteLength*m.byteLength||o>1<<20)return-1;I=Math.floor((u+m.byteLength-1)/m.byteLength);w=Math.floor((u+I-1)/I);for(b=0;b<o;b++)E[b]=n[b];i(p,t,r);for(R=1;u>0;R++){E[o+0]=R>>>24;E[o+1]=R>>>16;E[o+2]=R>>>8;E[o+3]=R;i(g,E,o+4);bcrypt_hash(p,g,_);for(b=m.byteLength;b--;)m[b]=_[b];for(b=1;b<h;b++){i(g,_,_.byteLength);bcrypt_hash(p,g,_);for(y=0;y<m.byteLength;y++)m[y]^=_[y]}w=Math.min(w,u);for(b=0;b<w;b++){C=b*I+(R-1);if(C>=B)break;s[C]=m[b]}u-=b}return 0}t.exports={BLOCKS:s,HASHSIZE:l,hash:bcrypt_hash,pbkdf:bcrypt_pbkdf}},5276:(t,r,n)=>{"use strict";n.d(r,{Z:()=>l});var i=n(6792);const o=class File extends i.Z{#lastModified=0;#name="";constructor(t,r,n={}){if(arguments.length<2){throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`)}super(t,n);if(n===null)n={};const i=n.lastModified===undefined?Date.now():Number(n.lastModified);if(!Number.isNaN(i)){this.#lastModified=i}this.#name=String(r)}get name(){return this.#name}get lastModified(){return this.#lastModified}get[Symbol.toStringTag](){return"File"}};const s=o;const l=s},6792:(t,r,n)=>{"use strict";n.d(r,{Z:()=>u});var i=n(8010);
/*! fetch-blob. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> */const o=65536;async function*toIterator(t,r=true){for(const n of t){if("stream"in n){yield*n.stream()}else if(ArrayBuffer.isView(n)){if(r){let t=n.byteOffset;const r=n.byteOffset+n.byteLength;while(t!==r){const i=Math.min(r-t,o);const s=n.buffer.slice(t,t+i);t+=s.byteLength;yield new Uint8Array(s)}}else{yield n}}else{let t=0;while(t!==n.size){const r=n.slice(t,Math.min(n.size,t+o));const i=await r.arrayBuffer();t+=i.byteLength;yield new Uint8Array(i)}}}}const s=class Blob{#parts=[];#type="";#size=0;constructor(t=[],r={}){if(typeof t!=="object"||t===null){throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.")}if(typeof t[Symbol.iterator]!=="function"){throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.")}if(typeof r!=="object"&&typeof r!=="function"){throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.")}if(r===null)r={};const n=new TextEncoder;for(const r of t){let t;if(ArrayBuffer.isView(r)){t=new Uint8Array(r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength))}else if(r instanceof ArrayBuffer){t=new Uint8Array(r.slice(0))}else if(r instanceof Blob){t=r}else{t=n.encode(r)}this.#size+=ArrayBuffer.isView(t)?t.byteLength:t.size;this.#parts.push(t)}const i=r.type===undefined?"":String(r.type);this.#type=/^[\x20-\x7E]*$/.test(i)?i:""}get size(){return this.#size}get type(){return this.#type}async text(){const t=new TextDecoder;let r="";for await(const n of toIterator(this.#parts,false)){r+=t.decode(n,{stream:true})}r+=t.decode();return r}async arrayBuffer(){const t=new Uint8Array(this.size);let r=0;for await(const n of toIterator(this.#parts,false)){t.set(n,r);r+=n.length}return t.buffer}stream(){const t=toIterator(this.#parts,true);return new globalThis.ReadableStream({type:"bytes",async pull(r){const n=await t.next();n.done?r.close():r.enqueue(n.value)},async cancel(){await t.return()}})}slice(t=0,r=this.size,n=""){const{size:i}=this;let o=t<0?Math.max(i+t,0):Math.min(t,i);let s=r<0?Math.max(i+r,0):Math.min(r,i);const l=Math.max(s-o,0);const u=this.#parts;const h=[];let p=0;for(const t of u){if(p>=l){break}const r=ArrayBuffer.isView(t)?t.byteLength:t.size;if(o&&r<=o){o-=r;s-=r}else{let n;if(ArrayBuffer.isView(t)){n=t.subarray(o,Math.min(r,s));p+=n.byteLength}else{n=t.slice(o,Math.min(r,s));p+=n.size}s-=r;h.push(n);o=0}}const g=new Blob([],{type:String(n).toLowerCase()});g.#size=l;g.#parts=h;return g}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](t){return t&&typeof t==="object"&&typeof t.constructor==="function"&&(typeof t.stream==="function"||typeof t.arrayBuffer==="function")&&/^(Blob|File)$/.test(t[Symbol.toStringTag])}};Object.defineProperties(s.prototype,{size:{enumerable:true},type:{enumerable:true},slice:{enumerable:true}});const l=s;const u=l},1402:(t,r,n)=>{"use strict";n.d(r,{Ct:()=>m,au:()=>formDataToBlob});var i=n(6792);var o=n(5276);
/*! formdata-polyfill. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> */var{toStringTag:s,iterator:l,hasInstance:u}=Symbol,h=Math.random,p="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),f=(t,r,n)=>(t+="",/^(Blob|File)$/.test(r&&r[s])?[(n=n!==void 0?n+"":r[s]=="File"?r.name:"blob",t),r.name!==n||r[s]=="blob"?new o.Z([r],n,r):r]:[t,r+""]),e=(t,r)=>(r?t:t.replace(/\r?\n|\r/g,"\r\n")).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),x=(t,r,n)=>{if(r.length<n){throw new TypeError(`Failed to execute '${t}' on 'FormData': ${n} arguments required, but only ${r.length} present.`)}};const g=null&&F;const m=class FormData{#d=[];constructor(...t){if(t.length)throw new TypeError(`Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.`)}get[s](){return"FormData"}[l](){return this.entries()}static[u](t){return t&&typeof t==="object"&&t[s]==="FormData"&&!p.some((r=>typeof t[r]!="function"))}append(...t){x("append",arguments,2);this.#d.push(f(...t))}delete(t){x("delete",arguments,1);t+="";this.#d=this.#d.filter((([r])=>r!==t))}get(t){x("get",arguments,1);t+="";for(var r=this.#d,n=r.length,i=0;i<n;i++)if(r[i][0]===t)return r[i][1];return null}getAll(t,r){x("getAll",arguments,1);r=[];t+="";this.#d.forEach((n=>n[0]===t&&r.push(n[1])));return r}has(t){x("has",arguments,1);t+="";return this.#d.some((r=>r[0]===t))}forEach(t,r){x("forEach",arguments,1);for(var[n,i]of this)t.call(r,i,n,this)}set(...t){x("set",arguments,2);var r=[],n=!0;t=f(...t);this.#d.forEach((i=>{i[0]===t[0]?n&&(n=!r.push(t)):r.push(i)}));n&&r.push(t);this.#d=r}*entries(){yield*this.#d}*keys(){for(var[t]of this)yield t}*values(){for(var[,t]of this)yield t}};function formDataToBlob(t,r=i.Z){var n=`${h()}${h()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),o=[],s=`--${n}\r\nContent-Disposition: form-data; name="`;t.forEach(((t,r)=>typeof t=="string"?o.push(s+e(r)+`"\r\n\r\n${t.replace(/\r(?!\n)|(?<!\r)\n/g,"\r\n")}\r\n`):o.push(s+e(r)+`"; filename="${e(t.name,1)}"\r\nContent-Type: ${t.type||"application/octet-stream"}\r\n\r\n`,t,"\r\n")));o.push(`--${n}--`);return new r(o,{type:"multipart/form-data; boundary="+n})}},1554:t=>{"use strict";const isStream=t=>t!==null&&typeof t==="object"&&typeof t.pipe==="function";isStream.writable=t=>isStream(t)&&t.writable!==false&&typeof t._write==="function"&&typeof t._writableState==="object";isStream.readable=t=>isStream(t)&&t.readable!==false&&typeof t._read==="function"&&typeof t._readableState==="object";isStream.duplex=t=>isStream.writable(t)&&isStream.readable(t);isStream.transform=t=>isStream.duplex(t)&&typeof t._transform==="function";t.exports=isStream},9126:(t,r,n)=>{"use strict";const i=n(5747);const o=n(5622);const{promisify:s}=n(1669);const l=n(3689);const u=l.satisfies(process.version,">=10.12.0");const checkPath=t=>{if(process.platform==="win32"){const r=/[<>:"|?*]/.test(t.replace(o.parse(t).root,""));if(r){const r=new Error(`Path contains invalid characters: ${t}`);r.code="EINVAL";throw r}}};const processOptions=t=>{const r={mode:511,fs:i};return{...r,...t}};const permissionError=t=>{const r=new Error(`operation not permitted, mkdir '${t}'`);r.code="EPERM";r.errno=-4048;r.path=t;r.syscall="mkdir";return r};const makeDir=async(t,r)=>{checkPath(t);r=processOptions(r);const n=s(r.fs.mkdir);const l=s(r.fs.stat);if(u&&r.fs.mkdir===i.mkdir){const i=o.resolve(t);await n(i,{mode:r.mode,recursive:true});return i}const make=async t=>{try{await n(t,r.mode);return t}catch(r){if(r.code==="EPERM"){throw r}if(r.code==="ENOENT"){if(o.dirname(t)===t){throw permissionError(t)}if(r.message.includes("null bytes")){throw r}await make(o.dirname(t));return make(t)}try{const r=await l(t);if(!r.isDirectory()){throw new Error("The path is not a directory")}}catch(t){throw r}return t}};return make(o.resolve(t))};t.exports=makeDir;t.exports.sync=(t,r)=>{checkPath(t);r=processOptions(r);if(u&&r.fs.mkdirSync===i.mkdirSync){const n=o.resolve(t);i.mkdirSync(n,{mode:r.mode,recursive:true});return n}const make=t=>{try{r.fs.mkdirSync(t,r.mode)}catch(n){if(n.code==="EPERM"){throw n}if(n.code==="ENOENT"){if(o.dirname(t)===t){throw permissionError(t)}if(n.message.includes("null bytes")){throw n}make(o.dirname(t));return make(t)}try{if(!r.fs.statSync(t).isDirectory()){throw new Error("The path is not a directory")}}catch(t){throw n}}return t};return make(o.resolve(t))}},3689:(t,r)=>{r=t.exports=SemVer;var n;if(typeof process==="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)){n=function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("SEMVER");console.log.apply(console,t)}}else{n=function(){}}r.SEMVER_SPEC_VERSION="2.0.0";var i=256;var o=Number.MAX_SAFE_INTEGER||9007199254740991;var s=16;var l=r.re=[];var u=r.src=[];var h=r.tokens={};var p=0;function tok(t){h[t]=p++}tok("NUMERICIDENTIFIER");u[h.NUMERICIDENTIFIER]="0|[1-9]\\d*";tok("NUMERICIDENTIFIERLOOSE");u[h.NUMERICIDENTIFIERLOOSE]="[0-9]+";tok("NONNUMERICIDENTIFIER");u[h.NONNUMERICIDENTIFIER]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";tok("MAINVERSION");u[h.MAINVERSION]="("+u[h.NUMERICIDENTIFIER]+")\\."+"("+u[h.NUMERICIDENTIFIER]+")\\."+"("+u[h.NUMERICIDENTIFIER]+")";tok("MAINVERSIONLOOSE");u[h.MAINVERSIONLOOSE]="("+u[h.NUMERICIDENTIFIERLOOSE]+")\\."+"("+u[h.NUMERICIDENTIFIERLOOSE]+")\\."+"("+u[h.NUMERICIDENTIFIERLOOSE]+")";tok("PRERELEASEIDENTIFIER");u[h.PRERELEASEIDENTIFIER]="(?:"+u[h.NUMERICIDENTIFIER]+"|"+u[h.NONNUMERICIDENTIFIER]+")";tok("PRERELEASEIDENTIFIERLOOSE");u[h.PRERELEASEIDENTIFIERLOOSE]="(?:"+u[h.NUMERICIDENTIFIERLOOSE]+"|"+u[h.NONNUMERICIDENTIFIER]+")";tok("PRERELEASE");u[h.PRERELEASE]="(?:-("+u[h.PRERELEASEIDENTIFIER]+"(?:\\."+u[h.PRERELEASEIDENTIFIER]+")*))";tok("PRERELEASELOOSE");u[h.PRERELEASELOOSE]="(?:-?("+u[h.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+u[h.PRERELEASEIDENTIFIERLOOSE]+")*))";tok("BUILDIDENTIFIER");u[h.BUILDIDENTIFIER]="[0-9A-Za-z-]+";tok("BUILD");u[h.BUILD]="(?:\\+("+u[h.BUILDIDENTIFIER]+"(?:\\."+u[h.BUILDIDENTIFIER]+")*))";tok("FULL");tok("FULLPLAIN");u[h.FULLPLAIN]="v?"+u[h.MAINVERSION]+u[h.PRERELEASE]+"?"+u[h.BUILD]+"?";u[h.FULL]="^"+u[h.FULLPLAIN]+"$";tok("LOOSEPLAIN");u[h.LOOSEPLAIN]="[v=\\s]*"+u[h.MAINVERSIONLOOSE]+u[h.PRERELEASELOOSE]+"?"+u[h.BUILD]+"?";tok("LOOSE");u[h.LOOSE]="^"+u[h.LOOSEPLAIN]+"$";tok("GTLT");u[h.GTLT]="((?:<|>)?=?)";tok("XRANGEIDENTIFIERLOOSE");u[h.XRANGEIDENTIFIERLOOSE]=u[h.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*";tok("XRANGEIDENTIFIER");u[h.XRANGEIDENTIFIER]=u[h.NUMERICIDENTIFIER]+"|x|X|\\*";tok("XRANGEPLAIN");u[h.XRANGEPLAIN]="[v=\\s]*("+u[h.XRANGEIDENTIFIER]+")"+"(?:\\.("+u[h.XRANGEIDENTIFIER]+")"+"(?:\\.("+u[h.XRANGEIDENTIFIER]+")"+"(?:"+u[h.PRERELEASE]+")?"+u[h.BUILD]+"?"+")?)?";tok("XRANGEPLAINLOOSE");u[h.XRANGEPLAINLOOSE]="[v=\\s]*("+u[h.XRANGEIDENTIFIERLOOSE]+")"+"(?:\\.("+u[h.XRANGEIDENTIFIERLOOSE]+")"+"(?:\\.("+u[h.XRANGEIDENTIFIERLOOSE]+")"+"(?:"+u[h.PRERELEASELOOSE]+")?"+u[h.BUILD]+"?"+")?)?";tok("XRANGE");u[h.XRANGE]="^"+u[h.GTLT]+"\\s*"+u[h.XRANGEPLAIN]+"$";tok("XRANGELOOSE");u[h.XRANGELOOSE]="^"+u[h.GTLT]+"\\s*"+u[h.XRANGEPLAINLOOSE]+"$";tok("COERCE");u[h.COERCE]="(^|[^\\d])"+"(\\d{1,"+s+"})"+"(?:\\.(\\d{1,"+s+"}))?"+"(?:\\.(\\d{1,"+s+"}))?"+"(?:$|[^\\d])";tok("COERCERTL");l[h.COERCERTL]=new RegExp(u[h.COERCE],"g");tok("LONETILDE");u[h.LONETILDE]="(?:~>?)";tok("TILDETRIM");u[h.TILDETRIM]="(\\s*)"+u[h.LONETILDE]+"\\s+";l[h.TILDETRIM]=new RegExp(u[h.TILDETRIM],"g");var g="$1~";tok("TILDE");u[h.TILDE]="^"+u[h.LONETILDE]+u[h.XRANGEPLAIN]+"$";tok("TILDELOOSE");u[h.TILDELOOSE]="^"+u[h.LONETILDE]+u[h.XRANGEPLAINLOOSE]+"$";tok("LONECARET");u[h.LONECARET]="(?:\\^)";tok("CARETTRIM");u[h.CARETTRIM]="(\\s*)"+u[h.LONECARET]+"\\s+";l[h.CARETTRIM]=new RegExp(u[h.CARETTRIM],"g");var m="$1^";tok("CARET");u[h.CARET]="^"+u[h.LONECARET]+u[h.XRANGEPLAIN]+"$";tok("CARETLOOSE");u[h.CARETLOOSE]="^"+u[h.LONECARET]+u[h.XRANGEPLAINLOOSE]+"$";tok("COMPARATORLOOSE");u[h.COMPARATORLOOSE]="^"+u[h.GTLT]+"\\s*("+u[h.LOOSEPLAIN]+")$|^$";tok("COMPARATOR");u[h.COMPARATOR]="^"+u[h.GTLT]+"\\s*("+u[h.FULLPLAIN]+")$|^$";tok("COMPARATORTRIM");u[h.COMPARATORTRIM]="(\\s*)"+u[h.GTLT]+"\\s*("+u[h.LOOSEPLAIN]+"|"+u[h.XRANGEPLAIN]+")";l[h.COMPARATORTRIM]=new RegExp(u[h.COMPARATORTRIM],"g");var _="$1$2$3";tok("HYPHENRANGE");u[h.HYPHENRANGE]="^\\s*("+u[h.XRANGEPLAIN]+")"+"\\s+-\\s+"+"("+u[h.XRANGEPLAIN]+")"+"\\s*$";tok("HYPHENRANGELOOSE");u[h.HYPHENRANGELOOSE]="^\\s*("+u[h.XRANGEPLAINLOOSE]+")"+"\\s+-\\s+"+"("+u[h.XRANGEPLAINLOOSE]+")"+"\\s*$";tok("STAR");u[h.STAR]="(<|>)?=?\\s*\\*";for(var E=0;E<p;E++){n(E,u[E]);if(!l[E]){l[E]=new RegExp(u[E])}}r.parse=parse;function parse(t,r){if(!r||typeof r!=="object"){r={loose:!!r,includePrerelease:false}}if(t instanceof SemVer){return t}if(typeof t!=="string"){return null}if(t.length>i){return null}var n=r.loose?l[h.LOOSE]:l[h.FULL];if(!n.test(t)){return null}try{return new SemVer(t,r)}catch(t){return null}}r.valid=valid;function valid(t,r){var n=parse(t,r);return n?n.version:null}r.clean=clean;function clean(t,r){var n=parse(t.trim().replace(/^[=v]+/,""),r);return n?n.version:null}r.SemVer=SemVer;function SemVer(t,r){if(!r||typeof r!=="object"){r={loose:!!r,includePrerelease:false}}if(t instanceof SemVer){if(t.loose===r.loose){return t}else{t=t.version}}else if(typeof t!=="string"){throw new TypeError("Invalid Version: "+t)}if(t.length>i){throw new TypeError("version is longer than "+i+" characters")}if(!(this instanceof SemVer)){return new SemVer(t,r)}n("SemVer",t,r);this.options=r;this.loose=!!r.loose;var s=t.trim().match(r.loose?l[h.LOOSE]:l[h.FULL]);if(!s){throw new TypeError("Invalid Version: "+t)}this.raw=t;this.major=+s[1];this.minor=+s[2];this.patch=+s[3];if(this.major>o||this.major<0){throw new TypeError("Invalid major version")}if(this.minor>o||this.minor<0){throw new TypeError("Invalid minor version")}if(this.patch>o||this.patch<0){throw new TypeError("Invalid patch version")}if(!s[4]){this.prerelease=[]}else{this.prerelease=s[4].split(".").map((function(t){if(/^[0-9]+$/.test(t)){var r=+t;if(r>=0&&r<o){return r}}return t}))}this.build=s[5]?s[5].split("."):[];this.format()}SemVer.prototype.format=function(){this.version=this.major+"."+this.minor+"."+this.patch;if(this.prerelease.length){this.version+="-"+this.prerelease.join(".")}return this.version};SemVer.prototype.toString=function(){return this.version};SemVer.prototype.compare=function(t){n("SemVer.compare",this.version,this.options,t);if(!(t instanceof SemVer)){t=new SemVer(t,this.options)}return this.compareMain(t)||this.comparePre(t)};SemVer.prototype.compareMain=function(t){if(!(t instanceof SemVer)){t=new SemVer(t,this.options)}return compareIdentifiers(this.major,t.major)||compareIdentifiers(this.minor,t.minor)||compareIdentifiers(this.patch,t.patch)};SemVer.prototype.comparePre=function(t){if(!(t instanceof SemVer)){t=new SemVer(t,this.options)}if(this.prerelease.length&&!t.prerelease.length){return-1}else if(!this.prerelease.length&&t.prerelease.length){return 1}else if(!this.prerelease.length&&!t.prerelease.length){return 0}var r=0;do{var i=this.prerelease[r];var o=t.prerelease[r];n("prerelease compare",r,i,o);if(i===undefined&&o===undefined){return 0}else if(o===undefined){return 1}else if(i===undefined){return-1}else if(i===o){continue}else{return compareIdentifiers(i,o)}}while(++r)};SemVer.prototype.compareBuild=function(t){if(!(t instanceof SemVer)){t=new SemVer(t,this.options)}var r=0;do{var i=this.build[r];var o=t.build[r];n("prerelease compare",r,i,o);if(i===undefined&&o===undefined){return 0}else if(o===undefined){return 1}else if(i===undefined){return-1}else if(i===o){continue}else{return compareIdentifiers(i,o)}}while(++r)};SemVer.prototype.inc=function(t,r){switch(t){case"premajor":this.prerelease.length=0;this.patch=0;this.minor=0;this.major++;this.inc("pre",r);break;case"preminor":this.prerelease.length=0;this.patch=0;this.minor++;this.inc("pre",r);break;case"prepatch":this.prerelease.length=0;this.inc("patch",r);this.inc("pre",r);break;case"prerelease":if(this.prerelease.length===0){this.inc("patch",r)}this.inc("pre",r);break;case"major":if(this.minor!==0||this.patch!==0||this.prerelease.length===0){this.major++}this.minor=0;this.patch=0;this.prerelease=[];break;case"minor":if(this.patch!==0||this.prerelease.length===0){this.minor++}this.patch=0;this.prerelease=[];break;case"patch":if(this.prerelease.length===0){this.patch++}this.prerelease=[];break;case"pre":if(this.prerelease.length===0){this.prerelease=[0]}else{var n=this.prerelease.length;while(--n>=0){if(typeof this.prerelease[n]==="number"){this.prerelease[n]++;n=-2}}if(n===-1){this.prerelease.push(0)}}if(r){if(this.prerelease[0]===r){if(isNaN(this.prerelease[1])){this.prerelease=[r,0]}}else{this.prerelease=[r,0]}}break;default:throw new Error("invalid increment argument: "+t)}this.format();this.raw=this.version;return this};r.inc=inc;function inc(t,r,n,i){if(typeof n==="string"){i=n;n=undefined}try{return new SemVer(t,n).inc(r,i).version}catch(t){return null}}r.diff=diff;function diff(t,r){if(eq(t,r)){return null}else{var n=parse(t);var i=parse(r);var o="";if(n.prerelease.length||i.prerelease.length){o="pre";var s="prerelease"}for(var l in n){if(l==="major"||l==="minor"||l==="patch"){if(n[l]!==i[l]){return o+l}}}return s}}r.compareIdentifiers=compareIdentifiers;var b=/^[0-9]+$/;function compareIdentifiers(t,r){var n=b.test(t);var i=b.test(r);if(n&&i){t=+t;r=+r}return t===r?0:n&&!i?-1:i&&!n?1:t<r?-1:1}r.rcompareIdentifiers=rcompareIdentifiers;function rcompareIdentifiers(t,r){return compareIdentifiers(r,t)}r.major=major;function major(t,r){return new SemVer(t,r).major}r.minor=minor;function minor(t,r){return new SemVer(t,r).minor}r.patch=patch;function patch(t,r){return new SemVer(t,r).patch}r.compare=compare;function compare(t,r,n){return new SemVer(t,n).compare(new SemVer(r,n))}r.compareLoose=compareLoose;function compareLoose(t,r){return compare(t,r,true)}r.compareBuild=compareBuild;function compareBuild(t,r,n){var i=new SemVer(t,n);var o=new SemVer(r,n);return i.compare(o)||i.compareBuild(o)}r.rcompare=rcompare;function rcompare(t,r,n){return compare(r,t,n)}r.sort=sort;function sort(t,n){return t.sort((function(t,i){return r.compareBuild(t,i,n)}))}r.rsort=rsort;function rsort(t,n){return t.sort((function(t,i){return r.compareBuild(i,t,n)}))}r.gt=gt;function gt(t,r,n){return compare(t,r,n)>0}r.lt=lt;function lt(t,r,n){return compare(t,r,n)<0}r.eq=eq;function eq(t,r,n){return compare(t,r,n)===0}r.neq=neq;function neq(t,r,n){return compare(t,r,n)!==0}r.gte=gte;function gte(t,r,n){return compare(t,r,n)>=0}r.lte=lte;function lte(t,r,n){return compare(t,r,n)<=0}r.cmp=cmp;function cmp(t,r,n,i){switch(r){case"===":if(typeof t==="object")t=t.version;if(typeof n==="object")n=n.version;return t===n;case"!==":if(typeof t==="object")t=t.version;if(typeof n==="object")n=n.version;return t!==n;case"":case"=":case"==":return eq(t,n,i);case"!=":return neq(t,n,i);case">":return gt(t,n,i);case">=":return gte(t,n,i);case"<":return lt(t,n,i);case"<=":return lte(t,n,i);default:throw new TypeError("Invalid operator: "+r)}}r.Comparator=Comparator;function Comparator(t,r){if(!r||typeof r!=="object"){r={loose:!!r,includePrerelease:false}}if(t instanceof Comparator){if(t.loose===!!r.loose){return t}else{t=t.value}}if(!(this instanceof Comparator)){return new Comparator(t,r)}n("comparator",t,r);this.options=r;this.loose=!!r.loose;this.parse(t);if(this.semver===y){this.value=""}else{this.value=this.operator+this.semver.version}n("comp",this)}var y={};Comparator.prototype.parse=function(t){var r=this.options.loose?l[h.COMPARATORLOOSE]:l[h.COMPARATOR];var n=t.match(r);if(!n){throw new TypeError("Invalid comparator: "+t)}this.operator=n[1]!==undefined?n[1]:"";if(this.operator==="="){this.operator=""}if(!n[2]){this.semver=y}else{this.semver=new SemVer(n[2],this.options.loose)}};Comparator.prototype.toString=function(){return this.value};Comparator.prototype.test=function(t){n("Comparator.test",t,this.options.loose);if(this.semver===y||t===y){return true}if(typeof t==="string"){try{t=new SemVer(t,this.options)}catch(t){return false}}return cmp(t,this.operator,this.semver,this.options)};Comparator.prototype.intersects=function(t,r){if(!(t instanceof Comparator)){throw new TypeError("a Comparator is required")}if(!r||typeof r!=="object"){r={loose:!!r,includePrerelease:false}}var n;if(this.operator===""){if(this.value===""){return true}n=new Range(t.value,r);return satisfies(this.value,n,r)}else if(t.operator===""){if(t.value===""){return true}n=new Range(this.value,r);return satisfies(t.semver,n,r)}var i=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">");var o=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<");var s=this.semver.version===t.semver.version;var l=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<=");var u=cmp(this.semver,"<",t.semver,r)&&((this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"));var h=cmp(this.semver,">",t.semver,r)&&((this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">"));return i||o||s&&l||u||h};r.Range=Range;function Range(t,r){if(!r||typeof r!=="object"){r={loose:!!r,includePrerelease:false}}if(t instanceof Range){if(t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease){return t}else{return new Range(t.raw,r)}}if(t instanceof Comparator){return new Range(t.value,r)}if(!(this instanceof Range)){return new Range(t,r)}this.options=r;this.loose=!!r.loose;this.includePrerelease=!!r.includePrerelease;this.raw=t;this.set=t.split(/\s*\|\|\s*/).map((function(t){return this.parseRange(t.trim())}),this).filter((function(t){return t.length}));if(!this.set.length){throw new TypeError("Invalid SemVer Range: "+t)}this.format()}Range.prototype.format=function(){this.range=this.set.map((function(t){return t.join(" ").trim()})).join("||").trim();return this.range};Range.prototype.toString=function(){return this.range};Range.prototype.parseRange=function(t){var r=this.options.loose;t=t.trim();var i=r?l[h.HYPHENRANGELOOSE]:l[h.HYPHENRANGE];t=t.replace(i,hyphenReplace);n("hyphen replace",t);t=t.replace(l[h.COMPARATORTRIM],_);n("comparator trim",t,l[h.COMPARATORTRIM]);t=t.replace(l[h.TILDETRIM],g);t=t.replace(l[h.CARETTRIM],m);t=t.split(/\s+/).join(" ");var o=r?l[h.COMPARATORLOOSE]:l[h.COMPARATOR];var s=t.split(" ").map((function(t){return parseComparator(t,this.options)}),this).join(" ").split(/\s+/);if(this.options.loose){s=s.filter((function(t){return!!t.match(o)}))}s=s.map((function(t){return new Comparator(t,this.options)}),this);return s};Range.prototype.intersects=function(t,r){if(!(t instanceof Range)){throw new TypeError("a Range is required")}return this.set.some((function(n){return isSatisfiable(n,r)&&t.set.some((function(t){return isSatisfiable(t,r)&&n.every((function(n){return t.every((function(t){return n.intersects(t,r)}))}))}))}))};function isSatisfiable(t,r){var n=true;var i=t.slice();var o=i.pop();while(n&&i.length){n=i.every((function(t){return o.intersects(t,r)}));o=i.pop()}return n}r.toComparators=toComparators;function toComparators(t,r){return new Range(t,r).set.map((function(t){return t.map((function(t){return t.value})).join(" ").trim().split(" ")}))}function parseComparator(t,r){n("comp",t,r);t=replaceCarets(t,r);n("caret",t);t=replaceTildes(t,r);n("tildes",t);t=replaceXRanges(t,r);n("xrange",t);t=replaceStars(t,r);n("stars",t);return t}function isX(t){return!t||t.toLowerCase()==="x"||t==="*"}function replaceTildes(t,r){return t.trim().split(/\s+/).map((function(t){return replaceTilde(t,r)})).join(" ")}function replaceTilde(t,r){var i=r.loose?l[h.TILDELOOSE]:l[h.TILDE];return t.replace(i,(function(r,i,o,s,l){n("tilde",t,r,i,o,s,l);var u;if(isX(i)){u=""}else if(isX(o)){u=">="+i+".0.0 <"+(+i+1)+".0.0"}else if(isX(s)){u=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0"}else if(l){n("replaceTilde pr",l);u=">="+i+"."+o+"."+s+"-"+l+" <"+i+"."+(+o+1)+".0"}else{u=">="+i+"."+o+"."+s+" <"+i+"."+(+o+1)+".0"}n("tilde return",u);return u}))}function replaceCarets(t,r){return t.trim().split(/\s+/).map((function(t){return replaceCaret(t,r)})).join(" ")}function replaceCaret(t,r){n("caret",t,r);var i=r.loose?l[h.CARETLOOSE]:l[h.CARET];return t.replace(i,(function(r,i,o,s,l){n("caret",t,r,i,o,s,l);var u;if(isX(i)){u=""}else if(isX(o)){u=">="+i+".0.0 <"+(+i+1)+".0.0"}else if(isX(s)){if(i==="0"){u=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0"}else{u=">="+i+"."+o+".0 <"+(+i+1)+".0.0"}}else if(l){n("replaceCaret pr",l);if(i==="0"){if(o==="0"){u=">="+i+"."+o+"."+s+"-"+l+" <"+i+"."+o+"."+(+s+1)}else{u=">="+i+"."+o+"."+s+"-"+l+" <"+i+"."+(+o+1)+".0"}}else{u=">="+i+"."+o+"."+s+"-"+l+" <"+(+i+1)+".0.0"}}else{n("no pr");if(i==="0"){if(o==="0"){u=">="+i+"."+o+"."+s+" <"+i+"."+o+"."+(+s+1)}else{u=">="+i+"."+o+"."+s+" <"+i+"."+(+o+1)+".0"}}else{u=">="+i+"."+o+"."+s+" <"+(+i+1)+".0.0"}}n("caret return",u);return u}))}function replaceXRanges(t,r){n("replaceXRanges",t,r);return t.split(/\s+/).map((function(t){return replaceXRange(t,r)})).join(" ")}function replaceXRange(t,r){t=t.trim();var i=r.loose?l[h.XRANGELOOSE]:l[h.XRANGE];return t.replace(i,(function(i,o,s,l,u,h){n("xRange",t,i,o,s,l,u,h);var p=isX(s);var g=p||isX(l);var m=g||isX(u);var _=m;if(o==="="&&_){o=""}h=r.includePrerelease?"-0":"";if(p){if(o===">"||o==="<"){i="<0.0.0-0"}else{i="*"}}else if(o&&_){if(g){l=0}u=0;if(o===">"){o=">=";if(g){s=+s+1;l=0;u=0}else{l=+l+1;u=0}}else if(o==="<="){o="<";if(g){s=+s+1}else{l=+l+1}}i=o+s+"."+l+"."+u+h}else if(g){i=">="+s+".0.0"+h+" <"+(+s+1)+".0.0"+h}else if(m){i=">="+s+"."+l+".0"+h+" <"+s+"."+(+l+1)+".0"+h}n("xRange return",i);return i}))}function replaceStars(t,r){n("replaceStars",t,r);return t.trim().replace(l[h.STAR],"")}function hyphenReplace(t,r,n,i,o,s,l,u,h,p,g,m,_){if(isX(n)){r=""}else if(isX(i)){r=">="+n+".0.0"}else if(isX(o)){r=">="+n+"."+i+".0"}else{r=">="+r}if(isX(h)){u=""}else if(isX(p)){u="<"+(+h+1)+".0.0"}else if(isX(g)){u="<"+h+"."+(+p+1)+".0"}else if(m){u="<="+h+"."+p+"."+g+"-"+m}else{u="<="+u}return(r+" "+u).trim()}Range.prototype.test=function(t){if(!t){return false}if(typeof t==="string"){try{t=new SemVer(t,this.options)}catch(t){return false}}for(var r=0;r<this.set.length;r++){if(testSet(this.set[r],t,this.options)){return true}}return false};function testSet(t,r,i){for(var o=0;o<t.length;o++){if(!t[o].test(r)){return false}}if(r.prerelease.length&&!i.includePrerelease){for(o=0;o<t.length;o++){n(t[o].semver);if(t[o].semver===y){continue}if(t[o].semver.prerelease.length>0){var s=t[o].semver;if(s.major===r.major&&s.minor===r.minor&&s.patch===r.patch){return true}}}return false}return true}r.satisfies=satisfies;function satisfies(t,r,n){try{r=new Range(r,n)}catch(t){return false}return r.test(t)}r.maxSatisfying=maxSatisfying;function maxSatisfying(t,r,n){var i=null;var o=null;try{var s=new Range(r,n)}catch(t){return null}t.forEach((function(t){if(s.test(t)){if(!i||o.compare(t)===-1){i=t;o=new SemVer(i,n)}}}));return i}r.minSatisfying=minSatisfying;function minSatisfying(t,r,n){var i=null;var o=null;try{var s=new Range(r,n)}catch(t){return null}t.forEach((function(t){if(s.test(t)){if(!i||o.compare(t)===1){i=t;o=new SemVer(i,n)}}}));return i}r.minVersion=minVersion;function minVersion(t,r){t=new Range(t,r);var n=new SemVer("0.0.0");if(t.test(n)){return n}n=new SemVer("0.0.0-0");if(t.test(n)){return n}n=null;for(var i=0;i<t.set.length;++i){var o=t.set[i];o.forEach((function(t){var r=new SemVer(t.semver.version);switch(t.operator){case">":if(r.prerelease.length===0){r.patch++}else{r.prerelease.push(0)}r.raw=r.format();case"":case">=":if(!n||gt(n,r)){n=r}break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+t.operator)}}))}if(n&&t.test(n)){return n}return null}r.validRange=validRange;function validRange(t,r){try{return new Range(t,r).range||"*"}catch(t){return null}}r.ltr=ltr;function ltr(t,r,n){return outside(t,r,"<",n)}r.gtr=gtr;function gtr(t,r,n){return outside(t,r,">",n)}r.outside=outside;function outside(t,r,n,i){t=new SemVer(t,i);r=new Range(r,i);var o,s,l,u,h;switch(n){case">":o=gt;s=lte;l=lt;u=">";h=">=";break;case"<":o=lt;s=gte;l=gt;u="<";h="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(satisfies(t,r,i)){return false}for(var p=0;p<r.set.length;++p){var g=r.set[p];var m=null;var _=null;g.forEach((function(t){if(t.semver===y){t=new Comparator(">=0.0.0")}m=m||t;_=_||t;if(o(t.semver,m.semver,i)){m=t}else if(l(t.semver,_.semver,i)){_=t}}));if(m.operator===u||m.operator===h){return false}if((!_.operator||_.operator===u)&&s(t,_.semver)){return false}else if(_.operator===h&&l(t,_.semver)){return false}}return true}r.prerelease=prerelease;function prerelease(t,r){var n=parse(t,r);return n&&n.prerelease.length?n.prerelease:null}r.intersects=intersects;function intersects(t,r,n){t=new Range(t,n);r=new Range(r,n);return t.intersects(r)}r.coerce=coerce;function coerce(t,r){if(t instanceof SemVer){return t}if(typeof t==="number"){t=String(t)}if(typeof t!=="string"){return null}r=r||{};var n=null;if(!r.rtl){n=t.match(l[h.COERCE])}else{var i;while((i=l[h.COERCERTL].exec(t))&&(!n||n.index+n[0].length!==t.length)){if(!n||i.index+i[0].length!==n.index+n[0].length){n=i}l[h.COERCERTL].lastIndex=i.index+i[1].length+i[2].length}l[h.COERCERTL].lastIndex=-1}if(n===null){return null}return parse(n[2]+"."+(n[3]||"0")+"."+(n[4]||"0"),r)}},7894:(t,r,n)=>{"use strict";n.r(r);n.d(r,{AbortError:()=>AbortError,FetchError:()=>FetchError,Headers:()=>Headers,Request:()=>Request,Response:()=>Response,default:()=>fetch,isRedirect:()=>isRedirect});const i=require("node:http");const o=require("node:https");const s=require("node:zlib");const l=require("node:stream");function dataUriToBuffer(t){if(!/^data:/i.test(t)){throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")')}t=t.replace(/\r?\n/g,"");const r=t.indexOf(",");if(r===-1||r<=4){throw new TypeError("malformed data: URI")}const n=t.substring(5,r).split(";");let i="";let o=false;const s=n[0]||"text/plain";let l=s;for(let t=1;t<n.length;t++){if(n[t]==="base64"){o=true}else{l+=`;${n[t]}`;if(n[t].indexOf("charset=")===0){i=n[t].substring(8)}}}if(!n[0]&&!i.length){l+=";charset=US-ASCII";i="US-ASCII"}const u=o?"base64":"ascii";const h=unescape(t.substring(r+1));const p=Buffer.from(h,u);p.type=s;p.typeFull=l;p.charset=i;return p}const u=dataUriToBuffer;const h=require("node:util");var p=n(6792);var g=n(1402);class FetchBaseError extends Error{constructor(t,r){super(t);Error.captureStackTrace(this,this.constructor);this.type=r}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}}class FetchError extends FetchBaseError{constructor(t,r,n){super(t,r);if(n){this.code=this.errno=n.code;this.erroredSysCall=n.syscall}}}const m=Symbol.toStringTag;const isURLSearchParameters=t=>typeof t==="object"&&typeof t.append==="function"&&typeof t.delete==="function"&&typeof t.get==="function"&&typeof t.getAll==="function"&&typeof t.has==="function"&&typeof t.set==="function"&&typeof t.sort==="function"&&t[m]==="URLSearchParams";const isBlob=t=>t&&typeof t==="object"&&typeof t.arrayBuffer==="function"&&typeof t.type==="string"&&typeof t.stream==="function"&&typeof t.constructor==="function"&&/^(Blob|File)$/.test(t[m]);const isAbortSignal=t=>typeof t==="object"&&(t[m]==="AbortSignal"||t[m]==="EventTarget");const _=Symbol("Body internals");class Body{constructor(t,{size:r=0}={}){let n=null;if(t===null){t=null}else if(isURLSearchParameters(t)){t=Buffer.from(t.toString())}else if(isBlob(t)){}else if(Buffer.isBuffer(t)){}else if(h.types.isAnyArrayBuffer(t)){t=Buffer.from(t)}else if(ArrayBuffer.isView(t)){t=Buffer.from(t.buffer,t.byteOffset,t.byteLength)}else if(t instanceof l){}else if(t instanceof g.Ct){t=(0,g.au)(t);n=t.type.split("=")[1]}else{t=Buffer.from(String(t))}let i=t;if(Buffer.isBuffer(t)){i=l.Readable.from(t)}else if(isBlob(t)){i=l.Readable.from(t.stream())}this[_]={body:t,stream:i,boundary:n,disturbed:false,error:null};this.size=r;if(t instanceof l){t.on("error",(t=>{const r=t instanceof FetchBaseError?t:new FetchError(`Invalid response body while trying to fetch ${this.url}: ${t.message}`,"system",t);this[_].error=r}))}}get body(){return this[_].stream}get bodyUsed(){return this[_].disturbed}async arrayBuffer(){const{buffer:t,byteOffset:r,byteLength:n}=await consumeBody(this);return t.slice(r,r+n)}async formData(){const t=this.headers.get("content-type");if(t.startsWith("application/x-www-form-urlencoded")){const t=new g.Ct;const r=new URLSearchParams(await this.text());for(const[n,i]of r){t.append(n,i)}return t}const{toFormData:r}=await n.e(478).then(n.bind(n,478));return r(this.body,t)}async blob(){const t=this.headers&&this.headers.get("content-type")||this[_].body&&this[_].body.type||"";const r=await this.buffer();return new p.Z([r],{type:t})}async json(){const t=await consumeBody(this);return JSON.parse(t.toString())}async text(){const t=await consumeBody(this);return t.toString()}buffer(){return consumeBody(this)}}Body.prototype.buffer=(0,h.deprecate)(Body.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(Body.prototype,{body:{enumerable:true},bodyUsed:{enumerable:true},arrayBuffer:{enumerable:true},blob:{enumerable:true},json:{enumerable:true},text:{enumerable:true}});async function consumeBody(t){if(t[_].disturbed){throw new TypeError(`body used already for: ${t.url}`)}t[_].disturbed=true;if(t[_].error){throw t[_].error}const{body:r}=t;if(r===null){return Buffer.alloc(0)}if(!(r instanceof l)){return Buffer.alloc(0)}const n=[];let i=0;try{for await(const o of r){if(t.size>0&&i+o.length>t.size){const n=new FetchError(`content size at ${t.url} over limit: ${t.size}`,"max-size");r.destroy(n);throw n}i+=o.length;n.push(o)}}catch(r){const n=r instanceof FetchBaseError?r:new FetchError(`Invalid response body while trying to fetch ${t.url}: ${r.message}`,"system",r);throw n}if(r.readableEnded===true||r._readableState.ended===true){try{if(n.every((t=>typeof t==="string"))){return Buffer.from(n.join(""))}return Buffer.concat(n,i)}catch(r){throw new FetchError(`Could not create Buffer from response body for ${t.url}: ${r.message}`,"system",r)}}else{throw new FetchError(`Premature close of server response while trying to fetch ${t.url}`)}}const clone=(t,r)=>{let n;let i;let{body:o}=t[_];if(t.bodyUsed){throw new Error("cannot clone body after it is used")}if(o instanceof l&&typeof o.getBoundary!=="function"){n=new l.PassThrough({highWaterMark:r});i=new l.PassThrough({highWaterMark:r});o.pipe(n);o.pipe(i);t[_].stream=n;o=i}return o};const E=(0,h.deprecate)((t=>t.getBoundary()),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167");const extractContentType=(t,r)=>{if(t===null){return null}if(typeof t==="string"){return"text/plain;charset=UTF-8"}if(isURLSearchParameters(t)){return"application/x-www-form-urlencoded;charset=UTF-8"}if(isBlob(t)){return t.type||null}if(Buffer.isBuffer(t)||h.types.isAnyArrayBuffer(t)||ArrayBuffer.isView(t)){return null}if(t instanceof g.Ct){return`multipart/form-data; boundary=${r[_].boundary}`}if(t&&typeof t.getBoundary==="function"){return`multipart/form-data;boundary=${E(t)}`}if(t instanceof l){return null}return"text/plain;charset=UTF-8"};const getTotalBytes=t=>{const{body:r}=t[_];if(r===null){return 0}if(isBlob(r)){return r.size}if(Buffer.isBuffer(r)){return r.length}if(r&&typeof r.getLengthSync==="function"){return r.hasKnownLength&&r.hasKnownLength()?r.getLengthSync():null}return null};const writeToStream=(t,{body:r})=>{if(r===null){t.end()}else{r.pipe(t)}};const b=typeof i.validateHeaderName==="function"?i.validateHeaderName:t=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(t)){const r=new TypeError(`Header name must be a valid HTTP token [${t}]`);Object.defineProperty(r,"code",{value:"ERR_INVALID_HTTP_TOKEN"});throw r}};const y=typeof i.validateHeaderValue==="function"?i.validateHeaderValue:(t,r)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(r)){const r=new TypeError(`Invalid character in header content ["${t}"]`);Object.defineProperty(r,"code",{value:"ERR_INVALID_CHAR"});throw r}};class Headers extends URLSearchParams{constructor(t){let r=[];if(t instanceof Headers){const n=t.raw();for(const[t,i]of Object.entries(n)){r.push(...i.map((r=>[t,r])))}}else if(t==null){}else if(typeof t==="object"&&!h.types.isBoxedPrimitive(t)){const n=t[Symbol.iterator];if(n==null){r.push(...Object.entries(t))}else{if(typeof n!=="function"){throw new TypeError("Header pairs must be iterable")}r=[...t].map((t=>{if(typeof t!=="object"||h.types.isBoxedPrimitive(t)){throw new TypeError("Each header pair must be an iterable object")}return[...t]})).map((t=>{if(t.length!==2){throw new TypeError("Each header pair must be a name/value tuple")}return[...t]}))}}else{throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)")}r=r.length>0?r.map((([t,r])=>{b(t);y(t,String(r));return[String(t).toLowerCase(),String(r)]})):undefined;super(r);return new Proxy(this,{get(t,r,n){switch(r){case"append":case"set":return(n,i)=>{b(n);y(n,String(i));return URLSearchParams.prototype[r].call(t,String(n).toLowerCase(),String(i))};case"delete":case"has":case"getAll":return n=>{b(n);return URLSearchParams.prototype[r].call(t,String(n).toLowerCase())};case"keys":return()=>{t.sort();return new Set(URLSearchParams.prototype.keys.call(t)).keys()};default:return Reflect.get(t,r,n)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(t){const r=this.getAll(t);if(r.length===0){return null}let n=r.join(", ");if(/^content-encoding$/i.test(t)){n=n.toLowerCase()}return n}forEach(t,r=undefined){for(const n of this.keys()){Reflect.apply(t,r,[this.get(n),n,this])}}*values(){for(const t of this.keys()){yield this.get(t)}}*entries(){for(const t of this.keys()){yield[t,this.get(t)]}}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce(((t,r)=>{t[r]=this.getAll(r);return t}),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce(((t,r)=>{const n=this.getAll(r);if(r==="host"){t[r]=n[0]}else{t[r]=n.length>1?n:n[0]}return t}),{})}}Object.defineProperties(Headers.prototype,["get","entries","forEach","values"].reduce(((t,r)=>{t[r]={enumerable:true};return t}),{}));function fromRawHeaders(t=[]){return new Headers(t.reduce(((t,r,n,i)=>{if(n%2===0){t.push(i.slice(n,n+2))}return t}),[]).filter((([t,r])=>{try{b(t);y(t,String(r));return true}catch{return false}})))}const w=new Set([301,302,303,307,308]);const isRedirect=t=>w.has(t);const I=Symbol("Response internals");class Response extends Body{constructor(t=null,r={}){super(t,r);const n=r.status!=null?r.status:200;const i=new Headers(r.headers);if(t!==null&&!i.has("Content-Type")){const r=extractContentType(t,this);if(r){i.append("Content-Type",r)}}this[I]={type:"default",url:r.url,status:n,statusText:r.statusText||"",headers:i,counter:r.counter,highWaterMark:r.highWaterMark}}get type(){return this[I].type}get url(){return this[I].url||""}get status(){return this[I].status}get ok(){return this[I].status>=200&&this[I].status<300}get redirected(){return this[I].counter>0}get statusText(){return this[I].statusText}get headers(){return this[I].headers}get highWaterMark(){return this[I].highWaterMark}clone(){return new Response(clone(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(t,r=302){if(!isRedirect(r)){throw new RangeError('Failed to execute "redirect" on "response": Invalid status code')}return new Response(null,{headers:{location:new URL(t).toString()},status:r})}static error(){const t=new Response(null,{status:0,statusText:""});t[I].type="error";return t}get[Symbol.toStringTag](){return"Response"}}Object.defineProperties(Response.prototype,{type:{enumerable:true},url:{enumerable:true},status:{enumerable:true},ok:{enumerable:true},redirected:{enumerable:true},statusText:{enumerable:true},headers:{enumerable:true},clone:{enumerable:true}});const C=require("node:url");const getSearch=t=>{if(t.search){return t.search}const r=t.href.length-1;const n=t.hash||(t.href[r]==="#"?"#":"");return t.href[r-n.length]==="?"?"?":""};var R=n(1631);function stripURLForUseAsAReferrer(t,r=false){if(t==null){return"no-referrer"}t=new URL(t);if(/^(about|blob|data):$/.test(t.protocol)){return"no-referrer"}t.username="";t.password="";t.hash="";if(r){t.pathname="";t.search=""}return t}const B=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]);const k="strict-origin-when-cross-origin";function validateReferrerPolicy(t){if(!B.has(t)){throw new TypeError(`Invalid referrerPolicy: ${t}`)}return t}function isOriginPotentiallyTrustworthy(t){if(/^(http|ws)s:$/.test(t.protocol)){return true}const r=t.host.replace(/(^\[)|(]$)/g,"");const n=(0,R.isIP)(r);if(n===4&&/^127\./.test(r)){return true}if(n===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(r)){return true}if(/^(.+\.)*localhost$/.test(t.host)){return false}if(t.protocol==="file:"){return true}return false}function isUrlPotentiallyTrustworthy(t){if(/^about:(blank|srcdoc)$/.test(t)){return true}if(t.protocol==="data:"){return true}if(/^(blob|filesystem):$/.test(t.protocol)){return true}return isOriginPotentiallyTrustworthy(t)}function determineRequestsReferrer(t,{referrerURLCallback:r,referrerOriginCallback:n}={}){if(t.referrer==="no-referrer"||t.referrerPolicy===""){return null}const i=t.referrerPolicy;if(t.referrer==="about:client"){return"no-referrer"}const o=t.referrer;let s=stripURLForUseAsAReferrer(o);let l=stripURLForUseAsAReferrer(o,true);if(s.toString().length>4096){s=l}if(r){s=r(s)}if(n){l=n(l)}const u=new URL(t.url);switch(i){case"no-referrer":return"no-referrer";case"origin":return l;case"unsafe-url":return s;case"strict-origin":if(isUrlPotentiallyTrustworthy(s)&&!isUrlPotentiallyTrustworthy(u)){return"no-referrer"}return l.toString();case"strict-origin-when-cross-origin":if(s.origin===u.origin){return s}if(isUrlPotentiallyTrustworthy(s)&&!isUrlPotentiallyTrustworthy(u)){return"no-referrer"}return l;case"same-origin":if(s.origin===u.origin){return s}return"no-referrer";case"origin-when-cross-origin":if(s.origin===u.origin){return s}return l;case"no-referrer-when-downgrade":if(isUrlPotentiallyTrustworthy(s)&&!isUrlPotentiallyTrustworthy(u)){return"no-referrer"}return s;default:throw new TypeError(`Invalid referrerPolicy: ${i}`)}}function parseReferrerPolicyFromHeader(t){const r=(t.get("referrer-policy")||"").split(/[,\s]+/);let n="";for(const t of r){if(t&&B.has(t)){n=t}}return n}const v=Symbol("Request internals");const isRequest=t=>typeof t==="object"&&typeof t[v]==="object";class Request extends Body{constructor(t,r={}){let n;if(isRequest(t)){n=new URL(t.url)}else{n=new URL(t);t={}}if(n.username!==""||n.password!==""){throw new TypeError(`${n} is an url with embedded credentails.`)}let i=r.method||t.method||"GET";i=i.toUpperCase();if((r.body!=null||isRequest(t))&&t.body!==null&&(i==="GET"||i==="HEAD")){throw new TypeError("Request with GET/HEAD method cannot have body")}const o=r.body?r.body:isRequest(t)&&t.body!==null?clone(t):null;super(o,{size:r.size||t.size||0});const s=new Headers(r.headers||t.headers||{});if(o!==null&&!s.has("Content-Type")){const t=extractContentType(o,this);if(t){s.set("Content-Type",t)}}let l=isRequest(t)?t.signal:null;if("signal"in r){l=r.signal}if(l!=null&&!isAbortSignal(l)){throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget")}let u=r.referrer==null?t.referrer:r.referrer;if(u===""){u="no-referrer"}else if(u){const t=new URL(u);u=/^about:(\/\/)?client$/.test(t)?"client":t}else{u=undefined}this[v]={method:i,redirect:r.redirect||t.redirect||"follow",headers:s,parsedURL:n,signal:l,referrer:u};this.follow=r.follow===undefined?t.follow===undefined?20:t.follow:r.follow;this.compress=r.compress===undefined?t.compress===undefined?true:t.compress:r.compress;this.counter=r.counter||t.counter||0;this.agent=r.agent||t.agent;this.highWaterMark=r.highWaterMark||t.highWaterMark||16384;this.insecureHTTPParser=r.insecureHTTPParser||t.insecureHTTPParser||false;this.referrerPolicy=r.referrerPolicy||t.referrerPolicy||""}get method(){return this[v].method}get url(){return(0,C.format)(this[v].parsedURL)}get headers(){return this[v].headers}get redirect(){return this[v].redirect}get signal(){return this[v].signal}get referrer(){if(this[v].referrer==="no-referrer"){return""}if(this[v].referrer==="client"){return"about:client"}if(this[v].referrer){return this[v].referrer.toString()}return undefined}get referrerPolicy(){return this[v].referrerPolicy}set referrerPolicy(t){this[v].referrerPolicy=validateReferrerPolicy(t)}clone(){return new Request(this)}get[Symbol.toStringTag](){return"Request"}}Object.defineProperties(Request.prototype,{method:{enumerable:true},url:{enumerable:true},headers:{enumerable:true},redirect:{enumerable:true},clone:{enumerable:true},signal:{enumerable:true},referrer:{enumerable:true},referrerPolicy:{enumerable:true}});const getNodeRequestOptions=t=>{const{parsedURL:r}=t[v];const n=new Headers(t[v].headers);if(!n.has("Accept")){n.set("Accept","*/*")}let i=null;if(t.body===null&&/^(post|put)$/i.test(t.method)){i="0"}if(t.body!==null){const r=getTotalBytes(t);if(typeof r==="number"&&!Number.isNaN(r)){i=String(r)}}if(i){n.set("Content-Length",i)}if(t.referrerPolicy===""){t.referrerPolicy=k}if(t.referrer&&t.referrer!=="no-referrer"){t[v].referrer=determineRequestsReferrer(t)}else{t[v].referrer="no-referrer"}if(t[v].referrer instanceof URL){n.set("Referer",t.referrer)}if(!n.has("User-Agent")){n.set("User-Agent","node-fetch")}if(t.compress&&!n.has("Accept-Encoding")){n.set("Accept-Encoding","gzip,deflate,br")}let{agent:o}=t;if(typeof o==="function"){o=o(r)}if(!n.has("Connection")&&!o){n.set("Connection","close")}const s=getSearch(r);const l={path:r.pathname+s,method:t.method,headers:n[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:t.insecureHTTPParser,agent:o};return{parsedURL:r,options:l}};class AbortError extends FetchBaseError{constructor(t,r="aborted"){super(t,r)}}const T=new Set(["data:","http:","https:"]);async function fetch(t,r){return new Promise(((n,h)=>{const p=new Request(t,r);const{parsedURL:g,options:m}=getNodeRequestOptions(p);if(!T.has(g.protocol)){throw new TypeError(`node-fetch cannot load ${t}. URL scheme "${g.protocol.replace(/:$/,"")}" is not supported.`)}if(g.protocol==="data:"){const t=u(p.url);const r=new Response(t,{headers:{"Content-Type":t.typeFull}});n(r);return}const _=(g.protocol==="https:"?o:i).request;const{signal:E}=p;let b=null;const abort=()=>{const t=new AbortError("The operation was aborted.");h(t);if(p.body&&p.body instanceof l.Readable){p.body.destroy(t)}if(!b||!b.body){return}b.body.emit("error",t)};if(E&&E.aborted){abort();return}const abortAndFinalize=()=>{abort();finalize()};const y=_(g,m);if(E){E.addEventListener("abort",abortAndFinalize)}const finalize=()=>{y.abort();if(E){E.removeEventListener("abort",abortAndFinalize)}};y.on("error",(t=>{h(new FetchError(`request to ${p.url} failed, reason: ${t.message}`,"system",t));finalize()}));fixResponseChunkedTransferBadEnding(y,(t=>{b.body.destroy(t)}));if(process.version<"v14"){y.on("socket",(t=>{let r;t.prependListener("end",(()=>{r=t._eventsCount}));t.prependListener("close",(n=>{if(b&&r<t._eventsCount&&!n){const t=new Error("Premature close");t.code="ERR_STREAM_PREMATURE_CLOSE";b.body.emit("error",t)}}))}))}y.on("response",(t=>{y.setTimeout(0);const i=fromRawHeaders(t.rawHeaders);if(isRedirect(t.statusCode)){const o=i.get("Location");const s=o===null?null:new URL(o,p.url);switch(p.redirect){case"error":h(new FetchError(`uri requested responds with a redirect, redirect mode is set to error: ${p.url}`,"no-redirect"));finalize();return;case"manual":if(s!==null){i.set("Location",s)}break;case"follow":{if(s===null){break}if(p.counter>=p.follow){h(new FetchError(`maximum redirect reached at: ${p.url}`,"max-redirect"));finalize();return}const o={headers:new Headers(p.headers),follow:p.follow,counter:p.counter+1,agent:p.agent,compress:p.compress,method:p.method,body:clone(p),signal:p.signal,size:p.size,referrer:p.referrer,referrerPolicy:p.referrerPolicy};if(t.statusCode!==303&&p.body&&r.body instanceof l.Readable){h(new FetchError("Cannot follow redirect with body being a readable stream","unsupported-redirect"));finalize();return}if(t.statusCode===303||(t.statusCode===301||t.statusCode===302)&&p.method==="POST"){o.method="GET";o.body=undefined;o.headers.delete("content-length")}const u=parseReferrerPolicyFromHeader(i);if(u){o.referrerPolicy=u}n(fetch(new Request(s,o)));finalize();return}default:return h(new TypeError(`Redirect option '${p.redirect}' is not a valid value of RequestRedirect`))}}if(E){t.once("end",(()=>{E.removeEventListener("abort",abortAndFinalize)}))}let o=(0,l.pipeline)(t,new l.PassThrough,h);if(process.version<"v12.10"){t.on("aborted",abortAndFinalize)}const u={url:p.url,status:t.statusCode,statusText:t.statusMessage,headers:i,size:p.size,counter:p.counter,highWaterMark:p.highWaterMark};const g=i.get("Content-Encoding");if(!p.compress||p.method==="HEAD"||g===null||t.statusCode===204||t.statusCode===304){b=new Response(o,u);n(b);return}const m={flush:s.Z_SYNC_FLUSH,finishFlush:s.Z_SYNC_FLUSH};if(g==="gzip"||g==="x-gzip"){o=(0,l.pipeline)(o,s.createGunzip(m),h);b=new Response(o,u);n(b);return}if(g==="deflate"||g==="x-deflate"){const r=(0,l.pipeline)(t,new l.PassThrough,h);r.once("data",(t=>{o=(t[0]&15)===8?(0,l.pipeline)(o,s.createInflate(),h):(0,l.pipeline)(o,s.createInflateRaw(),h);b=new Response(o,u);n(b)}));return}if(g==="br"){o=(0,l.pipeline)(o,s.createBrotliDecompress(),h);b=new Response(o,u);n(b);return}b=new Response(o,u);n(b)}));writeToStream(y,p)}))}function fixResponseChunkedTransferBadEnding(t,r){const n=Buffer.from("0\r\n\r\n");let i=false;let o=false;let s;t.on("response",(t=>{const{headers:r}=t;i=r["transfer-encoding"]==="chunked"&&!r["content-length"]}));t.on("socket",(l=>{const onSocketClose=()=>{if(i&&!o){const t=new Error("Premature close");t.code="ERR_STREAM_PREMATURE_CLOSE";r(t)}};l.prependListener("close",onSocketClose);t.on("abort",(()=>{l.removeListener("close",onSocketClose)}));l.on("data",(t=>{o=Buffer.compare(t.slice(-5),n)===0;if(!o&&s){o=Buffer.compare(s.slice(-3),n.slice(0,3))===0&&Buffer.compare(t.slice(-2),n.slice(3))===0}s=t}))}))}},5845:function(t,r,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,r,n,i){if(i===undefined)i=n;Object.defineProperty(t,i,{enumerable:true,get:function(){return r[n]}})}:function(t,r,n,i){if(i===undefined)i=n;t[i]=r[n]});var o=this&&this.__setModuleDefault||(Object.create?function(t,r){Object.defineProperty(t,"default",{enumerable:true,value:r})}:function(t,r){t["default"]=r});var s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var r={};if(t!=null)for(var n in t)if(n!=="default"&&Object.prototype.hasOwnProperty.call(t,n))i(r,t,n);o(r,t);return r};var l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:true});r.NodeSSH=r.SSHError=void 0;const u=l(n(5747));const h=l(n(5622));const p=l(n(9126));const g=l(n(1554));const m=l(n(8741));const _=l(n(689));const E=n(4977);const b=s(n(2357));const y=l(n(5869));const w=1;const DEFAULT_VALIDATE=t=>!h.default.basename(t).startsWith(".");const DEFAULT_TICK=()=>{};class SSHError extends Error{constructor(t,r=null){super(t);this.code=r}}r.SSHError=SSHError;function unixifyPath(t){if(t.includes("\\")){return t.split("\\").join("/")}return t}async function readFile(t){return new Promise(((r,n)=>{u.default.readFile(t,"utf8",((t,i)=>{if(t){n(t)}else{r(i)}}))}))}const I=/Error: (E[\S]+): /;async function makeDirectoryWithSftp(t,r){let n=null;try{n=await new Promise(((n,i)=>{r.stat(t,((t,r)=>{if(t){i(t)}else{n(r)}}))}))}catch(t){}if(n){if(n.isDirectory()){return}throw new Error("mkdir() failed, target already exists and is not a directory")}try{await new Promise(((n,i)=>{r.mkdir(t,(t=>{if(t){i(t)}else{n()}}))}))}catch(t){if(t!=null&&typeof t.stack==="string"){const r=I.exec(t.stack);if(r!=null){throw new SSHError(t.message,r[1])}throw t}}}class NodeSSH{constructor(){this.connection=null}getConnection(){const{connection:t}=this;if(t==null){throw new Error("Not connected to server")}return t}async connect(t){b.default(t!=null&&typeof t==="object","config must be a valid object");const r={...t};b.default(r.username!=null&&typeof r.username==="string","config.username must be a valid string");if(r.host!=null){b.default(typeof r.host==="string","config.host must be a valid string")}else if(r.sock!=null){b.default(typeof r.sock==="object","config.sock must be a valid object")}else{throw new b.AssertionError({message:"Either config.host or config.sock must be provided"})}if(r.privateKey!=null){b.default(typeof r.privateKey==="string","config.privateKey must be a valid string");b.default(r.passphrase==null||typeof r.passphrase==="string","config.passphrase must be a valid string");if(!(r.privateKey.includes("BEGIN")&&r.privateKey.includes("KEY")||r.privateKey.includes("PuTTY-User-Key-File-2"))){try{r.privateKey=await readFile(r.privateKey)}catch(t){if(t!=null&&t.code==="ENOENT"){throw new b.AssertionError({message:"config.privateKey does not exist at given fs path"})}throw t}}}else if(r.password!=null){b.default(typeof r.password==="string","config.password must be a valid string")}if(r.tryKeyboard!=null){b.default(typeof r.tryKeyboard==="boolean","config.tryKeyboard must be a valid boolean")}if(r.tryKeyboard){const{password:t}=r;if(r.onKeyboardInteractive!=null){b.default(typeof r.onKeyboardInteractive==="function","config.onKeyboardInteractive must be a valid function")}else if(t!=null){r.onKeyboardInteractive=(r,n,i,o,s)=>{if(o.length>0&&o[0].prompt.toLowerCase().includes("password")){s([t])}}}}const n=new y.default.Client;this.connection=n;await new Promise(((t,i)=>{n.on("error",i);if(r.onKeyboardInteractive){n.on("keyboard-interactive",r.onKeyboardInteractive)}n.on("ready",(()=>{n.removeListener("error",i);t()}));n.on("end",(()=>{if(this.connection===n){this.connection=null}}));n.on("close",(()=>{if(this.connection===n){this.connection=null}i(new SSHError("No response from server","ETIMEDOUT"))}));n.connect(r)}));return this}isConnected(){return this.connection!=null}async requestShell(t){const r=this.getConnection();return new Promise(((n,i)=>{const callback=(t,r)=>{if(t){i(t)}else{n(r)}};if(t==null){r.shell(callback)}else{r.shell(t,callback)}}))}async withShell(t,r){b.default(typeof t==="function","callback must be a valid function");const n=await this.requestShell(r);try{await t(n)}finally{if(!n.close()){n.destroy()}}}async requestSFTP(){const t=this.getConnection();return new Promise(((r,n)=>{t.sftp(((t,i)=>{if(t){n(t)}else{r(i)}}))}))}async withSFTP(t){b.default(typeof t==="function","callback must be a valid function");const r=await this.requestSFTP();try{await t(r)}finally{r.end()}}async execCommand(t,r={}){b.default(typeof t==="string","command must be a valid string");b.default(r!=null&&typeof r==="object","options must be a valid object");b.default(r.cwd==null||typeof r.cwd==="string","options.cwd must be a valid string");b.default(r.stdin==null||typeof r.stdin==="string"||g.default.readable(r.stdin),"options.stdin must be a valid string or readable stream");b.default(r.execOptions==null||typeof r.execOptions==="object","options.execOptions must be a valid object");b.default(r.encoding==null||typeof r.encoding==="string","options.encoding must be a valid string");b.default(r.onChannel==null||typeof r.onChannel==="function","options.onChannel must be a valid function");b.default(r.onStdout==null||typeof r.onStdout==="function","options.onStdout must be a valid function");b.default(r.onStderr==null||typeof r.onStderr==="function","options.onStderr must be a valid function");let n=t;if(r.cwd){n=`cd ${m.default([r.cwd])} ; ${n}`}const i=this.getConnection();const o={stdout:[],stderr:[]};return new Promise(((t,s)=>{i.exec(n,r.execOptions!=null?r.execOptions:{},((n,i)=>{if(n){s(n);return}if(r.onChannel){r.onChannel(i)}i.on("data",(t=>{if(r.onStdout)r.onStdout(t);o.stdout.push(t.toString(r.encoding))}));i.stderr.on("data",(t=>{if(r.onStderr)r.onStderr(t);o.stderr.push(t.toString(r.encoding))}));if(r.stdin!=null){if(g.default.readable(r.stdin)){r.stdin.pipe(i,{end:true})}else{i.write(r.stdin);i.end()}}else{i.end()}let l=null;let u=null;i.on("exit",((t,r)=>{l=t||null;u=r||null}));i.on("close",(()=>{t({code:l!=null?l:null,signal:u!=null?u:null,stdout:o.stdout.join("").trim(),stderr:o.stderr.join("").trim()})}))}))}))}async exec(t,r,n={}){b.default(typeof t==="string","command must be a valid string");b.default(Array.isArray(r),"parameters must be a valid array");b.default(n!=null&&typeof n==="object","options must be a valid object");b.default(n.stream==null||["both","stdout","stderr"].includes(n.stream),"options.stream must be one of both, stdout, stderr");for(let t=0,{length:n}=r;t<n;t+=1){b.default(typeof r[t]==="string",`parameters[${t}] must be a valid string`)}const i=`${t} ${m.default(r)}`;const o=await this.execCommand(i,n);if(n.stream==null||n.stream==="stdout"){if(o.stderr){throw new Error(o.stderr)}return o.stdout}if(n.stream==="stderr"){return o.stderr}return o}async mkdir(t,r="sftp",n=null){b.default(typeof t==="string","path must be a valid string");b.default(typeof r==="string"&&(r==="sftp"||r==="exec"),"method must be either sftp or exec");b.default(n==null||typeof n==="object","sftp must be a valid object");if(r==="exec"){await this.exec("mkdir",["-p",unixifyPath(t)]);return}const i=n||await this.requestSFTP();const makeSftpDirectory=async r=>makeDirectoryWithSftp(unixifyPath(t),i).catch((async n=>{if(!r||n==null||n.message!=="No such file"&&n.code!=="ENOENT"){throw n}await this.mkdir(h.default.dirname(t),"sftp",i);await makeSftpDirectory(false)}));try{await makeSftpDirectory(true)}finally{if(!n){i.end()}}}async getFile(t,r,n=null,i=null){b.default(typeof t==="string","localFile must be a valid string");b.default(typeof r==="string","remoteFile must be a valid string");b.default(n==null||typeof n==="object","sftp must be a valid object");b.default(i==null||typeof i==="object","transferOptions must be a valid object");const o=n||await this.requestSFTP();try{await new Promise(((n,s)=>{o.fastGet(unixifyPath(r),t,i||{},(t=>{if(t){s(t)}else{n()}}))}))}finally{if(!n){o.end()}}}async putFile(t,r,n=null,i=null){b.default(typeof t==="string","localFile must be a valid string");b.default(typeof r==="string","remoteFile must be a valid string");b.default(n==null||typeof n==="object","sftp must be a valid object");b.default(i==null||typeof i==="object","transferOptions must be a valid object");b.default(await new Promise((r=>{u.default.access(t,u.default.constants.R_OK,(t=>{r(t===null)}))})),`localFile does not exist at ${t}`);const o=n||await this.requestSFTP();const putFile=n=>new Promise(((s,l)=>{o.fastPut(t,unixifyPath(r),i||{},(t=>{if(t==null){s();return}if(t.message==="No such file"&&n){s(this.mkdir(h.default.dirname(r),"sftp",o).then((()=>putFile(false))))}else{l(t)}}))}));try{await putFile(true)}finally{if(!n){o.end()}}}async putFiles(t,{concurrency:r=w,sftp:n=null,transferOptions:i={}}={}){b.default(Array.isArray(t),"files must be an array");for(let r=0,{length:n}=t;r<n;r+=1){const n=t[r];b.default(n,"files items must be valid objects");b.default(n.local&&typeof n.local==="string",`files[${r}].local must be a string`);b.default(n.remote&&typeof n.remote==="string",`files[${r}].remote must be a string`)}const o=[];const s=n||await this.requestSFTP();const l=new E.PromiseQueue({concurrency:r});try{await new Promise(((r,n)=>{t.forEach((t=>{l.add((async()=>{await this.putFile(t.local,t.remote,s,i);o.push(t)})).catch(n)}));l.waitTillIdle().then(r)}))}catch(t){if(t!=null){t.transferred=o}throw t}finally{if(!n){s.end()}}}async putDirectory(t,r,{concurrency:n=w,sftp:i=null,transferOptions:o={},recursive:s=true,tick:l=DEFAULT_TICK,validate:p=DEFAULT_VALIDATE}={}){b.default(typeof t==="string"&&t,"localDirectory must be a string");b.default(typeof r==="string"&&r,"remoteDirectory must be a string");const g=await new Promise((r=>{u.default.stat(t,((t,n)=>{r(n||null)}))}));b.default(g!=null,`localDirectory does not exist at ${t}`);b.default(g.isDirectory(),`localDirectory is not a directory at ${t}`);const m=i||await this.requestSFTP();const y=await _.default(t,{recursive:s,validate:p});const I=y.files.map((r=>h.default.relative(t,r)));const C=y.directories.map((r=>h.default.relative(t,r)));C.sort(((t,r)=>t.length-r.length));let R=false;try{await new Promise(((t,i)=>{const o=new E.PromiseQueue({concurrency:n});C.forEach((t=>{o.add((async()=>{await this.mkdir(h.default.join(r,t),"sftp",m)})).catch(i)}));t(o.waitTillIdle())}));await new Promise(((i,s)=>{const u=new E.PromiseQueue({concurrency:n});I.forEach((n=>{u.add((async()=>{const i=h.default.join(t,n);const s=h.default.join(r,n);try{await this.putFile(i,s,m,o);l(i,s,null)}catch(t){R=true;l(i,s,t)}})).catch(s)}));i(u.waitTillIdle())}))}finally{if(!i){m.end()}}return!R}async getDirectory(t,r,{concurrency:n=w,sftp:i=null,transferOptions:o={},recursive:s=true,tick:l=DEFAULT_TICK,validate:g=DEFAULT_VALIDATE}={}){b.default(typeof t==="string"&&t,"localDirectory must be a string");b.default(typeof r==="string"&&r,"remoteDirectory must be a string");const m=await new Promise((r=>{u.default.stat(t,((t,n)=>{r(n||null)}))}));b.default(m!=null,`localDirectory does not exist at ${t}`);b.default(m.isDirectory(),`localDirectory is not a directory at ${t}`);const y=i||await this.requestSFTP();const I=await _.default(r,{recursive:s,validate:g,concurrency:n,fileSystem:{basename(t){return h.default.posix.basename(t)},join(t,r){return h.default.posix.join(t,r)},readdir(t){return new Promise(((r,n)=>{y.readdir(t,((t,i)=>{if(t){n(t)}else{r(i.map((t=>t.filename)))}}))}))},stat(t){return new Promise(((r,n)=>{y.stat(t,((t,i)=>{if(t){n(t)}else{r(i)}}))}))}}});const C=I.files.map((t=>h.default.relative(r,t)));const R=I.directories.map((t=>h.default.relative(r,t)));R.sort(((t,r)=>t.length-r.length));let B=false;try{await new Promise(((r,i)=>{const o=new E.PromiseQueue({concurrency:n});R.forEach((r=>{o.add((async()=>{await p.default(h.default.join(t,r))})).catch(i)}));r(o.waitTillIdle())}));await new Promise(((i,s)=>{const u=new E.PromiseQueue({concurrency:n});C.forEach((n=>{u.add((async()=>{const i=h.default.join(t,n);const s=h.default.join(r,n);try{await this.getFile(i,s,y,o);l(i,s,null)}catch(t){B=true;l(i,s,t)}})).catch(s)}));i(u.waitTillIdle())}))}finally{if(!i){y.end()}}return!B}dispose(){if(this.connection){this.connection.end();this.connection=null}}}r.NodeSSH=NodeSSH},5118:(t,r,n)=>{"use strict";var i=n(4293);var o=i.Buffer;var s={};var l;for(l in i){if(!i.hasOwnProperty(l))continue;if(l==="SlowBuffer"||l==="Buffer")continue;s[l]=i[l]}var u=s.Buffer={};for(l in o){if(!o.hasOwnProperty(l))continue;if(l==="allocUnsafe"||l==="allocUnsafeSlow")continue;u[l]=o[l]}s.Buffer.prototype=o.prototype;if(!u.from||u.from===Uint8Array.from){u.from=function(t,r,n){if(typeof t==="number"){throw new TypeError('The "value" argument must not be of type number. Received type '+typeof t)}if(t&&typeof t.length==="undefined"){throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}return o(t,r,n)}}if(!u.alloc){u.alloc=function(t,r,n){if(typeof t!=="number"){throw new TypeError('The "size" argument must be of type number. Received type '+typeof t)}if(t<0||t>=2*(1<<30)){throw new RangeError('The value "'+t+'" is invalid for option "size"')}var i=o(t);if(!r||r.length===0){i.fill(0)}else if(typeof n==="string"){i.fill(r,n)}else{i.fill(r)}return i}}if(!s.kStringMaxLength){try{s.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch(t){}}if(!s.constants){s.constants={MAX_LENGTH:s.kMaxLength};if(s.kStringMaxLength){s.constants.MAX_STRING_LENGTH=s.kStringMaxLength}}t.exports=s},4977:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function(){function PromiseQueue(t){var r=(t===void 0?{}:t).concurrency,n=r===void 0?1:r;this.options={concurrency:n};this.running=0;this.queue=[];this.idleCallbacks=[]}PromiseQueue.prototype.clear=function(){this.queue=[]};PromiseQueue.prototype.onIdle=function(t){var r=this;this.idleCallbacks.push(t);return function(){var n=r.idleCallbacks.indexOf(t);if(n!==-1){r.idleCallbacks.splice(n,1)}}};PromiseQueue.prototype.waitTillIdle=function(){var t=this;return new Promise((function(r){if(t.running===0){r();return}var n=t.onIdle((function(){n();r()}))}))};PromiseQueue.prototype.add=function(t){var r=this;return new Promise((function(n,i){var runCallback=function(){r.running+=1;try{Promise.resolve(t()).then((function(t){n(t);r.processNext()}),(function(t){i(t);r.processNext()}))}catch(t){i(t);r.processNext()}};if(r.running>=r.options.concurrency){r.queue.push(runCallback)}else{runCallback()}}))};PromiseQueue.prototype.processNext=function(){this.running-=1;var t=this.queue.shift();if(t){t()}else if(this.running===0){this.idleCallbacks.forEach((function(t){return t()}))}};return PromiseQueue}();r.PromiseQueue=n},689:function(t,r,n){"use strict";var i=this&&this.__assign||function(){i=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var o in r)if(Object.prototype.hasOwnProperty.call(r,o))t[o]=r[o]}return t};return i.apply(this,arguments)};var o=this&&this.__awaiter||function(t,r,n,i){function adopt(t){return t instanceof n?t:new n((function(r){r(t)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(t){try{step(i.next(t))}catch(t){o(t)}}function rejected(t){try{step(i["throw"](t))}catch(t){o(t)}}function step(t){t.done?n(t.value):adopt(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};var s=this&&this.__generator||function(t,r){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,o,s,l;return l={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(l[Symbol.iterator]=function(){return this}),l;function verb(t){return function(r){return step([t,r])}}function step(l){if(i)throw new TypeError("Generator is already executing.");while(n)try{if(i=1,o&&(s=l[0]&2?o["return"]:l[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;if(o=0,s)l=[l[0]&2,s.value];switch(l[0]){case 0:case 1:s=l;break;case 4:n.label++;return{value:l[1],done:false};case 5:n.label++;o=l[1];l=[0];continue;case 7:l=n.ops.pop();n.trys.pop();continue;default:if(!(s=n.trys,s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){n.label=l[1];break}if(l[0]===6&&n.label<s[1]){n.label=s[1];s=l;break}if(s&&n.label<s[2]){n.label=s[2];n.ops.push(l);break}if(s[2])n.ops.pop();n.trys.pop();continue}l=r.call(t,n)}catch(t){l=[6,t];o=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:true}}};var l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:true});r.defaultFilesystem=void 0;var u=l(n(5747));var h=l(n(5622));var p=l(n(2357));var g=n(4977);r.defaultFilesystem={join:function(t,r){return h.default.join(t,r)},basename:function(t){return h.default.basename(t)},stat:function(t){return new Promise((function(r,n){u.default.stat(t,(function(t,i){if(t){n(t)}else{r(i)}}))}))},readdir:function(t){return new Promise((function(r,n){u.default.readdir(t,(function(t,i){if(t){n(t)}else{r(i)}}))}))}};function scanDirectoryInternal(t){var r=t.path,n=t.recursive,i=t.validate,l=t.result,u=t.fileSystem,h=t.queue,p=t.reject;return o(this,void 0,void 0,(function(){var t,o;return s(this,(function(s){switch(s.label){case 0:return[4,u.stat(r)];case 1:t=s.sent();if(t.isFile()){l.files.push(r)}else if(t.isDirectory()){l.directories.push(r)}if(!t.isDirectory()||n==="none"){return[2]}return[4,u.readdir(r)];case 2:o=s.sent();o.forEach((function(t){var o=u.join(r,t);if(!i(o)){return}h.add((function(){return scanDirectoryInternal({path:o,recursive:n==="shallow"?"none":"deep",validate:i,result:l,fileSystem:u,queue:h,reject:p})})).catch(p)}));return[2]}}))}))}function scanDirectory(t,n){var l=n===void 0?{}:n,u=l.recursive,h=u===void 0?true:u,m=l.validate,_=m===void 0?null:m,E=l.concurrency,b=E===void 0?Infinity:E,y=l.fileSystem,w=y===void 0?r.defaultFilesystem:y;return o(this,void 0,void 0,(function(){var n,o,l;return s(this,(function(s){switch(s.label){case 0:p.default(t&&typeof t==="string","path must be a valid string");p.default(typeof h==="boolean","options.recursive must be a valid boolean");p.default(_===null||typeof _==="function","options.validate must be a valid function");p.default(typeof b==="number","options.concurrency must be a valid number");p.default(w!==null&&typeof w==="object","options.fileSystem must be a valid object");n=new g.PromiseQueue({concurrency:b});o={files:[],directories:[]};l=i(i({},r.defaultFilesystem),w);return[4,new Promise((function(r,i){scanDirectoryInternal({path:t,recursive:h?"deep":"shallow",validate:_!=null?_:function(t){return l.basename(t).slice(0,1)!=="."},result:o,fileSystem:l,queue:n,reject:i}).then((function(){return n.waitTillIdle()})).then(r,i)}))];case 1:s.sent();return[2,o]}}))}))}r.default=scanDirectory},8741:t=>{t.exports=shellescape;function shellescape(t){var r=[];t.forEach((function(t){if(!/^[A-Za-z0-9_\/-]+$/.test(t)){t="'"+t.replace(/'/g,"'\\''")+"'";t=t.replace(/^(?:'')+/g,"").replace(/\\'''/g,"\\'")}r.push(t)}));return r.join(" ")}},3204:(t,r,n)=>{"use strict";const{Duplex:i,Readable:o,Writable:s}=n(2413);const{CHANNEL_EXTENDED_DATATYPE:{STDERR:l}}=n(6832);const{bufferSlice:u}=n(9475);const h=32*1024;const p=2*1024*1024;const g=p/2;class ClientStderr extends o{constructor(t,r){super(r);this._channel=t}_read(t){if(this._channel._waitChanDrain){this._channel._waitChanDrain=false;if(this._channel.incoming.window<=g)windowAdjust(this._channel)}}}class ServerStderr extends s{constructor(t){super({highWaterMark:p});this._channel=t}_write(t,r,n){const i=this._channel;const o=i._client._protocol;const s=i.outgoing;const h=s.packetSize;const p=s.id;let g=s.window;const m=t.length;let _=0;if(s.state!=="open")return;while(m-_>0&&g>0){let r=m-_;if(r>g)r=g;if(r>h)r=h;if(_===0&&r===m)o.channelExtData(p,t,l);else o.channelExtData(p,u(t,_,_+r),l);_+=r;g-=r}s.window=g;if(m-_>0){if(g===0)i._waitWindow=true;if(_>0)i._chunkErr=u(t,_,m);else i._chunkErr=t;i._chunkcbErr=n;return}n()}}class Channel extends i{constructor(t,r,n){const i={highWaterMark:p,allowHalfOpen:!n||n&&n.allowHalfOpen!==false,emitClose:false};super(i);this.allowHalfOpen=i.allowHalfOpen;const o=!!(n&&n.server);this.server=o;this.type=r.type;this.subtype=undefined;this.incoming=r.incoming;this.outgoing=r.outgoing;this._callbacks=[];this._client=t;this._hasX11=false;this._exit={code:undefined,signal:undefined,dump:undefined,desc:undefined};this.stdin=this.stdout=this;if(o)this.stderr=new ServerStderr(this);else this.stderr=new ClientStderr(this,i);this._waitWindow=false;this._waitChanDrain=false;this._chunk=undefined;this._chunkcb=undefined;this._chunkErr=undefined;this._chunkcbErr=undefined;this.on("finish",onFinish).on("prefinish",onFinish);this.on("end",onEnd).on("close",onEnd)}_read(t){if(this._waitChanDrain){this._waitChanDrain=false;if(this.incoming.window<=g)windowAdjust(this)}}_write(t,r,n){const i=this._client._protocol;const o=this.outgoing;const s=o.packetSize;const l=o.id;let h=o.window;const p=t.length;let g=0;if(o.state!=="open")return;while(p-g>0&&h>0){let r=p-g;if(r>h)r=h;if(r>s)r=s;if(g===0&&r===p)i.channelData(l,t);else i.channelData(l,u(t,g,g+r));g+=r;h-=r}o.window=h;if(p-g>0){if(h===0)this._waitWindow=true;if(g>0)this._chunk=u(t,g,p);else this._chunk=t;this._chunkcb=n;return}n()}eof(){if(this.outgoing.state==="open"){this.outgoing.state="eof";this._client._protocol.channelEOF(this.outgoing.id)}}close(){if(this.outgoing.state==="open"||this.outgoing.state==="eof"){this.outgoing.state="closing";this._client._protocol.channelClose(this.outgoing.id)}}destroy(){this.end();this.close()}setWindow(t,r,n,i){if(this.server)throw new Error("Client-only method called in server mode");if(this.type==="session"&&(this.subtype==="shell"||this.subtype==="exec")&&this.writable&&this.outgoing.state==="open"){this._client._protocol.windowChange(this.outgoing.id,t,r,n,i)}}signal(t){if(this.server)throw new Error("Client-only method called in server mode");if(this.type==="session"&&this.writable&&this.outgoing.state==="open"){this._client._protocol.signal(this.outgoing.id,t)}}exit(t,r,n){if(!this.server)throw new Error("Server-only method called in client mode");if(this.type==="session"&&this.writable&&this.outgoing.state==="open"){if(typeof t==="number"){this._client._protocol.exitStatus(this.outgoing.id,t)}else{this._client._protocol.exitSignal(this.outgoing.id,t,r,n)}}}}function onFinish(){this.eof();if(this.server||!this.allowHalfOpen)this.close();this.writable=false}function onEnd(){this.readable=false}function windowAdjust(t){if(t.outgoing.state==="closed")return;const r=p-t.incoming.window;if(r<=0)return;t.incoming.window+=r;t._client._protocol.channelWindowAdjust(t.outgoing.id,r)}t.exports={Channel:Channel,MAX_WINDOW:p,PACKET_SIZE:h,windowAdjust:windowAdjust,WINDOW_THRESHOLD:g}},9054:(t,r,n)=>{"use strict";const{Socket:i}=n(1631);const{Duplex:o}=n(2413);const{resolve:s}=n(5622);const{readFile:l}=n(5747);const{execFile:u,spawn:h}=n(3129);const{isParsedKey:p,parseKey:g}=n(2218);const{makeBufferParser:m,readUInt32BE:_,writeUInt32BE:E,writeUInt32LE:b}=n(9475);function once(t){let r=false;return(...n)=>{if(r)return;r=true;t(...n)}}function concat(t,r){const n=Buffer.allocUnsafe(t.length+r.length);t.copy(n,0);r.copy(n,t.length);return n}function noop(){}const y=Buffer.alloc(0);const w=m();class BaseAgent{getIdentities(t){t(new Error("Missing getIdentities() implementation"))}sign(t,r,n,i){if(typeof n==="function")i=n;i(new Error("Missing sign() implementation"))}}class OpenSSHAgent extends BaseAgent{constructor(t){super();this.socketPath=t}getStream(t){t=once(t);const r=new i;r.on("connect",(()=>{t(null,r)}));r.on("close",onFail).on("end",onFail).on("error",onFail);r.connect(this.socketPath);function onFail(){try{r.destroy()}catch{}t(new Error("Failed to connect to agent"))}}getIdentities(t){t=once(t);this.getStream(((r,n)=>{function onFail(r){if(n){try{n.destroy()}catch{}}if(!r)r=new Error("Failed to retrieve identities from agent");t(r)}if(r)return onFail(r);const i=new B(true);i.on("error",onFail);i.pipe(n).pipe(i);n.on("close",onFail).on("end",onFail).on("error",onFail);i.getIdentities(((r,i)=>{if(r)return onFail(r);try{n.destroy()}catch{}t(null,i)}))}))}sign(t,r,n,i){if(typeof n==="function"){i=n;n=undefined}else if(typeof n!=="object"||n===null){n=undefined}i=once(i);this.getStream(((o,s)=>{function onFail(t){if(s){try{s.destroy()}catch{}}if(!t)t=new Error("Failed to sign data with agent");i(t)}if(o)return onFail(o);const l=new B(true);l.on("error",onFail);l.pipe(s).pipe(l);s.on("close",onFail).on("end",onFail).on("error",onFail);l.sign(t,r,n,((t,r)=>{if(t)return onFail(t);try{s.destroy()}catch{}i(null,r)}))}))}}const I=(()=>{const t=10;const r=11;const i=12;const s=13;const l=14;const u=15;const p=n.ab+"pagent.exe";const g={[t]:new Error("Invalid pagent.exe arguments"),[r]:new Error("Pageant is not running"),[i]:new Error("pagent.exe could not create an mmap"),[s]:new Error("pagent.exe could not set mode for stdin"),[l]:new Error("pagent.exe could not set mode for stdout"),[u]:new Error("pagent.exe did not get expected input payload")};function destroy(t){t.buffer=null;if(t.proc){t.proc.kill();t.proc=undefined}}class PageantSocket extends o{constructor(){super();this.proc=undefined;this.buffer=null}_read(t){}_write(t,r,i){if(this.buffer===null){this.buffer=t}else{const r=Buffer.allocUnsafe(this.buffer.length+t.length);this.buffer.copy(r,0);t.copy(r,this.buffer.length);this.buffer=r}if(this.buffer.length<4)return i();const o=_(this.buffer,0);if(this.buffer.length-4<o)return i();t=this.buffer.slice(0,4+o);if(this.buffer.length>4+o)return i(new Error("Unexpected multiple agent requests"));this.buffer=null;let s;const l=this.proc=h(n.ab+"pagent.exe",[t.length]);l.stdout.on("data",(t=>{this.push(t)}));l.on("error",(t=>{s=t;i(s)}));l.on("close",(t=>{this.proc=undefined;if(!s){if(s=g[t])return i(s);i()}}));l.stdin.end(t)}_final(t){destroy(this);t()}_destroy(t,r){destroy(this);r()}}return class PageantAgent extends OpenSSHAgent{getStream(t){t(null,new PageantSocket)}}})();const C=(()=>{const t=/^!<socket >(\d+) s ([A-Z0-9]{8}-[A-Z0-9]{8}-[A-Z0-9]{8}-[A-Z0-9]{8})/;return class CygwinAgent extends OpenSSHAgent{getStream(r){r=once(r);let n=this.socketPath;let o=false;l(n,(function readCygsocket(s,h){if(s){if(o)return r(new Error("Invalid cygwin unix socket path"));u("cygpath",["-w",n],((t,i,s)=>{if(t||i.length===0)return r(new Error("Invalid cygwin unix socket path"));o=true;n=i.toString().replace(/[\r\n]/g,"");l(n,readCygsocket)}));return}const p=t.exec(h.toString("ascii"));if(!p)return r(new Error("Malformed cygwin unix socket file"));let g;let m=0;let E=false;const y=[];let w;let I=Buffer.alloc(12);const C=parseInt(p[1],10);const R=p[2].replace(/-/g,"");const B=Buffer.allocUnsafe(16);for(let t=0,r=0;r<32;++t,r+=2)B[t]=parseInt(R.substring(r,r+2),16);for(let t=0;t<16;t+=4)b(B,_(B,t),t);tryConnect();function _onconnect(){m=0;g="secret";w.write(B)}function _ondata(t){m+=t.length;if(g==="secret"){if(m===16){m=0;g="creds";w.write(I)}return}if(g==="creds"){if(!E)y.push(t);if(m===12){w.removeListener("connect",_onconnect);w.removeListener("data",_ondata);w.removeListener("error",onFail);w.removeListener("end",onFail);w.removeListener("close",onFail);if(E)return r(null,w);E=true;I=Buffer.concat(y);b(I,process.pid,0);w.on("error",(()=>{}));w.destroy();tryConnect()}}}function onFail(){r(new Error("Problem negotiating cygwin unix socket security"))}function tryConnect(){w=new i;w.on("connect",_onconnect);w.on("data",_ondata);w.on("error",onFail);w.on("end",onFail);w.on("close",onFail);w.connect(C)}}))}}})();const R=/^[/\\][/\\]\.[/\\]pipe[/\\].+/;function createAgent(t){if(process.platform==="win32"&&!R.test(t)){return t==="pageant"?new I:new C(t)}return new OpenSSHAgent(t)}const B=(()=>{const t=11;const r=13;const n=5;const i=12;const s=14;const l=1<<1;const u=1<<2;const h=0;const m=1;function processResponses(t){let r;while(t[R].length){const n=t[R][0][I];if(n===undefined)break;t[R].shift();r=t.push(n)}return r}const b=Symbol("Inbound Request Type");const I=Symbol("Inbound Request Response");const C=Symbol("Inbound Request Context");class AgentInboundRequest{constructor(t,r){this[b]=t;this[I]=undefined;this[C]=r}hasResponded(){return this[I]!==undefined}getType(){return this[b]}getContext(){return this[C]}}function respond(t,r,n){r[I]=n;return processResponses(t)}function cleanup(t){t[k]=null;if(t[B]===h){const r=t[R];if(r&&r.length){t[R]=[];for(const t of r)t.cb(new Error("No reply from server"))}}try{t.end()}catch{}setImmediate((()=>{if(!t[P])t.emit("end");if(!t[T])t.emit("close")}))}function onClose(){this[T]=true}function onEnd(){this[P]=true}const R=Symbol("Requests");const B=Symbol("Agent Protocol Role");const k=Symbol("Agent Protocol Buffer");const v=Symbol("Agent Protocol Current Message Length");const T=Symbol("Agent Protocol Closed");const P=Symbol("Agent Protocol Ended");return class AgentProtocol extends o{constructor(t){super({autoDestroy:true,emitClose:false});this[B]=t?h:m;this[R]=[];this[k]=null;this[v]=-1;this.once("end",onEnd);this.once("close",onClose)}_read(t){}_write(o,p,m){if(this[k]===null)this[k]=o;else this[k]=concat(this[k],o);let E=this[k];let b=E.length;let y=0;while(y<b){if(b<5)break;if(this[v]===-1)this[v]=_(E,y);if(b<4+this[v])break;const o=E[y+=4];++y;if(this[B]===h){if(this[R].length===0)return m(new Error("Received unexpected message from server"));const l=this[R].shift();switch(o){case n:l.cb(new Error("Agent responded with failure"));break;case i:{if(l.type!==t)return m(new Error("Agent responded with wrong message type"));w.init(E,y);const r=w.readUInt32BE();if(r===undefined){w.clear();return m(new Error("Malformed agent response"))}const n=[];for(let t=0;t<r;++t){let t=w.readString();if(t===undefined){w.clear();return m(new Error("Malformed agent response"))}const r=w.readString(true);if(r===undefined){w.clear();return m(new Error("Malformed agent response"))}t=g(t);if(t instanceof Error)continue;t.comment=t.comment||r;n.push(t)}y=w.pos();w.clear();l.cb(null,n);break}case s:{if(l.type!==r)return m(new Error("Agent responded with wrong message type"));w.init(E,y);let t=w.readString();y=w.pos();w.clear();if(t===undefined)return m(new Error("Malformed agent response"));w.init(t,0);w.readString(true);t=w.readString();w.clear();if(t===undefined)return m(new Error("Malformed OpenSSH signature format"));l.cb(null,t);break}default:return m(new Error("Agent responded with unsupported message type"))}}else{switch(o){case t:{const t=new AgentInboundRequest(o);this[R].push(t);this.emit("identities",t);break}case r:{w.init(E,y);let t=w.readString();const r=w.readString();const n=w.readUInt32BE();y=w.pos();w.clear();if(n===undefined){const t=new AgentInboundRequest(o);this[R].push(t);return this.failureReply(t)}t=g(t);if(t instanceof Error){const t=new AgentInboundRequest(o);this[R].push(t);return this.failureReply(t)}const i={hash:undefined};let s;if(t.type==="ssh-rsa"){if(n&l){s="rsa-sha2-256";i.hash="sha256"}else if(n&u){s="rsa-sha2-512";i.hash="sha512"}}if(s===undefined)s=t.type;const h=new AgentInboundRequest(o,s);this[R].push(h);this.emit("sign",h,t,r,i);break}default:{const t=new AgentInboundRequest(o);this[R].push(t);this.failureReply(t)}}}this[v]=-1;if(y===b){this[k]=null;break}else{this[k]=E=E.slice(y);b=E.length;y=0}}m()}_destroy(t,r){cleanup(this);r()}_final(t){cleanup(this);t()}sign(t,n,i,o){if(this[B]!==h)throw new Error("Client-only method called with server role");if(typeof i==="function"){o=i;i=undefined}else if(typeof i!=="object"||i===null){i=undefined}let s=0;t=g(t);if(t instanceof Error)throw new Error("Invalid public key argument");if(t.type==="ssh-rsa"&&i){switch(i.hash){case"sha256":s=l;break;case"sha512":s=u;break}}t=t.getPublicSSH();const p=r;const m=t.length;const _=n.length;let b=0;const y=Buffer.allocUnsafe(4+1+4+m+4+_+4);E(y,y.length-4,b);y[b+=4]=p;E(y,m,++b);t.copy(y,b+=4);E(y,_,b+=m);n.copy(y,b+=4);E(y,s,b+=_);if(typeof o!=="function")o=noop;this[R].push({type:p,cb:o});return this.push(y)}getIdentities(r){if(this[B]!==h)throw new Error("Client-only method called with server role");const n=t;let i=0;const o=Buffer.allocUnsafe(4+1);E(o,o.length-4,i);o[i+=4]=n;if(typeof r!=="function")r=noop;this[R].push({type:n,cb:r});return this.push(o)}failureReply(t){if(this[B]!==m)throw new Error("Server-only method called with client role");if(!(t instanceof AgentInboundRequest))throw new Error("Wrong request argument");if(t.hasResponded())return true;let r=0;const i=Buffer.allocUnsafe(4+1);E(i,i.length-4,r);i[r+=4]=n;return respond(this,t,i)}getIdentitiesReply(r,n){if(this[B]!==m)throw new Error("Server-only method called with client role");if(!(r instanceof AgentInboundRequest))throw new Error("Wrong request argument");if(r.hasResponded())return true;if(r.getType()!==t)throw new Error("Invalid response to request");if(!Array.isArray(n))throw new Error("Keys argument must be an array");let o=4;const s=[];for(let t=0;t<n.length;++t){const r=n[t];if(typeof r!=="object"||r===null)throw new Error(`Invalid key entry: ${r}`);let i;let l;if(p(r)){i=r}else if(p(r.pubKey)){i=r.pubKey}else{if(typeof r.pubKey!=="object"||r.pubKey===null)continue;({pubKey:i,comment:l}=r.pubKey);i=g(i);if(i instanceof Error)continue}l=i.comment||l;i=i.getPublicSSH();o+=4+i.length;if(l&&typeof l==="string")l=Buffer.from(l);else if(!Buffer.isBuffer(l))l=y;o+=4+l.length;s.push({pubKey:i,comment:l})}let l=0;const u=Buffer.allocUnsafe(4+1+o);E(u,u.length-4,l);u[l+=4]=i;E(u,s.length,++l);l+=4;for(let t=0;t<s.length;++t){const{pubKey:r,comment:n}=s[t];E(u,r.length,l);r.copy(u,l+=4);E(u,n.length,l+=r.length);l+=4;if(n.length){n.copy(u,l);l+=n.length}}return respond(this,r,u)}signReply(t,n){if(this[B]!==m)throw new Error("Server-only method called with client role");if(!(t instanceof AgentInboundRequest))throw new Error("Wrong request argument");if(t.hasResponded())return true;if(t.getType()!==r)throw new Error("Invalid response to request");if(!Buffer.isBuffer(n))throw new Error("Signature argument must be a Buffer");if(n.length===0)throw new Error("Signature argument must be non-empty");let i=0;const o=t.getContext();const l=Buffer.byteLength(o);const u=Buffer.allocUnsafe(4+1+4+4+l+4+n.length);E(u,u.length-4,i);u[i+=4]=s;E(u,4+l+4+n.length,++i);E(u,l,i+=4);u.utf8Write(o,i+=4,l);E(u,n.length,i+=l);n.copy(u,i+=4);return respond(this,t,u)}}})();const k=Symbol("Agent");const v=Symbol("Agent Keys");const T=Symbol("Agent Keys Index");const P=Symbol("Agent Init Callbacks");class AgentContext{constructor(t){if(typeof t==="string")t=createAgent(t);else if(!isAgent(t))throw new Error("Invalid agent argument");this[k]=t;this[v]=null;this[T]=-1;this[P]=null}init(t){if(typeof t!=="function")t=noop;if(this[v]===null){if(this[P]===null){this[P]=[t];const doCbs=(...t)=>{process.nextTick((()=>{const r=this[P];this[P]=null;for(const n of r)n(...t)}))};this[k].getIdentities(once(((t,r)=>{if(t)return doCbs(t);if(!Array.isArray(r)){return doCbs(new Error("Agent implementation failed to provide keys"))}const n=[];for(let t of r){t=g(t);if(t instanceof Error){continue}n.push(t)}this[v]=n;this[T]=-1;doCbs()})))}else{this[P].push(t)}}else{process.nextTick(t)}}nextKey(){if(this[v]===null||++this[T]>=this[v].length){return false}return this[v][this[T]]}currentKey(){if(this[v]===null||this[T]>=this[v].length){return null}return this[v][this[T]]}pos(){if(this[v]===null||this[T]>=this[v].length){return-1}return this[T]}reset(){this[T]=-1}sign(...t){this[k].sign(...t)}}function isAgent(t){return t instanceof BaseAgent}t.exports={AgentContext:AgentContext,AgentProtocol:B,BaseAgent:BaseAgent,createAgent:createAgent,CygwinAgent:C,isAgent:isAgent,OpenSSHAgent:OpenSSHAgent,PageantAgent:I}},6063:(t,r,n)=>{"use strict";const{createHash:i,getHashes:o,randomFillSync:s}=n(6417);const{Socket:l}=n(1631);const{lookup:u}=n(881);const h=n(8614);const p=o();const{COMPAT:g,CHANNEL_EXTENDED_DATATYPE:{STDERR:m},CHANNEL_OPEN_FAILURE:_,DEFAULT_CIPHER:E,DEFAULT_COMPRESSION:b,DEFAULT_KEX:y,DEFAULT_MAC:w,DEFAULT_SERVER_HOST_KEY:I,DISCONNECT_REASON:C,DISCONNECT_REASON_BY_VALUE:R,SUPPORTED_CIPHER:B,SUPPORTED_COMPRESSION:k,SUPPORTED_KEX:v,SUPPORTED_MAC:T,SUPPORTED_SERVER_HOST_KEY:P}=n(6832);const{init:O}=n(5708);const D=n(9031);const{parseKey:L}=n(2218);const{SFTP:U}=n(2026);const{bufferCopy:W,makeBufferParser:Q,makeError:q,readUInt32BE:$,sigSSHToASN1:j,writeUInt32BE:G}=n(9475);const{AgentContext:Y,createAgent:z,isAgent:V}=n(9054);const{Channel:J,MAX_WINDOW:ee,PACKET_SIZE:te,windowAdjust:re,WINDOW_THRESHOLD:ne}=n(3204);const{ChannelManager:ie,generateAlgorithmList:oe,isWritable:se,onChannelOpenFailure:ae,onCHANNEL_CLOSE:le}=n(834);const ce=Q();const ue=Q();const fe=/^OpenSSH_(?:(?![0-4])\d)|(?:\d{2,})/;const noop=t=>{};class Client extends h{constructor(){super();this.config={host:undefined,port:undefined,localAddress:undefined,localPort:undefined,forceIPv4:undefined,forceIPv6:undefined,keepaliveCountMax:undefined,keepaliveInterval:undefined,readyTimeout:undefined,ident:undefined,username:undefined,password:undefined,privateKey:undefined,tryKeyboard:undefined,agent:undefined,allowAgentFwd:undefined,authHandler:undefined,hostHashAlgo:undefined,hostHashCb:undefined,strictVendor:undefined,debug:undefined};this._agent=undefined;this._readyTimeout=undefined;this._chanMgr=undefined;this._callbacks=undefined;this._forwarding=undefined;this._forwardingUnix=undefined;this._acceptX11=undefined;this._agentFwdEnabled=undefined;this._remoteVer=undefined;this._protocol=undefined;this._sock=undefined;this._resetKA=undefined}connect(t){if(this._sock&&se(this._sock)){this.once("close",(()=>{this.connect(t)}));this.end();return this}this.config.host=t.hostname||t.host||"localhost";this.config.port=t.port||22;this.config.localAddress=typeof t.localAddress==="string"?t.localAddress:undefined;this.config.localPort=typeof t.localPort==="string"||typeof t.localPort==="number"?t.localPort:undefined;this.config.forceIPv4=t.forceIPv4||false;this.config.forceIPv6=t.forceIPv6||false;this.config.keepaliveCountMax=typeof t.keepaliveCountMax==="number"&&t.keepaliveCountMax>=0?t.keepaliveCountMax:3;this.config.keepaliveInterval=typeof t.keepaliveInterval==="number"&&t.keepaliveInterval>0?t.keepaliveInterval:0;this.config.readyTimeout=typeof t.readyTimeout==="number"&&t.readyTimeout>=0?t.readyTimeout:2e4;this.config.ident=typeof t.ident==="string"||Buffer.isBuffer(t.ident)?t.ident:undefined;const r={kex:undefined,serverHostKey:undefined,cs:{cipher:undefined,mac:undefined,compress:undefined,lang:[]},sc:undefined};let n=true;if(typeof t.algorithms==="object"&&t.algorithms!==null){r.kex=oe(t.algorithms.kex,y,v);if(r.kex!==y)n=false;r.serverHostKey=oe(t.algorithms.serverHostKey,I,P);if(r.serverHostKey!==I)n=false;r.cs.cipher=oe(t.algorithms.cipher,E,B);if(r.cs.cipher!==E)n=false;r.cs.mac=oe(t.algorithms.hmac,w,T);if(r.cs.mac!==w)n=false;r.cs.compress=oe(t.algorithms.compress,b,k);if(r.cs.compress!==b)n=false;if(!n)r.sc=r.cs}if(typeof t.username==="string")this.config.username=t.username;else if(typeof t.user==="string")this.config.username=t.user;else throw new Error("Invalid username");this.config.password=typeof t.password==="string"?t.password:undefined;this.config.privateKey=typeof t.privateKey==="string"||Buffer.isBuffer(t.privateKey)?t.privateKey:undefined;this.config.localHostname=typeof t.localHostname==="string"?t.localHostname:undefined;this.config.localUsername=typeof t.localUsername==="string"?t.localUsername:undefined;this.config.tryKeyboard=t.tryKeyboard===true;if(typeof t.agent==="string"&&t.agent.length)this.config.agent=z(t.agent);else if(V(t.agent))this.config.agent=t.agent;else this.config.agent=undefined;this.config.allowAgentFwd=t.agentForward===true&&this.config.agent!==undefined;let o=this.config.authHandler=typeof t.authHandler==="function"||Array.isArray(t.authHandler)?t.authHandler:undefined;this.config.strictVendor=typeof t.strictVendor==="boolean"?t.strictVendor:true;const s=this.config.debug=typeof t.debug==="function"?t.debug:undefined;if(t.agentForward===true&&!this.config.allowAgentFwd){throw new Error("You must set a valid agent path to allow agent forwarding")}let h=this._callbacks=[];this._chanMgr=new ie(this);this._forwarding={};this._forwardingUnix={};this._acceptX11=0;this._agentFwdEnabled=false;this._agent=this.config.agent?this.config.agent:undefined;this._remoteVer=undefined;let g;if(this.config.privateKey){g=L(this.config.privateKey,t.passphrase);if(g instanceof Error)throw new Error(`Cannot parse privateKey: ${g.message}`);if(Array.isArray(g)){g=g[0]}if(g.getPrivatePEM()===null){throw new Error("privateKey value does not contain a (valid) private key")}}let _;if(typeof t.hostVerifier==="function"){const r=t.hostVerifier;let n;if(p.indexOf(t.hostHash)!==-1){n=i(t.hostHash)}_=(t,i)=>{if(n){n.update(t);t=n.digest("hex")}const o=r(t,i);if(o!==undefined)i(o)}}const W=this._sock=t.sock||new l;let Q=false;let $=false;if(this._protocol)this._protocol.cleanup();const j=!s?undefined:(t,r,n)=>{s(`Debug output from server: ${JSON.stringify(n)}`)};const G=this._protocol=new D({ident:this.config.ident,offer:n?undefined:r,onWrite:t=>{if(se(W))W.write(t)},onError:t=>{if(t.level==="handshake")clearTimeout(this._readyTimeout);if(!G._destruct)W.removeAllListeners("data");this.emit("error",t);try{W.end()}catch{}},onHeader:t=>{$=true;this._remoteVer=t.versions.software;if(t.greeting)this.emit("greeting",t.greeting)},onHandshakeComplete:t=>{this.emit("handshake",t);if(!Q){Q=true;G.service("ssh-userauth")}},debug:s,hostVerifier:_,messageHandlers:{DEBUG:j,DISCONNECT:(t,r,n)=>{if(r!==C.BY_APPLICATION){if(!n){n=R[r];if(n===undefined)n=`Unexpected disconnection reason: ${r}`}const t=new Error(n);t.code=r;this.emit("error",t)}W.end()},SERVICE_ACCEPT:(t,r)=>{if(r==="ssh-userauth")tryNextAuth()},USERAUTH_BANNER:(t,r)=>{this.emit("banner",r)},USERAUTH_SUCCESS:t=>{resetKA();clearTimeout(this._readyTimeout);this.emit("ready")},USERAUTH_FAILURE:(t,r,n)=>{if(me.type==="agent"){const t=me.agentCtx.pos();s&&s(`Client: Agent key #${t+1} failed`);return tryNextAgentKey()}s&&s(`Client: ${me.type} auth failed`);_e=n;Ae=r;tryNextAuth()},USERAUTH_PASSWD_CHANGEREQ:(t,r)=>{if(me.type==="password"){this.emit("change password",r,(t=>{G.authPassword(this.config.username,this.config.password,t)}))}},USERAUTH_PK_OK:t=>{if(me.type==="agent"){const t=me.agentCtx.currentKey();G.authPK(me.username,t,((r,n)=>{me.agentCtx.sign(t,r,{},((t,r)=>{if(t){t.level="agent";this.emit("error",t)}else{return n(r)}tryNextAgentKey()}))}))}else if(me.type==="publickey"){G.authPK(me.username,me.key,((t,r)=>{const n=me.key.sign(t);if(n instanceof Error){n.message=`Error signing data with key: ${n.message}`;n.level="client-authentication";this.emit("error",n);return tryNextAuth()}r(n)}))}},USERAUTH_INFO_REQUEST:(t,r,n,i)=>{if(me.type==="keyboard-interactive"){const t=Array.isArray(i)?i.length:0;if(t===0){s&&s("Client: Sending automatic USERAUTH_INFO_RESPONSE");G.authInfoRes();return}me.prompt(r,n,"",i,(t=>{G.authInfoRes(t)}))}},REQUEST_SUCCESS:(t,r)=>{if(h.length)h.shift()(false,r)},REQUEST_FAILURE:t=>{if(h.length)h.shift()(true)},GLOBAL_REQUEST:(t,r,n,i)=>{switch(r){case"hostkeys-00@openssh.com":hostKeysProve(this,i,((t,r)=>{if(t)return;this.emit("hostkeys",r)}));if(n)G.requestSuccess();break;default:if(n)G.requestFailure()}},CHANNEL_OPEN:(t,r)=>{onCHANNEL_OPEN(this,r)},CHANNEL_OPEN_CONFIRMATION:(t,r)=>{const n=this._chanMgr.get(r.recipient);if(typeof n!=="function")return;const i=n.type==="sftp";const o=i?"session":n.type;const l={type:o,incoming:{id:r.recipient,window:ee,packetSize:te,state:"open"},outgoing:{id:r.sender,window:r.window,packetSize:r.packetSize,state:"open"}};const u=i?new U(this,l,{debug:s}):new J(this,l);this._chanMgr.update(r.recipient,u);n(undefined,u)},CHANNEL_OPEN_FAILURE:(t,r,n,i)=>{const o=this._chanMgr.get(r);if(typeof o!=="function")return;const s={reason:n,description:i};ae(this,r,s,o)},CHANNEL_DATA:(t,r,n)=>{const i=this._chanMgr.get(r);if(typeof i!=="object"||i===null)return;if(i.incoming.window===0)return;i.incoming.window-=n.length;if(i.push(n)===false){i._waitChanDrain=true;return}if(i.incoming.window<=ne)re(i)},CHANNEL_EXTENDED_DATA:(t,r,n,i)=>{if(i!==m)return;const o=this._chanMgr.get(r);if(typeof o!=="object"||o===null)return;if(o.incoming.window===0)return;o.incoming.window-=n.length;if(!o.stderr.push(n)){o._waitChanDrain=true;return}if(o.incoming.window<=ne)re(o)},CHANNEL_WINDOW_ADJUST:(t,r,n)=>{const i=this._chanMgr.get(r);if(typeof i!=="object"||i===null)return;i.outgoing.window+=n;if(i._waitWindow){i._waitWindow=false;if(i._chunk){i._write(i._chunk,null,i._chunkcb)}else if(i._chunkcb){i._chunkcb()}else if(i._chunkErr){i.stderr._write(i._chunkErr,null,i._chunkcbErr)}else if(i._chunkcbErr){i._chunkcbErr()}}},CHANNEL_SUCCESS:(t,r)=>{const n=this._chanMgr.get(r);if(typeof n!=="object"||n===null)return;this._resetKA();if(n._callbacks.length)n._callbacks.shift()(false)},CHANNEL_FAILURE:(t,r)=>{const n=this._chanMgr.get(r);if(typeof n!=="object"||n===null)return;this._resetKA();if(n._callbacks.length)n._callbacks.shift()(true)},CHANNEL_REQUEST:(t,r,n,i,o)=>{const s=this._chanMgr.get(r);if(typeof s!=="object"||s===null)return;const l=s._exit;if(l.code!==undefined)return;switch(n){case"exit-status":s.emit("exit",l.code=o);return;case"exit-signal":s.emit("exit",l.code=null,l.signal=`SIG${o.signal}`,l.dump=o.coreDumped,l.desc=o.errorMessage);return}if(i)t.channelFailure(s.outgoing.id)},CHANNEL_EOF:(t,r)=>{const n=this._chanMgr.get(r);if(typeof n!=="object"||n===null)return;if(n.incoming.state!=="open")return;n.incoming.state="eof";if(n.readable)n.push(null);if(n.stderr.readable)n.stderr.push(null)},CHANNEL_CLOSE:(t,r)=>{le(this,r,this._chanMgr.get(r))}}});W.pause();const ce=this.config.keepaliveInterval;const ue=this.config.keepaliveCountMax;let fe=0;let de;const sendKA=()=>{if(++fe>ue){clearInterval(de);if(W.readable){const t=new Error("Keepalive timeout");t.level="client-timeout";this.emit("error",t);W.destroy()}return}if(se(W)){h.push(resetKA);G.ping()}else{clearInterval(de)}};function resetKA(){if(ce>0){fe=0;clearInterval(de);if(se(W))de=setInterval(sendKA,ce)}}this._resetKA=resetKA;const he=(()=>{let t=false;return()=>{if(t)return;t=true;if(ge&&!$){const t=q("Connection lost before handshake","protocol",true);this.emit("error",t)}}})();const pe=(()=>{let t=false;return()=>{if(t)return;t=true;ge=true;s&&s("Socket connected");this.emit("connect");O.then((()=>{W.on("data",(t=>{try{G.parse(t,0,t.length)}catch(t){this.emit("error",t);try{if(se(W))W.end()}catch{}}}));if(W.stderr&&typeof W.stderr.resume==="function")W.stderr.resume();W.resume()})).catch((t=>{this.emit("error",t);try{if(se(W))W.end()}catch{}}))}})();let ge=false;W.on("connect",pe).on("timeout",(()=>{this.emit("timeout")})).on("error",(t=>{s&&s(`Socket error: ${t.message}`);clearTimeout(this._readyTimeout);t.level="client-socket";this.emit("error",t)})).on("end",(()=>{s&&s("Socket ended");he();G.cleanup();clearTimeout(this._readyTimeout);clearInterval(de);this.emit("end")})).on("close",(()=>{s&&s("Socket closed");he();G.cleanup();clearTimeout(this._readyTimeout);clearInterval(de);this.emit("close");const t=h;h=this._callbacks=[];const r=new Error("No response from server");for(let n=0;n<t.length;++n)t[n](r);this._chanMgr.cleanup(r)}));let me;let _e=null;let Ae=null;const Ee=["none"];if(this.config.password!==undefined)Ee.push("password");if(g!==undefined)Ee.push("publickey");if(this._agent!==undefined)Ee.push("agent");if(this.config.tryKeyboard)Ee.push("keyboard-interactive");if(g!==undefined&&this.config.localHostname!==undefined&&this.config.localUsername!==undefined){Ee.push("hostbased")}if(Array.isArray(o))o=makeSimpleAuthHandler(o);else if(typeof o!=="function")o=makeSimpleAuthHandler(Ee);let be=false;const doNextAuth=t=>{if(be)return;be=true;if(t===false){const t=new Error("All configured authentication methods failed");t.level="client-authentication";this.emit("error",t);this.end();return}if(typeof t==="string"){const r=t;if(Ee.indexOf(r)===-1)return skipAuth(`Authentication method not allowed: ${r}`);const n=this.config.username;switch(r){case"password":t={type:r,username:n,password:this.config.password};break;case"publickey":t={type:r,username:n,key:g};break;case"hostbased":t={type:r,username:n,key:g,localHostname:this.config.localHostname,localUsername:this.config.localUsername};break;case"agent":t={type:r,username:n,agentCtx:new Y(this._agent)};break;case"keyboard-interactive":t={type:r,username:n,prompt:(...t)=>this.emit("keyboard-interactive",...t)};break;case"none":t={type:r,username:n};break;default:return skipAuth(`Skipping unsupported authentication method: ${t}`)}}else if(typeof t!=="object"||t===null){return skipAuth(`Skipping invalid authentication attempt: ${t}`)}else{const r=t.username;if(typeof r!=="string"){return skipAuth(`Skipping invalid authentication attempt: ${t}`)}const n=t.type;switch(n){case"password":{const{password:i}=t;if(typeof i!=="string"&&!Buffer.isBuffer(i))return skipAuth("Skipping invalid password auth attempt");t={type:n,username:r,password:i};break}case"publickey":{const i=L(t.key,t.passphrase);if(i instanceof Error)return skipAuth("Skipping invalid key auth attempt");if(!i.isPrivateKey())return skipAuth("Skipping non-private key");t={type:n,username:r,key:i};break}case"hostbased":{const{localHostname:i,localUsername:o}=t;const s=L(t.key,t.passphrase);if(s instanceof Error||typeof i!=="string"||typeof o!=="string"){return skipAuth("Skipping invalid hostbased auth attempt")}if(!s.isPrivateKey())return skipAuth("Skipping non-private key");t={type:n,username:r,key:s,localHostname:i,localUsername:o};break}case"agent":{let i=t.agent;if(typeof i==="string"&&i.length){i=z(i)}else if(!V(i)){return skipAuth(`Skipping invalid agent: ${t.agent}`)}t={type:n,username:r,agentCtx:new Y(i)};break}case"keyboard-interactive":{const{prompt:i}=t;if(typeof i!=="function"){return skipAuth("Skipping invalid keyboard-interactive auth attempt")}t={type:n,username:r,prompt:i};break}case"none":t={type:n,username:r};break;default:return skipAuth(`Skipping unsupported authentication method: ${t}`)}}me=t;try{const t=me.username;switch(me.type){case"password":G.authPassword(t,me.password);break;case"publickey":G.authPK(t,me.key);break;case"hostbased":G.authHostbased(t,me.key,me.localHostname,me.localUsername,((t,r)=>{const n=me.key.sign(t);if(n instanceof Error){n.message=`Error while signing with key: ${n.message}`;n.level="client-authentication";this.emit("error",n);return tryNextAuth()}r(n)}));break;case"agent":me.agentCtx.init((t=>{if(t){t.level="agent";this.emit("error",t);return tryNextAuth()}tryNextAgentKey()}));break;case"keyboard-interactive":G.authKeyboard(t);break;case"none":G.authNone(t);break}}finally{be=false}};function skipAuth(t){s&&s(t);process.nextTick(tryNextAuth)}function tryNextAuth(){be=false;const t=o(Ae,_e,doNextAuth);if(be||t===undefined)return;doNextAuth(t)}const tryNextAgentKey=()=>{if(me.type==="agent"){const t=me.agentCtx.nextKey();if(t===false){s&&s("Agent: No more keys left to try");s&&s("Client: agent auth failed");tryNextAuth()}else{const r=me.agentCtx.pos();s&&s(`Agent: Trying key #${r+1}`);G.authPK(me.username,t)}}};const startTimeout=()=>{if(this.config.readyTimeout>0){this._readyTimeout=setTimeout((()=>{const t=new Error("Timed out while waiting for handshake");t.level="client-timeout";this.emit("error",t);W.destroy()}),this.config.readyTimeout)}};if(!t.sock){let r=this.config.host;const n=this.config.forceIPv4;const i=this.config.forceIPv6;s&&s(`Client: Trying ${r} on port ${this.config.port} ...`);const doConnect=()=>{startTimeout();W.connect({host:r,port:this.config.port,localAddress:this.config.localAddress,localPort:this.config.localPort});W.setNoDelay(true);W.setMaxListeners(0);W.setTimeout(typeof t.timeout==="number"?t.timeout:0)};if(!n&&!i||n&&i){doConnect()}else{u(r,n?4:6,((t,i,o)=>{if(t){const i=n?"IPv4":"IPv6";const o=new Error(`Error while looking up ${i} address for '${r}': ${t}`);clearTimeout(this._readyTimeout);o.level="client-dns";this.emit("error",o);this.emit("close");return}r=i;doConnect()}))}}else{startTimeout();if(typeof W.connecting==="boolean"){if(!W.connecting){pe()}}else{pe()}}return this}end(){if(this._sock&&se(this._sock)){this._protocol.disconnect(C.BY_APPLICATION);this._sock.end()}return this}destroy(){this._sock&&se(this._sock)&&this._sock.destroy();return this}exec(t,r,n){if(!this._sock||!se(this._sock))throw new Error("Not connected");if(typeof r==="function"){n=r;r={}}const i={allowHalfOpen:r.allowHalfOpen!==false};openChannel(this,"session",i,((i,o)=>{if(i){n(i);return}const s=[];function reqCb(t){if(t){o.close();n(t);return}if(s.length)s.shift()()}if(this.config.allowAgentFwd===true||r&&r.agentForward===true&&this._agent!==undefined){s.push((()=>reqAgentFwd(o,reqCb)))}if(typeof r==="object"&&r!==null){if(typeof r.env==="object"&&r.env!==null)reqEnv(o,r.env);if(typeof r.pty==="object"&&r.pty!==null||r.pty===true){s.push((()=>reqPty(o,r.pty,reqCb)))}if(typeof r.x11==="object"&&r.x11!==null||r.x11==="number"||r.x11===true){s.push((()=>reqX11(o,r.x11,reqCb)))}}s.push((()=>reqExec(o,t,r,n)));s.shift()()}));return this}shell(t,r,n){if(!this._sock||!se(this._sock))throw new Error("Not connected");if(typeof t==="function"){n=t;t=r=undefined}else if(typeof r==="function"){n=r;r=undefined}if(t&&(t.x11!==undefined||t.env!==undefined)){r=t;t=undefined}openChannel(this,"session",((i,o)=>{if(i){n(i);return}const s=[];function reqCb(t){if(t){o.close();n(t);return}if(s.length)s.shift()()}if(this.config.allowAgentFwd===true||r&&r.agentForward===true&&this._agent!==undefined){s.push((()=>reqAgentFwd(o,reqCb)))}if(t!==false)s.push((()=>reqPty(o,t,reqCb)));if(typeof r==="object"&&r!==null){if(typeof r.env==="object"&&r.env!==null)reqEnv(o,r.env);if(typeof r.x11==="object"&&r.x11!==null||r.x11==="number"||r.x11===true){s.push((()=>reqX11(o,r.x11,reqCb)))}}s.push((()=>reqShell(o,n)));s.shift()()}));return this}subsys(t,r){if(!this._sock||!se(this._sock))throw new Error("Not connected");openChannel(this,"session",((n,i)=>{if(n){r(n);return}reqSubsystem(i,t,((t,n)=>{if(t){r(t);return}r(undefined,n)}))}));return this}forwardIn(t,r,n){if(!this._sock||!se(this._sock))throw new Error("Not connected");const i=typeof n==="function";if(i){this._callbacks.push(((i,o)=>{if(i){n(i!==true?i:new Error(`Unable to bind to ${t}:${r}`));return}let s=r;if(r===0&&o&&o.length>=4){s=$(o,0);if(!(this._protocol._compatFlags&g.DYN_RPORT_BUG))r=s}this._forwarding[`${t}:${r}`]=s;n(undefined,s)}))}this._protocol.tcpipForward(t,r,i);return this}unforwardIn(t,r,n){if(!this._sock||!se(this._sock))throw new Error("Not connected");const i=typeof n==="function";if(i){this._callbacks.push((i=>{if(i){n(i!==true?i:new Error(`Unable to unbind from ${t}:${r}`));return}delete this._forwarding[`${t}:${r}`];n()}))}this._protocol.cancelTcpipForward(t,r,i);return this}forwardOut(t,r,n,i,o){if(!this._sock||!se(this._sock))throw new Error("Not connected");const s={srcIP:t,srcPort:r,dstIP:n,dstPort:i};if(typeof o!=="function")o=noop;openChannel(this,"direct-tcpip",s,o);return this}openssh_noMoreSessions(t){if(!this._sock||!se(this._sock))throw new Error("Not connected");const r=typeof t==="function";if(!this.config.strictVendor||this.config.strictVendor&&fe.test(this._remoteVer)){if(r){this._callbacks.push((r=>{if(r){t(r!==true?r:new Error("Unable to disable future sessions"));return}t()}))}this._protocol.openssh_noMoreSessions(r);return this}if(!r)return this;process.nextTick(t,new Error("strictVendor enabled and server is not OpenSSH or compatible version"));return this}openssh_forwardInStreamLocal(t,r){if(!this._sock||!se(this._sock))throw new Error("Not connected");const n=typeof r==="function";if(!this.config.strictVendor||this.config.strictVendor&&fe.test(this._remoteVer)){if(n){this._callbacks.push((n=>{if(n){r(n!==true?n:new Error(`Unable to bind to ${t}`));return}this._forwardingUnix[t]=true;r()}))}this._protocol.openssh_streamLocalForward(t,n);return this}if(!n)return this;process.nextTick(r,new Error("strictVendor enabled and server is not OpenSSH or compatible version"));return this}openssh_unforwardInStreamLocal(t,r){if(!this._sock||!se(this._sock))throw new Error("Not connected");const n=typeof r==="function";if(!this.config.strictVendor||this.config.strictVendor&&fe.test(this._remoteVer)){if(n){this._callbacks.push((n=>{if(n){r(n!==true?n:new Error(`Unable to unbind from ${t}`));return}delete this._forwardingUnix[t];r()}))}this._protocol.openssh_cancelStreamLocalForward(t,n);return this}if(!n)return this;process.nextTick(r,new Error("strictVendor enabled and server is not OpenSSH or compatible version"));return this}openssh_forwardOutStreamLocal(t,r){if(!this._sock||!se(this._sock))throw new Error("Not connected");if(typeof r!=="function")r=noop;if(!this.config.strictVendor||this.config.strictVendor&&fe.test(this._remoteVer)){openChannel(this,"direct-streamlocal@openssh.com",{socketPath:t},r);return this}process.nextTick(r,new Error("strictVendor enabled and server is not OpenSSH or compatible version"));return this}sftp(t){if(!this._sock||!se(this._sock))throw new Error("Not connected");openChannel(this,"sftp",((r,n)=>{if(r){t(r);return}reqSubsystem(n,"sftp",((r,i)=>{if(r){t(r);return}function removeListeners(){n.removeListener("ready",onReady);n.removeListener("error",onError);n.removeListener("exit",onExit);n.removeListener("close",onExit)}function onReady(){removeListeners();t(undefined,n)}function onError(r){removeListeners();t(r)}function onExit(r,n){removeListeners();let i;if(typeof r==="number")i=`Received exit code ${r} while establishing SFTP session`;else if(n!==undefined)i=`Received signal ${n} while establishing SFTP session`;else i="Received unexpected SFTP session termination";const o=new Error(i);o.code=r;o.signal=n;t(o)}n.on("ready",onReady).on("error",onError).on("exit",onExit).on("close",onExit);n._init()}))}));return this}}function openChannel(t,r,n,i){const o=ee;const s=te;if(typeof n==="function"){i=n;n={}}const wrapper=(t,r)=>{i(t,r)};wrapper.type=r;const l=t._chanMgr.add(wrapper);if(l===-1){i(new Error("No free channels available"));return}switch(r){case"session":case"sftp":t._protocol.session(l,o,s);break;case"direct-tcpip":t._protocol.directTcpip(l,o,s,n);break;case"direct-streamlocal@openssh.com":t._protocol.openssh_directStreamLocal(l,o,s,n);break;default:throw new Error(`Unsupported channel type: ${r}`)}}function reqX11(t,r,n){const i={single:false,protocol:"MIT-MAGIC-COOKIE-1",cookie:undefined,screen:0};if(typeof r==="function"){n=r}else if(typeof r==="object"&&r!==null){if(typeof r.single==="boolean")i.single=r.single;if(typeof r.screen==="number")i.screen=r.screen;if(typeof r.protocol==="string")i.protocol=r.protocol;if(typeof r.cookie==="string")i.cookie=r.cookie;else if(Buffer.isBuffer(r.cookie))i.cookie=r.cookie.hexSlice(0,r.cookie.length)}if(i.cookie===undefined)i.cookie=de();const o=typeof n==="function";if(t.outgoing.state!=="open"){if(o)n(new Error("Channel is not open"));return}if(o){t._callbacks.push((r=>{if(r){n(r!==true?r:new Error("Unable to request X11"));return}t._hasX11=true;++t._client._acceptX11;t.once("close",(()=>{if(t._client._acceptX11)--t._client._acceptX11}));n()}))}t._client._protocol.x11Forward(t.outgoing.id,i,o)}function reqPty(t,r,n){let i=24;let o=80;let s=640;let l=480;let u="vt100";let h=null;if(typeof r==="function"){n=r}else if(typeof r==="object"&&r!==null){if(typeof r.rows==="number")i=r.rows;if(typeof r.cols==="number")o=r.cols;if(typeof r.width==="number")s=r.width;if(typeof r.height==="number")l=r.height;if(typeof r.term==="string")u=r.term;if(typeof r.modes==="object")h=r.modes}const p=typeof n==="function";if(t.outgoing.state!=="open"){if(p)n(new Error("Channel is not open"));return}if(p){t._callbacks.push((t=>{if(t){n(t!==true?t:new Error("Unable to request a pseudo-terminal"));return}n()}))}t._client._protocol.pty(t.outgoing.id,i,o,l,s,u,h,p)}function reqAgentFwd(t,r){const n=typeof r==="function";if(t.outgoing.state!=="open"){n&&r(new Error("Channel is not open"));return}if(t._client._agentFwdEnabled){n&&r(false);return}t._client._agentFwdEnabled=true;t._callbacks.push((i=>{if(i){t._client._agentFwdEnabled=false;if(n){r(i!==true?i:new Error("Unable to request agent forwarding"))}return}if(n)r()}));t._client._protocol.openssh_agentForward(t.outgoing.id,true)}function reqShell(t,r){if(t.outgoing.state!=="open"){r(new Error("Channel is not open"));return}t._callbacks.push((n=>{if(n){r(n!==true?n:new Error("Unable to open shell"));return}t.subtype="shell";r(undefined,t)}));t._client._protocol.shell(t.outgoing.id,true)}function reqExec(t,r,n,i){if(t.outgoing.state!=="open"){i(new Error("Channel is not open"));return}t._callbacks.push((r=>{if(r){i(r!==true?r:new Error("Unable to exec"));return}t.subtype="exec";t.allowHalfOpen=n.allowHalfOpen!==false;i(undefined,t)}));t._client._protocol.exec(t.outgoing.id,r,true)}function reqEnv(t,r){if(t.outgoing.state!=="open")return;const n=Object.keys(r||{});for(let i=0;i<n.length;++i){const o=n[i];const s=r[o];t._client._protocol.env(t.outgoing.id,o,s,false)}}function reqSubsystem(t,r,n){if(t.outgoing.state!=="open"){n(new Error("Channel is not open"));return}t._callbacks.push((i=>{if(i){n(i!==true?i:new Error(`Unable to start subsystem: ${r}`));return}t.subtype="subsystem";n(undefined,t)}));t._client._protocol.subsystem(t.outgoing.id,r,true)}function onCHANNEL_OPEN(t,r){let n=-1;let i;const accept=()=>{const i={type:r.type,incoming:{id:n,window:ee,packetSize:te,state:"open"},outgoing:{id:r.sender,window:r.window,packetSize:r.packetSize,state:"open"}};const o=new J(t,i);t._chanMgr.update(n,o);t._protocol.channelOpenConfirm(r.sender,n,ee,te);return o};const reject=()=>{if(i===undefined){if(n===-1)i=_.RESOURCE_SHORTAGE;else i=_.CONNECT_FAILED}if(n!==-1)t._chanMgr.remove(n);t._protocol.channelOpenFail(r.sender,i,"")};const reserveChannel=()=>{n=t._chanMgr.add();if(n===-1){i=_.RESOURCE_SHORTAGE;if(t.config.debug){t.config.debug("Client: Automatic rejection of incoming channel open: "+"no channels available")}}return n!==-1};const o=r.data;switch(r.type){case"forwarded-tcpip":{const r=t._forwarding[`${o.destIP}:${o.destPort}`];if(r!==undefined&&reserveChannel()){if(o.destPort===0)o.destPort=r;t.emit("tcp connection",o,accept,reject);return}break}case"forwarded-streamlocal@openssh.com":if(t._forwardingUnix[o.socketPath]!==undefined&&reserveChannel()){t.emit("unix connection",o,accept,reject);return}break;case"auth-agent@openssh.com":if(t._agentFwdEnabled&&typeof t._agent.getStream==="function"&&reserveChannel()){t._agent.getStream(((t,r)=>{if(t)return reject();const n=accept();n.pipe(r).pipe(n)}));return}break;case"x11":if(t._acceptX11!==0&&reserveChannel()){t.emit("x11",o,accept,reject);return}break;default:i=_.UNKNOWN_CHANNEL_TYPE;if(t.config.debug){t.config.debug("Client: Automatic rejection of unsupported incoming channel open "+`type: ${r.type}`)}}if(i===undefined){i=_.ADMINISTRATIVELY_PROHIBITED;if(t.config.debug){t.config.debug("Client: Automatic rejection of unexpected incoming channel open for: "+r.type)}}reject()}const de=(()=>{const t=Buffer.allocUnsafe(16);return()=>{s(t,0,16);return t.hexSlice(0,16)}})();function makeSimpleAuthHandler(t){if(!Array.isArray(t))throw new Error("authList must be an array");let r=0;return(n,i,o)=>{if(r===t.length)return false;return t[r++]}}function hostKeysProve(t,r,n){if(!t._sock||!se(t._sock))return;if(typeof n!=="function")n=noop;if(!Array.isArray(r))throw new TypeError("Invalid keys argument type");const i=[];for(const t of r){const r=L(t);if(r instanceof Error)throw r;i.push(r)}if(!t.config.strictVendor||t.config.strictVendor&&fe.test(t._remoteVer)){t._callbacks.push(((r,o)=>{if(r){n(r!==true?r:new Error("Server failed to prove supplied keys"));return}const s=[];let l=0;ce.init(o,0);while(ce.avail()){if(l===i.length)break;const r=i[l++];const n=r.getPublicSSH();const o=ce.readString();ue.init(o,0);const u=ue.readString(true);let h=ue.readString();let p;if(u!==r.type){if(r.type==="ssh-rsa"){switch(u){case"rsa-sha2-256":p="sha256";break;case"rsa-sha2-512":p="sha512";break;default:continue}}else{continue}}const g=t._protocol._kex.sessionID;const m=Buffer.allocUnsafe(4+29+4+g.length+4+n.length);let _=0;G(m,29,_);m.utf8Write("hostkeys-prove-00@openssh.com",_+=4,29);G(m,g.length,_+=29);W(g,m,0,g.length,_+=4);G(m,n.length,_+=g.length);W(n,m,0,n.length,_+=4);if(!(h=j(h,u)))continue;if(r.verify(m,h,p)===true)s.push(r)}ue.clear();ce.clear();n(null,s)}));t._protocol.openssh_hostKeysProve(i);return}process.nextTick(n,new Error("strictVendor enabled and server is not OpenSSH or compatible version"))}t.exports=Client},2994:(t,r,n)=>{"use strict";const{Agent:i}=n(8605);const{Agent:o}=n(7211);const{connect:s}=n(4016);let l;for(const t of[i,o]){class SSHAgent extends t{constructor(t,r){super(r);this._connectCfg=t;this._defaultSrcIP=r&&r.srcIP||"localhost"}createConnection(r,i){const o=r&&r.localAddress||this._defaultSrcIP;const s=r&&r.localPort||0;const u=r.host;const h=r.port;if(l===undefined)l=n(6063);const p=new l;let g=false;p.on("ready",(()=>{p.forwardOut(o,s,u,h,((n,o)=>{g=true;if(n){p.end();return i(n)}o.once("close",(()=>p.end()));i(null,decorateStream(o,t,r))}))})).on("error",i).on("close",(()=>{if(!g)i(new Error("Unexpected connection close"))})).connect(this._connectCfg)}}r[t===i?"SSHTTPAgent":"SSHTTPSAgent"]=SSHAgent}function noop(){}function decorateStream(t,r,n){if(r===i){t.setKeepAlive=noop;t.setNoDelay=noop;t.setTimeout=noop;t.ref=noop;t.unref=noop;t.destroySoon=t.destroy;return t}n.socket=t;const o=s(n);const l=(()=>{let r=false;return()=>{if(r)return;r=true;if(t.isPaused())t.resume()}})();o.on("end",l).on("close",l);return o}},5869:(t,r,n)=>{"use strict";const{AgentProtocol:i,BaseAgent:o,createAgent:s,CygwinAgent:l,OpenSSHAgent:u,PageantAgent:h}=n(9054);const{SSHTTPAgent:p,SSHTTPSAgent:g}=n(2994);const{parseKey:m}=n(2218);const{flagsToString:_,OPEN_MODE:E,STATUS_CODE:b,stringToFlags:y}=n(2026);t.exports={AgentProtocol:i,BaseAgent:o,createAgent:s,Client:n(6063),CygwinAgent:l,HTTPAgent:p,HTTPSAgent:g,OpenSSHAgent:u,PageantAgent:h,Server:n(2986),utils:{parseKey:m,sftp:{flagsToString:_,OPEN_MODE:E,STATUS_CODE:b,stringToFlags:y}}}},9031:(t,r,n)=>{"use strict";const{inspect:i}=n(1669);const{bindingAvailable:o,NullCipher:s,NullDecipher:l}=n(5708);const{COMPAT_CHECKS:u,DISCONNECT_REASON:h,MESSAGE:p,SIGNALS:g,TERMINAL_MODE:m}=n(6832);const{DEFAULT_KEXINIT:_,KexInit:E,kexinit:b,onKEXPayload:y}=n(4126);const{parseKey:w}=n(2218);const I=n(172);const{bufferCopy:C,bufferFill:R,bufferSlice:B,convertSignature:k,sendPacket:v,writeUInt32BE:T}=n(9475);const{PacketReader:P,PacketWriter:O,ZlibPacketReader:D,ZlibPacketWriter:L}=n(6715);const U=n(6447).i8;const W=new Map(Object.values(h).map((t=>[t,1])));const Q=Buffer.from(`SSH-2.0-ssh2js${U}`);const q=Buffer.from(`${Q}\r\n`);const $=8192;const j=1024;const G=Buffer.from([p.GLOBAL_REQUEST,0,0,0,21,107,101,101,112,97,108,105,118,101,64,111,112,101,110,115,115,104,46,99,111,109,1]);const Y=Buffer.from([m.TTY_OP_END]);function noop(){}class Protocol{constructor(t){const r=t.onWrite;if(typeof r!=="function")throw new Error("Missing onWrite function");this._onWrite=t=>{r(t)};const n=t.onError;if(typeof n!=="function")throw new Error("Missing onError function");this._onError=t=>{n(t)};const l=t.debug;this._debug=typeof l==="function"?t=>{l(t)}:undefined;const u=t.onHeader;this._onHeader=typeof u==="function"?(...t)=>{u(...t)}:noop;const h=t.onPacket;this._onPacket=typeof h==="function"?()=>{h()}:noop;let p=t.onHandshakeComplete;if(typeof p!=="function")p=noop;this._onHandshakeComplete=(...t)=>{this._debug&&this._debug("Handshake completed");const r=this._queue;if(r){this._queue=undefined;this._debug&&this._debug(`Draining outbound queue (${r.length}) ...`);for(let t=0;t<r.length;++t){const n=r[t];let i=this._packetRW.write.finalize(n);if(i===n){const t=this._cipher.allocPacket(n.length);t.set(n,5);i=t}v(this,i)}this._debug&&this._debug("... finished draining outbound queue")}p(...t)};this._queue=undefined;const g=t.messageHandlers;if(typeof g==="object"&&g!==null)this._handlers=g;else this._handlers={};this._onPayload=onPayload.bind(this);this._server=!!t.server;this._banner=undefined;let m;if(this._server){if(typeof t.hostKeys!=="object"||t.hostKeys===null)throw new Error("Missing server host key(s)");this._hostKeys=t.hostKeys;if(typeof t.greeting==="string"&&t.greeting.length){m=t.greeting.slice(-2)==="\r\n"?t.greeting:`${t.greeting}\r\n`}if(typeof t.banner==="string"&&t.banner.length){this._banner=t.banner.slice(-2)==="\r\n"?t.banner:`${t.banner}\r\n`}}else{this._hostKeys=undefined}let b=t.offer;if(typeof b!=="object"||b===null)b=_;else if(b.constructor!==E)b=new E(b);this._kex=undefined;this._kexinit=undefined;this._offer=b;this._cipher=new s(0,this._onWrite);this._decipher=undefined;this._skipNextInboundPacket=false;this._packetRW={read:new P,write:new O(this)};this._hostVerifier=!this._server&&typeof t.hostVerifier==="function"?t.hostVerifier:undefined;this._parse=parseHeader;this._buffer=undefined;this._authsQueue=[];this._authenticated=false;this._remoteIdentRaw=undefined;let y;if(typeof t.ident==="string"){this._identRaw=Buffer.from(`SSH-2.0-${t.ident}`);y=Buffer.allocUnsafe(this._identRaw.length+2);y.set(this._identRaw,0);y[y.length-2]=13;y[y.length-1]=10}else if(Buffer.isBuffer(t.ident)){const r=Buffer.allocUnsafe(8+t.ident.length);r.latin1Write("SSH-2.0-",0,8);r.set(t.ident,8);this._identRaw=r;y=Buffer.allocUnsafe(r.length+2);y.set(r,0);y[y.length-2]=13;y[y.length-1]=10}else{this._identRaw=Q;y=q}this._compatFlags=0;if(this._debug){if(o)this._debug("Custom crypto binding available");else this._debug("Custom crypto binding not available")}process.nextTick((()=>{this._debug&&this._debug(`Local ident: ${i(this._identRaw.toString())}`);if(m)this._onWrite(m);this._onWrite(y)}))}_destruct(t){this._packetRW.read.cleanup();this._packetRW.write.cleanup();this._cipher&&this._cipher.free();this._decipher&&this._decipher.free();if(typeof t!=="string"||t.length===0)t="fatal error";this.parse=()=>{throw new Error(`Instance unusable after ${t}`)};this._onWrite=()=>{throw new Error(`Instance unusable after ${t}`)};this._destruct=undefined}cleanup(){this._destruct&&this._destruct()}parse(t,r,n){while(r<n)r=this._parse(t,r,n)}disconnect(t){const r=1+4+4+4;let n=this._packetRW.write.allocStartKEX;const i=this._packetRW.write.alloc(r,true);const o=n+r;if(!W.has(t))t=h.PROTOCOL_ERROR;i[n]=p.DISCONNECT;T(i,t,++n);i.fill(0,n+=4,o);this._debug&&this._debug(`Outbound: Sending DISCONNECT (${t})`);v(this,this._packetRW.write.finalize(i,true),true)}ping(){const t=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(G.length);r.set(G,t);this._debug&&this._debug("Outbound: Sending ping (GLOBAL_REQUEST: keepalive@openssh.com)");v(this,this._packetRW.write.finalize(r))}rekey(){if(this._kexinit===undefined){this._debug&&this._debug("Outbound: Initiated explicit rekey");this._queue=[];b(this)}else{this._debug&&this._debug("Outbound: Ignoring rekey during handshake")}}requestSuccess(t){let r=this._packetRW.write.allocStart;let n;if(Buffer.isBuffer(t)){n=this._packetRW.write.alloc(1+t.length);n[r]=p.REQUEST_SUCCESS;n.set(t,++r)}else{n=this._packetRW.write.alloc(1);n[r]=p.REQUEST_SUCCESS}this._debug&&this._debug("Outbound: Sending REQUEST_SUCCESS");v(this,this._packetRW.write.finalize(n))}requestFailure(){const t=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1);r[t]=p.REQUEST_FAILURE;this._debug&&this._debug("Outbound: Sending REQUEST_FAILURE");v(this,this._packetRW.write.finalize(r))}channelSuccess(t){let r=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4);n[r]=p.CHANNEL_SUCCESS;T(n,t,++r);this._debug&&this._debug(`Outbound: Sending CHANNEL_SUCCESS (r:${t})`);v(this,this._packetRW.write.finalize(n))}channelFailure(t){let r=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4);n[r]=p.CHANNEL_FAILURE;T(n,t,++r);this._debug&&this._debug(`Outbound: Sending CHANNEL_FAILURE (r:${t})`);v(this,this._packetRW.write.finalize(n))}channelEOF(t){let r=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4);n[r]=p.CHANNEL_EOF;T(n,t,++r);this._debug&&this._debug(`Outbound: Sending CHANNEL_EOF (r:${t})`);v(this,this._packetRW.write.finalize(n))}channelClose(t){let r=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4);n[r]=p.CHANNEL_CLOSE;T(n,t,++r);this._debug&&this._debug(`Outbound: Sending CHANNEL_CLOSE (r:${t})`);v(this,this._packetRW.write.finalize(n))}channelWindowAdjust(t,r){let n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+4);i[n]=p.CHANNEL_WINDOW_ADJUST;T(i,t,++n);T(i,r,n+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_WINDOW_ADJUST (r:${t}, ${r})`);v(this,this._packetRW.write.finalize(i))}channelData(t,r){const n=Buffer.isBuffer(r);const i=n?r.length:Buffer.byteLength(r);let o=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+4+i);s[o]=p.CHANNEL_DATA;T(s,t,++o);T(s,i,o+=4);if(n)s.set(r,o+=4);else s.utf8Write(r,o+=4,i);this._debug&&this._debug(`Outbound: Sending CHANNEL_DATA (r:${t}, ${i})`);v(this,this._packetRW.write.finalize(s))}channelExtData(t,r,n){const i=Buffer.isBuffer(r);const o=i?r.length:Buffer.byteLength(r);let s=this._packetRW.write.allocStart;const l=this._packetRW.write.alloc(1+4+4+4+o);l[s]=p.CHANNEL_EXTENDED_DATA;T(l,t,++s);T(l,n,s+=4);T(l,o,s+=4);if(i)l.set(r,s+=4);else l.utf8Write(r,s+=4,o);this._debug&&this._debug(`Outbound: Sending CHANNEL_EXTENDED_DATA (r:${t})`);v(this,this._packetRW.write.finalize(l))}channelOpenConfirm(t,r,n,i){let o=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+4+4+4);s[o]=p.CHANNEL_OPEN_CONFIRMATION;T(s,t,++o);T(s,r,o+=4);T(s,n,o+=4);T(s,i,o+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN_CONFIRMATION (r:${t}, l:${r})`);v(this,this._packetRW.write.finalize(s))}channelOpenFail(t,r,n){if(typeof n!=="string")n="";const i=Buffer.byteLength(n);let o=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+4+4+i+4);s[o]=p.CHANNEL_OPEN_FAILURE;T(s,t,++o);T(s,r,o+=4);T(s,i,o+=4);o+=4;if(i){s.utf8Write(n,o,i);o+=i}T(s,0,o);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN_FAILURE (r:${t})`);v(this,this._packetRW.write.finalize(s))}service(t){if(this._server)throw new Error("Client-only method called in server mode");const r=Buffer.byteLength(t);let n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+r);i[n]=p.SERVICE_REQUEST;T(i,r,++n);i.utf8Write(t,n+=4,r);this._debug&&this._debug(`Outbound: Sending SERVICE_REQUEST (${t})`);v(this,this._packetRW.write.finalize(i))}authPassword(t,r,n){if(this._server)throw new Error("Client-only method called in server mode");const i=Buffer.byteLength(t);const o=Buffer.byteLength(r);const s=n?Buffer.byteLength(n):0;let l=this._packetRW.write.allocStart;const u=this._packetRW.write.alloc(1+4+i+4+14+4+8+1+4+o+(n?4+s:0));u[l]=p.USERAUTH_REQUEST;T(u,i,++l);u.utf8Write(t,l+=4,i);T(u,14,l+=i);u.utf8Write("ssh-connection",l+=4,14);T(u,8,l+=14);u.utf8Write("password",l+=4,8);u[l+=8]=n?1:0;T(u,o,++l);if(Buffer.isBuffer(r))C(r,u,0,o,l+=4);else u.utf8Write(r,l+=4,o);if(n){T(u,s,l+=o);if(Buffer.isBuffer(n))C(n,u,0,s,l+=4);else u.utf8Write(n,l+=4,s);this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (changed password)")}else{this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (password)")}this._authsQueue.push("password");v(this,this._packetRW.write.finalize(u))}authPK(t,r,n){if(this._server)throw new Error("Client-only method called in server mode");r=w(r);if(r instanceof Error)throw new Error("Invalid key");const i=r.type;r=r.getPublicSSH();const o=Buffer.byteLength(t);const s=Buffer.byteLength(i);const l=r.length;const u=this._kex.sessionID;const h=u.length;const g=(n?4+h:0)+1+4+o+4+14+4+9+1+4+s+4+l;let m;let _;if(n){m=Buffer.allocUnsafe(g);_=0;T(m,h,_);m.set(u,_+=4);_+=h}else{m=this._packetRW.write.alloc(g);_=this._packetRW.write.allocStart}m[_]=p.USERAUTH_REQUEST;T(m,o,++_);m.utf8Write(t,_+=4,o);T(m,14,_+=o);m.utf8Write("ssh-connection",_+=4,14);T(m,9,_+=14);m.utf8Write("publickey",_+=4,9);m[_+=9]=n?1:0;T(m,s,++_);m.utf8Write(i,_+=4,s);T(m,l,_+=s);m.set(r,_+=4);if(!n){this._authsQueue.push("publickey");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (publickey -- check)");v(this,this._packetRW.write.finalize(m));return}n(m,(n=>{n=k(n,i);if(n===false)throw new Error("Error while converting handshake signature");const u=n.length;_=this._packetRW.write.allocStart;m=this._packetRW.write.alloc(1+4+o+4+14+4+9+1+4+s+4+l+4+4+s+4+u);m[_]=p.USERAUTH_REQUEST;T(m,o,++_);m.utf8Write(t,_+=4,o);T(m,14,_+=o);m.utf8Write("ssh-connection",_+=4,14);T(m,9,_+=14);m.utf8Write("publickey",_+=4,9);m[_+=9]=1;T(m,s,++_);m.utf8Write(i,_+=4,s);T(m,l,_+=s);m.set(r,_+=4);T(m,4+s+4+u,_+=l);T(m,s,_+=4);m.utf8Write(i,_+=4,s);T(m,u,_+=s);m.set(n,_+=4);this._authsQueue.push("publickey");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (publickey)");v(this,this._packetRW.write.finalize(m))}))}authHostbased(t,r,n,i,o){if(this._server)throw new Error("Client-only method called in server mode");r=w(r);if(r instanceof Error)throw new Error("Invalid key");const s=r.type;r=r.getPublicSSH();const l=Buffer.byteLength(t);const u=Buffer.byteLength(s);const h=r.length;const g=this._kex.sessionID;const m=g.length;const _=Buffer.byteLength(n);const E=Buffer.byteLength(i);const b=Buffer.allocUnsafe(4+m+1+4+l+4+14+4+9+4+u+4+h+4+_+4+E);let y=0;T(b,m,y);b.set(g,y+=4);b[y+=m]=p.USERAUTH_REQUEST;T(b,l,++y);b.utf8Write(t,y+=4,l);T(b,14,y+=l);b.utf8Write("ssh-connection",y+=4,14);T(b,9,y+=14);b.utf8Write("hostbased",y+=4,9);T(b,u,y+=9);b.utf8Write(s,y+=4,u);T(b,h,y+=u);b.set(r,y+=4);T(b,_,y+=h);b.utf8Write(n,y+=4,_);T(b,E,y+=_);b.utf8Write(i,y+=4,E);o(b,(t=>{t=k(t,s);if(!t)throw new Error("Error while converting handshake signature");const r=t.length;const n=b.length-m-4;y=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(n+4+4+u+4+r);C(b,i,4+m,b.length,y);T(i,4+u+4+r,y+=n);T(i,u,y+=4);i.utf8Write(s,y+=4,u);T(i,r,y+=u);i.set(t,y+=4);this._authsQueue.push("hostbased");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (hostbased)");v(this,this._packetRW.write.finalize(i))}))}authKeyboard(t){if(this._server)throw new Error("Client-only method called in server mode");const r=Buffer.byteLength(t);let n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+r+4+14+4+20+4+4);i[n]=p.USERAUTH_REQUEST;T(i,r,++n);i.utf8Write(t,n+=4,r);T(i,14,n+=r);i.utf8Write("ssh-connection",n+=4,14);T(i,20,n+=14);i.utf8Write("keyboard-interactive",n+=4,20);T(i,0,n+=20);T(i,0,n+=4);this._authsQueue.push("keyboard-interactive");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (keyboard-interactive)");v(this,this._packetRW.write.finalize(i))}authNone(t){if(this._server)throw new Error("Client-only method called in server mode");const r=Buffer.byteLength(t);let n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+r+4+14+4+4);i[n]=p.USERAUTH_REQUEST;T(i,r,++n);i.utf8Write(t,n+=4,r);T(i,14,n+=r);i.utf8Write("ssh-connection",n+=4,14);T(i,4,n+=14);i.utf8Write("none",n+=4,4);this._authsQueue.push("none");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (none)");v(this,this._packetRW.write.finalize(i))}authInfoRes(t){if(this._server)throw new Error("Client-only method called in server mode");let r=0;let n;if(t){n=new Array(t.length);for(let i=0;i<t.length;++i){const o=Buffer.byteLength(t[i]);n[i]=o;r+=4+o}}let i=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+r);o[i]=p.USERAUTH_INFO_RESPONSE;if(t){T(o,t.length,++i);i+=4;for(let r=0;r<t.length;++r){const s=n[r];T(o,s,i);i+=4;if(s){o.utf8Write(t[r],i,s);i+=s}}}else{T(o,0,++i)}this._debug&&this._debug("Outbound: Sending USERAUTH_INFO_RESPONSE");v(this,this._packetRW.write.finalize(o))}tcpipForward(t,r,n){if(this._server)throw new Error("Client-only method called in server mode");const i=Buffer.byteLength(t);let o=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+13+1+4+i+4);s[o]=p.GLOBAL_REQUEST;T(s,13,++o);s.utf8Write("tcpip-forward",o+=4,13);s[o+=13]=n===undefined||n===true?1:0;T(s,i,++o);s.utf8Write(t,o+=4,i);T(s,r,o+=i);this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (tcpip-forward)");v(this,this._packetRW.write.finalize(s))}cancelTcpipForward(t,r,n){if(this._server)throw new Error("Client-only method called in server mode");const i=Buffer.byteLength(t);let o=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+20+1+4+i+4);s[o]=p.GLOBAL_REQUEST;T(s,20,++o);s.utf8Write("cancel-tcpip-forward",o+=4,20);s[o+=20]=n===undefined||n===true?1:0;T(s,i,++o);s.utf8Write(t,o+=4,i);T(s,r,o+=i);this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (cancel-tcpip-forward)");v(this,this._packetRW.write.finalize(s))}openssh_streamLocalForward(t,r){if(this._server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(t);let i=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+31+1+4+n);o[i]=p.GLOBAL_REQUEST;T(o,31,++i);o.utf8Write("streamlocal-forward@openssh.com",i+=4,31);o[i+=31]=r===undefined||r===true?1:0;T(o,n,++i);o.utf8Write(t,i+=4,n);this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (streamlocal-forward@openssh.com)");v(this,this._packetRW.write.finalize(o))}openssh_cancelStreamLocalForward(t,r){if(this._server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(t);let i=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+38+1+4+n);o[i]=p.GLOBAL_REQUEST;T(o,38,++i);o.utf8Write("cancel-streamlocal-forward@openssh.com",i+=4,38);o[i+=38]=r===undefined||r===true?1:0;T(o,n,++i);o.utf8Write(t,i+=4,n);if(this._debug){this._debug("Outbound: Sending GLOBAL_REQUEST "+"(cancel-streamlocal-forward@openssh.com)")}v(this,this._packetRW.write.finalize(o))}directTcpip(t,r,n,i){if(this._server)throw new Error("Client-only method called in server mode");const o=Buffer.byteLength(i.srcIP);const s=Buffer.byteLength(i.dstIP);let l=this._packetRW.write.allocStart;const u=this._packetRW.write.alloc(1+4+12+4+4+4+4+o+4+4+s+4);u[l]=p.CHANNEL_OPEN;T(u,12,++l);u.utf8Write("direct-tcpip",l+=4,12);T(u,t,l+=12);T(u,r,l+=4);T(u,n,l+=4);T(u,s,l+=4);u.utf8Write(i.dstIP,l+=4,s);T(u,i.dstPort,l+=s);T(u,o,l+=4);u.utf8Write(i.srcIP,l+=4,o);T(u,i.srcPort,l+=o);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, direct-tcpip)`);v(this,this._packetRW.write.finalize(u))}openssh_directStreamLocal(t,r,n,i){if(this._server)throw new Error("Client-only method called in server mode");const o=Buffer.byteLength(i.socketPath);let s=this._packetRW.write.allocStart;const l=this._packetRW.write.alloc(1+4+30+4+4+4+4+o+4+4);l[s]=p.CHANNEL_OPEN;T(l,30,++s);l.utf8Write("direct-streamlocal@openssh.com",s+=4,30);T(l,t,s+=30);T(l,r,s+=4);T(l,n,s+=4);T(l,o,s+=4);l.utf8Write(i.socketPath,s+=4,o);R(l,0,s+=o,s+8);if(this._debug){this._debug("Outbound: Sending CHANNEL_OPEN "+`(r:${t}, direct-streamlocal@openssh.com)`)}v(this,this._packetRW.write.finalize(l))}openssh_noMoreSessions(t){if(this._server)throw new Error("Client-only method called in server mode");let r=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4+28+1);n[r]=p.GLOBAL_REQUEST;T(n,28,++r);n.utf8Write("no-more-sessions@openssh.com",r+=4,28);n[r+=28]=t===undefined||t===true?1:0;this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (no-more-sessions@openssh.com)");v(this,this._packetRW.write.finalize(n))}session(t,r,n){if(this._server)throw new Error("Client-only method called in server mode");let i=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+7+4+4+4);o[i]=p.CHANNEL_OPEN;T(o,7,++i);o.utf8Write("session",i+=4,7);T(o,t,i+=7);T(o,r,i+=4);T(o,n,i+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, session)`);v(this,this._packetRW.write.finalize(o))}windowChange(t,r,n,i,o){if(this._server)throw new Error("Client-only method called in server mode");let s=this._packetRW.write.allocStart;const l=this._packetRW.write.alloc(1+4+4+13+1+4+4+4+4);l[s]=p.CHANNEL_REQUEST;T(l,t,++s);T(l,13,s+=4);l.utf8Write("window-change",s+=4,13);l[s+=13]=0;T(l,n,++s);T(l,r,s+=4);T(l,o,s+=4);T(l,i,s+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, window-change)`);v(this,this._packetRW.write.finalize(l))}pty(t,r,n,i,o,s,l,u){if(this._server)throw new Error("Client-only method called in server mode");if(!s||!s.length)s="vt100";if(l&&!Buffer.isBuffer(l)&&!Array.isArray(l)&&typeof l==="object"&&l!==null){l=modesToBytes(l)}if(!l||!l.length)l=Y;const h=s.length;const g=l.length;let m=this._packetRW.write.allocStart;const _=this._packetRW.write.alloc(1+4+4+7+1+4+h+4+4+4+4+4+g);_[m]=p.CHANNEL_REQUEST;T(_,t,++m);T(_,7,m+=4);_.utf8Write("pty-req",m+=4,7);_[m+=7]=u===undefined||u===true?1:0;T(_,h,++m);_.utf8Write(s,m+=4,h);T(_,n,m+=h);T(_,r,m+=4);T(_,o,m+=4);T(_,i,m+=4);T(_,g,m+=4);m+=4;if(Array.isArray(l)){for(let t=0;t<g;++t)_[m++]=l[t]}else if(Buffer.isBuffer(l)){_.set(l,m)}this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, pty-req)`);v(this,this._packetRW.write.finalize(_))}shell(t,r){if(this._server)throw new Error("Client-only method called in server mode");let n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+4+5+1);i[n]=p.CHANNEL_REQUEST;T(i,t,++n);T(i,5,n+=4);i.utf8Write("shell",n+=4,5);i[n+=5]=r===undefined||r===true?1:0;this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, shell)`);v(this,this._packetRW.write.finalize(i))}exec(t,r,n){if(this._server)throw new Error("Client-only method called in server mode");const i=Buffer.isBuffer(r);const o=i?r.length:Buffer.byteLength(r);let s=this._packetRW.write.allocStart;const l=this._packetRW.write.alloc(1+4+4+4+1+4+o);l[s]=p.CHANNEL_REQUEST;T(l,t,++s);T(l,4,s+=4);l.utf8Write("exec",s+=4,4);l[s+=4]=n===undefined||n===true?1:0;T(l,o,++s);if(i)l.set(r,s+=4);else l.utf8Write(r,s+=4,o);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, exec: ${r})`);v(this,this._packetRW.write.finalize(l))}signal(t,r){if(this._server)throw new Error("Client-only method called in server mode");const n=r;r=r.toUpperCase();if(r.slice(0,3)==="SIG")r=r.slice(3);if(g[r]!==1)throw new Error(`Invalid signal: ${n}`);const i=r.length;let o=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+4+6+1+4+i);s[o]=p.CHANNEL_REQUEST;T(s,t,++o);T(s,6,o+=4);s.utf8Write("signal",o+=4,6);s[o+=6]=0;T(s,i,++o);s.utf8Write(r,o+=4,i);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, signal: ${r})`);v(this,this._packetRW.write.finalize(s))}env(t,r,n,i){if(this._server)throw new Error("Client-only method called in server mode");const o=Buffer.byteLength(r);const s=Buffer.isBuffer(n);const l=s?n.length:Buffer.byteLength(n);let u=this._packetRW.write.allocStart;const h=this._packetRW.write.alloc(1+4+4+3+1+4+o+4+l);h[u]=p.CHANNEL_REQUEST;T(h,t,++u);T(h,3,u+=4);h.utf8Write("env",u+=4,3);h[u+=3]=i===undefined||i===true?1:0;T(h,o,++u);h.utf8Write(r,u+=4,o);T(h,l,u+=o);if(s)h.set(n,u+=4);else h.utf8Write(n,u+=4,l);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, env: ${r}=${n})`);v(this,this._packetRW.write.finalize(h))}x11Forward(t,r,n){if(this._server)throw new Error("Client-only method called in server mode");const i=r.protocol;const o=r.cookie;const s=Buffer.isBuffer(i);const l=s?i.length:Buffer.byteLength(i);const u=Buffer.isBuffer(o);const h=u?o.length:Buffer.byteLength(o);let g=this._packetRW.write.allocStart;const m=this._packetRW.write.alloc(1+4+4+7+1+1+4+l+4+h+4);m[g]=p.CHANNEL_REQUEST;T(m,t,++g);T(m,7,g+=4);m.utf8Write("x11-req",g+=4,7);m[g+=7]=n===undefined||n===true?1:0;m[++g]=r.single?1:0;T(m,l,++g);if(s)m.set(i,g+=4);else m.utf8Write(i,g+=4,l);T(m,h,g+=l);if(u)m.set(o,g+=4);else m.latin1Write(o,g+=4,h);T(m,r.screen||0,g+=h);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, x11-req)`);v(this,this._packetRW.write.finalize(m))}subsystem(t,r,n){if(this._server)throw new Error("Client-only method called in server mode");const i=Buffer.byteLength(r);let o=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+4+9+1+4+i);s[o]=p.CHANNEL_REQUEST;T(s,t,++o);T(s,9,o+=4);s.utf8Write("subsystem",o+=4,9);s[o+=9]=n===undefined||n===true?1:0;T(s,i,++o);s.utf8Write(r,o+=4,i);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, subsystem: ${r})`);v(this,this._packetRW.write.finalize(s))}openssh_agentForward(t,r){if(this._server)throw new Error("Client-only method called in server mode");let n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+4+26+1);i[n]=p.CHANNEL_REQUEST;T(i,t,++n);T(i,26,n+=4);i.utf8Write("auth-agent-req@openssh.com",n+=4,26);i[n+=26]=r===undefined||r===true?1:0;if(this._debug){this._debug("Outbound: Sending CHANNEL_REQUEST "+`(r:${t}, auth-agent-req@openssh.com)`)}v(this,this._packetRW.write.finalize(i))}openssh_hostKeysProve(t){if(this._server)throw new Error("Client-only method called in server mode");let r=0;const n=[];for(const i of t){const t=i.getPublicSSH();r+=4+t.length;n.push(t)}let i=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+29+1+r);o[i]=p.GLOBAL_REQUEST;T(o,29,++i);o.utf8Write("hostkeys-prove-00@openssh.com",i+=4,29);o[i+=29]=1;++i;for(const t of n){T(o,t.length,i);C(t,o,0,t.length,i+=4);i+=t.length}if(this._debug){this._debug("Outbound: Sending GLOBAL_REQUEST (hostkeys-prove-00@openssh.com)")}v(this,this._packetRW.write.finalize(o))}serviceAccept(t){if(!this._server)throw new Error("Server-only method called in client mode");const r=Buffer.byteLength(t);let n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+r);i[n]=p.SERVICE_ACCEPT;T(i,r,++n);i.utf8Write(t,n+=4,r);this._debug&&this._debug(`Outbound: Sending SERVICE_ACCEPT (${t})`);v(this,this._packetRW.write.finalize(i));if(this._server&&this._banner&&t==="ssh-userauth"){const t=this._banner;this._banner=undefined;const r=Buffer.byteLength(t);n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+r+4);i[n]=p.USERAUTH_BANNER;T(i,r,++n);i.utf8Write(t,n+=4,r);T(i,0,n+=r);this._debug&&this._debug("Outbound: Sending USERAUTH_BANNER");v(this,this._packetRW.write.finalize(i))}}forwardedTcpip(t,r,n,i){if(!this._server)throw new Error("Server-only method called in client mode");const o=Buffer.byteLength(i.boundAddr);const s=Buffer.byteLength(i.remoteAddr);let l=this._packetRW.write.allocStart;const u=this._packetRW.write.alloc(1+4+15+4+4+4+4+o+4+4+s+4);u[l]=p.CHANNEL_OPEN;T(u,15,++l);u.utf8Write("forwarded-tcpip",l+=4,15);T(u,t,l+=15);T(u,r,l+=4);T(u,n,l+=4);T(u,o,l+=4);u.utf8Write(i.boundAddr,l+=4,o);T(u,i.boundPort,l+=o);T(u,s,l+=4);u.utf8Write(i.remoteAddr,l+=4,s);T(u,i.remotePort,l+=s);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, forwarded-tcpip)`);v(this,this._packetRW.write.finalize(u))}x11(t,r,n,i){if(!this._server)throw new Error("Server-only method called in client mode");const o=Buffer.byteLength(i.originAddr);let s=this._packetRW.write.allocStart;const l=this._packetRW.write.alloc(1+4+3+4+4+4+4+o+4);l[s]=p.CHANNEL_OPEN;T(l,3,++s);l.utf8Write("x11",s+=4,3);T(l,t,s+=3);T(l,r,s+=4);T(l,n,s+=4);T(l,o,s+=4);l.utf8Write(i.originAddr,s+=4,o);T(l,i.originPort,s+=o);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, x11)`);v(this,this._packetRW.write.finalize(l))}openssh_authAgent(t,r,n){if(!this._server)throw new Error("Server-only method called in client mode");let i=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+22+4+4+4);o[i]=p.CHANNEL_OPEN;T(o,22,++i);o.utf8Write("auth-agent@openssh.com",i+=4,22);T(o,t,i+=22);T(o,r,i+=4);T(o,n,i+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, auth-agent@openssh.com)`);v(this,this._packetRW.write.finalize(o))}openssh_forwardedStreamLocal(t,r,n,i){if(!this._server)throw new Error("Server-only method called in client mode");const o=Buffer.byteLength(i.socketPath);let s=this._packetRW.write.allocStart;const l=this._packetRW.write.alloc(1+4+33+4+4+4+4+o+4);l[s]=p.CHANNEL_OPEN;T(l,33,++s);l.utf8Write("forwarded-streamlocal@openssh.com",s+=4,33);T(l,t,s+=33);T(l,r,s+=4);T(l,n,s+=4);T(l,o,s+=4);l.utf8Write(i.socketPath,s+=4,o);T(l,0,s+=o);if(this._debug){this._debug("Outbound: Sending CHANNEL_OPEN "+`(r:${t}, forwarded-streamlocal@openssh.com)`)}v(this,this._packetRW.write.finalize(l))}exitStatus(t,r){if(!this._server)throw new Error("Server-only method called in client mode");let n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+4+11+1+4);i[n]=p.CHANNEL_REQUEST;T(i,t,++n);T(i,11,n+=4);i.utf8Write("exit-status",n+=4,11);i[n+=11]=0;T(i,r,++n);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, exit-status: ${r})`);v(this,this._packetRW.write.finalize(i))}exitSignal(t,r,n,i){if(!this._server)throw new Error("Server-only method called in client mode");const o=r;if(typeof o!=="string"||!o)throw new Error(`Invalid signal: ${o}`);let s=r.toUpperCase();if(s.slice(0,3)==="SIG")s=s.slice(3);if(g[s]!==1)throw new Error(`Invalid signal: ${o}`);const l=Buffer.byteLength(s);const u=i?Buffer.byteLength(i):0;let h=this._packetRW.write.allocStart;const m=this._packetRW.write.alloc(1+4+4+11+1+4+l+1+4+u+4);m[h]=p.CHANNEL_REQUEST;T(m,t,++h);T(m,11,h+=4);m.utf8Write("exit-signal",h+=4,11);m[h+=11]=0;T(m,l,++h);m.utf8Write(s,h+=4,l);m[h+=l]=n?1:0;T(m,u,++h);h+=4;if(u){m.utf8Write(i,h,u);h+=u}T(m,0,h);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, exit-signal: ${r})`);v(this,this._packetRW.write.finalize(m))}authFailure(t,r){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0)throw new Error("No auth in progress");let n;if(typeof t==="boolean"){r=t;t=undefined}if(t){n=[];for(let r=0;r<t.length;++r){if(t[r].toLowerCase()==="none")continue;n.push(t[r])}n=n.join(",")}else{n=""}const i=n.length;let o=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+i+1);s[o]=p.USERAUTH_FAILURE;T(s,i,++o);s.utf8Write(n,o+=4,i);s[o+=i]=r===true?1:0;this._authsQueue.shift();this._debug&&this._debug("Outbound: Sending USERAUTH_FAILURE");v(this,this._packetRW.write.finalize(s))}authSuccess(){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0)throw new Error("No auth in progress");const t=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1);r[t]=p.USERAUTH_SUCCESS;this._authsQueue.shift();this._authenticated=true;this._debug&&this._debug("Outbound: Sending USERAUTH_SUCCESS");v(this,this._packetRW.write.finalize(r));if(this._kex.negotiated.cs.compress==="zlib@openssh.com")this._packetRW.read=new D;if(this._kex.negotiated.sc.compress==="zlib@openssh.com")this._packetRW.write=new L(this)}authPKOK(t,r){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0||this._authsQueue[0]!=="publickey")throw new Error('"publickey" auth not in progress');const n=Buffer.byteLength(t);const i=r.length;let o=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+n+4+i);s[o]=p.USERAUTH_PK_OK;T(s,n,++o);s.utf8Write(t,o+=4,n);T(s,i,o+=n);s.set(r,o+=4);this._authsQueue.shift();this._debug&&this._debug("Outbound: Sending USERAUTH_PK_OK");v(this,this._packetRW.write.finalize(s))}authPasswdChg(t){if(!this._server)throw new Error("Server-only method called in client mode");const r=Buffer.byteLength(t);let n=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+r+4);i[n]=p.USERAUTH_PASSWD_CHANGEREQ;T(i,r,++n);i.utf8Write(t,n+=4,r);T(i,0,n+=r);this._debug&&this._debug("Outbound: Sending USERAUTH_PASSWD_CHANGEREQ");v(this,this._packetRW.write.finalize(i))}authInfoReq(t,r,n){if(!this._server)throw new Error("Server-only method called in client mode");let i=0;const o=t?Buffer.byteLength(t):0;const s=r?Buffer.byteLength(r):0;for(let t=0;t<n.length;++t)i+=4+Buffer.byteLength(n[t].prompt)+1;let l=this._packetRW.write.allocStart;const u=this._packetRW.write.alloc(1+4+o+4+s+4+4+i);u[l]=p.USERAUTH_INFO_REQUEST;T(u,o,++l);l+=4;if(t){u.utf8Write(t,l,o);l+=o}T(u,s,l);l+=4;if(r){u.utf8Write(r,l,s);l+=s}T(u,0,l);T(u,n.length,l+=4);l+=4;for(let t=0;t<n.length;++t){const r=n[t];const i=Buffer.byteLength(r.prompt);T(u,i,l);l+=4;if(i){u.utf8Write(r.prompt,l,i);l+=i}u[l++]=r.echo?1:0}this._debug&&this._debug("Outbound: Sending USERAUTH_INFO_REQUEST");v(this,this._packetRW.write.finalize(u))}}const z=/^SSH-(2\.0|1\.99)-([^ ]+)(?: (.*))?$/;function parseHeader(t,r,n){let o;let s;if(this._buffer){o=Buffer.allocUnsafe(this._buffer.length+(n-r));o.set(this._buffer,0);if(r===0){o.set(t,this._buffer.length)}else{o.set(new Uint8Array(t.buffer,t.byteOffset+r,n-r),this._buffer.length)}s=this._buffer.length;r=0}else{o=t;s=0}const u=r;let h=r;let p=r;let g=false;let m=0;let _=0;for(;r<o.length;++r){const t=o[r];if(t===13){g=true;continue}if(t===10){if(p>h&&p-h>4&&o[h]===83&&o[h+1]===83&&o[h+2]===72&&o[h+3]===45){const t=o.latin1Slice(u,p+1);const g=h===u?t:t.slice(h-u);const m=z.exec(g);if(!m)throw new Error("Invalid identification string");const _={greeting:h===u?"":t.slice(0,h-u),identRaw:g,versions:{protocol:m[1],software:m[2]},comments:m[3]};this._remoteIdentRaw=Buffer.from(g);this._debug&&this._debug(`Remote ident: ${i(g)}`);this._compatFlags=getCompatFlags(_);this._buffer=undefined;this._decipher=new l(0,y.bind(this,{firstPacket:true}));this._parse=parsePacket;this._onHeader(_);if(!this._destruct){return n}b(this);return r+1-s}if(this._server)throw new Error("Greetings from clients not permitted");if(++_>j)throw new Error("Max greeting lines exceeded");g=false;h=r+1;m=0}else if(g){throw new Error("Invalid header: expected newline")}else if(++m>=$){throw new Error("Header line too long")}p=r}if(!this._buffer)this._buffer=B(o,u);return r-s}function parsePacket(t,r,n){return this._decipher.decrypt(t,r,n)}function onPayload(t){this._onPacket();if(t.length===0){this._debug&&this._debug("Inbound: Skipping empty packet payload");return}t=this._packetRW.read.read(t);const r=t[0];if(r===p.USERAUTH_SUCCESS&&!this._server&&!this._authenticated){this._authenticated=true;if(this._kex.negotiated.cs.compress==="zlib@openssh.com")this._packetRW.write=new L(this);if(this._kex.negotiated.sc.compress==="zlib@openssh.com")this._packetRW.read=new D}const n=I[r];if(n===undefined){this._debug&&this._debug(`Inbound: Unsupported message type: ${r}`);return}return n(this,t)}function getCompatFlags(t){const r=t.versions.software;let n=0;for(const t of u){if(typeof t[0]==="string"){if(r===t[0])n|=t[1]}else if(t[0].test(r)){n|=t[1]}}return n}function modesToBytes(t){const r=Object.keys(t);const n=Buffer.allocUnsafe(5*r.length+1);let i=0;for(let o=0;o<r.length;++o){const s=r[o];if(s==="TTY_OP_END")continue;const l=m[s];if(l===undefined)continue;const u=t[s];if(typeof u==="number"&&isFinite(u)){n[i++]=l;n[i++]=u>>>24;n[i++]=u>>>16;n[i++]=u>>>8;n[i++]=u}}n[i++]=m.TTY_OP_END;if(i<n.length)return B(n,0,i);return n}t.exports=Protocol},2026:(t,r,n)=>{"use strict";const i=n(8614);const o=n(5747);const{constants:s}=o;const{Readable:l,Writable:u}=n(2413);const{inherits:h,isDate:p}=n(1669);const g=Buffer[Symbol.species];const{bufferCopy:m,bufferSlice:_,makeBufferParser:E,writeUInt32BE:b}=n(9475);const y={SIZE:1,UIDGID:2,PERMISSIONS:4,ACMODTIME:8,EXTENDED:2147483648};const w=Buffer.alloc(28);const I={OK:0,EOF:1,NO_SUCH_FILE:2,PERMISSION_DENIED:3,FAILURE:4,BAD_MESSAGE:5,NO_CONNECTION:6,CONNECTION_LOST:7,OP_UNSUPPORTED:8};const C=new Map(Object.values(I).map((t=>[t,1])));const R={[I.OK]:"No error",[I.EOF]:"End of file",[I.NO_SUCH_FILE]:"No such file or directory",[I.PERMISSION_DENIED]:"Permission denied",[I.FAILURE]:"Failure",[I.BAD_MESSAGE]:"Bad message",[I.NO_CONNECTION]:"No connection",[I.CONNECTION_LOST]:"Connection lost",[I.OP_UNSUPPORTED]:"Operation unsupported"};const B={INIT:1,OPEN:3,CLOSE:4,READ:5,WRITE:6,LSTAT:7,FSTAT:8,SETSTAT:9,FSETSTAT:10,OPENDIR:11,READDIR:12,REMOVE:13,MKDIR:14,RMDIR:15,REALPATH:16,STAT:17,RENAME:18,READLINK:19,SYMLINK:20,EXTENDED:200};const k={VERSION:2,STATUS:101,HANDLE:102,DATA:103,NAME:104,ATTRS:105,EXTENDED:201};const v={READ:1,WRITE:2,APPEND:4,CREAT:8,TRUNC:16,EXCL:32};const T=2*1024;const P=2**32-1;const O=Buffer.from([0,0,0,5,B.INIT,0,0,0,3]);const D=Buffer.from([0,0,0,5,k.VERSION,0,0,0,3]);const L=/^SSH-2.0-(?:OpenSSH|dropbear)/;const U=256*1024;const W=E();const Q={readable:false,writable:false,push:t=>{},once:()=>{},on:()=>{},emit:()=>{},end:()=>{}};function noop(){}class SFTP extends i{constructor(t,r,n){super();if(typeof n!=="object"||!n)n={};const i=t._protocol._remoteIdentRaw;this.server=!!n.server;this._debug=typeof n.debug==="function"?n.debug:undefined;this._isOpenSSH=i&&L.test(i);this._version=-1;this._extensions={};this._biOpt=n.biOpt;this._pktLenBytes=0;this._pktLen=0;this._pktPos=0;this._pktType=0;this._pktData=undefined;this._writeReqid=-1;this._requests={};this._maxInPktLen=U;this._maxOutPktLen=34e3;this._maxReadLen=(this._isOpenSSH?U:34e3)-T;this._maxWriteLen=(this._isOpenSSH?U:34e3)-T;this.maxOpenHandles=undefined;this._client=t;this._protocol=t._protocol;this._callbacks=[];this._hasX11=false;this._exit={code:undefined,signal:undefined,dump:undefined,desc:undefined};this._waitWindow=false;this._chunkcb=undefined;this._buffer=[];this.type=r.type;this.subtype=undefined;this.incoming=r.incoming;this.outgoing=r.outgoing;this.stderr=Q;this.readable=true}push(t){if(t===null){cleanupRequests(this);if(!this.readable)return;this.readable=false;this.emit("end");return}let r=0;while(r<t.length){if(this._pktLenBytes<4){let n=Math.min(4-this._pktLenBytes,t.length-r);this._pktLenBytes+=n;while(n--)this._pktLen=(this._pktLen<<8)+t[r++];if(this._pktLenBytes<4)return;if(this._pktLen===0)return doFatalSFTPError(this,"Invalid packet length");if(this._pktLen>this._maxInPktLen){const t=this._maxInPktLen;return doFatalSFTPError(this,`Packet length ${this._pktLen} exceeds max length of ${t}`)}if(r>=t.length)return}if(this._pktPos<this._pktLen){const n=Math.min(this._pktLen-this._pktPos,t.length-r);if(r!==0||n!==t.length){if(n===this._pktLen){this._pkt=new g(t.buffer,t.byteOffset+r,n)}else{if(!this._pkt)this._pkt=Buffer.allocUnsafe(this._pktLen);this._pkt.set(new Uint8Array(t.buffer,t.byteOffset+r,n),this._pktPos)}}else if(n===this._pktLen){this._pkt=t}else{if(!this._pkt)this._pkt=Buffer.allocUnsafe(this._pktLen);this._pkt.set(t,this._pktPos)}r+=n;this._pktPos+=n;if(this._pktPos<this._pktLen)return}const n=this._pkt[0];const i=this._pkt;this._pktLen=0;this._pktLenBytes=0;this._pkt=undefined;this._pktPos=0;const o=this.server?G[n]:j[n];if(!o)return doFatalSFTPError(this,`Unknown packet type ${n}`);if(this._version===-1){if(this.server){if(n!==B.INIT)return doFatalSFTPError(this,`Expected INIT packet, got ${n}`)}else if(n!==k.VERSION){return doFatalSFTPError(this,`Expected VERSION packet, got ${n}`)}}if(o(this,i)===false)return}}end(){this.destroy()}destroy(){if(this.outgoing.state==="open"||this.outgoing.state==="eof"){this.outgoing.state="closing";this._protocol.channelClose(this.outgoing.id)}}_init(){this._init=noop;if(!this.server)sendOrBuffer(this,O)}createReadStream(t,r){if(this.server)throw new Error("Client-only method called in server mode");return new ReadStream(this,t,r)}createWriteStream(t,r){if(this.server)throw new Error("Client-only method called in server mode");return new WriteStream(this,t,r)}open(t,r,n,i){if(this.server)throw new Error("Client-only method called in server mode");if(typeof n==="function"){i=n;n=undefined}const o=typeof r==="number"?r:stringToFlags(r);if(o===null)throw new Error(`Unknown flags string: ${r}`);let s=0;let l=0;if(typeof n==="string"||typeof n==="number")n={mode:n};if(typeof n==="object"&&n!==null){n=attrsToBytes(n);s=n.flags;l=n.nb}const u=Buffer.byteLength(t);let h=9;const p=Buffer.allocUnsafe(4+1+4+4+u+4+4+l);b(p,p.length-4,0);p[4]=B.OPEN;const g=this._writeReqid=this._writeReqid+1&P;b(p,g,5);b(p,u,h);p.utf8Write(t,h+=4,u);b(p,o,h+=u);b(p,s,h+=4);if(l){h+=4;if(l===w.length)p.set(w,h);else m(w,p,0,l,h);h+=l}this._requests[g]={cb:i};const _=sendOrBuffer(this,p);this._debug&&this._debug(`SFTP: Outbound: ${_?"Buffered":"Sending"} OPEN`)}close(t,r){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");const n=t.length;let i=9;const o=Buffer.allocUnsafe(4+1+4+4+n);b(o,o.length-4,0);o[4]=B.CLOSE;const s=this._writeReqid=this._writeReqid+1&P;b(o,s,5);b(o,n,i);o.set(t,i+=4);this._requests[s]={cb:r};const l=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} CLOSE`)}read(t,r,n,i,o,s){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(r))throw new Error("buffer is not a Buffer");if(n>=r.length)throw new Error("offset is out of bounds");if(n+i>r.length)throw new Error("length extends beyond buffer");if(o===null)throw new Error("null position currently unsupported");read_(this,t,r,n,i,o,s)}readData(t,r,n,i,o,s){this.read(t,r,n,i,o,s)}write(t,r,n,i,o,s){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(r))throw new Error("buffer is not a Buffer");if(n>r.length)throw new Error("offset is out of bounds");if(n+i>r.length)throw new Error("length extends beyond buffer");if(o===null)throw new Error("null position currently unsupported");if(!i){s&&process.nextTick(s,undefined,0);return}const l=this._maxWriteLen;const u=Math.max(i-l,0);const h=o;if(u)i=l;const p=t.length;let g=9;const _=Buffer.allocUnsafe(4+1+4+4+p+8+4+i);b(_,_.length-4,0);_[4]=B.WRITE;const E=this._writeReqid=this._writeReqid+1&P;b(_,E,5);b(_,p,g);_.set(t,g+=4);g+=p;for(let t=7;t>=0;--t){_[g+t]=o&255;o/=256}b(_,i,g+=8);m(r,_,n,n+i,g+=4);this._requests[E]={cb:o=>{if(o){if(typeof s==="function")s(o)}else if(u){this.write(t,r,n+i,u,h+i,s)}else if(typeof s==="function"){s(undefined,n+i)}}};const y=sendOrBuffer(this,_);if(this._debug){const t=y?"Sent":"Buffered";this._debug(`SFTP: Outbound: ${t} WRITE (id:${E})`)}}writeData(t,r,n,i,o,s){this.write(t,r,n,i,o,s)}fastGet(t,r,n,i){if(this.server)throw new Error("Client-only method called in server mode");fastXfer(this,o,t,r,n,i)}fastPut(t,r,n,i){if(this.server)throw new Error("Client-only method called in server mode");fastXfer(o,this,t,r,n,i)}readFile(t,r,n){if(this.server)throw new Error("Client-only method called in server mode");let i;if(typeof n==="function"){i=n}else if(typeof r==="function"){i=r;r=undefined}if(typeof r==="string")r={encoding:r,flag:"r"};else if(!r)r={encoding:null,flag:"r"};else if(typeof r!=="object")throw new TypeError("Bad arguments");const o=r.encoding;if(o&&!Buffer.isEncoding(o))throw new Error(`Unknown encoding: ${o}`);let s;let l;let u;let h=0;let p;let g=0;const m=r.flag||"r";const read=()=>{if(s===0){l=Buffer.allocUnsafe(8192);this.read(p,l,0,8192,g,afterRead)}else{this.read(p,l,h,s-h,g,afterRead)}};const afterRead=(t,r)=>{let n;if(t){n=t.code===I.EOF;if(!n){return this.close(p,(()=>i&&i(t)))}}else{n=false}if(n||s===0&&r===0)return close();g+=r;h+=r;if(s!==0){if(h===s)close();else read()}else{u.push(_(l,0,r));read()}};afterRead._wantEOFError=true;const close=()=>{this.close(p,(t=>{if(s===0){l=Buffer.concat(u,h)}else if(h<s){l=_(l,0,h)}if(o)l=l.toString(o);return i&&i(t,l)}))};this.open(t,m,438,((r,n)=>{if(r)return i&&i(r);p=n;const tryStat=(r,n)=>{if(r){this.stat(t,((t,n)=>{if(t){return this.close(p,(()=>{i&&i(r)}))}tryStat(null,n)}));return}s=n.size||0;if(s===0){u=[];return read()}l=Buffer.allocUnsafe(s);read()};this.fstat(p,tryStat)}))}writeFile(t,r,n,i){if(this.server)throw new Error("Client-only method called in server mode");let o;if(typeof i==="function"){o=i}else if(typeof n==="function"){o=n;n=undefined}if(typeof n==="string")n={encoding:n,mode:438,flag:"w"};else if(!n)n={encoding:"utf8",mode:438,flag:"w"};else if(typeof n!=="object")throw new TypeError("Bad arguments");if(n.encoding&&!Buffer.isEncoding(n.encoding))throw new Error(`Unknown encoding: ${n.encoding}`);const s=n.flag||"w";this.open(t,s,n.mode,((i,l)=>{if(i){o&&o(i)}else{const i=Buffer.isBuffer(r)?r:Buffer.from(""+r,n.encoding||"utf8");const u=/a/.test(s)?null:0;if(u===null){const tryStat=(r,n)=>{if(r){this.stat(t,((t,n)=>{if(t){return this.close(l,(()=>{o&&o(r)}))}tryStat(null,n)}));return}writeAll(this,l,i,0,i.length,n.size,o)};this.fstat(l,tryStat);return}writeAll(this,l,i,0,i.length,u,o)}}))}appendFile(t,r,n,i){if(this.server)throw new Error("Client-only method called in server mode");let o;if(typeof i==="function"){o=i}else if(typeof n==="function"){o=n;n=undefined}if(typeof n==="string")n={encoding:n,mode:438,flag:"a"};else if(!n)n={encoding:"utf8",mode:438,flag:"a"};else if(typeof n!=="object")throw new TypeError("Bad arguments");if(!n.flag)n=Object.assign({flag:"a"},n);this.writeFile(t,r,n,o)}exists(t,r){if(this.server)throw new Error("Client-only method called in server mode");this.stat(t,(t=>{r&&r(t?false:true)}))}unlink(t,r){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(t);let i=9;const o=Buffer.allocUnsafe(4+1+4+4+n);b(o,o.length-4,0);o[4]=B.REMOVE;const s=this._writeReqid=this._writeReqid+1&P;b(o,s,5);b(o,n,i);o.utf8Write(t,i+=4,n);this._requests[s]={cb:r};const l=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} REMOVE`)}rename(t,r,n){if(this.server)throw new Error("Client-only method called in server mode");const i=Buffer.byteLength(t);const o=Buffer.byteLength(r);let s=9;const l=Buffer.allocUnsafe(4+1+4+4+i+4+o);b(l,l.length-4,0);l[4]=B.RENAME;const u=this._writeReqid=this._writeReqid+1&P;b(l,u,5);b(l,i,s);l.utf8Write(t,s+=4,i);b(l,o,s+=i);l.utf8Write(r,s+=4,o);this._requests[u]={cb:n};const h=sendOrBuffer(this,l);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} RENAME`)}mkdir(t,r,n){if(this.server)throw new Error("Client-only method called in server mode");let i=0;let o=0;if(typeof r==="function"){n=r;r=undefined}if(typeof r==="object"&&r!==null){r=attrsToBytes(r);i=r.flags;o=r.nb}const s=Buffer.byteLength(t);let l=9;const u=Buffer.allocUnsafe(4+1+4+4+s+4+o);b(u,u.length-4,0);u[4]=B.MKDIR;const h=this._writeReqid=this._writeReqid+1&P;b(u,h,5);b(u,s,l);u.utf8Write(t,l+=4,s);b(u,i,l+=s);if(o){l+=4;if(o===w.length)u.set(w,l);else m(w,u,0,o,l);l+=o}this._requests[h]={cb:n};const p=sendOrBuffer(this,u);this._debug&&this._debug(`SFTP: Outbound: ${p?"Buffered":"Sending"} MKDIR`)}rmdir(t,r){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(t);let i=9;const o=Buffer.allocUnsafe(4+1+4+4+n);b(o,o.length-4,0);o[4]=B.RMDIR;const s=this._writeReqid=this._writeReqid+1&P;b(o,s,5);b(o,n,i);o.utf8Write(t,i+=4,n);this._requests[s]={cb:r};const l=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} RMDIR`)}readdir(t,r,n){if(this.server)throw new Error("Client-only method called in server mode");if(typeof r==="function"){n=r;r={}}if(typeof r!=="object"||r===null)r={};const i=r&&r.full?false:true;if(!Buffer.isBuffer(t)&&typeof t!=="string")throw new Error("missing directory handle or path");if(typeof t==="string"){const i=[];let o=0;const reread=(t,s)=>{if(t)return n(t);this.readdir(s,r,((t,r)=>{const l=t&&t.code===I.EOF;if(t&&!l)return this.close(s,(()=>n(t)));if(l){return this.close(s,(t=>{if(t)return n(t);n(undefined,i)}))}for(let t=0;t<r.length;++t,++o)i[o]=r[t];reread(undefined,s)}))};return this.opendir(t,reread)}const o=t.length;let s=9;const l=Buffer.allocUnsafe(4+1+4+4+o);b(l,l.length-4,0);l[4]=B.READDIR;const u=this._writeReqid=this._writeReqid+1&P;b(l,u,5);b(l,o,s);l.set(t,s+=4);this._requests[u]={cb:i?(t,r)=>{if(typeof n!=="function")return;if(t)return n(t);for(let t=r.length-1;t>=0;--t){if(r[t].filename==="."||r[t].filename==="..")r.splice(t,1)}n(undefined,r)}:n};const h=sendOrBuffer(this,l);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} READDIR`)}fstat(t,r){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");const n=t.length;let i=9;const o=Buffer.allocUnsafe(4+1+4+4+n);b(o,o.length-4,0);o[4]=B.FSTAT;const s=this._writeReqid=this._writeReqid+1&P;b(o,s,5);b(o,n,i);o.set(t,i+=4);this._requests[s]={cb:r};const l=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} FSTAT`)}stat(t,r){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(t);let i=9;const o=Buffer.allocUnsafe(4+1+4+4+n);b(o,o.length-4,0);o[4]=B.STAT;const s=this._writeReqid=this._writeReqid+1&P;b(o,s,5);b(o,n,i);o.utf8Write(t,i+=4,n);this._requests[s]={cb:r};const l=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} STAT`)}lstat(t,r){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(t);let i=9;const o=Buffer.allocUnsafe(4+1+4+4+n);b(o,o.length-4,0);o[4]=B.LSTAT;const s=this._writeReqid=this._writeReqid+1&P;b(o,s,5);b(o,n,i);o.utf8Write(t,i+=4,n);this._requests[s]={cb:r};const l=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} LSTAT`)}opendir(t,r){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(t);let i=9;const o=Buffer.allocUnsafe(4+1+4+4+n);b(o,o.length-4,0);o[4]=B.OPENDIR;const s=this._writeReqid=this._writeReqid+1&P;b(o,s,5);b(o,n,i);o.utf8Write(t,i+=4,n);this._requests[s]={cb:r};const l=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} OPENDIR`)}setstat(t,r,n){if(this.server)throw new Error("Client-only method called in server mode");let i=0;let o=0;if(typeof r==="object"&&r!==null){r=attrsToBytes(r);i=r.flags;o=r.nb}else if(typeof r==="function"){n=r}const s=Buffer.byteLength(t);let l=9;const u=Buffer.allocUnsafe(4+1+4+4+s+4+o);b(u,u.length-4,0);u[4]=B.SETSTAT;const h=this._writeReqid=this._writeReqid+1&P;b(u,h,5);b(u,s,l);u.utf8Write(t,l+=4,s);b(u,i,l+=s);if(o){l+=4;if(o===w.length)u.set(w,l);else m(w,u,0,o,l);l+=o}this._requests[h]={cb:n};const p=sendOrBuffer(this,u);this._debug&&this._debug(`SFTP: Outbound: ${p?"Buffered":"Sending"} SETSTAT`)}fsetstat(t,r,n){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");let i=0;let o=0;if(typeof r==="object"&&r!==null){r=attrsToBytes(r);i=r.flags;o=r.nb}else if(typeof r==="function"){n=r}const s=t.length;let l=9;const u=Buffer.allocUnsafe(4+1+4+4+s+4+o);b(u,u.length-4,0);u[4]=B.FSETSTAT;const h=this._writeReqid=this._writeReqid+1&P;b(u,h,5);b(u,s,l);u.set(t,l+=4);b(u,i,l+=s);if(o){l+=4;if(o===w.length)u.set(w,l);else m(w,u,0,o,l);l+=o}this._requests[h]={cb:n};const p=sendOrBuffer(this,u);this._debug&&this._debug(`SFTP: Outbound: ${p?"Buffered":"Sending"} FSETSTAT`)}futimes(t,r,n,i){return this.fsetstat(t,{atime:toUnixTimestamp(r),mtime:toUnixTimestamp(n)},i)}utimes(t,r,n,i){return this.setstat(t,{atime:toUnixTimestamp(r),mtime:toUnixTimestamp(n)},i)}fchown(t,r,n,i){return this.fsetstat(t,{uid:r,gid:n},i)}chown(t,r,n,i){return this.setstat(t,{uid:r,gid:n},i)}fchmod(t,r,n){return this.fsetstat(t,{mode:r},n)}chmod(t,r,n){return this.setstat(t,{mode:r},n)}readlink(t,r){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(t);let i=9;const o=Buffer.allocUnsafe(4+1+4+4+n);b(o,o.length-4,0);o[4]=B.READLINK;const s=this._writeReqid=this._writeReqid+1&P;b(o,s,5);b(o,n,i);o.utf8Write(t,i+=4,n);this._requests[s]={cb:(t,n)=>{if(typeof r!=="function")return;if(t)return r(t);if(!n||!n.length)return r(new Error("Response missing link info"));r(undefined,n[0].filename)}};const l=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} READLINK`)}symlink(t,r,n){if(this.server)throw new Error("Client-only method called in server mode");const i=Buffer.byteLength(r);const o=Buffer.byteLength(t);let s=9;const l=Buffer.allocUnsafe(4+1+4+4+i+4+o);b(l,l.length-4,0);l[4]=B.SYMLINK;const u=this._writeReqid=this._writeReqid+1&P;b(l,u,5);if(this._isOpenSSH){b(l,o,s);l.utf8Write(t,s+=4,o);b(l,i,s+=o);l.utf8Write(r,s+=4,i)}else{b(l,i,s);l.utf8Write(r,s+=4,i);b(l,o,s+=i);l.utf8Write(t,s+=4,o)}this._requests[u]={cb:n};const h=sendOrBuffer(this,l);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} SYMLINK`)}realpath(t,r){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(t);let i=9;const o=Buffer.allocUnsafe(4+1+4+4+n);b(o,o.length-4,0);o[4]=B.REALPATH;const s=this._writeReqid=this._writeReqid+1&P;b(o,s,5);b(o,n,i);o.utf8Write(t,i+=4,n);this._requests[s]={cb:(t,n)=>{if(typeof r!=="function")return;if(t)return r(t);if(!n||!n.length)return r(new Error("Response missing path info"));r(undefined,n[0].filename)}};const l=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} REALPATH`)}ext_openssh_rename(t,r,n){if(this.server)throw new Error("Client-only method called in server mode");const i=this._extensions["posix-rename@openssh.com"];if(!i||i!=="1")throw new Error("Server does not support this extended request");const o=Buffer.byteLength(t);const s=Buffer.byteLength(r);let l=9;const u=Buffer.allocUnsafe(4+1+4+4+24+4+o+4+s);b(u,u.length-4,0);u[4]=B.EXTENDED;const h=this._writeReqid=this._writeReqid+1&P;b(u,h,5);b(u,24,l);u.utf8Write("posix-rename@openssh.com",l+=4,24);b(u,o,l+=24);u.utf8Write(t,l+=4,o);b(u,s,l+=o);u.utf8Write(r,l+=4,s);this._requests[h]={cb:n};const p=sendOrBuffer(this,u);if(this._debug){const t=p?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${t} posix-rename@openssh.com`)}}ext_openssh_statvfs(t,r){if(this.server)throw new Error("Client-only method called in server mode");const n=this._extensions["statvfs@openssh.com"];if(!n||n!=="2")throw new Error("Server does not support this extended request");const i=Buffer.byteLength(t);let o=9;const s=Buffer.allocUnsafe(4+1+4+4+19+4+i);b(s,s.length-4,0);s[4]=B.EXTENDED;const l=this._writeReqid=this._writeReqid+1&P;b(s,l,5);b(s,19,o);s.utf8Write("statvfs@openssh.com",o+=4,19);b(s,i,o+=19);s.utf8Write(t,o+=4,i);this._requests[l]={extended:"statvfs@openssh.com",cb:r};const u=sendOrBuffer(this,s);if(this._debug){const t=u?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${t} statvfs@openssh.com`)}}ext_openssh_fstatvfs(t,r){if(this.server)throw new Error("Client-only method called in server mode");const n=this._extensions["fstatvfs@openssh.com"];if(!n||n!=="2")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");const i=t.length;let o=9;const s=Buffer.allocUnsafe(4+1+4+4+20+4+i);b(s,s.length-4,0);s[4]=B.EXTENDED;const l=this._writeReqid=this._writeReqid+1&P;b(s,l,5);b(s,20,o);s.utf8Write("fstatvfs@openssh.com",o+=4,20);b(s,i,o+=20);s.set(t,o+=4);this._requests[l]={extended:"fstatvfs@openssh.com",cb:r};const u=sendOrBuffer(this,s);if(this._debug){const t=u?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${t} fstatvfs@openssh.com`)}}ext_openssh_hardlink(t,r,n){if(this.server)throw new Error("Client-only method called in server mode");const i=this._extensions["hardlink@openssh.com"];if(i!=="1")throw new Error("Server does not support this extended request");const o=Buffer.byteLength(t);const s=Buffer.byteLength(r);let l=9;const u=Buffer.allocUnsafe(4+1+4+4+20+4+o+4+s);b(u,u.length-4,0);u[4]=B.EXTENDED;const h=this._writeReqid=this._writeReqid+1&P;b(u,h,5);b(u,20,l);u.utf8Write("hardlink@openssh.com",l+=4,20);b(u,o,l+=20);u.utf8Write(t,l+=4,o);b(u,s,l+=o);u.utf8Write(r,l+=4,s);this._requests[h]={cb:n};const p=sendOrBuffer(this,u);if(this._debug){const t=p?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${t} hardlink@openssh.com`)}}ext_openssh_fsync(t,r){if(this.server)throw new Error("Client-only method called in server mode");const n=this._extensions["fsync@openssh.com"];if(n!=="1")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");const i=t.length;let o=9;const s=Buffer.allocUnsafe(4+1+4+4+17+4+i);b(s,s.length-4,0);s[4]=B.EXTENDED;const l=this._writeReqid=this._writeReqid+1&P;b(s,l,5);b(s,17,o);s.utf8Write("fsync@openssh.com",o+=4,17);b(s,i,o+=17);s.set(t,o+=4);this._requests[l]={cb:r};const u=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} fsync@openssh.com`)}ext_openssh_lsetstat(t,r,n){if(this.server)throw new Error("Client-only method called in server mode");const i=this._extensions["lsetstat@openssh.com"];if(i!=="1")throw new Error("Server does not support this extended request");let o=0;let s=0;if(typeof r==="object"&&r!==null){r=attrsToBytes(r);o=r.flags;s=r.nb}else if(typeof r==="function"){n=r}const l=Buffer.byteLength(t);let u=9;const h=Buffer.allocUnsafe(4+1+4+4+20+4+l+4+s);b(h,h.length-4,0);h[4]=B.EXTENDED;const p=this._writeReqid=this._writeReqid+1&P;b(h,p,5);b(h,20,u);h.utf8Write("lsetstat@openssh.com",u+=4,20);b(h,l,u+=20);h.utf8Write(t,u+=4,l);b(h,o,u+=l);if(s){u+=4;if(s===w.length)h.set(w,u);else m(w,h,0,s,u);u+=s}this._requests[p]={cb:n};const g=sendOrBuffer(this,h);if(this._debug){const t=g?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${t} lsetstat@openssh.com`)}}ext_openssh_expandPath(t,r){if(this.server)throw new Error("Client-only method called in server mode");const n=this._extensions["expand-path@openssh.com"];if(n!=="1")throw new Error("Server does not support this extended request");const i=Buffer.byteLength(t);let o=9;const s=Buffer.allocUnsafe(4+1+4+4+23+4+i);b(s,s.length-4,0);s[4]=B.EXTENDED;const l=this._writeReqid=this._writeReqid+1&P;b(s,l,5);b(s,23,o);s.utf8Write("expand-path@openssh.com",o+=4,23);b(s,i,o+=20);s.utf8Write(t,o+=4,i);this._requests[l]={cb:r};const u=sendOrBuffer(this,s);if(this._debug){const t=u?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${t} expand-path@openssh.com`)}}handle(t,r){if(!this.server)throw new Error("Server-only method called in client mode");if(!Buffer.isBuffer(r))throw new Error("handle is not a Buffer");const n=r.length;if(n>256)throw new Error("handle too large (> 256 bytes)");let i=9;const o=Buffer.allocUnsafe(4+1+4+4+n);b(o,o.length-4,0);o[4]=k.HANDLE;b(o,t,5);b(o,n,i);if(n)o.set(r,i+=4);const s=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${s?"Buffered":"Sending"} HANDLE`)}status(t,r,n){if(!this.server)throw new Error("Server-only method called in client mode");if(!C.has(r))throw new Error(`Bad status code: ${r}`);n||(n="");const i=Buffer.byteLength(n);let o=9;const s=Buffer.allocUnsafe(4+1+4+4+4+i+4);b(s,s.length-4,0);s[4]=k.STATUS;b(s,t,5);b(s,r,o);b(s,i,o+=4);o+=4;if(i){s.utf8Write(n,o,i);o+=i}b(s,0,o);const l=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} STATUS`)}data(t,r,n){if(!this.server)throw new Error("Server-only method called in client mode");const i=Buffer.isBuffer(r);if(!i&&typeof r!=="string")throw new Error("data is not a Buffer or string");let o;if(!i&&!n){n=undefined;o=true}const s=i?r.length:Buffer.byteLength(r,n);let l=9;const u=Buffer.allocUnsafe(4+1+4+4+s);b(u,u.length-4,0);u[4]=k.DATA;b(u,t,5);b(u,s,l);if(s){if(i)u.set(r,l+=4);else if(o)u.utf8Write(r,l+=4,s);else u.write(r,l+=4,s,n)}const h=sendOrBuffer(this,u);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} DATA`)}name(t,r){if(!this.server)throw new Error("Server-only method called in client mode");if(!Array.isArray(r)){if(typeof r!=="object"||r===null)throw new Error("names is not an object or array");r=[r]}const n=r.length;let i=0;let o;const s=[];for(let t=0;t<n;++t){const n=r[t];const l=!n||!n.filename||typeof n.filename!=="string"?"":n.filename;i+=4+Buffer.byteLength(l);const u=!n||!n.longname||typeof n.longname!=="string"?"":n.longname;i+=4+Buffer.byteLength(u);if(typeof n.attrs==="object"&&n.attrs!==null){o=attrsToBytes(n.attrs);i+=4+o.nb;if(o.nb){let t;if(o.nb===w.length){t=new Uint8Array(w)}else{t=new Uint8Array(o.nb);m(w,t,0,o.nb,0)}o.bytes=t}s.push(o)}else{i+=4;s.push(null)}}let l=9;const u=Buffer.allocUnsafe(4+1+4+4+i);b(u,u.length-4,0);u[4]=k.NAME;b(u,t,5);b(u,n,l);l+=4;for(let t=0;t<n;++t){const n=r[t];{const t=!n||!n.filename||typeof n.filename!=="string"?"":n.filename;const r=Buffer.byteLength(t);b(u,r,l);l+=4;if(r){u.utf8Write(t,l,r);l+=r}}{const t=!n||!n.longname||typeof n.longname!=="string"?"":n.longname;const r=Buffer.byteLength(t);b(u,r,l);l+=4;if(r){u.utf8Write(t,l,r);l+=r}}const i=s[t];if(i){b(u,i.flags,l);l+=4;if(i.flags&&i.bytes){u.set(i.bytes,l);l+=i.nb}}else{b(u,0,l);l+=4}}const h=sendOrBuffer(this,u);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} NAME`)}attrs(t,r){if(!this.server)throw new Error("Server-only method called in client mode");if(typeof r!=="object"||r===null)throw new Error("attrs is not an object");r=attrsToBytes(r);const n=r.flags;const i=r.nb;let o=9;const s=Buffer.allocUnsafe(4+1+4+4+i);b(s,s.length-4,0);s[4]=k.ATTRS;b(s,t,5);b(s,n,o);if(i){o+=4;if(i===w.length)s.set(w,o);else m(w,s,0,i,o);o+=i}const l=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} ATTRS`)}}function tryCreateBuffer(t){try{return Buffer.allocUnsafe(t)}catch(t){return t}}function read_(t,r,n,i,o,s,l,u){const h=t._maxReadLen;const p=Math.max(o-h,0);if(p)o=h;const g=r.length;let m=9;let E=s;const y=Buffer.allocUnsafe(4+1+4+4+g+8+4);b(y,y.length-4,0);y[4]=B.READ;const w=t._writeReqid=t._writeReqid+1&P;b(y,w,5);b(y,g,m);y.set(r,m+=4);m+=g;for(let t=7;t>=0;--t){y[m+t]=E&255;E/=256}b(y,o,m+=8);if(typeof l!=="function")l=noop;const C=u||{nb:0,position:s,off:i,origOff:i,len:undefined,overflow:undefined,cb:(i,o,s)=>{const u=C.len;const h=C.overflow;if(i){if(l._wantEOFError||i.code!==I.EOF)return l(i)}else if(s>u){return l(new Error("Received more data than requested"))}else if(s===u&&h){C.nb+=s;C.position+=s;C.off+=s;read_(t,r,n,C.off,h,C.position,l,C);return}if(C.origOff===0&&n.length===C.nb)o=n;else o=_(n,C.origOff,C.origOff+C.nb);l(undefined,C.nb+(s||0),o,C.position)},buffer:undefined};C.len=o;C.overflow=p;C.buffer=_(n,i,i+o);t._requests[w]=C;const R=sendOrBuffer(t,y);t._debug&&t._debug(`SFTP: Outbound: ${R?"Buffered":"Sending"} READ`)}function fastXfer(t,r,n,i,s,l){let u=64;let h=32768;let p;let g;let m;if(typeof s==="function"){l=s}else if(typeof s==="object"&&s!==null){if(typeof s.concurrency==="number"&&s.concurrency>0&&!isNaN(s.concurrency)){u=s.concurrency}if(typeof s.chunkSize==="number"&&s.chunkSize>0&&!isNaN(s.chunkSize)){h=s.chunkSize}if(typeof s.fileSize==="number"&&s.fileSize>0&&!isNaN(s.fileSize)){m=s.fileSize}if(typeof s.step==="function")p=s.step;if(typeof s.mode==="string"||typeof s.mode==="number")g=modeNum(s.mode)}let _;let E=0;let b=0;let y=false;let w;let I;let C;let R=h*u;function onerror(n){if(y)return;y=true;let i=0;let s;if(w||I){s=()=>{if(--i===0)l(n)};if(w&&(t===o||t.outgoing.state==="open"))++i;if(I&&(r===o||r.outgoing.state==="open"))++i;if(w&&(t===o||t.outgoing.state==="open"))t.close(w,s);if(I&&(r===o||r.outgoing.state==="open"))r.close(I,s)}else{l(n)}}t.open(n,"r",((s,y)=>{if(s)return onerror(s);w=y;if(m===undefined)t.fstat(w,tryStat);else tryStat(null,{size:m});function tryStat(s,m){if(s){if(t!==o){t.stat(n,((t,r)=>{if(t)return onerror(s);tryStat(null,r)}));return}return onerror(s)}_=m.size;r.open(i,"w",((n,o)=>{if(n)return onerror(n);I=o;if(_<=0)return onerror();while(R>_){if(u===1){R=_;break}R-=h;--u}C=tryCreateBuffer(R);if(C instanceof Error)return onerror(C);if(g!==undefined){r.fchmod(I,g,(function tryAgain(t){if(t){r.chmod(i,g,(t=>tryAgain()));return}startReads()}))}else{startReads()}function onread(n,i,o,s,u,g){if(n)return onerror(n);u=u||0;r.write(I,C,u,i,s,writeCb);function writeCb(n){if(n)return onerror(n);b+=i;p&&p(b,i,_);if(i<g)return singleRead(u,s+i,g-i);if(b===_){r.close(I,(r=>{I=undefined;if(r)return onerror(r);t.close(w,(t=>{w=undefined;if(t)return onerror(t);l()}))}));return}if(E>=_)return;const o=E+h>_?_-E:h;singleRead(u,E,o);E+=o}}function makeCb(t,r,n){return(i,o,s)=>{onread(i,o,s,r,t,n)}}function singleRead(r,n,i){t.read(w,C,r,i,n,makeCb(r,n,i))}function startReads(){let t=0;let r=0;while(E<_&&t<u){const n=E+h>_?_-E:h;singleRead(r,E,n);r+=n;E+=n;++t}}}))}}))}function writeAll(t,r,n,i,o,s,l){const u=typeof l==="function"?l:undefined;t.write(r,n,i,o,s,((l,h)=>{if(l){return t.close(r,(()=>{u&&u(l)}))}if(h===o){t.close(r,u)}else{i+=h;o-=h;s+=h;writeAll(t,r,n,i,o,s,u)}}))}class Stats{constructor(t){this.mode=t&&t.mode;this.uid=t&&t.uid;this.gid=t&&t.gid;this.size=t&&t.size;this.atime=t&&t.atime;this.mtime=t&&t.mtime;this.extended=t&&t.extended}isDirectory(){return(this.mode&s.S_IFMT)===s.S_IFDIR}isFile(){return(this.mode&s.S_IFMT)===s.S_IFREG}isBlockDevice(){return(this.mode&s.S_IFMT)===s.S_IFBLK}isCharacterDevice(){return(this.mode&s.S_IFMT)===s.S_IFCHR}isSymbolicLink(){return(this.mode&s.S_IFMT)===s.S_IFLNK}isFIFO(){return(this.mode&s.S_IFMT)===s.S_IFIFO}isSocket(){return(this.mode&s.S_IFMT)===s.S_IFSOCK}}function attrsToBytes(t){let r=0;let n=0;if(typeof t==="object"&&t!==null){if(typeof t.size==="number"){r|=y.SIZE;const i=t.size;w[n++]=i/72057594037927940;w[n++]=i/281474976710656;w[n++]=i/1099511627776;w[n++]=i/4294967296;w[n++]=i/16777216;w[n++]=i/65536;w[n++]=i/256;w[n++]=i}if(typeof t.uid==="number"&&typeof t.gid==="number"){r|=y.UIDGID;const i=t.uid;const o=t.gid;w[n++]=i>>>24;w[n++]=i>>>16;w[n++]=i>>>8;w[n++]=i;w[n++]=o>>>24;w[n++]=o>>>16;w[n++]=o>>>8;w[n++]=o}if(typeof t.mode==="number"||typeof t.mode==="string"){const i=modeNum(t.mode);r|=y.PERMISSIONS;w[n++]=i>>>24;w[n++]=i>>>16;w[n++]=i>>>8;w[n++]=i}if((typeof t.atime==="number"||p(t.atime))&&(typeof t.mtime==="number"||p(t.mtime))){const i=toUnixTimestamp(t.atime);const o=toUnixTimestamp(t.mtime);r|=y.ACMODTIME;w[n++]=i>>>24;w[n++]=i>>>16;w[n++]=i>>>8;w[n++]=i;w[n++]=o>>>24;w[n++]=o>>>16;w[n++]=o>>>8;w[n++]=o}}return{flags:r,nb:n}}function toUnixTimestamp(t){if(typeof t==="number"&&t===t)return t;if(p(t))return parseInt(t.getTime()/1e3,10);throw new Error(`Cannot parse time: ${t}`)}function modeNum(t){if(typeof t==="number"&&t===t)return t;if(typeof t==="string")return modeNum(parseInt(t,8));throw new Error(`Cannot parse mode: ${t}`)}const q={r:v.READ,"r+":v.READ|v.WRITE,w:v.TRUNC|v.CREAT|v.WRITE,wx:v.TRUNC|v.CREAT|v.WRITE|v.EXCL,xw:v.TRUNC|v.CREAT|v.WRITE|v.EXCL,"w+":v.TRUNC|v.CREAT|v.READ|v.WRITE,"wx+":v.TRUNC|v.CREAT|v.READ|v.WRITE|v.EXCL,"xw+":v.TRUNC|v.CREAT|v.READ|v.WRITE|v.EXCL,a:v.APPEND|v.CREAT|v.WRITE,ax:v.APPEND|v.CREAT|v.WRITE|v.EXCL,xa:v.APPEND|v.CREAT|v.WRITE|v.EXCL,"a+":v.APPEND|v.CREAT|v.READ|v.WRITE,"ax+":v.APPEND|v.CREAT|v.READ|v.WRITE|v.EXCL,"xa+":v.APPEND|v.CREAT|v.READ|v.WRITE|v.EXCL};function stringToFlags(t){const r=q[t];return r!==undefined?r:null}const $=(()=>{const t=Object.keys(q);return r=>{for(let n=0;n<t.length;++n){const i=t[n];if(q[i]===r)return i}return null}})();function readAttrs(t){const r=W.readUInt32BE();if(r===undefined)return;const n=new Stats;if(r&y.SIZE){const r=W.readUInt64BE(t);if(r===undefined)return;n.size=r}if(r&y.UIDGID){const t=W.readUInt32BE();const r=W.readUInt32BE();if(r===undefined)return;n.uid=t;n.gid=r}if(r&y.PERMISSIONS){const t=W.readUInt32BE();if(t===undefined)return;n.mode=t}if(r&y.ACMODTIME){const t=W.readUInt32BE();const r=W.readUInt32BE();if(r===undefined)return;n.atime=t;n.mtime=r}if(r&y.EXTENDED){const t=W.readUInt32BE();if(t===undefined)return;const r={};for(let n=0;n<t;++n){const t=W.readString(true);const n=W.readString();if(n===undefined)return;r[t]=n}n.extended=r}return n}function sendOrBuffer(t,r){const n=tryWritePayload(t,r);if(n!==undefined){t._buffer.push(n);return false}return true}function tryWritePayload(t,r){const n=t.outgoing;if(n.state!=="open")return;if(n.window===0){t._waitWindow=true;return r}let i;const o=r.length;let s=0;while(o-s>0&&n.window>0){const i=Math.min(o-s,n.window,n.packetSize);n.window-=i;if(n.window===0){t._waitWindow=true;t._chunkcb=drainBuffer}if(s===0&&i===o){t._protocol.channelData(t.outgoing.id,r)}else{t._protocol.channelData(t.outgoing.id,_(r,s,s+i))}s+=i}if(o-s>0){if(s>0)i=_(r,s,o);else i=r}return i}function drainBuffer(){this._chunkcb=undefined;const t=this._buffer;let r=0;while(r<t.length){const n=t[r];const i=tryWritePayload(this,n);if(i!==undefined){if(i!==n)t[r]=i;if(r>0)this._buffer=t.slice(r);return}++r}if(r>0)this._buffer=[]}function doFatalSFTPError(t,r,n){const i=new Error(r);i.level="sftp-protocol";if(!n&&t._debug)t._debug(`SFTP: Inbound: ${r}`);t.emit("error",i);t.destroy();cleanupRequests(t);return false}function cleanupRequests(t){const r=Object.keys(t._requests);if(r.length===0)return;const n=t._requests;t._requests={};const i=new Error("No response from server");for(let t=0;t<r.length;++t){const o=n[r[t]];if(typeof o.cb==="function")o.cb(i)}}function requestLimits(t,r){let n=9;const i=Buffer.allocUnsafe(4+1+4+4+18);b(i,i.length-4,0);i[4]=B.EXTENDED;const o=t._writeReqid=t._writeReqid+1&P;b(i,o,5);b(i,18,n);i.utf8Write("limits@openssh.com",n+=4,18);t._requests[o]={extended:"limits@openssh.com",cb:r};const s=sendOrBuffer(t,i);if(t._debug){const r=s?"Buffered":"Sending";t._debug(`SFTP: Outbound: ${r} limits@openssh.com`)}}const j={[k.VERSION]:(t,r)=>{if(t._version!==-1)return doFatalSFTPError(t,"Duplicate VERSION packet");const n={};W.init(r,1);let i=W.readUInt32BE();while(W.avail()){const t=W.readString(true);const r=W.readString(true);if(r===undefined){i=undefined;break}n[t]=r}W.clear();if(i===undefined)return doFatalSFTPError(t,"Malformed VERSION packet");if(t._debug){const r=Object.keys(n);if(r.length){t._debug(`SFTP: Inbound: Received VERSION (v${i}, exts:${r})`)}else{t._debug(`SFTP: Inbound: Received VERSION (v${i})`)}}t._version=i;t._extensions=n;if(n["limits@openssh.com"]==="1"){return requestLimits(t,((r,n)=>{if(!r){if(n.maxPktLen>0)t._maxOutPktLen=n.maxPktLen;if(n.maxReadLen>0)t._maxReadLen=n.maxReadLen;if(n.maxWriteLen>0)t._maxWriteLen=n.maxWriteLen;t.maxOpenHandles=n.maxOpenHandles>0?n.maxOpenHandles:Infinity}t.emit("ready")}))}t.emit("ready")},[k.STATUS]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readUInt32BE();const o=W.readString(true);const s=W.skipString();W.clear();if(s===undefined){if(n!==undefined)delete t._requests[n];return doFatalSFTPError(t,"Malformed STATUS packet")}if(t._debug){const r=JSON.stringify(o);t._debug(`SFTP: Inbound: Received STATUS (id:${n}, ${i}, ${r})`)}const l=t._requests[n];delete t._requests[n];if(l&&typeof l.cb==="function"){if(i===I.OK){l.cb();return}const t=new Error(o||R[i]||"Unknown status");t.code=i;l.cb(t)}},[k.HANDLE]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString();W.clear();if(i===undefined){if(n!==undefined)delete t._requests[n];return doFatalSFTPError(t,"Malformed HANDLE packet")}t._debug&&t._debug(`SFTP: Inbound: Received HANDLE (id:${n})`);const o=t._requests[n];delete t._requests[n];if(o&&typeof o.cb==="function")o.cb(undefined,i)},[k.DATA]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();let i;if(n!==undefined){i=t._requests[n];delete t._requests[n]}if(i&&typeof i.cb==="function"){if(i.buffer){const r=W.readString(i.buffer);W.clear();if(r!==undefined){t._debug&&t._debug(`SFTP: Inbound: Received DATA (id:${n}, ${r})`);i.cb(undefined,i.buffer,r);return}}else{const r=W.readString();W.clear();if(r!==undefined){t._debug&&t._debug(`SFTP: Inbound: Received DATA (id:${n}, ${r.length})`);i.cb(undefined,r);return}}}else{const r=W.skipString();W.clear();if(r!==undefined){t._debug&&t._debug(`SFTP: Inbound: Received DATA (id:${n}, ${r})`);return}}return doFatalSFTPError(t,"Malformed DATA packet")},[k.NAME]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();let i;if(n!==undefined){i=t._requests[n];delete t._requests[n]}const o=W.readUInt32BE();if(o!==undefined){let r=[];for(let n=0;n<o;++n){const n=W.readString(true);const i=W.readString(true);const o=readAttrs(t._biOpt);if(o===undefined){r=undefined;break}r.push({filename:n,longname:i,attrs:o})}if(r!==undefined){t._debug&&t._debug(`SFTP: Inbound: Received NAME (id:${n}, ${r.length})`);W.clear();if(i&&typeof i.cb==="function")i.cb(undefined,r);return}}W.clear();return doFatalSFTPError(t,"Malformed NAME packet")},[k.ATTRS]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();let i;if(n!==undefined){i=t._requests[n];delete t._requests[n]}const o=readAttrs(t._biOpt);W.clear();if(o!==undefined){t._debug&&t._debug(`SFTP: Inbound: Received ATTRS (id:${n})`);if(i&&typeof i.cb==="function")i.cb(undefined,o);return}return doFatalSFTPError(t,"Malformed ATTRS packet")},[k.EXTENDED]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();if(n!==undefined){const r=t._requests[n];if(r){delete t._requests[n];switch(r.extended){case"statvfs@openssh.com":case"fstatvfs@openssh.com":{const i=t._biOpt;const o={f_bsize:W.readUInt64BE(i),f_frsize:W.readUInt64BE(i),f_blocks:W.readUInt64BE(i),f_bfree:W.readUInt64BE(i),f_bavail:W.readUInt64BE(i),f_files:W.readUInt64BE(i),f_ffree:W.readUInt64BE(i),f_favail:W.readUInt64BE(i),f_sid:W.readUInt64BE(i),f_flag:W.readUInt64BE(i),f_namemax:W.readUInt64BE(i)};if(o.f_namemax===undefined)break;if(t._debug){t._debug("SFTP: Inbound: Received EXTENDED_REPLY "+`(id:${n}, ${r.extended})`)}W.clear();if(typeof r.cb==="function")r.cb(undefined,o);return}case"limits@openssh.com":{const i={maxPktLen:W.readUInt64BE(),maxReadLen:W.readUInt64BE(),maxWriteLen:W.readUInt64BE(),maxOpenHandles:W.readUInt64BE()};if(i.maxOpenHandles===undefined)break;if(t._debug){t._debug("SFTP: Inbound: Received EXTENDED_REPLY "+`(id:${n}, ${r.extended})`)}W.clear();if(typeof r.cb==="function")r.cb(undefined,i);return}default:t._debug&&t._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${n}, ???)`);W.clear();if(typeof r.cb==="function")r.cb();return}}else{t._debug&&t._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${n}, ???)`);W.clear();return}}W.clear();return doFatalSFTPError(t,"Malformed EXTENDED_REPLY packet")}};const G={[B.INIT]:(t,r)=>{if(t._version!==-1)return doFatalSFTPError(t,"Duplicate INIT packet");const n={};W.init(r,1);let i=W.readUInt32BE();while(W.avail()){const t=W.readString(true);const r=W.readString(true);if(r===undefined){i=undefined;break}n[t]=r}W.clear();if(i===undefined)return doFatalSFTPError(t,"Malformed INIT packet");if(t._debug){const r=Object.keys(n);if(r.length){t._debug(`SFTP: Inbound: Received INIT (v${i}, exts:${r})`)}else{t._debug(`SFTP: Inbound: Received INIT (v${i})`)}}sendOrBuffer(t,D);t._version=i;t._extensions=n;t.emit("ready")},[B.OPEN]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString(true);const o=W.readUInt32BE();const s=readAttrs(t._biOpt);W.clear();if(s===undefined)return doFatalSFTPError(t,"Malformed OPEN packet");t._debug&&t._debug(`SFTP: Inbound: Received OPEN (id:${n})`);if(!t.emit("OPEN",n,i,o,s)){t.status(n,I.OP_UNSUPPORTED)}},[B.CLOSE]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString();W.clear();if(i===undefined||i.length>256)return doFatalSFTPError(t,"Malformed CLOSE packet");t._debug&&t._debug(`SFTP: Inbound: Received CLOSE (id:${n})`);if(!t.emit("CLOSE",n,i)){t.status(n,I.OP_UNSUPPORTED)}},[B.READ]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString();const o=W.readUInt64BE(t._biOpt);const s=W.readUInt32BE();W.clear();if(s===undefined||i.length>256)return doFatalSFTPError(t,"Malformed READ packet");t._debug&&t._debug(`SFTP: Inbound: Received READ (id:${n})`);if(!t.emit("READ",n,i,o,s)){t.status(n,I.OP_UNSUPPORTED)}},[B.WRITE]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString();const o=W.readUInt64BE(t._biOpt);const s=W.readString();W.clear();if(s===undefined||i.length>256)return doFatalSFTPError(t,"Malformed WRITE packet");t._debug&&t._debug(`SFTP: Inbound: Received WRITE (id:${n})`);if(!t.emit("WRITE",n,i,o,s)){t.status(n,I.OP_UNSUPPORTED)}},[B.LSTAT]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString(true);W.clear();if(i===undefined)return doFatalSFTPError(t,"Malformed LSTAT packet");t._debug&&t._debug(`SFTP: Inbound: Received LSTAT (id:${n})`);if(!t.emit("LSTAT",n,i)){t.status(n,I.OP_UNSUPPORTED)}},[B.FSTAT]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString();W.clear();if(i===undefined||i.length>256)return doFatalSFTPError(t,"Malformed FSTAT packet");t._debug&&t._debug(`SFTP: Inbound: Received FSTAT (id:${n})`);if(!t.emit("FSTAT",n,i)){t.status(n,I.OP_UNSUPPORTED)}},[B.SETSTAT]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString(true);const o=readAttrs(t._biOpt);W.clear();if(o===undefined)return doFatalSFTPError(t,"Malformed SETSTAT packet");t._debug&&t._debug(`SFTP: Inbound: Received SETSTAT (id:${n})`);if(!t.emit("SETSTAT",n,i,o)){t.status(n,I.OP_UNSUPPORTED)}},[B.FSETSTAT]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString();const o=readAttrs(t._biOpt);W.clear();if(o===undefined||i.length>256)return doFatalSFTPError(t,"Malformed FSETSTAT packet");t._debug&&t._debug(`SFTP: Inbound: Received FSETSTAT (id:${n})`);if(!t.emit("FSETSTAT",n,i,o)){t.status(n,I.OP_UNSUPPORTED)}},[B.OPENDIR]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString(true);W.clear();if(i===undefined)return doFatalSFTPError(t,"Malformed OPENDIR packet");t._debug&&t._debug(`SFTP: Inbound: Received OPENDIR (id:${n})`);if(!t.emit("OPENDIR",n,i)){t.status(n,I.OP_UNSUPPORTED)}},[B.READDIR]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString();W.clear();if(i===undefined||i.length>256)return doFatalSFTPError(t,"Malformed READDIR packet");t._debug&&t._debug(`SFTP: Inbound: Received READDIR (id:${n})`);if(!t.emit("READDIR",n,i)){t.status(n,I.OP_UNSUPPORTED)}},[B.REMOVE]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString(true);W.clear();if(i===undefined)return doFatalSFTPError(t,"Malformed REMOVE packet");t._debug&&t._debug(`SFTP: Inbound: Received REMOVE (id:${n})`);if(!t.emit("REMOVE",n,i)){t.status(n,I.OP_UNSUPPORTED)}},[B.MKDIR]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString(true);const o=readAttrs(t._biOpt);W.clear();if(o===undefined)return doFatalSFTPError(t,"Malformed MKDIR packet");t._debug&&t._debug(`SFTP: Inbound: Received MKDIR (id:${n})`);if(!t.emit("MKDIR",n,i,o)){t.status(n,I.OP_UNSUPPORTED)}},[B.RMDIR]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString(true);W.clear();if(i===undefined)return doFatalSFTPError(t,"Malformed RMDIR packet");t._debug&&t._debug(`SFTP: Inbound: Received RMDIR (id:${n})`);if(!t.emit("RMDIR",n,i)){t.status(n,I.OP_UNSUPPORTED)}},[B.REALPATH]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString(true);W.clear();if(i===undefined)return doFatalSFTPError(t,"Malformed REALPATH packet");t._debug&&t._debug(`SFTP: Inbound: Received REALPATH (id:${n})`);if(!t.emit("REALPATH",n,i)){t.status(n,I.OP_UNSUPPORTED)}},[B.STAT]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString(true);W.clear();if(i===undefined)return doFatalSFTPError(t,"Malformed STAT packet");t._debug&&t._debug(`SFTP: Inbound: Received STAT (id:${n})`);if(!t.emit("STAT",n,i)){t.status(n,I.OP_UNSUPPORTED)}},[B.RENAME]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString(true);const o=W.readString(true);W.clear();if(o===undefined)return doFatalSFTPError(t,"Malformed RENAME packet");t._debug&&t._debug(`SFTP: Inbound: Received RENAME (id:${n})`);if(!t.emit("RENAME",n,i,o)){t.status(n,I.OP_UNSUPPORTED)}},[B.READLINK]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString(true);W.clear();if(i===undefined)return doFatalSFTPError(t,"Malformed READLINK packet");t._debug&&t._debug(`SFTP: Inbound: Received READLINK (id:${n})`);if(!t.emit("READLINK",n,i)){t.status(n,I.OP_UNSUPPORTED)}},[B.SYMLINK]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString(true);const o=W.readString(true);W.clear();if(o===undefined)return doFatalSFTPError(t,"Malformed SYMLINK packet");t._debug&&t._debug(`SFTP: Inbound: Received SYMLINK (id:${n})`);let s;if(t._isOpenSSH){s=t.emit("SYMLINK",n,o,i)}else{s=t.emit("SYMLINK",n,i,o)}if(!s){t.status(n,I.OP_UNSUPPORTED)}},[B.EXTENDED]:(t,r)=>{W.init(r,1);const n=W.readUInt32BE();const i=W.readString(true);if(i===undefined){W.clear();return doFatalSFTPError(t,"Malformed EXTENDED packet")}let o;if(W.avail())o=W.readRaw();W.clear();t._debug&&t._debug(`SFTP: Inbound: Received EXTENDED (id:${n})`);if(!t.emit("EXTENDED",n,i,o)){t.status(n,I.OP_UNSUPPORTED)}}};const{ERR_INVALID_ARG_TYPE:Y,ERR_OUT_OF_RANGE:z,validateNumber:V}=n(7609);const J=128;let ee;const te=[];function allocNewPool(t){if(te.length>0)ee=te.pop();else ee=Buffer.allocUnsafe(t);ee.used=0}function checkPosition(t,r){if(!Number.isSafeInteger(t)){V(t,r);if(!Number.isInteger(t))throw new z(r,"an integer",t);throw new z(r,">= 0 and <= 2 ** 53 - 1",t)}if(t<0)throw new z(r,">= 0 and <= 2 ** 53 - 1",t)}function roundUpToMultipleOf8(t){return t+7&~7}function ReadStream(t,r,n){if(n===undefined)n={};else if(typeof n==="string")n={encoding:n};else if(n===null||typeof n!=="object")throw new TypeError('"options" argument must be a string or an object');else n=Object.create(n);if(n.highWaterMark===undefined)n.highWaterMark=64*1024;n.emitClose=false;n.autoDestroy=false;l.call(this,n);this.path=r;this.flags=n.flags===undefined?"r":n.flags;this.mode=n.mode===undefined?438:n.mode;this.start=n.start;this.end=n.end;this.autoClose=n.autoClose===undefined?true:n.autoClose;this.pos=0;this.bytesRead=0;this.closed=false;this.handle=n.handle===undefined?null:n.handle;this.sftp=t;this._opening=false;if(this.start!==undefined){checkPosition(this.start,"start");this.pos=this.start}if(this.end===undefined){this.end=Infinity}else if(this.end!==Infinity){checkPosition(this.end,"end");if(this.start!==undefined&&this.start>this.end){throw new z("start",`<= "end" (here: ${this.end})`,this.start)}}this.on("end",(function(){if(this.autoClose)this.destroy()}));if(!Buffer.isBuffer(this.handle))this.open()}h(ReadStream,l);ReadStream.prototype.open=function(){if(this._opening)return;this._opening=true;this.sftp.open(this.path,this.flags,this.mode,((t,r)=>{this._opening=false;if(t){this.emit("error",t);if(this.autoClose)this.destroy();return}this.handle=r;this.emit("open",r);this.emit("ready");this.read()}))};ReadStream.prototype._read=function(t){if(!Buffer.isBuffer(this.handle))return this.once("open",(()=>this._read(t)));if(this.destroyed)return;if(!ee||ee.length-ee.used<J){allocNewPool(this.readableHighWaterMark||this._readableState.highWaterMark)}const r=ee;let n=Math.min(ee.length-ee.used,t);const i=ee.used;if(this.end!==undefined)n=Math.min(this.end-this.pos+1,n);if(n<=0)return this.push(null);this.sftp.read(this.handle,ee,ee.used,n,this.pos,((t,o)=>{if(t){this.emit("error",t);if(this.autoClose)this.destroy();return}let s=null;if(i+n===r.used&&r===ee){r.used=roundUpToMultipleOf8(r.used+o-n)}else{const t=i+n&~7;const s=roundUpToMultipleOf8(i+o);if(t-s>=J)te.push(r.slice(s,t))}if(o>0){this.bytesRead+=o;s=r.slice(i,i+o)}this.pos+=o;this.push(s)}));ee.used=roundUpToMultipleOf8(ee.used+n)};ReadStream.prototype._destroy=function(t,r){if(this._opening&&!Buffer.isBuffer(this.handle)){this.once("open",closeStream.bind(null,this,r,t));return}closeStream(this,r,t);this.handle=null;this._opening=false};function closeStream(t,r,n){if(!t.handle)return onclose();t.sftp.close(t.handle,onclose);function onclose(i){i=i||n;r(i);t.closed=true;if(!i)t.emit("close")}}ReadStream.prototype.close=function(t){this.destroy(null,t)};Object.defineProperty(ReadStream.prototype,"pending",{get(){return this.handle===null},configurable:true});function WriteStream(t,r,n){if(n===undefined)n={};else if(typeof n==="string")n={encoding:n};else if(n===null||typeof n!=="object")throw new TypeError('"options" argument must be a string or an object');else n=Object.create(n);n.emitClose=false;n.autoDestroy=false;u.call(this,n);this.path=r;this.flags=n.flags===undefined?"w":n.flags;this.mode=n.mode===undefined?438:n.mode;this.start=n.start;this.autoClose=n.autoClose===undefined?true:n.autoClose;this.pos=0;this.bytesWritten=0;this.closed=false;this.handle=n.handle===undefined?null:n.handle;this.sftp=t;this._opening=false;if(this.start!==undefined){checkPosition(this.start,"start");this.pos=this.start}if(n.encoding)this.setDefaultEncoding(n.encoding);this.on("finish",(function(){if(this._writableState.finalCalled)return;if(this.autoClose)this.destroy()}));if(!Buffer.isBuffer(this.handle))this.open()}h(WriteStream,u);WriteStream.prototype._final=function(t){if(this.autoClose)this.destroy();t()};WriteStream.prototype.open=function(){if(this._opening)return;this._opening=true;this.sftp.open(this.path,this.flags,this.mode,((t,r)=>{this._opening=false;if(t){this.emit("error",t);if(this.autoClose)this.destroy();return}this.handle=r;const tryAgain=t=>{if(t){this.sftp.chmod(this.path,this.mode,(t=>tryAgain()));return}if(this.flags[0]==="a"){const tryStat=(t,n)=>{if(t){this.sftp.stat(this.path,((r,n)=>{if(r){this.destroy();this.emit("error",t);return}tryStat(null,n)}));return}this.pos=n.size;this.emit("open",r);this.emit("ready")};this.sftp.fstat(r,tryStat);return}this.emit("open",r);this.emit("ready")};this.sftp.fchmod(r,this.mode,tryAgain)}))};WriteStream.prototype._write=function(t,r,n){if(!Buffer.isBuffer(t)){const r=new Y("data","Buffer",t);return this.emit("error",r)}if(!Buffer.isBuffer(this.handle)){return this.once("open",(function(){this._write(t,r,n)}))}this.sftp.write(this.handle,t,0,t.length,this.pos,((t,r)=>{if(t){if(this.autoClose)this.destroy();return n(t)}this.bytesWritten+=r;n()}));this.pos+=t.length};WriteStream.prototype._writev=function(t,r){if(!Buffer.isBuffer(this.handle)){return this.once("open",(function(){this._writev(t,r)}))}const n=this.sftp;const i=this.handle;let o=t.length;const onwrite=(t,n)=>{if(t){this.destroy();return r(t)}this.bytesWritten+=n;if(--o===0)r()};for(let r=0;r<t.length;++r){const o=t[r].chunk;n.write(i,o,0,o.length,this.pos,onwrite);this.pos+=o.length}};if(typeof u.prototype.destroy!=="function")WriteStream.prototype.destroy=ReadStream.prototype.destroy;WriteStream.prototype._destroy=ReadStream.prototype._destroy;WriteStream.prototype.close=function(t){if(t){if(this.closed){process.nextTick(t);return}this.on("close",t)}if(!this.autoClose)this.on("finish",this.destroy.bind(this));this.end()};WriteStream.prototype.destroySoon=WriteStream.prototype.end;Object.defineProperty(WriteStream.prototype,"pending",{get(){return this.handle===null},configurable:true});t.exports={flagsToString:$,OPEN_MODE:v,SFTP:SFTP,Stats:Stats,STATUS_CODE:I,stringToFlags:stringToFlags}},6832:(t,r,n)=>{"use strict";const i=n(6417);let o;try{o=n(7295)()}catch{}const{bindingAvailable:s}=n(5708);const l=(()=>{if(typeof i.sign==="function"&&typeof i.verify==="function"){const t="-----BEGIN PRIVATE KEY-----\r\nMC4CAQAwBQYDK2VwBCIEIHKj+sVa9WcD"+"/q2DJUJaf43Kptc8xYuUQA4bOFj9vC8T\r\n-----END PRIVATE KEY-----";const r=Buffer.from("a");let n;let o;try{n=i.sign(null,r,t);o=i.verify(null,r,t,n)}catch{}return Buffer.isBuffer(n)&&n.length===64&&o===true}return false})();const u=typeof i.diffieHellman==="function"&&typeof i.generateKeyPairSync==="function"&&typeof i.createPublicKey==="function";const h=["ecdh-sha2-nistp256","ecdh-sha2-nistp384","ecdh-sha2-nistp521","diffie-hellman-group-exchange-sha256","diffie-hellman-group14-sha256","diffie-hellman-group15-sha512","diffie-hellman-group16-sha512","diffie-hellman-group17-sha512","diffie-hellman-group18-sha512"];if(u){h.unshift("curve25519-sha256");h.unshift("curve25519-sha256@libssh.org")}const p=h.concat(["diffie-hellman-group-exchange-sha1","diffie-hellman-group14-sha1","diffie-hellman-group1-sha1"]);const g=["ecdsa-sha2-nistp256","ecdsa-sha2-nistp384","ecdsa-sha2-nistp521","rsa-sha2-512","rsa-sha2-256","ssh-rsa"];if(l)g.unshift("ssh-ed25519");const m=g.concat(["ssh-dss"]);const _=["aes128-gcm","aes128-gcm@openssh.com","aes256-gcm","aes256-gcm@openssh.com","aes128-ctr","aes192-ctr","aes256-ctr"];if(o&&o.flags&&!o.flags.aes){if(s)_.unshift("chacha20-poly1305@openssh.com");else _.push("chacha20-poly1305@openssh.com")}else if(s&&o&&o.arch==="x86"){_.splice(4,0,"chacha20-poly1305@openssh.com")}else{_.push("chacha20-poly1305@openssh.com")}const E=_.concat(["aes256-cbc","aes192-cbc","aes128-cbc","blowfish-cbc","3des-cbc","arcfour256","arcfour128","cast128-cbc","arcfour"]);const b=["hmac-sha2-256-etm@openssh.com","hmac-sha2-512-etm@openssh.com","hmac-sha1-etm@openssh.com","hmac-sha2-256","hmac-sha2-512","hmac-sha1"];const y=b.concat(["hmac-md5","hmac-sha2-256-96","hmac-sha2-512-96","hmac-ripemd160","hmac-sha1-96","hmac-md5-96"]);const w=["none","zlib@openssh.com","zlib"];const I=w.concat([]);const C={BAD_DHGEX:1<<0,OLD_EXIT:1<<1,DYN_RPORT_BUG:1<<2,BUG_DHGEX_LARGE:1<<3};t.exports={MESSAGE:{DISCONNECT:1,IGNORE:2,UNIMPLEMENTED:3,DEBUG:4,SERVICE_REQUEST:5,SERVICE_ACCEPT:6,KEXINIT:20,NEWKEYS:21,KEXDH_INIT:30,KEXDH_REPLY:31,KEXDH_GEX_GROUP:31,KEXDH_GEX_INIT:32,KEXDH_GEX_REPLY:33,KEXDH_GEX_REQUEST:34,KEXECDH_INIT:30,KEXECDH_REPLY:31,USERAUTH_REQUEST:50,USERAUTH_FAILURE:51,USERAUTH_SUCCESS:52,USERAUTH_BANNER:53,USERAUTH_PASSWD_CHANGEREQ:60,USERAUTH_PK_OK:60,USERAUTH_INFO_REQUEST:60,USERAUTH_INFO_RESPONSE:61,GLOBAL_REQUEST:80,REQUEST_SUCCESS:81,REQUEST_FAILURE:82,CHANNEL_OPEN:90,CHANNEL_OPEN_CONFIRMATION:91,CHANNEL_OPEN_FAILURE:92,CHANNEL_WINDOW_ADJUST:93,CHANNEL_DATA:94,CHANNEL_EXTENDED_DATA:95,CHANNEL_EOF:96,CHANNEL_CLOSE:97,CHANNEL_REQUEST:98,CHANNEL_SUCCESS:99,CHANNEL_FAILURE:100},DISCONNECT_REASON:{HOST_NOT_ALLOWED_TO_CONNECT:1,PROTOCOL_ERROR:2,KEY_EXCHANGE_FAILED:3,RESERVED:4,MAC_ERROR:5,COMPRESSION_ERROR:6,SERVICE_NOT_AVAILABLE:7,PROTOCOL_VERSION_NOT_SUPPORTED:8,HOST_KEY_NOT_VERIFIABLE:9,CONNECTION_LOST:10,BY_APPLICATION:11,TOO_MANY_CONNECTIONS:12,AUTH_CANCELED_BY_USER:13,NO_MORE_AUTH_METHODS_AVAILABLE:14,ILLEGAL_USER_NAME:15},DISCONNECT_REASON_STR:undefined,CHANNEL_OPEN_FAILURE:{ADMINISTRATIVELY_PROHIBITED:1,CONNECT_FAILED:2,UNKNOWN_CHANNEL_TYPE:3,RESOURCE_SHORTAGE:4},TERMINAL_MODE:{TTY_OP_END:0,VINTR:1,VQUIT:2,VERASE:3,VKILL:4,VEOF:5,VEOL:6,VEOL2:7,VSTART:8,VSTOP:9,VSUSP:10,VDSUSP:11,VREPRINT:12,VWERASE:13,VLNEXT:14,VFLUSH:15,VSWTCH:16,VSTATUS:17,VDISCARD:18,IGNPAR:30,PARMRK:31,INPCK:32,ISTRIP:33,INLCR:34,IGNCR:35,ICRNL:36,IUCLC:37,IXON:38,IXANY:39,IXOFF:40,IMAXBEL:41,ISIG:50,ICANON:51,XCASE:52,ECHO:53,ECHOE:54,ECHOK:55,ECHONL:56,NOFLSH:57,TOSTOP:58,IEXTEN:59,ECHOCTL:60,ECHOKE:61,PENDIN:62,OPOST:70,OLCUC:71,ONLCR:72,OCRNL:73,ONOCR:74,ONLRET:75,CS7:90,CS8:91,PARENB:92,PARODD:93,TTY_OP_ISPEED:128,TTY_OP_OSPEED:129},CHANNEL_EXTENDED_DATATYPE:{STDERR:1},SIGNALS:["ABRT","ALRM","FPE","HUP","ILL","INT","QUIT","SEGV","TERM","USR1","USR2","KILL","PIPE"].reduce(((t,r)=>({...t,[r]:1})),{}),COMPAT:C,COMPAT_CHECKS:[["Cisco-1.25",C.BAD_DHGEX],[/^Cisco-1\./,C.BUG_DHGEX_LARGE],[/^[0-9.]+$/,C.OLD_EXIT],[/^OpenSSH_5\.\d+/,C.DYN_RPORT_BUG]],DEFAULT_KEX:h,SUPPORTED_KEX:p,DEFAULT_SERVER_HOST_KEY:g,SUPPORTED_SERVER_HOST_KEY:m,DEFAULT_CIPHER:_,SUPPORTED_CIPHER:E,DEFAULT_MAC:b,SUPPORTED_MAC:y,DEFAULT_COMPRESSION:w,SUPPORTED_COMPRESSION:I,curve25519Supported:u,eddsaSupported:l};t.exports.DISCONNECT_REASON_BY_VALUE=Array.from(Object.entries(t.exports.DISCONNECT_REASON)).reduce(((t,[r,n])=>({...t,[n]:r})),{})},5708:(t,r,n)=>{"use strict";const{createCipheriv:i,createDecipheriv:o,createHmac:s,randomFillSync:l,timingSafeEqual:u}=n(6417);const{readUInt32BE:h,writeUInt32BE:p}=n(9475);const g=Buffer[Symbol.species];const m=2**32-1;const _=Buffer.alloc(0);const E=Buffer.alloc(4);const b=new Map;const y=35e3;let w;let I;let C;let R;let B;let k;let v;try{w=n(9041);({AESGCMCipher:I,ChaChaPolyCipher:C,GenericCipher:R,AESGCMDecipher:B,ChaChaPolyDecipher:k,GenericDecipher:v}=w)}catch{}const T=1<<0;const P=(()=>{function info(t,r,n,i,o,s,l){return{sslName:t,blockLen:r,keyLen:n,ivLen:i!==0||l&T?i:r,authLen:o,discardLen:s,stream:!!(l&T)}}return{"chacha20-poly1305@openssh.com":info("chacha20",8,64,0,16,0,T),"aes128-gcm":info("aes-128-gcm",16,16,12,16,0,T),"aes256-gcm":info("aes-256-gcm",16,32,12,16,0,T),"aes128-gcm@openssh.com":info("aes-128-gcm",16,16,12,16,0,T),"aes256-gcm@openssh.com":info("aes-256-gcm",16,32,12,16,0,T),"aes128-cbc":info("aes-128-cbc",16,16,0,0,0,0),"aes192-cbc":info("aes-192-cbc",16,24,0,0,0,0),"aes256-cbc":info("aes-256-cbc",16,32,0,0,0,0),"rijndael-cbc@lysator.liu.se":info("aes-256-cbc",16,32,0,0,0,0),"3des-cbc":info("des-ede3-cbc",8,24,0,0,0,0),"blowfish-cbc":info("bf-cbc",8,16,0,0,0,0),"idea-cbc":info("idea-cbc",8,16,0,0,0,0),"cast128-cbc":info("cast-cbc",8,16,0,0,0,0),"aes128-ctr":info("aes-128-ctr",16,16,16,0,0,T),"aes192-ctr":info("aes-192-ctr",16,24,16,0,0,T),"aes256-ctr":info("aes-256-ctr",16,32,16,0,0,T),"3des-ctr":info("des-ede3",8,24,8,0,0,T),"blowfish-ctr":info("bf-ecb",8,16,8,0,0,T),"cast128-ctr":info("cast5-ecb",8,16,8,0,0,T),arcfour:info("rc4",8,16,0,0,1536,T),arcfour128:info("rc4",8,16,0,0,1536,T),arcfour256:info("rc4",8,32,0,0,1536,T),arcfour512:info("rc4",8,64,0,0,1536,T)}})();const O=(()=>{function info(t,r,n,i){return{sslName:t,len:r,actualLen:n,isETM:i}}return{"hmac-md5":info("md5",16,16,false),"hmac-md5-96":info("md5",16,12,false),"hmac-ripemd160":info("ripemd160",20,20,false),"hmac-sha1":info("sha1",20,20,false),"hmac-sha1-etm@openssh.com":info("sha1",20,20,true),"hmac-sha1-96":info("sha1",20,12,false),"hmac-sha2-256":info("sha256",32,32,false),"hmac-sha2-256-etm@openssh.com":info("sha256",32,32,true),"hmac-sha2-256-96":info("sha256",32,12,false),"hmac-sha2-512":info("sha512",64,64,false),"hmac-sha2-512-etm@openssh.com":info("sha512",64,64,true),"hmac-sha2-512-96":info("sha512",64,12,false)}})();class NullCipher{constructor(t,r){this.outSeqno=t;this._onWrite=r;this._dead=false}free(){this._dead=true}allocPacket(t){let r=4+1+t;let n=8-(r&8-1);if(n<4)n+=8;r+=n;const i=Buffer.allocUnsafe(r);p(i,r-4,0);i[4]=n;l(i,5+t,n);return i}encrypt(t){if(this._dead)return;this._onWrite(t);this.outSeqno=this.outSeqno+1>>>0}}const D=Buffer.alloc(32);const L=Buffer.alloc(16);let U;let W;let Q;class ChaChaPolyCipherNative{constructor(t){const r=t.outbound;this.outSeqno=r.seqno;this._onWrite=r.onWrite;this._encKeyMain=r.cipherKey.slice(0,32);this._encKeyPktLen=r.cipherKey.slice(32);this._dead=false}free(){this._dead=true}allocPacket(t){let r=4+1+t;let n=8-(r-4&8-1);if(n<4)n+=8;r+=n;const i=Buffer.allocUnsafe(r);p(i,r-4,0);i[4]=n;l(i,5+t,n);return i}encrypt(t){if(this._dead)return;L[0]=0;p(L,this.outSeqno,12);const r=i("chacha20",this._encKeyMain,L).update(D);const n=i("chacha20",this._encKeyPktLen,L).update(t.slice(0,4));this._onWrite(n);L[0]=1;const o=i("chacha20",this._encKeyMain,L).update(t.slice(4));this._onWrite(o);Q(W,n,n.length,o,o.length,r);const s=Buffer.allocUnsafe(16);s.set(new Uint8Array(U.HEAPU8.buffer,W,16),0);this._onWrite(s);this.outSeqno=this.outSeqno+1>>>0}}class ChaChaPolyCipherBinding{constructor(t){const r=t.outbound;this.outSeqno=r.seqno;this._onWrite=r.onWrite;this._instance=new C(r.cipherKey);this._dead=false}free(){this._dead=true;this._instance.free()}allocPacket(t){let r=4+1+t;let n=8-(r-4&8-1);if(n<4)n+=8;r+=n;const i=Buffer.allocUnsafe(r+16);p(i,r-4,0);i[4]=n;l(i,5+t,n);return i}encrypt(t){if(this._dead)return;this._instance.encrypt(t,this.outSeqno);this._onWrite(t);this.outSeqno=this.outSeqno+1>>>0}}class AESGCMCipherNative{constructor(t){const r=t.outbound;this.outSeqno=r.seqno;this._onWrite=r.onWrite;this._encSSLName=r.cipherInfo.sslName;this._encKey=r.cipherKey;this._encIV=r.cipherIV;this._dead=false}free(){this._dead=true}allocPacket(t){let r=4+1+t;let n=16-(r-4&16-1);if(n<4)n+=16;r+=n;const i=Buffer.allocUnsafe(r);p(i,r-4,0);i[4]=n;l(i,5+t,n);return i}encrypt(t){if(this._dead)return;const r=i(this._encSSLName,this._encKey,this._encIV);r.setAutoPadding(false);const n=t.slice(0,4);r.setAAD(n);this._onWrite(n);const o=r.update(t.slice(4));this._onWrite(o);const s=r.final();if(s.length)this._onWrite(s);const l=r.getAuthTag();this._onWrite(l);ivIncrement(this._encIV);this.outSeqno=this.outSeqno+1>>>0}}class AESGCMCipherBinding{constructor(t){const r=t.outbound;this.outSeqno=r.seqno;this._onWrite=r.onWrite;this._instance=new I(r.cipherInfo.sslName,r.cipherKey,r.cipherIV);this._dead=false}free(){this._dead=true;this._instance.free()}allocPacket(t){let r=4+1+t;let n=16-(r-4&16-1);if(n<4)n+=16;r+=n;const i=Buffer.allocUnsafe(r+16);p(i,r-4,0);i[4]=n;l(i,5+t,n);return i}encrypt(t){if(this._dead)return;this._instance.encrypt(t);this._onWrite(t);this.outSeqno=this.outSeqno+1>>>0}}class GenericCipherNative{constructor(t){const r=t.outbound;this.outSeqno=r.seqno;this._onWrite=r.onWrite;this._encBlockLen=r.cipherInfo.blockLen;this._cipherInstance=i(r.cipherInfo.sslName,r.cipherKey,r.cipherIV);this._macSSLName=r.macInfo.sslName;this._macKey=r.macKey;this._macActualLen=r.macInfo.actualLen;this._macETM=r.macInfo.isETM;this._aadLen=this._macETM?4:0;this._dead=false;const n=r.cipherInfo.discardLen;if(n){let t=b.get(n);if(t===undefined){t=Buffer.alloc(n);b.set(n,t)}this._cipherInstance.update(t)}}free(){this._dead=true}allocPacket(t){const r=this._encBlockLen;let n=4+1+t;let i=r-(n-this._aadLen&r-1);if(i<4)i+=r;n+=i;const o=Buffer.allocUnsafe(n);p(o,n-4,0);o[4]=i;l(o,5+t,i);return o}encrypt(t){if(this._dead)return;let r;if(this._macETM){const n=new Uint8Array(t.buffer,t.byteOffset,4);const i=this._cipherInstance.update(new Uint8Array(t.buffer,t.byteOffset+4,t.length-4));this._onWrite(n);this._onWrite(i);r=s(this._macSSLName,this._macKey);p(E,this.outSeqno,0);r.update(E);r.update(n);r.update(i)}else{const n=this._cipherInstance.update(t);this._onWrite(n);r=s(this._macSSLName,this._macKey);p(E,this.outSeqno,0);r.update(E);r.update(t)}let n=r.digest();if(n.length>this._macActualLen)n=n.slice(0,this._macActualLen);this._onWrite(n);this.outSeqno=this.outSeqno+1>>>0}}class GenericCipherBinding{constructor(t){const r=t.outbound;this.outSeqno=r.seqno;this._onWrite=r.onWrite;this._encBlockLen=r.cipherInfo.blockLen;this._macLen=r.macInfo.len;this._macActualLen=r.macInfo.actualLen;this._aadLen=r.macInfo.isETM?4:0;this._instance=new R(r.cipherInfo.sslName,r.cipherKey,r.cipherIV,r.macInfo.sslName,r.macKey,r.macInfo.isETM);this._dead=false}free(){this._dead=true;this._instance.free()}allocPacket(t){const r=this._encBlockLen;let n=4+1+t;let i=r-(n-this._aadLen&r-1);if(i<4)i+=r;n+=i;const o=Buffer.allocUnsafe(n+this._macLen);p(o,n-4,0);o[4]=i;l(o,5+t,i);return o}encrypt(t){if(this._dead)return;this._instance.encrypt(t,this.outSeqno);if(this._macActualLen<this._macLen){t=new g(t.buffer,t.byteOffset,t.length-(this._macLen-this._macActualLen))}this._onWrite(t);this.outSeqno=this.outSeqno+1>>>0}}class NullDecipher{constructor(t,r){this.inSeqno=t;this._onPayload=r;this._len=0;this._lenBytes=0;this._packet=null;this._packetPos=0}free(){}decrypt(t,r,n){while(r<n){if(this._lenBytes<4){let i=Math.min(4-this._lenBytes,n-r);this._lenBytes+=i;while(i--)this._len=(this._len<<8)+t[r++];if(this._lenBytes<4)return;if(this._len>y||this._len<8||(4+this._len&7)!==0){throw new Error("Bad packet length")}if(r>=n)return}if(this._packetPos<this._len){const i=Math.min(this._len-this._packetPos,n-r);if(r!==0||i!==n){if(i===this._len){this._packet=new g(t.buffer,t.byteOffset+r,i)}else{this._packet=Buffer.allocUnsafe(this._len);this._packet.set(new Uint8Array(t.buffer,t.byteOffset+r,i),this._packetPos)}}else if(i===this._len){this._packet=t}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(t,this._packetPos)}r+=i;this._packetPos+=i;if(this._packetPos<this._len)return}const i=!this._packet?_:new g(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._len=0;this._lenBytes=0;this._packet=null;this._packetPos=0;{const t=this._onPayload(i);if(t!==undefined)return t===false?r:t}}}}class ChaChaPolyDecipherNative{constructor(t){const r=t.inbound;this.inSeqno=r.seqno;this._onPayload=r.onPayload;this._decKeyMain=r.decipherKey.slice(0,32);this._decKeyPktLen=r.decipherKey.slice(32);this._len=0;this._lenBuf=Buffer.alloc(4);this._lenPos=0;this._packet=null;this._pktLen=0;this._mac=Buffer.allocUnsafe(16);this._calcMac=Buffer.allocUnsafe(16);this._macPos=0}free(){}decrypt(t,r,n){while(r<n){if(this._lenPos<4){let i=Math.min(4-this._lenPos,n-r);while(i--)this._lenBuf[this._lenPos++]=t[r++];if(this._lenPos<4)return;L[0]=0;p(L,this.inSeqno,12);const s=o("chacha20",this._decKeyPktLen,L).update(this._lenBuf);this._len=h(s,0);if(this._len>y||this._len<8||(this._len&7)!==0){throw new Error("Bad packet length")}}if(this._pktLen<this._len){if(r>=n)return;const i=Math.min(this._len-this._pktLen,n-r);let o;if(r!==0||i!==n)o=new Uint8Array(t.buffer,t.byteOffset+r,i);else o=t;if(i===this._len){this._packet=o}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(o,this._pktLen)}r+=i;this._pktLen+=i;if(this._pktLen<this._len||r>=n)return}{const i=Math.min(16-this._macPos,n-r);if(r!==0||i!==n){this._mac.set(new Uint8Array(t.buffer,t.byteOffset+r,i),this._macPos)}else{this._mac.set(t,this._macPos)}r+=i;this._macPos+=i;if(this._macPos<16)return}L[0]=0;p(L,this.inSeqno,12);const s=i("chacha20",this._decKeyMain,L).update(D);Q(W,this._lenBuf,4,this._packet,this._packet.length,s);this._calcMac.set(new Uint8Array(U.HEAPU8.buffer,W,16),0);if(!u(this._calcMac,this._mac))throw new Error("Invalid MAC");L[0]=1;const l=o("chacha20",this._decKeyMain,L).update(this._packet);const m=new g(l.buffer,l.byteOffset+1,l.length-l[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._len=0;this._lenPos=0;this._packet=null;this._pktLen=0;this._macPos=0;{const t=this._onPayload(m);if(t!==undefined)return t===false?r:t}}}}class ChaChaPolyDecipherBinding{constructor(t){const r=t.inbound;this.inSeqno=r.seqno;this._onPayload=r.onPayload;this._instance=new k(r.decipherKey);this._len=0;this._lenBuf=Buffer.alloc(4);this._lenPos=0;this._packet=null;this._pktLen=0;this._mac=Buffer.allocUnsafe(16);this._macPos=0}free(){this._instance.free()}decrypt(t,r,n){while(r<n){if(this._lenPos<4){let i=Math.min(4-this._lenPos,n-r);while(i--)this._lenBuf[this._lenPos++]=t[r++];if(this._lenPos<4)return;this._len=this._instance.decryptLen(this._lenBuf,this.inSeqno);if(this._len>y||this._len<8||(this._len&7)!==0){throw new Error("Bad packet length")}if(r>=n)return}if(this._pktLen<this._len){const i=Math.min(this._len-this._pktLen,n-r);let o;if(r!==0||i!==n)o=new Uint8Array(t.buffer,t.byteOffset+r,i);else o=t;if(i===this._len){this._packet=o}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(o,this._pktLen)}r+=i;this._pktLen+=i;if(this._pktLen<this._len||r>=n)return}{const i=Math.min(16-this._macPos,n-r);if(r!==0||i!==n){this._mac.set(new Uint8Array(t.buffer,t.byteOffset+r,i),this._macPos)}else{this._mac.set(t,this._macPos)}r+=i;this._macPos+=i;if(this._macPos<16)return}this._instance.decrypt(this._packet,this._mac,this.inSeqno);const i=new g(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._len=0;this._lenPos=0;this._packet=null;this._pktLen=0;this._macPos=0;{const t=this._onPayload(i);if(t!==undefined)return t===false?r:t}}}}class AESGCMDecipherNative{constructor(t){const r=t.inbound;this.inSeqno=r.seqno;this._onPayload=r.onPayload;this._decipherInstance=null;this._decipherSSLName=r.decipherInfo.sslName;this._decipherKey=r.decipherKey;this._decipherIV=r.decipherIV;this._len=0;this._lenBytes=0;this._packet=null;this._packetPos=0;this._pktLen=0;this._tag=Buffer.allocUnsafe(16);this._tagPos=0}free(){}decrypt(t,r,n){while(r<n){if(this._lenBytes<4){let i=Math.min(4-this._lenBytes,n-r);this._lenBytes+=i;while(i--)this._len=(this._len<<8)+t[r++];if(this._lenBytes<4)return;if(this._len+20>y||this._len<16||(this._len&15)!==0){throw new Error("Bad packet length")}this._decipherInstance=o(this._decipherSSLName,this._decipherKey,this._decipherIV);this._decipherInstance.setAutoPadding(false);this._decipherInstance.setAAD(q(this._len))}if(this._pktLen<this._len){if(r>=n)return;const i=Math.min(this._len-this._pktLen,n-r);let o;if(r!==0||i!==n){o=this._decipherInstance.update(new Uint8Array(t.buffer,t.byteOffset+r,i))}else{o=this._decipherInstance.update(t)}if(o.length){if(i===this._len){this._packet=o}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(o,this._packetPos)}this._packetPos+=o.length}r+=i;this._pktLen+=i;if(this._pktLen<this._len||r>=n)return}{const i=Math.min(16-this._tagPos,n-r);if(r!==0||i!==n){this._tag.set(new Uint8Array(t.buffer,t.byteOffset+r,i),this._tagPos)}else{this._tag.set(t,this._tagPos)}r+=i;this._tagPos+=i;if(this._tagPos<16)return}{this._decipherInstance.setAuthTag(this._tag);const t=this._decipherInstance.final();if(t.length){if(this._packet)this._packet.set(t,this._packetPos);else this._packet=t}}const i=!this._packet?_:new g(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;ivIncrement(this._decipherIV);this._len=0;this._lenBytes=0;this._packet=null;this._packetPos=0;this._pktLen=0;this._tagPos=0;{const t=this._onPayload(i);if(t!==undefined)return t===false?r:t}}}}class AESGCMDecipherBinding{constructor(t){const r=t.inbound;this.inSeqno=r.seqno;this._onPayload=r.onPayload;this._instance=new B(r.decipherInfo.sslName,r.decipherKey,r.decipherIV);this._len=0;this._lenBytes=0;this._packet=null;this._pktLen=0;this._tag=Buffer.allocUnsafe(16);this._tagPos=0}free(){}decrypt(t,r,n){while(r<n){if(this._lenBytes<4){let i=Math.min(4-this._lenBytes,n-r);this._lenBytes+=i;while(i--)this._len=(this._len<<8)+t[r++];if(this._lenBytes<4)return;if(this._len+20>y||this._len<16||(this._len&15)!==0){throw new Error(`Bad packet length: ${this._len}`)}}if(this._pktLen<this._len){if(r>=n)return;const i=Math.min(this._len-this._pktLen,n-r);let o;if(r!==0||i!==n)o=new Uint8Array(t.buffer,t.byteOffset+r,i);else o=t;if(i===this._len){this._packet=o}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(o,this._pktLen)}r+=i;this._pktLen+=i;if(this._pktLen<this._len||r>=n)return}{const i=Math.min(16-this._tagPos,n-r);if(r!==0||i!==n){this._tag.set(new Uint8Array(t.buffer,t.byteOffset+r,i),this._tagPos)}else{this._tag.set(t,this._tagPos)}r+=i;this._tagPos+=i;if(this._tagPos<16)return}this._instance.decrypt(this._packet,this._len,this._tag);const i=new g(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._len=0;this._lenBytes=0;this._packet=null;this._pktLen=0;this._tagPos=0;{const t=this._onPayload(i);if(t!==undefined)return t===false?r:t}}}}class GenericDecipherNative{constructor(t){const r=t.inbound;this.inSeqno=r.seqno;this._onPayload=r.onPayload;this._decipherInstance=o(r.decipherInfo.sslName,r.decipherKey,r.decipherIV);this._decipherInstance.setAutoPadding(false);this._block=Buffer.allocUnsafe(r.macInfo.isETM?4:r.decipherInfo.blockLen);this._blockSize=r.decipherInfo.blockLen;this._blockPos=0;this._len=0;this._packet=null;this._packetPos=0;this._pktLen=0;this._mac=Buffer.allocUnsafe(r.macInfo.actualLen);this._macPos=0;this._macSSLName=r.macInfo.sslName;this._macKey=r.macKey;this._macActualLen=r.macInfo.actualLen;this._macETM=r.macInfo.isETM;this._macInstance=null;const n=r.decipherInfo.discardLen;if(n){let t=b.get(n);if(t===undefined){t=Buffer.alloc(n);b.set(n,t)}this._decipherInstance.update(t)}}free(){}decrypt(t,r,n){while(r<n){if(this._blockPos<this._block.length){const i=Math.min(this._block.length-this._blockPos,n-r);if(r!==0||i!==n||i<t.length){this._block.set(new Uint8Array(t.buffer,t.byteOffset+r,i),this._blockPos)}else{this._block.set(t,this._blockPos)}r+=i;this._blockPos+=i;if(this._blockPos<this._block.length)return;let o;let l;if(this._macETM){this._len=l=h(this._block,0)}else{o=this._decipherInstance.update(this._block);this._len=h(o,0);l=4+this._len-this._blockSize}if(this._len>y||this._len<5||(l&this._blockSize-1)!==0){throw new Error("Bad packet length")}this._macInstance=s(this._macSSLName,this._macKey);p(E,this.inSeqno,0);this._macInstance.update(E);if(this._macETM){this._macInstance.update(this._block)}else{this._macInstance.update(new Uint8Array(o.buffer,o.byteOffset,4));this._pktLen=o.length-4;this._packetPos=this._pktLen;this._packet=Buffer.allocUnsafe(this._len);this._packet.set(new Uint8Array(o.buffer,o.byteOffset+4,this._packetPos),0)}if(r>=n)return}if(this._pktLen<this._len){const i=Math.min(this._len-this._pktLen,n-r);let o;if(r!==0||i!==n)o=new Uint8Array(t.buffer,t.byteOffset+r,i);else o=t;if(this._macETM)this._macInstance.update(o);const s=this._decipherInstance.update(o);if(s.length){if(i===this._len){this._packet=s}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(s,this._packetPos)}this._packetPos+=s.length}r+=i;this._pktLen+=i;if(this._pktLen<this._len||r>=n)return}{const i=Math.min(this._macActualLen-this._macPos,n-r);if(r!==0||i!==n){this._mac.set(new Uint8Array(t.buffer,t.byteOffset+r,i),this._macPos)}else{this._mac.set(t,this._macPos)}r+=i;this._macPos+=i;if(this._macPos<this._macActualLen)return}if(!this._macETM)this._macInstance.update(this._packet);let i=this._macInstance.digest();if(this._macActualLen<i.length){i=new Uint8Array(i.buffer,i.byteOffset,this._macActualLen)}if(!timingSafeEquals(i,this._mac))throw new Error("Invalid MAC");const o=new g(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._blockPos=0;this._len=0;this._packet=null;this._packetPos=0;this._pktLen=0;this._macPos=0;this._macInstance=null;{const t=this._onPayload(o);if(t!==undefined)return t===false?r:t}}}}class GenericDecipherBinding{constructor(t){const r=t.inbound;this.inSeqno=r.seqno;this._onPayload=r.onPayload;this._instance=new v(r.decipherInfo.sslName,r.decipherKey,r.decipherIV,r.macInfo.sslName,r.macKey,r.macInfo.isETM,r.macInfo.actualLen);this._block=Buffer.allocUnsafe(r.macInfo.isETM||r.decipherInfo.stream?4:r.decipherInfo.blockLen);this._blockPos=0;this._len=0;this._packet=null;this._pktLen=0;this._mac=Buffer.allocUnsafe(r.macInfo.actualLen);this._macPos=0;this._macActualLen=r.macInfo.actualLen;this._macETM=r.macInfo.isETM}free(){this._instance.free()}decrypt(t,r,n){while(r<n){if(this._blockPos<this._block.length){const i=Math.min(this._block.length-this._blockPos,n-r);if(r!==0||i!==n||i<t.length){this._block.set(new Uint8Array(t.buffer,t.byteOffset+r,i),this._blockPos)}else{this._block.set(t,this._blockPos)}r+=i;this._blockPos+=i;if(this._blockPos<this._block.length)return;let o;if(this._macETM){this._len=o=h(this._block,0)}else{this._instance.decryptBlock(this._block);this._len=h(this._block,0);o=4+this._len-this._block.length}if(this._len>y||this._len<5||(o&this._block.length-1)!==0){throw new Error("Bad packet length")}if(!this._macETM){this._pktLen=this._block.length-4;if(this._pktLen){this._packet=Buffer.allocUnsafe(this._len);this._packet.set(new Uint8Array(this._block.buffer,this._block.byteOffset+4,this._pktLen),0)}}if(r>=n)return}if(this._pktLen<this._len){const i=Math.min(this._len-this._pktLen,n-r);let o;if(r!==0||i!==n)o=new Uint8Array(t.buffer,t.byteOffset+r,i);else o=t;if(i===this._len){this._packet=o}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(o,this._pktLen)}r+=i;this._pktLen+=i;if(this._pktLen<this._len||r>=n)return}{const i=Math.min(this._macActualLen-this._macPos,n-r);if(r!==0||i!==n){this._mac.set(new Uint8Array(t.buffer,t.byteOffset+r,i),this._macPos)}else{this._mac.set(t,this._macPos)}r+=i;this._macPos+=i;if(this._macPos<this._macActualLen)return}this._instance.decrypt(this._packet,this.inSeqno,this._block,this._mac);const i=new g(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._blockPos=0;this._len=0;this._packet=null;this._pktLen=0;this._macPos=0;this._macInstance=null;{const t=this._onPayload(i);if(t!==undefined)return t===false?r:t}}}}function ivIncrement(t){++t[11]>>>8&&++t[10]>>>8&&++t[9]>>>8&&++t[8]>>>8&&++t[7]>>>8&&++t[6]>>>8&&++t[5]>>>8&&++t[4]>>>8}const q=(()=>{const t=Buffer.alloc(4);return r=>{t[0]=r>>>24;t[1]=r>>>16;t[2]=r>>>8;t[3]=r;return t}})();function timingSafeEquals(t,r){if(t.length!==r.length){u(t,t);return false}return u(t,r)}function createCipher(t){if(typeof t!=="object"||t===null)throw new Error("Invalid config");if(typeof t.outbound!=="object"||t.outbound===null)throw new Error("Invalid outbound");const r=t.outbound;if(typeof r.onWrite!=="function")throw new Error("Invalid outbound.onWrite");if(typeof r.cipherInfo!=="object"||r.cipherInfo===null)throw new Error("Invalid outbound.cipherInfo");if(!Buffer.isBuffer(r.cipherKey)||r.cipherKey.length!==r.cipherInfo.keyLen){throw new Error("Invalid outbound.cipherKey")}if(r.cipherInfo.ivLen&&(!Buffer.isBuffer(r.cipherIV)||r.cipherIV.length!==r.cipherInfo.ivLen)){throw new Error("Invalid outbound.cipherIV")}if(typeof r.seqno!=="number"||r.seqno<0||r.seqno>m){throw new Error("Invalid outbound.seqno")}const n=!!r.forceNative;switch(r.cipherInfo.sslName){case"aes-128-gcm":case"aes-256-gcm":return I&&!n?new AESGCMCipherBinding(t):new AESGCMCipherNative(t);case"chacha20":return C&&!n?new ChaChaPolyCipherBinding(t):new ChaChaPolyCipherNative(t);default:{if(typeof r.macInfo!=="object"||r.macInfo===null)throw new Error("Invalid outbound.macInfo");if(!Buffer.isBuffer(r.macKey)||r.macKey.length!==r.macInfo.len){throw new Error("Invalid outbound.macKey")}return R&&!n?new GenericCipherBinding(t):new GenericCipherNative(t)}}}function createDecipher(t){if(typeof t!=="object"||t===null)throw new Error("Invalid config");if(typeof t.inbound!=="object"||t.inbound===null)throw new Error("Invalid inbound");const r=t.inbound;if(typeof r.onPayload!=="function")throw new Error("Invalid inbound.onPayload");if(typeof r.decipherInfo!=="object"||r.decipherInfo===null){throw new Error("Invalid inbound.decipherInfo")}if(!Buffer.isBuffer(r.decipherKey)||r.decipherKey.length!==r.decipherInfo.keyLen){throw new Error("Invalid inbound.decipherKey")}if(r.decipherInfo.ivLen&&(!Buffer.isBuffer(r.decipherIV)||r.decipherIV.length!==r.decipherInfo.ivLen)){throw new Error("Invalid inbound.decipherIV")}if(typeof r.seqno!=="number"||r.seqno<0||r.seqno>m){throw new Error("Invalid inbound.seqno")}const n=!!r.forceNative;switch(r.decipherInfo.sslName){case"aes-128-gcm":case"aes-256-gcm":return B&&!n?new AESGCMDecipherBinding(t):new AESGCMDecipherNative(t);case"chacha20":return k&&!n?new ChaChaPolyDecipherBinding(t):new ChaChaPolyDecipherNative(t);default:{if(typeof r.macInfo!=="object"||r.macInfo===null)throw new Error("Invalid inbound.macInfo");if(!Buffer.isBuffer(r.macKey)||r.macKey.length!==r.macInfo.len){throw new Error("Invalid inbound.macKey")}return v&&!n?new GenericDecipherBinding(t):new GenericDecipherNative(t)}}}t.exports={CIPHER_INFO:P,MAC_INFO:O,bindingAvailable:!!w,init:(()=>new Promise((async(t,r)=>{try{U=await n(4989)();W=U._malloc(16);Q=U.cwrap("poly1305_auth",null,["number","array","number","array","number","array"])}catch(t){return r(t)}t()})))(),NullCipher:NullCipher,createCipher:createCipher,NullDecipher:NullDecipher,createDecipher:createDecipher}},4989:(t,r,n)=>{var i=function(){var t=typeof document!=="undefined"&&document.currentScript?document.currentScript.src:undefined;if(typeof __filename!=="undefined")t=t||__filename;return function(r){r=r||{};var i;i||(i=typeof r!=="undefined"?r:{});var o,s;i.ready=new Promise((function(t,r){o=t;s=r}));var l={},u;for(u in i)i.hasOwnProperty(u)&&(l[u]=i[u]);var h="object"===typeof window,p="function"===typeof importScripts,g="object"===typeof process&&"object"===typeof process.versions&&"string"===typeof process.versions.node,m="",_,E,b,y,w;if(g)m=p?n(5622).dirname(m)+"/":__dirname+"/",_=function(t,r){var i=H(t);if(i)return r?i:i.toString();y||(y=n(5747));w||(w=n(5622));t=w.normalize(t);return y.readFileSync(t,r?null:"utf8")},b=function(t){t=_(t,!0);t.buffer||(t=new Uint8Array(t));assert(t.buffer);return t},E=function(t,r,i){var o=H(t);o&&r(o);y||(y=n(5747));w||(w=n(5622));t=w.normalize(t);y.readFile(t,(function(t,n){t?i(t):r(n.buffer)}))},1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),i.inspect=function(){return"[Emscripten Module object]"};else if(h||p)p?m=self.location.href:"undefined"!==typeof document&&document.currentScript&&(m=document.currentScript.src),t&&(m=t),0!==m.indexOf("blob:")?m=m.substr(0,m.lastIndexOf("/")+1):m="",_=function(t){try{var r=new XMLHttpRequest;r.open("GET",t,!1);r.send(null);return r.responseText}catch(o){if(t=H(t)){r=[];for(var n=0;n<t.length;n++){var i=t[n];255<i&&(z&&assert(!1,"Character code "+i+" ("+String.fromCharCode(i)+")  at offset "+n+" not in 0x00-0xFF."),i&=255);r.push(String.fromCharCode(i))}return r.join("")}throw o}},p&&(b=function(t){try{var r=new XMLHttpRequest;r.open("GET",t,!1);r.responseType="arraybuffer";r.send(null);return new Uint8Array(r.response)}catch(r){if(t=H(t))return t;throw r}}),E=function(t,r,n){var i=new XMLHttpRequest;i.open("GET",t,!0);i.responseType="arraybuffer";i.onload=function(){if(200==i.status||0==i.status&&i.response)r(i.response);else{var o=H(t);o?r(o.buffer):n()}};i.onerror=n;i.send(null)};i.print||console.log.bind(console);var I=i.printErr||console.warn.bind(console);for(u in l)l.hasOwnProperty(u)&&(i[u]=l[u]);l=null;var C;i.wasmBinary&&(C=i.wasmBinary);var R=i.noExitRuntime||!0;"object"!==typeof WebAssembly&&K("no native wasm support detected");var B,k=!1;function assert(t,r){t||K("Assertion failed: "+r)}function N(t){var r=i["_"+t];assert(r,"Cannot call unknown function "+t+", make sure it is exported");return r}function ca(t,r,n,i){var o={string:function(t){var r=0;if(null!==t&&void 0!==t&&0!==t){var n=(t.length<<2)+1;r=re(n);var i=r,o=O;if(0<n){n=i+n-1;for(var s=0;s<t.length;++s){var l=t.charCodeAt(s);if(55296<=l&&57343>=l){var u=t.charCodeAt(++s);l=65536+((l&1023)<<10)|u&1023}if(127>=l){if(i>=n)break;o[i++]=l}else{if(2047>=l){if(i+1>=n)break;o[i++]=192|l>>6}else{if(65535>=l){if(i+2>=n)break;o[i++]=224|l>>12}else{if(i+3>=n)break;o[i++]=240|l>>18;o[i++]=128|l>>12&63}o[i++]=128|l>>6&63}o[i++]=128|l&63}}o[i]=0}}return r},array:function(t){var r=re(t.length);P.set(t,r);return r}},s=N(t),l=[];t=0;if(i)for(var u=0;u<i.length;u++){var h=o[n[u]];h?(0===t&&(t=ee()),l[u]=h(i[u])):l[u]=i[u]}n=s.apply(null,l);n=function(t){if("string"===r)if(t){for(var n=O,i=t+NaN,o=t;n[o]&&!(o>=i);)++o;if(16<o-t&&n.subarray&&v)t=v.decode(n.subarray(t,o));else{for(i="";t<o;){var s=n[t++];if(s&128){var l=n[t++]&63;if(192==(s&224))i+=String.fromCharCode((s&31)<<6|l);else{var u=n[t++]&63;s=224==(s&240)?(s&15)<<12|l<<6|u:(s&7)<<18|l<<12|u<<6|n[t++]&63;65536>s?i+=String.fromCharCode(s):(s-=65536,i+=String.fromCharCode(55296|s>>10,56320|s&1023))}}else i+=String.fromCharCode(s)}t=i}}else t="";else t="boolean"===r?!!t:t;return t}(n);0!==t&&te(t);return n}var v="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0,T,P,O;function ia(){var t=B.buffer;T=t;i.HEAP8=P=new Int8Array(t);i.HEAP16=new Int16Array(t);i.HEAP32=new Int32Array(t);i.HEAPU8=O=new Uint8Array(t);i.HEAPU16=new Uint16Array(t);i.HEAPU32=new Uint32Array(t);i.HEAPF32=new Float32Array(t);i.HEAPF64=new Float64Array(t)}var D,L=[],U=[],W=[];function ma(){var t=i.preRun.shift();L.unshift(t)}var Q=0,q=null,$=null;i.preloadedImages={};i.preloadedAudios={};function K(t){if(i.onAbort)i.onAbort(t);I(t);k=!0;t=new WebAssembly.RuntimeError("abort("+t+"). Build with -s ASSERTIONS=1 for more info.");s(t);throw t}var j="data:application/octet-stream;base64,",G;G="data:application/octet-stream;base64,AGFzbQEAAAABIAZgAX8Bf2ADf39/AGABfwBgAABgAAF/YAZ/f39/f38AAgcBAWEBYQAAAwsKAAEDAQAAAgQFAgQFAXABAQEFBwEBgAKAgAIGCQF/AUGAjMACCwclCQFiAgABYwADAWQACQFlAAgBZgAHAWcABgFoAAUBaQAKAWoBAAqGTQpPAQJ/QYAIKAIAIgEgAEEDakF8cSICaiEAAkAgAkEAIAAgAU0bDQAgAD8AQRB0SwRAIAAQAEUNAQtBgAggADYCACABDwtBhAhBMDYCAEF/C4wFAg5+Cn8gACgCJCEUIAAoAiAhFSAAKAIcIREgACgCGCESIAAoAhQhEyACQRBPBEAgAC0ATEVBGHQhFyAAKAIEIhZBBWytIQ8gACgCCCIYQQVsrSENIAAoAgwiGUEFbK0hCyAAKAIQIhpBBWytIQkgADUCACEIIBqtIRAgGa0hDiAYrSEMIBatIQoDQCASIAEtAAMiEiABLQAEQQh0ciABLQAFQRB0ciABLQAGIhZBGHRyQQJ2Qf///x9xaq0iAyAOfiABLwAAIAEtAAJBEHRyIBNqIBJBGHRBgICAGHFqrSIEIBB+fCARIAEtAAdBCHQgFnIgAS0ACEEQdHIgAS0ACSIRQRh0ckEEdkH///8fcWqtIgUgDH58IAEtAApBCHQgEXIgAS0AC0EQdHIgAS0ADEEYdHJBBnYgFWqtIgYgCn58IBQgF2ogAS8ADSABLQAPQRB0cmqtIgcgCH58IAMgDH4gBCAOfnwgBSAKfnwgBiAIfnwgByAJfnwgAyAKfiAEIAx+fCAFIAh+fCAGIAl+fCAHIAt+fCADIAh+IAQgCn58IAUgCX58IAYgC358IAcgDX58IAMgCX4gBCAIfnwgBSALfnwgBiANfnwgByAPfnwiA0IaiEL/////D4N8IgRCGohC/////w+DfCIFQhqIQv////8Pg3wiBkIaiEL/////D4N8IgdCGoinQQVsIAOnQf///x9xaiITQRp2IASnQf///x9xaiESIAWnQf///x9xIREgBqdB////H3EhFSAHp0H///8fcSEUIBNB////H3EhEyABQRBqIQEgAkEQayICQQ9LDQALCyAAIBQ2AiQgACAVNgIgIAAgETYCHCAAIBI2AhggACATNgIUCwMAAQu2BAEGfwJAIAAoAjgiBARAIABBPGohBQJAIAJBECAEayIDIAIgA0kbIgZFDQAgBkEDcSEHAkAgBkEBa0EDSQRAQQAhAwwBCyAGQXxxIQhBACEDA0AgBSADIARqaiABIANqLQAAOgAAIAUgA0EBciIEIAAoAjhqaiABIARqLQAAOgAAIAUgA0ECciIEIAAoAjhqaiABIARqLQAAOgAAIAUgA0EDciIEIAAoAjhqaiABIARqLQAAOgAAIANBBGohAyAAKAI4IQQgCEEEayIIDQALCyAHRQ0AA0AgBSADIARqaiABIANqLQAAOgAAIANBAWohAyAAKAI4IQQgB0EBayIHDQALCyAAIAQgBmoiAzYCOCADQRBJDQEgACAFQRAQAiAAQQA2AjggAiAGayECIAEgBmohAQsgAkEQTwRAIAAgASACQXBxIgMQAiACQQ9xIQIgASADaiEBCyACRQ0AIAJBA3EhBCAAQTxqIQVBACEDIAJBAWtBA08EQCACQXxxIQcDQCAFIAAoAjggA2pqIAEgA2otAAA6AAAgBSADQQFyIgYgACgCOGpqIAEgBmotAAA6AAAgBSADQQJyIgYgACgCOGpqIAEgBmotAAA6AAAgBSADQQNyIgYgACgCOGpqIAEgBmotAAA6AAAgA0EEaiEDIAdBBGsiBw0ACwsgBARAA0AgBSAAKAI4IANqaiABIANqLQAAOgAAIANBAWohAyAEQQFrIgQNAAsLIAAgACgCOCACajYCOAsLoS0BDH8jAEEQayIMJAACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgAEH0AU0EQEGICCgCACIFQRAgAEELakF4cSAAQQtJGyIIQQN2IgJ2IgFBA3EEQCABQX9zQQFxIAJqIgNBA3QiAUG4CGooAgAiBEEIaiEAAkAgBCgCCCICIAFBsAhqIgFGBEBBiAggBUF+IAN3cTYCAAwBCyACIAE2AgwgASACNgIICyAEIANBA3QiAUEDcjYCBCABIARqIgEgASgCBEEBcjYCBAwNCyAIQZAIKAIAIgpNDQEgAQRAAkBBAiACdCIAQQAgAGtyIAEgAnRxIgBBACAAa3FBAWsiACAAQQx2QRBxIgJ2IgFBBXZBCHEiACACciABIAB2IgFBAnZBBHEiAHIgASAAdiIBQQF2QQJxIgByIAEgAHYiAUEBdkEBcSIAciABIAB2aiIDQQN0IgBBuAhqKAIAIgQoAggiASAAQbAIaiIARgRAQYgIIAVBfiADd3EiBTYCAAwBCyABIAA2AgwgACABNgIICyAEQQhqIQAgBCAIQQNyNgIEIAQgCGoiAiADQQN0IgEgCGsiA0EBcjYCBCABIARqIAM2AgAgCgRAIApBA3YiAUEDdEGwCGohB0GcCCgCACEEAn8gBUEBIAF0IgFxRQRAQYgIIAEgBXI2AgAgBwwBCyAHKAIICyEBIAcgBDYCCCABIAQ2AgwgBCAHNgIMIAQgATYCCAtBnAggAjYCAEGQCCADNgIADA0LQYwIKAIAIgZFDQEgBkEAIAZrcUEBayIAIABBDHZBEHEiAnYiAUEFdkEIcSIAIAJyIAEgAHYiAUECdkEEcSIAciABIAB2IgFBAXZBAnEiAHIgASAAdiIBQQF2QQFxIgByIAEgAHZqQQJ0QbgKaigCACIBKAIEQXhxIAhrIQMgASECA0ACQCACKAIQIgBFBEAgAigCFCIARQ0BCyAAKAIEQXhxIAhrIgIgAyACIANJIgIbIQMgACABIAIbIQEgACECDAELCyABIAhqIgkgAU0NAiABKAIYIQsgASABKAIMIgRHBEAgASgCCCIAQZgIKAIASRogACAENgIMIAQgADYCCAwMCyABQRRqIgIoAgAiAEUEQCABKAIQIgBFDQQgAUEQaiECCwNAIAIhByAAIgRBFGoiAigCACIADQAgBEEQaiECIAQoAhAiAA0ACyAHQQA2AgAMCwtBfyEIIABBv39LDQAgAEELaiIAQXhxIQhBjAgoAgAiCUUNAEEAIAhrIQMCQAJAAkACf0EAIAhBgAJJDQAaQR8gCEH///8HSw0AGiAAQQh2IgAgAEGA/j9qQRB2QQhxIgJ0IgAgAEGA4B9qQRB2QQRxIgF0IgAgAEGAgA9qQRB2QQJxIgB0QQ92IAEgAnIgAHJrIgBBAXQgCCAAQRVqdkEBcXJBHGoLIgVBAnRBuApqKAIAIgJFBEBBACEADAELQQAhACAIQQBBGSAFQQF2ayAFQR9GG3QhAQNAAkAgAigCBEF4cSAIayIHIANPDQAgAiEEIAciAw0AQQAhAyACIQAMAwsgACACKAIUIgcgByACIAFBHXZBBHFqKAIQIgJGGyAAIAcbIQAgAUEBdCEBIAINAAsLIAAgBHJFBEBBACEEQQIgBXQiAEEAIABrciAJcSIARQ0DIABBACAAa3FBAWsiACAAQQx2QRBxIgJ2IgFBBXZBCHEiACACciABIAB2IgFBAnZBBHEiAHIgASAAdiIBQQF2QQJxIgByIAEgAHYiAUEBdkEBcSIAciABIAB2akECdEG4CmooAgAhAAsgAEUNAQsDQCAAKAIEQXhxIAhrIgEgA0khAiABIAMgAhshAyAAIAQgAhshBCAAKAIQIgEEfyABBSAAKAIUCyIADQALCyAERQ0AIANBkAgoAgAgCGtPDQAgBCAIaiIGIARNDQEgBCgCGCEFIAQgBCgCDCIBRwRAIAQoAggiAEGYCCgCAEkaIAAgATYCDCABIAA2AggMCgsgBEEUaiICKAIAIgBFBEAgBCgCECIARQ0EIARBEGohAgsDQCACIQcgACIBQRRqIgIoAgAiAA0AIAFBEGohAiABKAIQIgANAAsgB0EANgIADAkLIAhBkAgoAgAiAk0EQEGcCCgCACEDAkAgAiAIayIBQRBPBEBBkAggATYCAEGcCCADIAhqIgA2AgAgACABQQFyNgIEIAIgA2ogATYCACADIAhBA3I2AgQMAQtBnAhBADYCAEGQCEEANgIAIAMgAkEDcjYCBCACIANqIgAgACgCBEEBcjYCBAsgA0EIaiEADAsLIAhBlAgoAgAiBkkEQEGUCCAGIAhrIgE2AgBBoAhBoAgoAgAiAiAIaiIANgIAIAAgAUEBcjYCBCACIAhBA3I2AgQgAkEIaiEADAsLQQAhACAIQS9qIgkCf0HgCygCAARAQegLKAIADAELQewLQn83AgBB5AtCgKCAgICABDcCAEHgCyAMQQxqQXBxQdiq1aoFczYCAEH0C0EANgIAQcQLQQA2AgBBgCALIgFqIgVBACABayIHcSICIAhNDQpBwAsoAgAiBARAQbgLKAIAIgMgAmoiASADTQ0LIAEgBEsNCwtBxAstAABBBHENBQJAAkBBoAgoAgAiAwRAQcgLIQADQCADIAAoAgAiAU8EQCABIAAoAgRqIANLDQMLIAAoAggiAA0ACwtBABABIgFBf0YNBiACIQVB5AsoAgAiA0EBayIAIAFxBEAgAiABayAAIAFqQQAgA2txaiEFCyAFIAhNDQYgBUH+////B0sNBkHACygCACIEBEBBuAsoAgAiAyAFaiIAIANNDQcgACAESw0HCyAFEAEiACABRw0BDAgLIAUgBmsgB3EiBUH+////B0sNBSAFEAEiASAAKAIAIAAoAgRqRg0EIAEhAAsCQCAAQX9GDQAgCEEwaiAFTQ0AQegLKAIAIgEgCSAFa2pBACABa3EiAUH+////B0sEQCAAIQEMCAsgARABQX9HBEAgASAFaiEFIAAhAQwIC0EAIAVrEAEaDAULIAAiAUF/Rw0GDAQLAAtBACEEDAcLQQAhAQwFCyABQX9HDQILQcQLQcQLKAIAQQRyNgIACyACQf7///8HSw0BIAIQASEBQQAQASEAIAFBf0YNASAAQX9GDQEgACABTQ0BIAAgAWsiBSAIQShqTQ0BC0G4C0G4CygCACAFaiIANgIAQbwLKAIAIABJBEBBvAsgADYCAAsCQAJAAkBBoAgoAgAiBwRAQcgLIQADQCABIAAoAgAiAyAAKAIEIgJqRg0CIAAoAggiAA0ACwwCC0GYCCgCACIAQQAgACABTRtFBEBBmAggATYCAAtBACEAQcwLIAU2AgBByAsgATYCAEGoCEF/NgIAQawIQeALKAIANgIAQdQLQQA2AgADQCAAQQN0IgNBuAhqIANBsAhqIgI2AgAgA0G8CGogAjYCACAAQQFqIgBBIEcNAAtBlAggBUEoayIDQXggAWtBB3FBACABQQhqQQdxGyIAayICNgIAQaAIIAAgAWoiADYCACAAIAJBAXI2AgQgASADakEoNgIEQaQIQfALKAIANgIADAILIAAtAAxBCHENACADIAdLDQAgASAHTQ0AIAAgAiAFajYCBEGgCCAHQXggB2tBB3FBACAHQQhqQQdxGyIAaiICNgIAQZQIQZQIKAIAIAVqIgEgAGsiADYCACACIABBAXI2AgQgASAHakEoNgIEQaQIQfALKAIANgIADAELQZgIKAIAIAFLBEBBmAggATYCAAsgASAFaiECQcgLIQACQAJAAkACQAJAAkADQCACIAAoAgBHBEAgACgCCCIADQEMAgsLIAAtAAxBCHFFDQELQcgLIQADQCAHIAAoAgAiAk8EQCACIAAoAgRqIgQgB0sNAwsgACgCCCEADAALAAsgACABNgIAIAAgACgCBCAFajYCBCABQXggAWtBB3FBACABQQhqQQdxG2oiCSAIQQNyNgIEIAJBeCACa0EHcUEAIAJBCGpBB3EbaiIFIAggCWoiBmshAiAFIAdGBEBBoAggBjYCAEGUCEGUCCgCACACaiIANgIAIAYgAEEBcjYCBAwDCyAFQZwIKAIARgRAQZwIIAY2AgBBkAhBkAgoAgAgAmoiADYCACAGIABBAXI2AgQgACAGaiAANgIADAMLIAUoAgQiAEEDcUEBRgRAIABBeHEhBwJAIABB/wFNBEAgBSgCCCIDIABBA3YiAEEDdEGwCGpGGiADIAUoAgwiAUYEQEGICEGICCgCAEF+IAB3cTYCAAwCCyADIAE2AgwgASADNgIIDAELIAUoAhghCAJAIAUgBSgCDCIBRwRAIAUoAggiACABNgIMIAEgADYCCAwBCwJAIAVBFGoiACgCACIDDQAgBUEQaiIAKAIAIgMNAEEAIQEMAQsDQCAAIQQgAyIBQRRqIgAoAgAiAw0AIAFBEGohACABKAIQIgMNAAsgBEEANgIACyAIRQ0AAkAgBSAFKAIcIgNBAnRBuApqIgAoAgBGBEAgACABNgIAIAENAUGMCEGMCCgCAEF+IAN3cTYCAAwCCyAIQRBBFCAIKAIQIAVGG2ogATYCACABRQ0BCyABIAg2AhggBSgCECIABEAgASAANgIQIAAgATYCGAsgBSgCFCIARQ0AIAEgADYCFCAAIAE2AhgLIAUgB2ohBSACIAdqIQILIAUgBSgCBEF+cTYCBCAGIAJBAXI2AgQgAiAGaiACNgIAIAJB/wFNBEAgAkEDdiIAQQN0QbAIaiECAn9BiAgoAgAiAUEBIAB0IgBxRQRAQYgIIAAgAXI2AgAgAgwBCyACKAIICyEAIAIgBjYCCCAAIAY2AgwgBiACNgIMIAYgADYCCAwDC0EfIQAgAkH///8HTQRAIAJBCHYiACAAQYD+P2pBEHZBCHEiA3QiACAAQYDgH2pBEHZBBHEiAXQiACAAQYCAD2pBEHZBAnEiAHRBD3YgASADciAAcmsiAEEBdCACIABBFWp2QQFxckEcaiEACyAGIAA2AhwgBkIANwIQIABBAnRBuApqIQQCQEGMCCgCACIDQQEgAHQiAXFFBEBBjAggASADcjYCACAEIAY2AgAgBiAENgIYDAELIAJBAEEZIABBAXZrIABBH0YbdCEAIAQoAgAhAQNAIAEiAygCBEF4cSACRg0DIABBHXYhASAAQQF0IQAgAyABQQRxaiIEKAIQIgENAAsgBCAGNgIQIAYgAzYCGAsgBiAGNgIMIAYgBjYCCAwCC0GUCCAFQShrIgNBeCABa0EHcUEAIAFBCGpBB3EbIgBrIgI2AgBBoAggACABaiIANgIAIAAgAkEBcjYCBCABIANqQSg2AgRBpAhB8AsoAgA2AgAgByAEQScgBGtBB3FBACAEQSdrQQdxG2pBL2siACAAIAdBEGpJGyICQRs2AgQgAkHQCykCADcCECACQcgLKQIANwIIQdALIAJBCGo2AgBBzAsgBTYCAEHICyABNgIAQdQLQQA2AgAgAkEYaiEAA0AgAEEHNgIEIABBCGohASAAQQRqIQAgASAESQ0ACyACIAdGDQMgAiACKAIEQX5xNgIEIAcgAiAHayIEQQFyNgIEIAIgBDYCACAEQf8BTQRAIARBA3YiAEEDdEGwCGohAgJ/QYgIKAIAIgFBASAAdCIAcUUEQEGICCAAIAFyNgIAIAIMAQsgAigCCAshACACIAc2AgggACAHNgIMIAcgAjYCDCAHIAA2AggMBAtBHyEAIAdCADcCECAEQf///wdNBEAgBEEIdiIAIABBgP4/akEQdkEIcSICdCIAIABBgOAfakEQdkEEcSIBdCIAIABBgIAPakEQdkECcSIAdEEPdiABIAJyIAByayIAQQF0IAQgAEEVanZBAXFyQRxqIQALIAcgADYCHCAAQQJ0QbgKaiEDAkBBjAgoAgAiAkEBIAB0IgFxRQRAQYwIIAEgAnI2AgAgAyAHNgIAIAcgAzYCGAwBCyAEQQBBGSAAQQF2ayAAQR9GG3QhACADKAIAIQEDQCABIgIoAgRBeHEgBEYNBCAAQR12IQEgAEEBdCEAIAIgAUEEcWoiAygCECIBDQALIAMgBzYCECAHIAI2AhgLIAcgBzYCDCAHIAc2AggMAwsgAygCCCIAIAY2AgwgAyAGNgIIIAZBADYCGCAGIAM2AgwgBiAANgIICyAJQQhqIQAMBQsgAigCCCIAIAc2AgwgAiAHNgIIIAdBADYCGCAHIAI2AgwgByAANgIIC0GUCCgCACIAIAhNDQBBlAggACAIayIBNgIAQaAIQaAIKAIAIgIgCGoiADYCACAAIAFBAXI2AgQgAiAIQQNyNgIEIAJBCGohAAwDC0GECEEwNgIAQQAhAAwCCwJAIAVFDQACQCAEKAIcIgJBAnRBuApqIgAoAgAgBEYEQCAAIAE2AgAgAQ0BQYwIIAlBfiACd3EiCTYCAAwCCyAFQRBBFCAFKAIQIARGG2ogATYCACABRQ0BCyABIAU2AhggBCgCECIABEAgASAANgIQIAAgATYCGAsgBCgCFCIARQ0AIAEgADYCFCAAIAE2AhgLAkAgA0EPTQRAIAQgAyAIaiIAQQNyNgIEIAAgBGoiACAAKAIEQQFyNgIEDAELIAQgCEEDcjYCBCAGIANBAXI2AgQgAyAGaiADNgIAIANB/wFNBEAgA0EDdiIAQQN0QbAIaiECAn9BiAgoAgAiAUEBIAB0IgBxRQRAQYgIIAAgAXI2AgAgAgwBCyACKAIICyEAIAIgBjYCCCAAIAY2AgwgBiACNgIMIAYgADYCCAwBC0EfIQAgA0H///8HTQRAIANBCHYiACAAQYD+P2pBEHZBCHEiAnQiACAAQYDgH2pBEHZBBHEiAXQiACAAQYCAD2pBEHZBAnEiAHRBD3YgASACciAAcmsiAEEBdCADIABBFWp2QQFxckEcaiEACyAGIAA2AhwgBkIANwIQIABBAnRBuApqIQICQAJAIAlBASAAdCIBcUUEQEGMCCABIAlyNgIAIAIgBjYCACAGIAI2AhgMAQsgA0EAQRkgAEEBdmsgAEEfRht0IQAgAigCACEIA0AgCCIBKAIEQXhxIANGDQIgAEEddiECIABBAXQhACABIAJBBHFqIgIoAhAiCA0ACyACIAY2AhAgBiABNgIYCyAGIAY2AgwgBiAGNgIIDAELIAEoAggiACAGNgIMIAEgBjYCCCAGQQA2AhggBiABNgIMIAYgADYCCAsgBEEIaiEADAELAkAgC0UNAAJAIAEoAhwiAkECdEG4CmoiACgCACABRgRAIAAgBDYCACAEDQFBjAggBkF+IAJ3cTYCAAwCCyALQRBBFCALKAIQIAFGG2ogBDYCACAERQ0BCyAEIAs2AhggASgCECIABEAgBCAANgIQIAAgBDYCGAsgASgCFCIARQ0AIAQgADYCFCAAIAQ2AhgLAkAgA0EPTQRAIAEgAyAIaiIAQQNyNgIEIAAgAWoiACAAKAIEQQFyNgIEDAELIAEgCEEDcjYCBCAJIANBAXI2AgQgAyAJaiADNgIAIAoEQCAKQQN2IgBBA3RBsAhqIQRBnAgoAgAhAgJ/QQEgAHQiACAFcUUEQEGICCAAIAVyNgIAIAQMAQsgBCgCCAshACAEIAI2AgggACACNgIMIAIgBDYCDCACIAA2AggLQZwIIAk2AgBBkAggAzYCAAsgAUEIaiEACyAMQRBqJAAgAAsQACMAIABrQXBxIgAkACAACwYAIAAkAAsEACMAC4AJAgh/BH4jAEGQAWsiBiQAIAYgBS0AA0EYdEGAgIAYcSAFLwAAIAUtAAJBEHRycjYCACAGIAUoAANBAnZBg/7/H3E2AgQgBiAFKAAGQQR2Qf+B/x9xNgIIIAYgBSgACUEGdkH//8AfcTYCDCAFLwANIQggBS0ADyEJIAZCADcCFCAGQgA3AhwgBkEANgIkIAYgCCAJQRB0QYCAPHFyNgIQIAYgBSgAEDYCKCAGIAUoABQ2AiwgBiAFKAAYNgIwIAUoABwhBSAGQQA6AEwgBkEANgI4IAYgBTYCNCAGIAEgAhAEIAQEQCAGIAMgBBAECyAGKAI4IgEEQCAGQTxqIgIgAWpBAToAACABQQFqQQ9NBEAgASAGakE9aiEEAkBBDyABayIDRQ0AIAMgBGoiAUEBa0EAOgAAIARBADoAACADQQNJDQAgAUECa0EAOgAAIARBADoAASABQQNrQQA6AAAgBEEAOgACIANBB0kNACABQQRrQQA6AAAgBEEAOgADIANBCUkNACAEQQAgBGtBA3EiAWoiBEEANgIAIAQgAyABa0F8cSIBaiIDQQRrQQA2AgAgAUEJSQ0AIARBADYCCCAEQQA2AgQgA0EIa0EANgIAIANBDGtBADYCACABQRlJDQAgBEEANgIYIARBADYCFCAEQQA2AhAgBEEANgIMIANBEGtBADYCACADQRRrQQA2AgAgA0EYa0EANgIAIANBHGtBADYCACABIARBBHFBGHIiAWsiA0EgSQ0AIAEgBGohAQNAIAFCADcDGCABQgA3AxAgAUIANwMIIAFCADcDACABQSBqIQEgA0EgayIDQR9LDQALCwsgBkEBOgBMIAYgAkEQEAILIAY1AjQhECAGNQIwIREgBjUCLCEOIAAgBjUCKCAGKAIkIAYoAiAgBigCHCAGKAIYIgNBGnZqIgJBGnZqIgFBGnZqIgtBgICAYHIgAUH///8fcSINIAJB////H3EiCCAGKAIUIAtBGnZBBWxqIgFB////H3EiCUEFaiIFQRp2IANB////H3EgAUEadmoiA2oiAUEadmoiAkEadmoiBEEadmoiDEEfdSIHIANxIAEgDEEfdkEBayIDQf///x9xIgpxciIBQRp0IAUgCnEgByAJcXJyrXwiDzwAACAAIA9CGIg8AAMgACAPQhCIPAACIAAgD0IIiDwAASAAIA4gByAIcSACIApxciICQRR0IAFBBnZyrXwgD0IgiHwiDjwABCAAIA5CGIg8AAcgACAOQhCIPAAGIAAgDkIIiDwABSAAIBEgByANcSAEIApxciIBQQ50IAJBDHZyrXwgDkIgiHwiDjwACCAAIA5CGIg8AAsgACAOQhCIPAAKIAAgDkIIiDwACSAAIBAgAyAMcSAHIAtxckEIdCABQRJ2cq18IA5CIIh8Ig48AAwgACAOQhiIPAAPIAAgDkIQiDwADiAAIA5CCIg8AA0gBkIANwIwIAZCADcCKCAGQgA3AiAgBkIANwIYIAZCADcCECAGQgA3AgggBkIANwIAIAZBkAFqJAALpwwBB38CQCAARQ0AIABBCGsiAyAAQQRrKAIAIgFBeHEiAGohBQJAIAFBAXENACABQQNxRQ0BIAMgAygCACIBayIDQZgIKAIASQ0BIAAgAWohACADQZwIKAIARwRAIAFB/wFNBEAgAygCCCICIAFBA3YiBEEDdEGwCGpGGiACIAMoAgwiAUYEQEGICEGICCgCAEF+IAR3cTYCAAwDCyACIAE2AgwgASACNgIIDAILIAMoAhghBgJAIAMgAygCDCIBRwRAIAMoAggiAiABNgIMIAEgAjYCCAwBCwJAIANBFGoiAigCACIEDQAgA0EQaiICKAIAIgQNAEEAIQEMAQsDQCACIQcgBCIBQRRqIgIoAgAiBA0AIAFBEGohAiABKAIQIgQNAAsgB0EANgIACyAGRQ0BAkAgAyADKAIcIgJBAnRBuApqIgQoAgBGBEAgBCABNgIAIAENAUGMCEGMCCgCAEF+IAJ3cTYCAAwDCyAGQRBBFCAGKAIQIANGG2ogATYCACABRQ0CCyABIAY2AhggAygCECICBEAgASACNgIQIAIgATYCGAsgAygCFCICRQ0BIAEgAjYCFCACIAE2AhgMAQsgBSgCBCIBQQNxQQNHDQBBkAggADYCACAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAA8LIAMgBU8NACAFKAIEIgFBAXFFDQACQCABQQJxRQRAIAVBoAgoAgBGBEBBoAggAzYCAEGUCEGUCCgCACAAaiIANgIAIAMgAEEBcjYCBCADQZwIKAIARw0DQZAIQQA2AgBBnAhBADYCAA8LIAVBnAgoAgBGBEBBnAggAzYCAEGQCEGQCCgCACAAaiIANgIAIAMgAEEBcjYCBCAAIANqIAA2AgAPCyABQXhxIABqIQACQCABQf8BTQRAIAUoAggiAiABQQN2IgRBA3RBsAhqRhogAiAFKAIMIgFGBEBBiAhBiAgoAgBBfiAEd3E2AgAMAgsgAiABNgIMIAEgAjYCCAwBCyAFKAIYIQYCQCAFIAUoAgwiAUcEQCAFKAIIIgJBmAgoAgBJGiACIAE2AgwgASACNgIIDAELAkAgBUEUaiICKAIAIgQNACAFQRBqIgIoAgAiBA0AQQAhAQwBCwNAIAIhByAEIgFBFGoiAigCACIEDQAgAUEQaiECIAEoAhAiBA0ACyAHQQA2AgALIAZFDQACQCAFIAUoAhwiAkECdEG4CmoiBCgCAEYEQCAEIAE2AgAgAQ0BQYwIQYwIKAIAQX4gAndxNgIADAILIAZBEEEUIAYoAhAgBUYbaiABNgIAIAFFDQELIAEgBjYCGCAFKAIQIgIEQCABIAI2AhAgAiABNgIYCyAFKAIUIgJFDQAgASACNgIUIAIgATYCGAsgAyAAQQFyNgIEIAAgA2ogADYCACADQZwIKAIARw0BQZAIIAA2AgAPCyAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAAsgAEH/AU0EQCAAQQN2IgFBA3RBsAhqIQACf0GICCgCACICQQEgAXQiAXFFBEBBiAggASACcjYCACAADAELIAAoAggLIQIgACADNgIIIAIgAzYCDCADIAA2AgwgAyACNgIIDwtBHyECIANCADcCECAAQf///wdNBEAgAEEIdiIBIAFBgP4/akEQdkEIcSIBdCICIAJBgOAfakEQdkEEcSICdCIEIARBgIAPakEQdkECcSIEdEEPdiABIAJyIARyayIBQQF0IAAgAUEVanZBAXFyQRxqIQILIAMgAjYCHCACQQJ0QbgKaiEBAkACQAJAQYwIKAIAIgRBASACdCIHcUUEQEGMCCAEIAdyNgIAIAEgAzYCACADIAE2AhgMAQsgAEEAQRkgAkEBdmsgAkEfRht0IQIgASgCACEBA0AgASIEKAIEQXhxIABGDQIgAkEddiEBIAJBAXQhAiAEIAFBBHFqIgdBEGooAgAiAQ0ACyAHIAM2AhAgAyAENgIYCyADIAM2AgwgAyADNgIIDAELIAQoAggiACADNgIMIAQgAzYCCCADQQA2AhggAyAENgIMIAMgADYCCAtBqAhBqAgoAgBBAWsiAEF/IAAbNgIACwsLCQEAQYEICwIGUA==";if(!G.startsWith(j)){var Y=G;G=i.locateFile?i.locateFile(Y,m):m+Y}function pa(){var t=G;try{if(t==G&&C)return new Uint8Array(C);var r=H(t);if(r)return r;if(b)return b(t);throw"both async and sync fetching of the wasm failed"}catch(t){K(t)}}function qa(){if(!C&&(h||p)){if("function"===typeof fetch&&!G.startsWith("file://"))return fetch(G,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+G+"'";return t.arrayBuffer()})).catch((function(){return pa()}));if(E)return new Promise((function(t,r){E(G,(function(r){t(new Uint8Array(r))}),r)}))}return Promise.resolve().then((function(){return pa()}))}function X(t){for(;0<t.length;){var r=t.shift();if("function"==typeof r)r(i);else{var n=r.m;"number"===typeof n?void 0===r.l?D.get(n)():D.get(n)(r.l):n(void 0===r.l?null:r.l)}}}var z=!1,V="function"===typeof atob?atob:function(t){var r="",n=0;t=t.replace(/[^A-Za-z0-9\+\/=]/g,"");do{var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t.charAt(n++));var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t.charAt(n++));var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t.charAt(n++));var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t.charAt(n++));i=i<<2|o>>4;o=(o&15)<<4|s>>2;var u=(s&3)<<6|l;r+=String.fromCharCode(i);64!==s&&(r+=String.fromCharCode(o));64!==l&&(r+=String.fromCharCode(u))}while(n<t.length);return r};function H(t){if(t.startsWith(j)){t=t.slice(j.length);if("boolean"===typeof g&&g){var r=Buffer.from(t,"base64");r=new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}else try{var n=V(t),i=new Uint8Array(n.length);for(t=0;t<n.length;++t)i[t]=n.charCodeAt(t);r=i}catch(t){throw Error("Converting base64 string to bytes failed.")}return r}}var J={a:function(t){var r=O.length;t>>>=0;if(2147483648<t)return!1;for(var n=1;4>=n;n*=2){var i=r*(1+.2/n);i=Math.min(i,t+100663296);i=Math.max(t,i);0<i%65536&&(i+=65536-i%65536);e:{try{B.grow(Math.min(2147483648,i)-T.byteLength+65535>>>16);ia();var o=1;break e}catch(t){}o=void 0}if(o)return!0}return!1}};(function(){function a(t){i.asm=t.exports;B=i.asm.b;ia();D=i.asm.j;U.unshift(i.asm.c);Q--;i.monitorRunDependencies&&i.monitorRunDependencies(Q);0==Q&&(null!==q&&(clearInterval(q),q=null),$&&(t=$,$=null,t()))}function c(t){a(t.instance)}function d(r){return qa().then((function(r){return WebAssembly.instantiate(r,t)})).then(r,(function(t){I("failed to asynchronously prepare wasm: "+t);K(t)}))}var t={a:J};Q++;i.monitorRunDependencies&&i.monitorRunDependencies(Q);if(i.instantiateWasm)try{return i.instantiateWasm(t,a)}catch(t){return I("Module.instantiateWasm callback failed with error: "+t),!1}(function(){return C||"function"!==typeof WebAssembly.instantiateStreaming||G.startsWith(j)||G.startsWith("file://")||"function"!==typeof fetch?d(c):fetch(G,{credentials:"same-origin"}).then((function(r){return WebAssembly.instantiateStreaming(r,t).then(c,(function(t){I("wasm streaming compile failed: "+t);I("falling back to ArrayBuffer instantiation");return d(c)}))}))})().catch(s);return{}})();i.___wasm_call_ctors=function(){return(i.___wasm_call_ctors=i.asm.c).apply(null,arguments)};i._poly1305_auth=function(){return(i._poly1305_auth=i.asm.d).apply(null,arguments)};var ee=i.stackSave=function(){return(ee=i.stackSave=i.asm.e).apply(null,arguments)},te=i.stackRestore=function(){return(te=i.stackRestore=i.asm.f).apply(null,arguments)},re=i.stackAlloc=function(){return(re=i.stackAlloc=i.asm.g).apply(null,arguments)};i._malloc=function(){return(i._malloc=i.asm.h).apply(null,arguments)};i._free=function(){return(i._free=i.asm.i).apply(null,arguments)};i.cwrap=function(t,r,n,i){n=n||[];var o=n.every((function(t){return"number"===t}));return"string"!==r&&o&&!i?N(t):function(){return ca(t,r,n,arguments)}};var ne;$=function ta(){ne||Z();ne||($=ta)};function Z(){function a(){if(!ne&&(ne=!0,i.calledRun=!0,!k)){X(U);o(i);if(i.onRuntimeInitialized)i.onRuntimeInitialized();if(i.postRun)for("function"==typeof i.postRun&&(i.postRun=[i.postRun]);i.postRun.length;){var t=i.postRun.shift();W.unshift(t)}X(W)}}if(!(0<Q)){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;)ma();X(L);0<Q||(i.setStatus?(i.setStatus("Running..."),setTimeout((function(){setTimeout((function(){i.setStatus("")}),1);a()}),1)):a())}}i.run=Z;if(i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);0<i.preInit.length;)i.preInit.pop()();Z();return r.ready}}();if(true)t.exports=i;else{}},172:(t,r,n)=>{"use strict";const i=new Array(256);[n(4126).HANDLERS,n(6475)].forEach((t=>{for(let[r,n]of Object.entries(t)){r=+r;if(isFinite(r)&&r>=0&&r<i.length)i[r]=n}}));t.exports=i},6475:(t,r,n)=>{"use strict";const{bufferSlice:i,bufferParser:o,doFatalError:s,sigSSHToASN1:l,writeUInt32BE:u}=n(9475);const{CHANNEL_OPEN_FAILURE:h,COMPAT:p,MESSAGE:g,TERMINAL_MODE:m}=n(6832);const{parseKey:_}=n(2218);const E=Array.from(Object.entries(m)).reduce(((t,[r,n])=>({...t,[r]:n})),{});t.exports={[g.DISCONNECT]:(t,r)=>{o.init(r,1);const n=o.readUInt32BE();const i=o.readString(true);const l=o.readString();o.clear();if(l===undefined){return s(t,"Inbound: Malformed DISCONNECT packet")}t._debug&&t._debug(`Inbound: Received DISCONNECT (${n}, "${i}")`);const u=t._handlers.DISCONNECT;u&&u(t,n,i)},[g.IGNORE]:(t,r)=>{t._debug&&t._debug("Inbound: Received IGNORE")},[g.UNIMPLEMENTED]:(t,r)=>{o.init(r,1);const n=o.readUInt32BE();o.clear();if(n===undefined){return s(t,"Inbound: Malformed UNIMPLEMENTED packet")}t._debug&&t._debug(`Inbound: Received UNIMPLEMENTED (seqno ${n})`)},[g.DEBUG]:(t,r)=>{o.init(r,1);const n=o.readBool();const i=o.readString(true);const l=o.readString();o.clear();if(l===undefined){return s(t,"Inbound: Malformed DEBUG packet")}t._debug&&t._debug("Inbound: Received DEBUG");const u=t._handlers.DEBUG;u&&u(t,n,i)},[g.SERVICE_REQUEST]:(t,r)=>{o.init(r,1);const n=o.readString(true);o.clear();if(n===undefined){return s(t,"Inbound: Malformed SERVICE_REQUEST packet")}t._debug&&t._debug(`Inbound: Received SERVICE_REQUEST (${n})`);const i=t._handlers.SERVICE_REQUEST;i&&i(t,n)},[g.SERVICE_ACCEPT]:(t,r)=>{o.init(r,1);const n=o.readString(true);o.clear();if(n===undefined){return s(t,"Inbound: Malformed SERVICE_ACCEPT packet")}t._debug&&t._debug(`Inbound: Received SERVICE_ACCEPT (${n})`);const i=t._handlers.SERVICE_ACCEPT;i&&i(t,n)},[g.USERAUTH_REQUEST]:(t,r)=>{o.init(r,1);const n=o.readString(true);const h=o.readString(true);const p=o.readString(true);let g;let m;switch(p){case"none":g=null;break;case"password":{const t=o.readBool();if(t!==undefined){g=o.readString(true);if(g!==undefined&&t){const t=o.readString(true);if(t!==undefined)g={oldPassword:g,newPassword:t};else g=undefined}}break}case"publickey":{const n=o.readBool();if(n!==undefined){const s=o.readString(true);const h=o.readString();if(n){const n=o.pos();let p=o.readString();if(p!==undefined){if(p.length>4+s.length+4&&p.utf8Slice(4,4+s.length)===s){p=i(p,4+s.length+4)}p=l(p,s);if(p){const i=t._kex.sessionID;const o=Buffer.allocUnsafe(4+i.length+n);u(o,i.length,0);o.set(i,4);o.set(new Uint8Array(r.buffer,r.byteOffset,n),4+i.length);g={keyAlgo:s,key:h,signature:p,blob:o}}}}else{g={keyAlgo:s,key:h};m="publickey -- check"}}break}case"hostbased":{const n=o.readString(true);const s=o.readString();const h=o.readString(true);const p=o.readString(true);const m=o.pos();let _=o.readString();if(_!==undefined){if(_.length>4+n.length+4&&_.utf8Slice(4,4+n.length)===n){_=i(_,4+n.length+4)}_=l(_,n);if(_!==undefined){const i=t._kex.sessionID;const o=Buffer.allocUnsafe(4+i.length+m);u(o,i.length,0);o.set(i,4);o.set(new Uint8Array(r.buffer,r.byteOffset,m),4+i.length);g={keyAlgo:n,key:s,signature:_,blob:o,localHostname:h,localUsername:p}}}break}case"keyboard-interactive":o.skipString();g=o.readList();break;default:if(p!==undefined)g=o.readRaw()}o.clear();if(g===undefined){return s(t,"Inbound: Malformed USERAUTH_REQUEST packet")}if(m===undefined)m=p;t._authsQueue.push(p);t._debug&&t._debug(`Inbound: Received USERAUTH_REQUEST (${m})`);const _=t._handlers.USERAUTH_REQUEST;_&&_(t,n,h,p,g)},[g.USERAUTH_FAILURE]:(t,r)=>{o.init(r,1);const n=o.readList();const i=o.readBool();o.clear();if(i===undefined){return s(t,"Inbound: Malformed USERAUTH_FAILURE packet")}t._debug&&t._debug(`Inbound: Received USERAUTH_FAILURE (${n})`);t._authsQueue.shift();const l=t._handlers.USERAUTH_FAILURE;l&&l(t,n,i)},[g.USERAUTH_SUCCESS]:(t,r)=>{t._debug&&t._debug("Inbound: Received USERAUTH_SUCCESS");t._authsQueue.shift();const n=t._handlers.USERAUTH_SUCCESS;n&&n(t)},[g.USERAUTH_BANNER]:(t,r)=>{o.init(r,1);const n=o.readString(true);const i=o.readString();o.clear();if(i===undefined){return s(t,"Inbound: Malformed USERAUTH_BANNER packet")}t._debug&&t._debug("Inbound: Received USERAUTH_BANNER");const l=t._handlers.USERAUTH_BANNER;l&&l(t,n)},60:(t,r)=>{if(!t._authsQueue.length){t._debug&&t._debug("Inbound: Received payload type 60 without auth");return}switch(t._authsQueue[0]){case"password":{o.init(r,1);const n=o.readString(true);const i=o.readString();o.clear();if(i===undefined){return s(t,"Inbound: Malformed USERAUTH_PASSWD_CHANGEREQ packet")}t._debug&&t._debug("Inbound: Received USERAUTH_PASSWD_CHANGEREQ");const l=t._handlers.USERAUTH_PASSWD_CHANGEREQ;l&&l(t,n);break}case"publickey":{o.init(r,1);const n=o.readString(true);const i=o.readString();o.clear();if(i===undefined){return s(t,"Inbound: Malformed USERAUTH_PK_OK packet")}t._debug&&t._debug("Inbound: Received USERAUTH_PK_OK");t._authsQueue.shift();const l=t._handlers.USERAUTH_PK_OK;l&&l(t,n,i);break}case"keyboard-interactive":{o.init(r,1);const n=o.readString(true);const i=o.readString(true);o.readString();const l=o.readUInt32BE();let u;if(l!==undefined){u=new Array(l);let t;for(t=0;t<l;++t){const r=o.readString(true);const n=o.readBool();if(n===undefined)break;u[t]={prompt:r,echo:n}}if(t!==l)u=undefined}o.clear();if(u===undefined){return s(t,"Inbound: Malformed USERAUTH_INFO_REQUEST packet")}t._debug&&t._debug("Inbound: Received USERAUTH_INFO_REQUEST");const h=t._handlers.USERAUTH_INFO_REQUEST;h&&h(t,n,i,u);break}default:t._debug&&t._debug("Inbound: Received unexpected payload type 60")}},61:(t,r)=>{if(!t._authsQueue.length){t._debug&&t._debug("Inbound: Received payload type 61 without auth");return}if(t._authsQueue[0]!=="keyboard-interactive"){return s(t,"Inbound: Received unexpected payload type 61")}o.init(r,1);const n=o.readUInt32BE();let i;if(n!==undefined){i=new Array(n);let t;for(t=0;t<n;++t){const r=o.readString(true);if(r===undefined)break;i[t]=r}if(t!==n)i=undefined}o.clear();if(i===undefined){return s(t,"Inbound: Malformed USERAUTH_INFO_RESPONSE packet")}t._debug&&t._debug("Inbound: Received USERAUTH_INFO_RESPONSE");const l=t._handlers.USERAUTH_INFO_RESPONSE;l&&l(t,i)},[g.GLOBAL_REQUEST]:(t,r)=>{o.init(r,1);const n=o.readString(true);const i=o.readBool();let l;if(i!==undefined){switch(n){case"tcpip-forward":case"cancel-tcpip-forward":{const t=o.readString(true);const r=o.readUInt32BE();if(r!==undefined)l={bindAddr:t,bindPort:r};break}case"streamlocal-forward@openssh.com":case"cancel-streamlocal-forward@openssh.com":{const t=o.readString(true);if(t!==undefined)l={socketPath:t};break}case"no-more-sessions@openssh.com":l=null;break;case"hostkeys-00@openssh.com":{l=[];while(o.avail()>0){const t=o.readString();if(t===undefined){l=undefined;break}const r=_(t);if(!(r instanceof Error))l.push(r)}break}default:l=o.readRaw()}}o.clear();if(l===undefined){return s(t,"Inbound: Malformed GLOBAL_REQUEST packet")}t._debug&&t._debug(`Inbound: GLOBAL_REQUEST (${n})`);const u=t._handlers.GLOBAL_REQUEST;if(u)u(t,n,i,l);else t.requestFailure()},[g.REQUEST_SUCCESS]:(t,r)=>{const n=r.length>1?i(r,1):null;t._debug&&t._debug("Inbound: REQUEST_SUCCESS");const o=t._handlers.REQUEST_SUCCESS;o&&o(t,n)},[g.REQUEST_FAILURE]:(t,r)=>{t._debug&&t._debug("Inbound: Received REQUEST_FAILURE");const n=t._handlers.REQUEST_FAILURE;n&&n(t)},[g.CHANNEL_OPEN]:(t,r)=>{o.init(r,1);const n=o.readString(true);const i=o.readUInt32BE();const l=o.readUInt32BE();const u=o.readUInt32BE();let p;switch(n){case"forwarded-tcpip":case"direct-tcpip":{const t=o.readString(true);const r=o.readUInt32BE();const s=o.readString(true);const h=o.readUInt32BE();if(h!==undefined){p={type:n,sender:i,window:l,packetSize:u,data:{destIP:t,destPort:r,srcIP:s,srcPort:h}}}break}case"forwarded-streamlocal@openssh.com":case"direct-streamlocal@openssh.com":{const t=o.readString(true);if(t!==undefined){p={type:n,sender:i,window:l,packetSize:u,data:{socketPath:t}}}break}case"x11":{const t=o.readString(true);const r=o.readUInt32BE();if(r!==undefined){p={type:n,sender:i,window:l,packetSize:u,data:{srcIP:t,srcPort:r}}}break}default:p={type:n,sender:i,window:l,packetSize:u,data:{}}}o.clear();if(p===undefined){return s(t,"Inbound: Malformed CHANNEL_OPEN packet")}t._debug&&t._debug(`Inbound: CHANNEL_OPEN (s:${i}, ${n})`);const g=t._handlers.CHANNEL_OPEN;if(g){g(t,p)}else{t.channelOpenFail(p.sender,h.ADMINISTRATIVELY_PROHIBITED,"","")}},[g.CHANNEL_OPEN_CONFIRMATION]:(t,r)=>{o.init(r,1);const n=o.readUInt32BE();const i=o.readUInt32BE();const l=o.readUInt32BE();const u=o.readUInt32BE();const h=o.avail()?o.readRaw():undefined;o.clear();if(u===undefined){return s(t,"Inbound: Malformed CHANNEL_OPEN_CONFIRMATION packet")}t._debug&&t._debug(`Inbound: CHANNEL_OPEN_CONFIRMATION (r:${n}, s:${i})`);const p=t._handlers.CHANNEL_OPEN_CONFIRMATION;if(p)p(t,{recipient:n,sender:i,window:l,packetSize:u,data:h})},[g.CHANNEL_OPEN_FAILURE]:(t,r)=>{o.init(r,1);const n=o.readUInt32BE();const i=o.readUInt32BE();const l=o.readString(true);const u=o.readString();o.clear();if(u===undefined){return s(t,"Inbound: Malformed CHANNEL_OPEN_FAILURE packet")}t._debug&&t._debug(`Inbound: CHANNEL_OPEN_FAILURE (r:${n})`);const h=t._handlers.CHANNEL_OPEN_FAILURE;h&&h(t,n,i,l)},[g.CHANNEL_WINDOW_ADJUST]:(t,r)=>{o.init(r,1);const n=o.readUInt32BE();const i=o.readUInt32BE();o.clear();if(i===undefined){return s(t,"Inbound: Malformed CHANNEL_WINDOW_ADJUST packet")}t._debug&&t._debug(`Inbound: CHANNEL_WINDOW_ADJUST (r:${n}, ${i})`);const l=t._handlers.CHANNEL_WINDOW_ADJUST;l&&l(t,n,i)},[g.CHANNEL_DATA]:(t,r)=>{o.init(r,1);const n=o.readUInt32BE();const i=o.readString();o.clear();if(i===undefined){return s(t,"Inbound: Malformed CHANNEL_DATA packet")}t._debug&&t._debug(`Inbound: CHANNEL_DATA (r:${n}, ${i.length})`);const l=t._handlers.CHANNEL_DATA;l&&l(t,n,i)},[g.CHANNEL_EXTENDED_DATA]:(t,r)=>{o.init(r,1);const n=o.readUInt32BE();const i=o.readUInt32BE();const l=o.readString();o.clear();if(l===undefined){return s(t,"Inbound: Malformed CHANNEL_EXTENDED_DATA packet")}t._debug&&t._debug(`Inbound: CHANNEL_EXTENDED_DATA (r:${n}, ${l.length})`);const u=t._handlers.CHANNEL_EXTENDED_DATA;u&&u(t,n,l,i)},[g.CHANNEL_EOF]:(t,r)=>{o.init(r,1);const n=o.readUInt32BE();o.clear();if(n===undefined){return s(t,"Inbound: Malformed CHANNEL_EOF packet")}t._debug&&t._debug(`Inbound: CHANNEL_EOF (r:${n})`);const i=t._handlers.CHANNEL_EOF;i&&i(t,n)},[g.CHANNEL_CLOSE]:(t,r)=>{o.init(r,1);const n=o.readUInt32BE();o.clear();if(n===undefined){return s(t,"Inbound: Malformed CHANNEL_CLOSE packet")}t._debug&&t._debug(`Inbound: CHANNEL_CLOSE (r:${n})`);const i=t._handlers.CHANNEL_CLOSE;i&&i(t,n)},[g.CHANNEL_REQUEST]:(t,r)=>{o.init(r,1);const n=o.readUInt32BE();const i=o.readString(true);const l=o.readBool();let u;if(l!==undefined){switch(i){case"exit-status":u=o.readUInt32BE();t._debug&&t._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i}: ${u})`);break;case"exit-signal":{let r;let s;if(t._compatFlags&p.OLD_EXIT){const t=o.readUInt32BE();switch(t){case 1:r="HUP";break;case 2:r="INT";break;case 3:r="QUIT";break;case 6:r="ABRT";break;case 9:r="KILL";break;case 14:r="ALRM";break;case 15:r="TERM";break;default:if(t!==undefined){r=`UNKNOWN (${t})`}}s=false}else{r=o.readString(true);s=o.readBool();if(s===undefined)r=undefined}const l=o.readString(true);if(o.skipString()!==undefined)u={signal:r,coreDumped:s,errorMessage:l};t._debug&&t._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i}: ${r})`);break}case"pty-req":{const r=o.readString(true);const s=o.readUInt32BE();const l=o.readUInt32BE();const h=o.readUInt32BE();const p=o.readUInt32BE();const g=o.readString();if(g!==undefined){o.init(g,1);let t={};while(o.avail()){const r=o.readByte();if(r===m.TTY_OP_END)break;const n=E[r];const i=o.readUInt32BE();if(r===undefined||n===undefined||i===undefined){t=undefined;break}t[n]=i}if(t!==undefined)u={term:r,cols:s,rows:l,width:h,height:p,modes:t}}t._debug&&t._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i})`);break}case"window-change":{const r=o.readUInt32BE();const s=o.readUInt32BE();const l=o.readUInt32BE();const h=o.readUInt32BE();if(h!==undefined)u={cols:r,rows:s,width:l,height:h};t._debug&&t._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i})`);break}case"x11-req":{const r=o.readBool();const s=o.readString(true);const l=o.readString();const h=o.readUInt32BE();if(h!==undefined)u={single:r,protocol:s,cookie:l,screen:h};t._debug&&t._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i})`);break}case"env":{const r=o.readString(true);const s=o.readString(true);if(s!==undefined)u={name:r,value:s};if(t._debug){t._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i}: `+`${r}=${s})`)}break}case"shell":u=null;t._debug&&t._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i})`);break;case"exec":u=o.readString(true);t._debug&&t._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i}: ${u})`);break;case"subsystem":u=o.readString(true);t._debug&&t._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i}: ${u})`);break;case"signal":u=o.readString(true);t._debug&&t._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i}: ${u})`);break;case"xon-xoff":u=o.readBool();t._debug&&t._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i}: ${u})`);break;case"auth-agent-req@openssh.com":u=null;t._debug&&t._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i})`);break;default:u=o.avail()?o.readRaw():null;t._debug&&t._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${i})`)}}o.clear();if(u===undefined){return s(t,"Inbound: Malformed CHANNEL_REQUEST packet")}const h=t._handlers.CHANNEL_REQUEST;h&&h(t,n,i,l,u)},[g.CHANNEL_SUCCESS]:(t,r)=>{o.init(r,1);const n=o.readUInt32BE();o.clear();if(n===undefined){return s(t,"Inbound: Malformed CHANNEL_SUCCESS packet")}t._debug&&t._debug(`Inbound: CHANNEL_SUCCESS (r:${n})`);const i=t._handlers.CHANNEL_SUCCESS;i&&i(t,n)},[g.CHANNEL_FAILURE]:(t,r)=>{o.init(r,1);const n=o.readUInt32BE();o.clear();if(n===undefined){return s(t,"Inbound: Malformed CHANNEL_FAILURE packet")}t._debug&&t._debug(`Inbound: CHANNEL_FAILURE (r:${n})`);const i=t._handlers.CHANNEL_FAILURE;i&&i(t,n)}}},4126:(t,r,n)=>{"use strict";const{createDiffieHellman:i,createDiffieHellmanGroup:o,createECDH:s,createHash:l,createPublicKey:u,diffieHellman:h,generateKeyPairSync:p,randomFillSync:g}=n(6417);const{Ber:m}=n(970);const{COMPAT:_,curve25519Supported:E,DEFAULT_KEX:b,DEFAULT_SERVER_HOST_KEY:y,DEFAULT_CIPHER:w,DEFAULT_MAC:I,DEFAULT_COMPRESSION:C,DISCONNECT_REASON:R,MESSAGE:B}=n(6832);const{CIPHER_INFO:k,createCipher:v,createDecipher:T,MAC_INFO:P}=n(5708);const{parseDERKey:O}=n(2218);const{bufferFill:D,bufferParser:L,convertSignature:U,doFatalError:W,FastBuffer:Q,sigSSHToASN1:q,writeUInt32BE:$}=n(9475);const{PacketReader:j,PacketWriter:G,ZlibPacketReader:Y,ZlibPacketWriter:z}=n(6715);let V;const J=2048;const ee=8192;const te=Buffer.alloc(0);function kexinit(t){let r;if(t._compatFlags&_.BAD_DHGEX){const n=t._offer.lists.kex;let i=n.array;let o=false;for(let t=0;t<i.length;++t){if(i[t].indexOf("group-exchange")!==-1){if(!o){o=true;i=i.slice()}i.splice(t--,1)}}if(o){let o=1+16+t._offer.totalSize+1+4;const s=Buffer.from(i.join(","));o-=n.buffer.length-s.length;const l=t._offer.lists.all;const u=new Uint8Array(l.buffer,l.byteOffset+4+n.buffer.length,l.length-(4+n.buffer.length));r=Buffer.allocUnsafe(o);$(r,s.length,0);r.set(s,4);r.set(u,4+s.length)}}if(r===undefined){r=Buffer.allocUnsafe(1+16+t._offer.totalSize+1+4);t._offer.copyAllTo(r,17)}t._debug&&t._debug("Outbound: Sending KEXINIT");r[0]=B.KEXINIT;g(r,1,16);D(r,0,r.length-5);t._kexinit=r;t._packetRW.write.allocStart=0;{const n=t._packetRW.write.allocStartKEX;const i=t._packetRW.write.alloc(r.length,true);i.set(r,n);t._cipher.encrypt(t._packetRW.write.finalize(i,true))}}function handleKexInit(t,r){const n={kex:undefined,serverHostKey:undefined,cs:{cipher:undefined,mac:undefined,compress:undefined,lang:undefined},sc:{cipher:undefined,mac:undefined,compress:undefined,lang:undefined}};L.init(r,17);if((n.kex=L.readList())===undefined||(n.serverHostKey=L.readList())===undefined||(n.cs.cipher=L.readList())===undefined||(n.sc.cipher=L.readList())===undefined||(n.cs.mac=L.readList())===undefined||(n.sc.mac=L.readList())===undefined||(n.cs.compress=L.readList())===undefined||(n.sc.compress=L.readList())===undefined||(n.cs.lang=L.readList())===undefined||(n.sc.lang=L.readList())===undefined){L.clear();return W(t,"Received malformed KEXINIT","handshake",R.KEY_EXCHANGE_FAILED)}const i=L.pos();const o=i<r.length&&r[i]===1;L.clear();const s=t._offer;const l=n;let u=s.lists.kex.array;if(t._compatFlags&_.BAD_DHGEX){let t=false;for(let r=0;r<u.length;++r){if(u[r].indexOf("group-exchange")!==-1){if(!t){t=true;u=u.slice()}u.splice(r--,1)}}}let h;let p;let g;const m=t._debug;m&&m("Inbound: Handshake in progress");m&&m(`Handshake: (local) KEX method: ${u}`);m&&m(`Handshake: (remote) KEX method: ${l.kex}`);if(t._server){p=u;h=l.kex}else{p=l.kex;h=u}for(g=0;g<h.length&&p.indexOf(h[g])===-1;++g);if(g===h.length){m&&m("Handshake: No matching key exchange algorithm");return W(t,"Handshake failed: no matching key exchange algorithm","handshake",R.KEY_EXCHANGE_FAILED)}n.kex=h[g];m&&m(`Handshake: KEX algorithm: ${h[g]}`);if(o&&(!l.kex.length||h[g]!==l.kex[0])){t._skipNextInboundPacket=true}const E=s.lists.serverHostKey.array;m&&m(`Handshake: (local) Host key format: ${E}`);m&&m(`Handshake: (remote) Host key format: ${l.serverHostKey}`);if(t._server){p=E;h=l.serverHostKey}else{p=l.serverHostKey;h=E}for(g=0;g<h.length&&p.indexOf(h[g])===-1;++g);if(g===h.length){m&&m("Handshake: No matching host key format");return W(t,"Handshake failed: no matching host key format","handshake",R.KEY_EXCHANGE_FAILED)}n.serverHostKey=h[g];m&&m(`Handshake: Host key format: ${h[g]}`);const b=s.lists.cs.cipher.array;m&&m(`Handshake: (local) C->S cipher: ${b}`);m&&m(`Handshake: (remote) C->S cipher: ${l.cs.cipher}`);if(t._server){p=b;h=l.cs.cipher}else{p=l.cs.cipher;h=b}for(g=0;g<h.length&&p.indexOf(h[g])===-1;++g);if(g===h.length){m&&m("Handshake: No matching C->S cipher");return W(t,"Handshake failed: no matching C->S cipher","handshake",R.KEY_EXCHANGE_FAILED)}n.cs.cipher=h[g];m&&m(`Handshake: C->S Cipher: ${h[g]}`);const y=s.lists.sc.cipher.array;m&&m(`Handshake: (local) S->C cipher: ${y}`);m&&m(`Handshake: (remote) S->C cipher: ${l.sc.cipher}`);if(t._server){p=y;h=l.sc.cipher}else{p=l.sc.cipher;h=y}for(g=0;g<h.length&&p.indexOf(h[g])===-1;++g);if(g===h.length){m&&m("Handshake: No matching S->C cipher");return W(t,"Handshake failed: no matching S->C cipher","handshake",R.KEY_EXCHANGE_FAILED)}n.sc.cipher=h[g];m&&m(`Handshake: S->C cipher: ${h[g]}`);const w=s.lists.cs.mac.array;m&&m(`Handshake: (local) C->S MAC: ${w}`);m&&m(`Handshake: (remote) C->S MAC: ${l.cs.mac}`);if(k[n.cs.cipher].authLen>0){n.cs.mac="";m&&m("Handshake: C->S MAC: <implicit>")}else{if(t._server){p=w;h=l.cs.mac}else{p=l.cs.mac;h=w}for(g=0;g<h.length&&p.indexOf(h[g])===-1;++g);if(g===h.length){m&&m("Handshake: No matching C->S MAC");return W(t,"Handshake failed: no matching C->S MAC","handshake",R.KEY_EXCHANGE_FAILED)}n.cs.mac=h[g];m&&m(`Handshake: C->S MAC: ${h[g]}`)}const I=s.lists.sc.mac.array;m&&m(`Handshake: (local) S->C MAC: ${I}`);m&&m(`Handshake: (remote) S->C MAC: ${l.sc.mac}`);if(k[n.sc.cipher].authLen>0){n.sc.mac="";m&&m("Handshake: S->C MAC: <implicit>")}else{if(t._server){p=I;h=l.sc.mac}else{p=l.sc.mac;h=I}for(g=0;g<h.length&&p.indexOf(h[g])===-1;++g);if(g===h.length){m&&m("Handshake: No matching S->C MAC");return W(t,"Handshake failed: no matching S->C MAC","handshake",R.KEY_EXCHANGE_FAILED)}n.sc.mac=h[g];m&&m(`Handshake: S->C MAC: ${h[g]}`)}const C=s.lists.cs.compress.array;m&&m(`Handshake: (local) C->S compression: ${C}`);m&&m(`Handshake: (remote) C->S compression: ${l.cs.compress}`);if(t._server){p=C;h=l.cs.compress}else{p=l.cs.compress;h=C}for(g=0;g<h.length&&p.indexOf(h[g])===-1;++g);if(g===h.length){m&&m("Handshake: No matching C->S compression");return W(t,"Handshake failed: no matching C->S compression","handshake",R.KEY_EXCHANGE_FAILED)}n.cs.compress=h[g];m&&m(`Handshake: C->S compression: ${h[g]}`);const B=s.lists.sc.compress.array;m&&m(`Handshake: (local) S->C compression: ${B}`);m&&m(`Handshake: (remote) S->C compression: ${l.sc.compress}`);if(t._server){p=B;h=l.sc.compress}else{p=l.sc.compress;h=B}for(g=0;g<h.length&&p.indexOf(h[g])===-1;++g);if(g===h.length){m&&m("Handshake: No matching S->C compression");return W(t,"Handshake failed: no matching S->C compression","handshake",R.KEY_EXCHANGE_FAILED)}n.sc.compress=h[g];m&&m(`Handshake: S->C compression: ${h[g]}`);n.cs.lang="";n.sc.lang="";if(t._kex){if(!t._kexinit){kexinit(t)}t._decipher._onPayload=onKEXPayload.bind(t,{firstPacket:false})}t._kex=re(n,t,r);t._kex.start()}const re=(()=>{function convertToMpint(t){let r=0;let n=t.length;while(t[r]===0){++r;--n}let i;if(t[r]&128){i=Buffer.allocUnsafe(1+n);i[0]=0;t.copy(i,1,r);t=i}else if(n!==t.length){i=Buffer.allocUnsafe(n);t.copy(i,0,r);t=i}return t}class KeyExchange{constructor(t,r,n){this._protocol=r;this.sessionID=r._kex?r._kex.sessionID:undefined;this.negotiated=t;this._step=1;this._public=null;this._dh=null;this._sentNEWKEYS=false;this._receivedNEWKEYS=false;this._finished=false;this._hostVerified=false;this._kexinit=r._kexinit;this._remoteKexinit=n;this._identRaw=r._identRaw;this._remoteIdentRaw=r._remoteIdentRaw;this._hostKey=undefined;this._dhData=undefined;this._sig=undefined}finish(){if(this._finished)return false;this._finished=true;const t=this._protocol._server;const r=this.negotiated;const n=this.convertPublicKey(this._dhData);let i=this.computeSecret(this._dhData);if(i instanceof Error){i.message=`Error while computing DH secret (${this.type}): ${i.message}`;i.level="handshake";return W(this._protocol,i,R.KEY_EXCHANGE_FAILED)}const o=l(this.hashName);ie(o,t?this._remoteIdentRaw:this._identRaw);ie(o,t?this._identRaw:this._remoteIdentRaw);ie(o,t?this._remoteKexinit:this._kexinit);ie(o,t?this._kexinit:this._remoteKexinit);const s=t?this._hostKey.getPublicSSH():this._hostKey;ie(o,s);if(this.type==="groupex"){const t=this.getDHParams();const r=Buffer.allocUnsafe(4);$(r,this._minBits,0);o.update(r);$(r,this._prefBits,0);o.update(r);$(r,this._maxBits,0);o.update(r);ie(o,t.prime);ie(o,t.generator)}ie(o,t?n:this.getPublicKey());const u=t?this.getPublicKey():n;ie(o,u);ie(o,i);const h=o.digest();if(!t){L.init(this._sig,0);const t=L.readString(true);if(!t){return W(this._protocol,"Malformed packet while reading signature","handshake",R.KEY_EXCHANGE_FAILED)}if(t!==r.serverHostKey){return W(this._protocol,`Wrong signature type: ${t}, `+`expected: ${r.serverHostKey}`,"handshake",R.KEY_EXCHANGE_FAILED)}let n=L.readString();L.clear();if(n===undefined){return W(this._protocol,"Malformed packet while reading signature","handshake",R.KEY_EXCHANGE_FAILED)}if(!(n=q(n,t))){return W(this._protocol,"Malformed signature","handshake",R.KEY_EXCHANGE_FAILED)}let i;{L.init(this._hostKey,0);const t=L.readString(true);const r=this._hostKey.slice(L.pos());L.clear();i=O(r,t);if(i instanceof Error){i.level="handshake";return W(this._protocol,i,R.KEY_EXCHANGE_FAILED)}}let o;switch(this.negotiated.serverHostKey){case"rsa-sha2-256":o="sha256";break;case"rsa-sha2-512":o="sha512";break}this._protocol._debug&&this._protocol._debug("Verifying signature ...");const s=i.verify(h,n,o);if(s!==true){if(s instanceof Error){this._protocol._debug&&this._protocol._debug(`Signature verification failed: ${s.stack}`)}else{this._protocol._debug&&this._protocol._debug("Signature verification failed")}return W(this._protocol,"Handshake failed: signature verification failed","handshake",R.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Verified signature")}else{let t;switch(this.negotiated.serverHostKey){case"rsa-sha2-256":t="sha256";break;case"rsa-sha2-512":t="sha512";break}this._protocol._debug&&this._protocol._debug("Generating signature ...");let r=this._hostKey.sign(h,t);if(r instanceof Error){return W(this._protocol,"Handshake failed: signature generation failed for "+`${this._hostKey.type} host key: ${r.message}`,"handshake",R.KEY_EXCHANGE_FAILED)}r=U(r,this._hostKey.type);if(r===false){return W(this._protocol,"Handshake failed: signature conversion failed for "+`${this._hostKey.type} host key`,"handshake",R.KEY_EXCHANGE_FAILED)}const n=this.negotiated.serverHostKey;const i=Buffer.byteLength(n);const o=4+i+4+r.length;let l=this._protocol._packetRW.write.allocStartKEX;const p=this._protocol._packetRW.write.alloc(1+4+s.length+4+u.length+4+o,true);p[l]=B.KEXDH_REPLY;$(p,s.length,++l);p.set(s,l+=4);$(p,u.length,l+=s.length);p.set(u,l+=4);$(p,o,l+=u.length);$(p,i,l+=4);p.utf8Write(n,l+=4,i);$(p,r.length,l+=i);p.set(r,l+=4);if(this._protocol._debug){let t;switch(this.type){case"group":t="KEXDH_REPLY";break;case"groupex":t="KEXDH_GEX_REPLY";break;default:t="KEXECDH_REPLY"}this._protocol._debug(`Outbound: Sending ${t}`)}this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(p,true))}trySendNEWKEYS(this);const completeHandshake=()=>{if(!this.sessionID)this.sessionID=h;{const t=Buffer.allocUnsafe(4+i.length);$(t,i.length,0);t.set(i,4);i=t}const n=k[r.cs.cipher];const o=k[r.sc.cipher];const s=generateKEXVal(n.ivLen,this.hashName,i,h,this.sessionID,"A");const l=generateKEXVal(o.ivLen,this.hashName,i,h,this.sessionID,"B");const u=generateKEXVal(n.keyLen,this.hashName,i,h,this.sessionID,"C");const p=generateKEXVal(o.keyLen,this.hashName,i,h,this.sessionID,"D");let g;let m;if(!n.authLen){g=P[r.cs.mac];m=generateKEXVal(g.len,this.hashName,i,h,this.sessionID,"E")}let _;let E;if(!o.authLen){_=P[r.sc.mac];E=generateKEXVal(_.len,this.hashName,i,h,this.sessionID,"F")}const b={inbound:{onPayload:this._protocol._onPayload,seqno:this._protocol._decipher.inSeqno,decipherInfo:!t?o:n,decipherIV:!t?l:s,decipherKey:!t?p:u,macInfo:!t?_:g,macKey:!t?E:m},outbound:{onWrite:this._protocol._onWrite,seqno:this._protocol._cipher.outSeqno,cipherInfo:t?o:n,cipherIV:t?l:s,cipherKey:t?p:u,macInfo:t?_:g,macKey:t?E:m}};this._protocol._cipher&&this._protocol._cipher.free();this._protocol._decipher&&this._protocol._decipher.free();this._protocol._cipher=v(b);this._protocol._decipher=T(b);const y={read:undefined,write:undefined};switch(r.cs.compress){case"zlib":if(t)y.read=new Y;else y.write=new z(this._protocol);break;case"zlib@openssh.com":if(this._protocol._authenticated){if(t)y.read=new Y;else y.write=new z(this._protocol);break}default:if(t)y.read=new j;else y.write=new G(this._protocol)}switch(r.sc.compress){case"zlib":if(t)y.write=new z(this._protocol);else y.read=new Y;break;case"zlib@openssh.com":if(this._protocol._authenticated){if(t)y.write=new z(this._protocol);else y.read=new Y;break}default:if(t)y.write=new G(this._protocol);else y.read=new j}this._protocol._packetRW.read.cleanup();this._protocol._packetRW.write.cleanup();this._protocol._packetRW=y;this._public=null;this._dh=null;this._kexinit=this._protocol._kexinit=undefined;this._remoteKexinit=undefined;this._identRaw=undefined;this._remoteIdentRaw=undefined;this._hostKey=undefined;this._dhData=undefined;this._sig=undefined;this._protocol._onHandshakeComplete(r);return false};if(!t)return completeHandshake();this.finish=completeHandshake}start(){if(!this._protocol._server){if(this._protocol._debug){let t;switch(this.type){case"group":t="KEXDH_INIT";break;default:t="KEXECDH_INIT"}this._protocol._debug(`Outbound: Sending ${t}`)}const t=this.getPublicKey();let r=this._protocol._packetRW.write.allocStartKEX;const n=this._protocol._packetRW.write.alloc(1+4+t.length,true);n[r]=B.KEXDH_INIT;$(n,t.length,++r);n.set(t,r+=4);this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(n,true))}}getPublicKey(){this.generateKeys();const t=this._public;if(t)return this.convertPublicKey(t)}convertPublicKey(t){let r;let n=0;let i=t.length;while(t[n]===0){++n;--i}if(t[n]&128){r=Buffer.allocUnsafe(1+i);r[0]=0;t.copy(r,1,n);return r}if(i!==t.length){r=Buffer.allocUnsafe(i);t.copy(r,0,n);t=r}return t}computeSecret(t){this.generateKeys();try{return convertToMpint(this._dh.computeSecret(t))}catch(t){return t}}parse(t){const r=t[0];switch(this._step){case 1:if(this._protocol._server){if(r!==B.KEXDH_INIT){return W(this._protocol,`Received packet ${r} instead of ${B.KEXDH_INIT}`,"handshake",R.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH Init");L.init(t,1);const n=L.readString();L.clear();if(n===undefined){return W(this._protocol,"Received malformed KEX*_INIT","handshake",R.KEY_EXCHANGE_FAILED)}this._dhData=n;let i=this._protocol._hostKeys[this.negotiated.serverHostKey];if(Array.isArray(i))i=i[0];this._hostKey=i;this.finish()}else{if(r!==B.KEXDH_REPLY){return W(this._protocol,`Received packet ${r} instead of ${B.KEXDH_REPLY}`,"handshake",R.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH Reply");L.init(t,1);let n;let i;let o;if((n=L.readString())===undefined||(i=L.readString())===undefined||(o=L.readString())===undefined){L.clear();return W(this._protocol,"Received malformed KEX*_REPLY","handshake",R.KEY_EXCHANGE_FAILED)}L.clear();L.init(n,0);const s=L.readString(true);L.clear();if(s===undefined){return W(this._protocol,"Received malformed host public key","handshake",R.KEY_EXCHANGE_FAILED)}if(s!==this.negotiated.serverHostKey){switch(this.negotiated.serverHostKey){case"rsa-sha2-256":case"rsa-sha2-512":if(s==="ssh-rsa")break;default:return W(this._protocol,"Host key does not match negotiated type","handshake",R.KEY_EXCHANGE_FAILED)}}this._hostKey=n;this._dhData=i;this._sig=o;let l=false;let u;if(this._protocol._hostVerifier===undefined){u=true;this._protocol._debug&&this._protocol._debug("Host accepted by default (no verification)")}else{u=this._protocol._hostVerifier(n,(t=>{if(l)return;l=true;if(t===false){this._protocol._debug&&this._protocol._debug("Host denied (verification failed)");return W(this._protocol,"Host denied (verification failed)","handshake",R.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Host accepted (verified)");this._hostVerified=true;if(this._receivedNEWKEYS)this.finish();else trySendNEWKEYS(this)}))}if(u===undefined){++this._step;return}l=true;if(u===false){this._protocol._debug&&this._protocol._debug("Host denied (verification failed)");return W(this._protocol,"Host denied (verification failed)","handshake",R.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Host accepted (verified)");this._hostVerified=true;trySendNEWKEYS(this)}++this._step;break;case 2:if(r!==B.NEWKEYS){return W(this._protocol,`Received packet ${r} instead of ${B.NEWKEYS}`,"handshake",R.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Inbound: NEWKEYS");this._receivedNEWKEYS=true;++this._step;if(this._protocol._server||this._hostVerified)return this.finish();return false;default:return W(this._protocol,`Received unexpected packet ${r} after NEWKEYS`,"handshake",R.KEY_EXCHANGE_FAILED)}}}class Curve25519Exchange extends KeyExchange{constructor(t,...r){super(...r);this.type="25519";this.hashName=t;this._keys=null}generateKeys(){if(!this._keys)this._keys=p("x25519")}getPublicKey(){this.generateKeys();const t=this._keys.publicKey.export({type:"spki",format:"der"});return t.slice(-32)}convertPublicKey(t){let r;let n=0;let i=t.length;while(t[n]===0){++n;--i}if(t.length===32)return t;if(i!==t.length){r=Buffer.allocUnsafe(i);t.copy(r,0,n);t=r}return t}computeSecret(t){this.generateKeys();try{const r=new m.Writer;r.startSequence();r.startSequence();r.writeOID("1.3.101.110");r.endSequence();r.startSequence(m.BitString);r.writeByte(0);r._ensure(t.length);t.copy(r._buf,r._offset,0,t.length);r._offset+=t.length;r.endSequence();r.endSequence();return convertToMpint(h({privateKey:this._keys.privateKey,publicKey:u({key:r.buffer,type:"spki",format:"der"})}))}catch(t){return t}}}class ECDHExchange extends KeyExchange{constructor(t,r,...n){super(...n);this.type="ecdh";this.curveName=t;this.hashName=r}generateKeys(){if(!this._dh){this._dh=s(this.curveName);this._public=this._dh.generateKeys()}}}class DHGroupExchange extends KeyExchange{constructor(t,...r){super(...r);this.type="groupex";this.hashName=t;this._prime=null;this._generator=null;this._minBits=J;this._prefBits=dhEstimate(this.negotiated);if(this._protocol._compatFlags&_.BUG_DHGEX_LARGE)this._prefBits=Math.min(this._prefBits,4096);this._maxBits=ee}start(){if(this._protocol._server)return;this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_GEX_REQUEST");let t=this._protocol._packetRW.write.allocStartKEX;const r=this._protocol._packetRW.write.alloc(1+4+4+4,true);r[t]=B.KEXDH_GEX_REQUEST;$(r,this._minBits,++t);$(r,this._prefBits,t+=4);$(r,this._maxBits,t+=4);this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(r,true))}generateKeys(){if(!this._dh&&this._prime&&this._generator){this._dh=i(this._prime,this._generator);this._public=this._dh.generateKeys()}}setDHParams(t,r){if(!Buffer.isBuffer(t))throw new Error("Invalid prime value");if(!Buffer.isBuffer(r))throw new Error("Invalid generator value");this._prime=t;this._generator=r}getDHParams(){if(this._dh){return{prime:convertToMpint(this._dh.getPrime()),generator:convertToMpint(this._dh.getGenerator())}}}parse(t){const r=t[0];switch(this._step){case 1:if(this._protocol._server){if(r!==B.KEXDH_GEX_REQUEST){return W(this._protocol,`Received packet ${r} instead of `+B.KEXDH_GEX_REQUEST,"handshake",R.KEY_EXCHANGE_FAILED)}return W(this._protocol,"Group exchange not implemented for server","handshake",R.KEY_EXCHANGE_FAILED)}if(r!==B.KEXDH_GEX_GROUP){return W(this._protocol,`Received packet ${r} instead of ${B.KEXDH_GEX_GROUP}`,"handshake",R.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH GEX Group");L.init(t,1);let n;let i;if((n=L.readString())===undefined||(i=L.readString())===undefined){L.clear();return W(this._protocol,"Received malformed KEXDH_GEX_GROUP","handshake",R.KEY_EXCHANGE_FAILED)}L.clear();this.setDHParams(n,i);this.generateKeys();const o=this.getPublicKey();this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_GEX_INIT");let s=this._protocol._packetRW.write.allocStartKEX;const l=this._protocol._packetRW.write.alloc(1+4+o.length,true);l[s]=B.KEXDH_GEX_INIT;$(l,o.length,++s);l.set(o,s+=4);this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(l,true));++this._step;break;case 2:if(this._protocol._server){if(r!==B.KEXDH_GEX_INIT){return W(this._protocol,`Received packet ${r} instead of ${B.KEXDH_GEX_INIT}`,"handshake",R.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH GEX Init");return W(this._protocol,"Group exchange not implemented for server","handshake",R.KEY_EXCHANGE_FAILED)}else if(r!==B.KEXDH_GEX_REPLY){return W(this._protocol,`Received packet ${r} instead of ${B.KEXDH_GEX_REPLY}`,"handshake",R.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH GEX Reply");this._step=1;t[0]=B.KEXDH_REPLY;this.parse=KeyExchange.prototype.parse;this.parse(t)}}}class DHExchange extends KeyExchange{constructor(t,r,...n){super(...n);this.type="group";this.groupName=t;this.hashName=r}start(){if(!this._protocol._server){this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_INIT");const t=this.getPublicKey();let r=this._protocol._packetRW.write.allocStartKEX;const n=this._protocol._packetRW.write.alloc(1+4+t.length,true);n[r]=B.KEXDH_INIT;$(n,t.length,++r);n.set(t,r+=4);this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(n,true))}}generateKeys(){if(!this._dh){this._dh=o(this.groupName);this._public=this._dh.generateKeys()}}getDHParams(){if(this._dh){return{prime:convertToMpint(this._dh.getPrime()),generator:convertToMpint(this._dh.getGenerator())}}}}return(t,...r)=>{if(typeof t!=="object"||t===null)throw new Error("Invalid negotiated argument");const n=t.kex;if(typeof n==="string"){r=[t,...r];switch(n){case"curve25519-sha256":case"curve25519-sha256@libssh.org":if(!E)break;return new Curve25519Exchange("sha256",...r);case"ecdh-sha2-nistp256":return new ECDHExchange("prime256v1","sha256",...r);case"ecdh-sha2-nistp384":return new ECDHExchange("secp384r1","sha384",...r);case"ecdh-sha2-nistp521":return new ECDHExchange("secp521r1","sha512",...r);case"diffie-hellman-group1-sha1":return new DHExchange("modp2","sha1",...r);case"diffie-hellman-group14-sha1":return new DHExchange("modp14","sha1",...r);case"diffie-hellman-group14-sha256":return new DHExchange("modp14","sha256",...r);case"diffie-hellman-group15-sha512":return new DHExchange("modp15","sha512",...r);case"diffie-hellman-group16-sha512":return new DHExchange("modp16","sha512",...r);case"diffie-hellman-group17-sha512":return new DHExchange("modp17","sha512",...r);case"diffie-hellman-group18-sha512":return new DHExchange("modp18","sha512",...r);case"diffie-hellman-group-exchange-sha1":return new DHGroupExchange("sha1",...r);case"diffie-hellman-group-exchange-sha256":return new DHGroupExchange("sha256",...r)}throw new Error(`Unsupported key exchange algorithm: ${n}`)}throw new Error(`Invalid key exchange type: ${n}`)}})();const ne=(()=>{const t=["kex","serverHostKey",["cs","cipher"],["sc","cipher"],["cs","mac"],["sc","mac"],["cs","compress"],["sc","compress"],["cs","lang"],["sc","lang"]];return class KexInit{constructor(r){if(typeof r!=="object"||r===null)throw new TypeError("Argument must be an object");const n={kex:undefined,serverHostKey:undefined,cs:{cipher:undefined,mac:undefined,compress:undefined,lang:undefined},sc:{cipher:undefined,mac:undefined,compress:undefined,lang:undefined},all:undefined};let i=0;for(const o of t){let t;let s;let l;let u;if(typeof o==="string"){t=n;s=r[o];l=u=o}else{const i=o[0];t=n[i];u=o[1];s=r[i][u];l=`${i}.${u}`}const h={array:undefined,buffer:undefined};if(Buffer.isBuffer(s)){h.array=(""+s).split(",");h.buffer=s;i+=4+s.length}else{if(typeof s==="string")s=s.split(",");if(Array.isArray(s)){h.array=s;h.buffer=Buffer.from(s.join(","))}else{throw new TypeError(`Invalid \`${l}\` type: ${typeof s}`)}i+=4+h.buffer.length}t[u]=h}const o=Buffer.allocUnsafe(i);n.all=o;let s=0;for(const r of t){let t;if(typeof r==="string")t=n[r].buffer;else t=n[r[0]][r[1]].buffer;s=$(o,t.length,s);o.set(t,s);s+=t.length}this.totalSize=i;this.lists=n}copyAllTo(t,r){const n=this.lists.all;if(typeof r!=="number")throw new TypeError(`Invalid offset value: ${typeof r}`);if(t.length-r<n.length)throw new Error("Insufficient space to copy list");t.set(n,r);return n.length}}})();const ie=(()=>{const t=Buffer.allocUnsafe(4);return(r,n)=>{$(t,n.length,0);r.update(t);r.update(n)}})();function generateKEXVal(t,r,n,i,o,s){let u;if(t){let h=l(r).update(n).update(i).update(s).update(o).digest();while(h.length<t){const t=l(r).update(n).update(i).update(h).digest();const o=Buffer.allocUnsafe(h.length+t.length);o.set(h,0);o.set(t,h.length);h=o}if(h.length===t)u=h;else u=new Q(h.buffer,h.byteOffset,t)}else{u=te}return u}function onKEXPayload(t,r){if(r.length===0){this._debug&&this._debug("Inbound: Skipping empty packet payload");return}if(this._skipNextInboundPacket){this._skipNextInboundPacket=false;return}r=this._packetRW.read.read(r);const i=r[0];switch(i){case B.DISCONNECT:case B.IGNORE:case B.UNIMPLEMENTED:case B.DEBUG:if(!V)V=n(172);return V[i](this,r);case B.KEXINIT:if(!t.firstPacket){return W(this,"Received extra KEXINIT during handshake","handshake",R.KEY_EXCHANGE_FAILED)}t.firstPacket=false;return handleKexInit(this,r);default:if(i<20||i>49){return W(this,`Received unexpected packet type ${i}`,"handshake",R.KEY_EXCHANGE_FAILED)}}return this._kex.parse(r)}function dhEstimate(t){const r=k[t.cs.cipher];const n=k[t.sc.cipher];const i=Math.max(0,r.sslName==="des-ede3-cbc"?14:r.keyLen,r.blockLen,r.ivLen,n.sslName==="des-ede3-cbc"?14:n.keyLen,n.blockLen,n.ivLen)*8;if(i<=112)return 2048;if(i<=128)return 3072;if(i<=192)return 7680;return 8192}function trySendNEWKEYS(t){if(!t._sentNEWKEYS){t._protocol._debug&&t._protocol._debug("Outbound: Sending NEWKEYS");const r=t._protocol._packetRW.write.allocStartKEX;const n=t._protocol._packetRW.write.alloc(1,true);n[r]=B.NEWKEYS;t._protocol._cipher.encrypt(t._protocol._packetRW.write.finalize(n,true));t._sentNEWKEYS=true}}t.exports={KexInit:ne,kexinit:kexinit,onKEXPayload:onKEXPayload,DEFAULT_KEXINIT:new ne({kex:b,serverHostKey:y,cs:{cipher:w,mac:I,compress:C,lang:[]},sc:{cipher:w,mac:I,compress:C,lang:[]}}),HANDLERS:{[B.KEXINIT]:handleKexInit}}},2218:(t,r,n)=>{"use strict";const{createDecipheriv:i,createECDH:o,createHash:s,createHmac:l,createSign:u,createVerify:h,getCiphers:p,sign:g,verify:m}=n(6417);const _=p();const{Ber:E}=n(970);const b=n(5447).pbkdf;const{CIPHER_INFO:y}=n(5708);const{eddsaSupported:w,SUPPORTED_CIPHER:I}=n(6832);const{bufferSlice:C,makeBufferParser:R,readString:B,readUInt32BE:k,writeUInt32BE:v}=n(9475);const T=Symbol("Hash Algorithm");const P=Symbol("Private key PEM");const O=Symbol("Public key PEM");const D=Symbol("Public key SSH");const L=Symbol("Decrypted Key");const U=Object.create(null);{const t=Object.keys(y);for(let r=0;r<t.length;++r){const n=y[t[r]].sslName;if(!n||U[n])continue;U[n]=y[t[r]]}}const W=R();function makePEM(t,r){r=r.base64Slice(0,r.length);let n=r.replace(/.{64}/g,"$&\n");if(r.length&63)n+="\n";return`-----BEGIN ${t} KEY-----\n${n}-----END ${t} KEY-----`}function combineBuffers(t,r){const n=Buffer.allocUnsafe(t.length+r.length);n.set(t,0);n.set(r,t.length);return n}function skipFields(t,r){const n=t.length;let i=t._pos||0;for(let o=0;o<r;++o){const r=n-i;if(i>=n||r<4)return false;const o=k(t,i);if(r<4+o)return false;i+=4+o}t._pos=i;return true}function genOpenSSLRSAPub(t,r){const n=new E.Writer;n.startSequence();n.startSequence();n.writeOID("1.2.840.113549.1.1.1");n.writeNull();n.endSequence();n.startSequence(E.BitString);n.writeByte(0);n.startSequence();n.writeBuffer(t,E.Integer);n.writeBuffer(r,E.Integer);n.endSequence();n.endSequence();n.endSequence();return makePEM("PUBLIC",n.buffer)}function genOpenSSHRSAPub(t,r){const n=Buffer.allocUnsafe(4+7+4+r.length+4+t.length);v(n,7,0);n.utf8Write("ssh-rsa",4,7);let i=4+7;v(n,r.length,i);n.set(r,i+=4);v(n,t.length,i+=r.length);n.set(t,i+4);return n}const Q=(()=>{function genRSAASN1Buf(t,r,n,i,o,s,l,u){const h=new E.Writer;h.startSequence();h.writeInt(0,E.Integer);h.writeBuffer(t,E.Integer);h.writeBuffer(r,E.Integer);h.writeBuffer(n,E.Integer);h.writeBuffer(i,E.Integer);h.writeBuffer(o,E.Integer);h.writeBuffer(s,E.Integer);h.writeBuffer(l,E.Integer);h.writeBuffer(u,E.Integer);h.endSequence();return h.buffer}function bigIntFromBuffer(t){return BigInt(`0x${t.hexSlice(0,t.length)}`)}function bigIntToBuffer(t){let r=t.toString(16);if((r.length&1)!==0){r=`0${r}`}else{const t=r.charCodeAt(0);if(t===56||t===57||t>=97&&t<=102){r=`00${r}`}}return Buffer.from(r,"hex")}return function genOpenSSLRSAPriv(t,r,n,i,o,s){const l=bigIntFromBuffer(n);const u=bigIntToBuffer(l%(bigIntFromBuffer(o)-1n));const h=bigIntToBuffer(l%(bigIntFromBuffer(s)-1n));return makePEM("RSA PRIVATE",genRSAASN1Buf(t,r,n,o,s,u,h,i))}})();function genOpenSSLDSAPub(t,r,n,i){const o=new E.Writer;o.startSequence();o.startSequence();o.writeOID("1.2.840.10040.4.1");o.startSequence();o.writeBuffer(t,E.Integer);o.writeBuffer(r,E.Integer);o.writeBuffer(n,E.Integer);o.endSequence();o.endSequence();o.startSequence(E.BitString);o.writeByte(0);o.writeBuffer(i,E.Integer);o.endSequence();o.endSequence();return makePEM("PUBLIC",o.buffer)}function genOpenSSHDSAPub(t,r,n,i){const o=Buffer.allocUnsafe(4+7+4+t.length+4+r.length+4+n.length+4+i.length);v(o,7,0);o.utf8Write("ssh-dss",4,7);let s=4+7;v(o,t.length,s);o.set(t,s+=4);v(o,r.length,s+=t.length);o.set(r,s+=4);v(o,n.length,s+=r.length);o.set(n,s+=4);v(o,i.length,s+=n.length);o.set(i,s+4);return o}function genOpenSSLDSAPriv(t,r,n,i,o){const s=new E.Writer;s.startSequence();s.writeInt(0,E.Integer);s.writeBuffer(t,E.Integer);s.writeBuffer(r,E.Integer);s.writeBuffer(n,E.Integer);s.writeBuffer(i,E.Integer);s.writeBuffer(o,E.Integer);s.endSequence();return makePEM("DSA PRIVATE",s.buffer)}function genOpenSSLEdPub(t){const r=new E.Writer;r.startSequence();r.startSequence();r.writeOID("1.3.101.112");r.endSequence();r.startSequence(E.BitString);r.writeByte(0);r._ensure(t.length);r._buf.set(t,r._offset);r._offset+=t.length;r.endSequence();r.endSequence();return makePEM("PUBLIC",r.buffer)}function genOpenSSHEdPub(t){const r=Buffer.allocUnsafe(4+11+4+t.length);v(r,11,0);r.utf8Write("ssh-ed25519",4,11);v(r,t.length,15);r.set(t,19);return r}function genOpenSSLEdPriv(t){const r=new E.Writer;r.startSequence();r.writeInt(0,E.Integer);r.startSequence();r.writeOID("1.3.101.112");r.endSequence();r.startSequence(E.OctetString);r.writeBuffer(t,E.OctetString);r.endSequence();r.endSequence();return makePEM("PRIVATE",r.buffer)}function genOpenSSLECDSAPub(t,r){const n=new E.Writer;n.startSequence();n.startSequence();n.writeOID("1.2.840.10045.2.1");n.writeOID(t);n.endSequence();n.startSequence(E.BitString);n.writeByte(0);n._ensure(r.length);n._buf.set(r,n._offset);n._offset+=r.length;n.endSequence();n.endSequence();return makePEM("PUBLIC",n.buffer)}function genOpenSSHECDSAPub(t,r){let n;switch(t){case"1.2.840.10045.3.1.7":n="nistp256";break;case"1.3.132.0.34":n="nistp384";break;case"1.3.132.0.35":n="nistp521";break;default:return}const i=Buffer.allocUnsafe(4+19+4+8+4+r.length);v(i,19,0);i.utf8Write(`ecdsa-sha2-${n}`,4,19);v(i,8,23);i.utf8Write(n,27,8);v(i,r.length,35);i.set(r,39);return i}function genOpenSSLECDSAPriv(t,r,n){const i=new E.Writer;i.startSequence();i.writeInt(1,E.Integer);i.writeBuffer(n,E.OctetString);i.startSequence(160);i.writeOID(t);i.endSequence();i.startSequence(161);i.startSequence(E.BitString);i.writeByte(0);i._ensure(r.length);i._buf.set(r,i._offset);i._offset+=r.length;i.endSequence();i.endSequence();i.endSequence();return makePEM("EC PRIVATE",i.buffer)}function genOpenSSLECDSAPubFromPriv(t,r){const n=o(t);n.setPrivateKey(r);return n.getPublicKey()}const q={sign:(()=>{if(typeof g==="function"){return function sign(t,r){const n=this[P];if(n===null)return new Error("No private key available");if(!r||typeof r!=="string")r=this[T];try{return g(r,t,n)}catch(t){return t}}}return function sign(t,r){const n=this[P];if(n===null)return new Error("No private key available");if(!r||typeof r!=="string")r=this[T];const i=u(r);i.update(t);try{return i.sign(n)}catch(t){return t}}})(),verify:(()=>{if(typeof m==="function"){return function verify(t,r,n){const i=this[O];if(i===null)return new Error("No public key available");if(!n||typeof n!=="string")n=this[T];try{return m(n,t,i,r)}catch(t){return t}}}return function verify(t,r,n){const i=this[O];if(i===null)return new Error("No public key available");if(!n||typeof n!=="string")n=this[T];const o=h(n);o.update(t);try{return o.verify(i,r)}catch(t){return t}}})(),isPrivateKey:function isPrivateKey(){return this[P]!==null},getPrivatePEM:function getPrivatePEM(){return this[P]},getPublicPEM:function getPublicPEM(){return this[O]},getPublicSSH:function getPublicSSH(){return this[D]},equals:function equals(t){const r=parseKey(t);if(r instanceof Error)return false;return this.type===r.type&&this[P]===r[P]&&this[O]===r[O]&&this[D]===r[D]}};function OpenSSH_Private(t,r,n,i,o,s,l){this.type=t;this.comment=r;this[P]=n;this[O]=i;this[D]=o;this[T]=s;this[L]=l}OpenSSH_Private.prototype=q;{const t=/^-----BEGIN OPENSSH PRIVATE KEY-----(?:\r\n|\n)([\s\S]+)(?:\r\n|\n)-----END OPENSSH PRIVATE KEY-----$/;OpenSSH_Private.parse=(r,n)=>{const o=t.exec(r);if(o===null)return null;let s;const l=Buffer.from(o[1],"base64");if(l.length<31)return new Error("Malformed OpenSSH private key");const u=l.utf8Slice(0,15);if(u!=="openssh-key-v1\0")return new Error(`Unsupported OpenSSH key magic: ${u}`);const h=B(l,15,true);if(h===undefined)return new Error("Malformed OpenSSH private key");if(h!=="none"&&I.indexOf(h)===-1)return new Error(`Unsupported cipher for OpenSSH key: ${h}`);const p=B(l,l._pos,true);if(p===undefined)return new Error("Malformed OpenSSH private key");if(p!=="none"){if(h==="none")return new Error("Malformed OpenSSH private key");if(p!=="bcrypt")return new Error(`Unsupported kdf name for OpenSSH key: ${p}`);if(!n){return new Error("Encrypted private OpenSSH key detected, but no passphrase given")}}else if(h!=="none"){return new Error("Malformed OpenSSH private key")}let g;let m;let _;if(h!=="none")g=y[h];const E=B(l,l._pos);if(E===undefined)return new Error("Malformed OpenSSH private key");if(E.length){switch(p){case"none":return new Error("Malformed OpenSSH private key");case"bcrypt":const t=B(E,0);if(t===undefined||E._pos+4>E.length)return new Error("Malformed OpenSSH private key");const r=k(E,E._pos);const i=Buffer.allocUnsafe(g.keyLen+g.ivLen);const o=b(n,n.length,t,t.length,i,i.length,r);if(o!==0)return new Error("Failed to generate information to decrypt key");m=C(i,0,g.keyLen);_=C(i,g.keyLen,i.length);break}}else if(p!=="none"){return new Error("Malformed OpenSSH private key")}if(l._pos+3>=l.length)return new Error("Malformed OpenSSH private key");const w=k(l,l._pos);l._pos+=4;if(w>0){for(let t=0;t<w;++t){const t=B(l,l._pos);if(t===undefined)return new Error("Malformed OpenSSH private key");const r=B(t,0,true);if(r===undefined)return new Error("Malformed OpenSSH private key")}let t=B(l,l._pos);if(t===undefined)return new Error("Malformed OpenSSH private key");if(m!==undefined){if(t.length<g.blockLen||t.length%g.blockLen!==0){return new Error("Malformed OpenSSH private key")}try{const r={authTagLength:g.authLen};const n=i(g.sslName,m,_,r);if(g.authLen>0){if(l.length-l._pos<g.authLen)return new Error("Malformed OpenSSH private key");n.setAuthTag(C(l,l._pos,l._pos+=g.authLen))}t=combineBuffers(n.update(t),n.final())}catch(t){return t}}if(l._pos!==l.length)return new Error("Malformed OpenSSH private key");s=parseOpenSSHPrivKeys(t,w,m!==undefined)}else{s=[]}return s[0]};function parseOpenSSHPrivKeys(t,r,n){const i=[];if(t.length<8)return new Error("Malformed OpenSSH private key");const o=k(t,0);const s=k(t,4);if(o!==s){if(n){return new Error("OpenSSH key integrity check failed -- bad passphrase?")}return new Error("OpenSSH key integrity check failed")}t._pos=8;let l;let u;for(l=0;l<r;++l){let r;let o;let s;let l;const h=B(t,t._pos,true);if(h===undefined)return new Error("Malformed OpenSSH private key");switch(h){case"ssh-rsa":{const n=B(t,t._pos);if(n===undefined)return new Error("Malformed OpenSSH private key");const i=B(t,t._pos);if(i===undefined)return new Error("Malformed OpenSSH private key");const u=B(t,t._pos);if(u===undefined)return new Error("Malformed OpenSSH private key");const h=B(t,t._pos);if(h===undefined)return new Error("Malformed OpenSSH private key");const p=B(t,t._pos);if(p===undefined)return new Error("Malformed OpenSSH private key");const g=B(t,t._pos);if(g===undefined)return new Error("Malformed OpenSSH private key");s=genOpenSSLRSAPub(n,i);l=genOpenSSHRSAPub(n,i);o=Q(n,i,u,h,p,g);r="sha1";break}case"ssh-dss":{const n=B(t,t._pos);if(n===undefined)return new Error("Malformed OpenSSH private key");const i=B(t,t._pos);if(i===undefined)return new Error("Malformed OpenSSH private key");const u=B(t,t._pos);if(u===undefined)return new Error("Malformed OpenSSH private key");const h=B(t,t._pos);if(h===undefined)return new Error("Malformed OpenSSH private key");const p=B(t,t._pos);if(p===undefined)return new Error("Malformed OpenSSH private key");s=genOpenSSLDSAPub(n,i,u,h);l=genOpenSSHDSAPub(n,i,u,h);o=genOpenSSLDSAPriv(n,i,u,h,p);r="sha1";break}case"ssh-ed25519":{if(!w)return new Error(`Unsupported OpenSSH private key type: ${h}`);const n=B(t,t._pos);if(n===undefined||n.length!==32)return new Error("Malformed OpenSSH private key");const i=B(t,t._pos);if(i===undefined||i.length!==64)return new Error("Malformed OpenSSH private key");s=genOpenSSLEdPub(n);l=genOpenSSHEdPub(n);o=genOpenSSLEdPriv(C(i,0,32));r=null;break}case"ecdsa-sha2-nistp256":r="sha256";u="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":if(r===undefined){r="sha384";u="1.3.132.0.34"}case"ecdsa-sha2-nistp521":{if(r===undefined){r="sha512";u="1.3.132.0.35"}if(!skipFields(t,1))return new Error("Malformed OpenSSH private key");const n=B(t,t._pos);if(n===undefined)return new Error("Malformed OpenSSH private key");const i=B(t,t._pos);if(i===undefined)return new Error("Malformed OpenSSH private key");s=genOpenSSLECDSAPub(u,n);l=genOpenSSHECDSAPub(u,n);o=genOpenSSLECDSAPriv(u,n,i);break}default:return new Error(`Unsupported OpenSSH private key type: ${h}`)}const p=B(t,t._pos,true);if(p===undefined)return new Error("Malformed OpenSSH private key");i.push(new OpenSSH_Private(h,p,o,s,l,r,n))}let h=0;for(l=t._pos;l<t.length;++l){if(t[l]!==++h%255)return new Error("Malformed OpenSSH private key")}return i}}function OpenSSH_Old_Private(t,r,n,i,o,s,l){this.type=t;this.comment=r;this[P]=n;this[O]=i;this[D]=o;this[T]=s;this[L]=l}OpenSSH_Old_Private.prototype=q;{const t=/^-----BEGIN (RSA|DSA|EC) PRIVATE KEY-----(?:\r\n|\n)((?:[^:]+:\s*[\S].*(?:\r\n|\n))*)([\s\S]+)(?:\r\n|\n)-----END (RSA|DSA|EC) PRIVATE KEY-----$/;OpenSSH_Old_Private.parse=(r,n)=>{const o=t.exec(r);if(o===null)return null;let l=Buffer.from(o[3],"base64");let u=o[2];let h=false;if(u!==undefined){u=u.split(/\r\n|\n/g);for(let t=0;t<u.length;++t){const r=u[t];let o=r.indexOf(":");if(r.slice(0,o)==="DEK-Info"){const t=r.slice(o+2);o=t.indexOf(",");if(o===-1)continue;const u=t.slice(0,o).toLowerCase();if(_.indexOf(u)===-1){return new Error(`Cipher (${u}) not supported `+"for encrypted OpenSSH private key")}const p=U[u];if(!p){return new Error(`Cipher (${u}) not supported `+"for encrypted OpenSSH private key")}const g=Buffer.from(t.slice(o+1),"hex");if(g.length!==p.ivLen)return new Error("Malformed encrypted OpenSSH private key");if(!n){return new Error("Encrypted OpenSSH private key detected, but no passphrase given")}const m=C(g,0,8);let E=s("md5").update(n).update(m).digest();while(E.length<p.keyLen){E=combineBuffers(E,s("md5").update(E).update(n).update(m).digest())}if(E.length>p.keyLen)E=C(E,0,p.keyLen);try{const t=i(u,E,g);t.setAutoPadding(false);l=combineBuffers(t.update(l),t.final());h=true}catch(t){return t}}}}let p;let g;let m;let b;let y;let w;let I="Malformed OpenSSH private key";if(h)I+=". Bad passphrase?";switch(o[1]){case"RSA":p="ssh-rsa";g=makePEM("RSA PRIVATE",l);try{w=new E.Reader(l);w.readSequence();w.readInt();const t=w.readString(E.Integer,true);if(t===null)return new Error(I);const r=w.readString(E.Integer,true);if(r===null)return new Error(I);m=genOpenSSLRSAPub(t,r);b=genOpenSSHRSAPub(t,r)}catch{return new Error(I)}y="sha1";break;case"DSA":p="ssh-dss";g=makePEM("DSA PRIVATE",l);try{w=new E.Reader(l);w.readSequence();w.readInt();const t=w.readString(E.Integer,true);if(t===null)return new Error(I);const r=w.readString(E.Integer,true);if(r===null)return new Error(I);const n=w.readString(E.Integer,true);if(n===null)return new Error(I);const i=w.readString(E.Integer,true);if(i===null)return new Error(I);m=genOpenSSLDSAPub(t,r,n,i);b=genOpenSSHDSAPub(t,r,n,i)}catch{return new Error(I)}y="sha1";break;case"EC":let t;let r;let n;try{w=new E.Reader(l);w.readSequence();w.readInt();r=w.readString(E.OctetString,true);w.readByte();const i=w.readLength();if(i!==null){w._offset=i;n=w.readOID();if(n===null)return new Error(I);switch(n){case"1.2.840.10045.3.1.7":t="prime256v1";p="ecdsa-sha2-nistp256";y="sha256";break;case"1.3.132.0.34":t="secp384r1";p="ecdsa-sha2-nistp384";y="sha384";break;case"1.3.132.0.35":t="secp521r1";p="ecdsa-sha2-nistp521";y="sha512";break;default:return new Error(`Unsupported private key EC OID: ${n}`)}}else{return new Error(I)}}catch{return new Error(I)}g=makePEM("EC PRIVATE",l);const i=genOpenSSLECDSAPubFromPriv(t,r);m=genOpenSSLECDSAPub(n,i);b=genOpenSSHECDSAPub(n,i);break}return new OpenSSH_Old_Private(p,"",g,m,b,y,h)}}function PPK_Private(t,r,n,i,o,s,l){this.type=t;this.comment=r;this[P]=n;this[O]=i;this[D]=o;this[T]=s;this[L]=l}PPK_Private.prototype=q;{const t=Buffer.alloc(0);const r=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);const n=Buffer.from([0,0,0,0]);const o=Buffer.from([0,0,0,1]);const u=/^PuTTY-User-Key-File-2: (ssh-(?:rsa|dss))\r?\nEncryption: (aes256-cbc|none)\r?\nComment: ([^\r\n]*)\r?\nPublic-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-MAC: ([^\r\n]+)/;PPK_Private.parse=(h,p)=>{const g=u.exec(h);if(g===null)return null;const m=g[2];const _=m!=="none";if(_&&!p){return new Error("Encrypted PPK private key detected, but no passphrase given")}let E=Buffer.from(g[5],"base64");if(_){const t=y[m];let l=combineBuffers(s("sha1").update(n).update(p).digest(),s("sha1").update(o).update(p).digest());if(l.length>t.keyLen)l=C(l,0,t.keyLen);try{const n=i(t.sslName,l,r);n.setAutoPadding(false);E=combineBuffers(n.update(E),n.final())}catch(t){return t}}const b=g[1];const w=g[3];const I=Buffer.from(g[4],"base64");const R=g[6];const k=b.length;const T=m.length;const P=Buffer.byteLength(w);const O=I.length;const D=E.length;const L=Buffer.allocUnsafe(4+k+4+T+4+P+4+O+4+D);let U=0;v(L,k,U);L.utf8Write(b,U+=4,k);v(L,T,U+=k);L.utf8Write(m,U+=4,T);v(L,P,U+=T);L.utf8Write(w,U+=4,P);v(L,O,U+=P);L.set(I,U+=4);v(L,D,U+=O);L.set(E,U+4);if(!p)p=t;const W=l("sha1",s("sha1").update("putty-private-key-file-mac-key").update(p).digest()).update(L).digest("hex");if(W!==R){if(_){return new Error("PPK private key integrity check failed -- bad passphrase?")}return new Error("PPK private key integrity check failed")}let q;let $;let j;I._pos=0;skipFields(I,1);switch(b){case"ssh-rsa":{const t=B(I,I._pos);if(t===undefined)return new Error("Malformed PPK public key");const r=B(I,I._pos);if(r===undefined)return new Error("Malformed PPK public key");const n=B(E,0);if(n===undefined)return new Error("Malformed PPK private key");const i=B(E,E._pos);if(i===undefined)return new Error("Malformed PPK private key");const o=B(E,E._pos);if(o===undefined)return new Error("Malformed PPK private key");const s=B(E,E._pos);if(s===undefined)return new Error("Malformed PPK private key");q=genOpenSSLRSAPub(r,t);$=genOpenSSHRSAPub(r,t);j=Q(r,t,n,s,i,o);break}case"ssh-dss":{const t=B(I,I._pos);if(t===undefined)return new Error("Malformed PPK public key");const r=B(I,I._pos);if(r===undefined)return new Error("Malformed PPK public key");const n=B(I,I._pos);if(n===undefined)return new Error("Malformed PPK public key");const i=B(I,I._pos);if(i===undefined)return new Error("Malformed PPK public key");const o=B(E,0);if(o===undefined)return new Error("Malformed PPK private key");q=genOpenSSLDSAPub(t,r,n,i);$=genOpenSSHDSAPub(t,r,n,i);j=genOpenSSLDSAPriv(t,r,n,i,o);break}}return new PPK_Private(b,w,j,q,$,"sha1",_)}}function OpenSSH_Public(t,r,n,i,o){this.type=t;this.comment=r;this[P]=null;this[O]=n;this[D]=i;this[T]=o;this[L]=false}OpenSSH_Public.prototype=q;{let t;if(w)t=/^(((?:ssh-(?:rsa|dss|ed25519))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z/+=]+)(?:$|\s+([\S].*)?)$/;else t=/^(((?:ssh-(?:rsa|dss))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z/+=]+)(?:$|\s+([\S].*)?)$/;OpenSSH_Public.parse=r=>{const n=t.exec(r);if(n===null)return null;const i=n[1];const o=n[2];const s=Buffer.from(n[3],"base64");const l=n[4]||"";const u=B(s,s._pos,true);if(u===undefined||u.indexOf(o)!==0)return new Error("Malformed OpenSSH public key");return parseDER(s,o,l,i)}}function RFC4716_Public(t,r,n,i,o){this.type=t;this.comment=r;this[P]=null;this[O]=n;this[D]=i;this[T]=o;this[L]=false}RFC4716_Public.prototype=q;{const t=/^---- BEGIN SSH2 PUBLIC KEY ----(?:\r?\n)((?:.{0,72}\r?\n)+)---- END SSH2 PUBLIC KEY ----$/;const r=/^[A-Z0-9a-z/+=\r\n]+$/;const n=/^([\x21-\x39\x3B-\x7E]{1,64}): ((?:[^\\]*\\\r?\n)*[^\r\n]+)\r?\n/gm;const i=/\\\r?\n/g;RFC4716_Public.parse=o=>{let s=t.exec(o);if(s===null)return null;const l=s[1];let u=0;let h="";while(s=n.exec(l)){const t=s[1];const r=s[2].replace(i,"");if(r.length>1024){n.lastIndex=0;return new Error("Malformed RFC4716 public key")}u=n.lastIndex;if(t.toLowerCase()==="comment"){h=r;if(h.length>1&&h.charCodeAt(0)===34&&h.charCodeAt(h.length-1)===34){h=h.slice(1,-1)}}}let p=l.slice(u);if(!r.test(p))return new Error("Malformed RFC4716 public key");p=Buffer.from(p,"base64");const g=B(p,0,true);if(g===undefined)return new Error("Malformed RFC4716 public key");let m=null;let _=null;switch(g){case"ssh-rsa":{const t=B(p,p._pos);if(t===undefined)return new Error("Malformed RFC4716 public key");const r=B(p,p._pos);if(r===undefined)return new Error("Malformed RFC4716 public key");m=genOpenSSLRSAPub(r,t);_=genOpenSSHRSAPub(r,t);break}case"ssh-dss":{const t=B(p,p._pos);if(t===undefined)return new Error("Malformed RFC4716 public key");const r=B(p,p._pos);if(r===undefined)return new Error("Malformed RFC4716 public key");const n=B(p,p._pos);if(n===undefined)return new Error("Malformed RFC4716 public key");const i=B(p,p._pos);if(i===undefined)return new Error("Malformed RFC4716 public key");m=genOpenSSLDSAPub(t,r,n,i);_=genOpenSSHDSAPub(t,r,n,i);break}default:return new Error("Malformed RFC4716 public key")}return new RFC4716_Public(g,h,m,_,"sha1")}}function parseDER(t,r,n,i){if(!isSupportedKeyType(r))return new Error(`Unsupported OpenSSH public key type: ${r}`);let o;let s;let l=null;let u=null;switch(r){case"ssh-rsa":{const r=B(t,t._pos||0);if(r===undefined)return new Error("Malformed OpenSSH public key");const n=B(t,t._pos);if(n===undefined)return new Error("Malformed OpenSSH public key");l=genOpenSSLRSAPub(n,r);u=genOpenSSHRSAPub(n,r);o="sha1";break}case"ssh-dss":{const r=B(t,t._pos||0);if(r===undefined)return new Error("Malformed OpenSSH public key");const n=B(t,t._pos);if(n===undefined)return new Error("Malformed OpenSSH public key");const i=B(t,t._pos);if(i===undefined)return new Error("Malformed OpenSSH public key");const s=B(t,t._pos);if(s===undefined)return new Error("Malformed OpenSSH public key");l=genOpenSSLDSAPub(r,n,i,s);u=genOpenSSHDSAPub(r,n,i,s);o="sha1";break}case"ssh-ed25519":{const r=B(t,t._pos||0);if(r===undefined||r.length!==32)return new Error("Malformed OpenSSH public key");l=genOpenSSLEdPub(r);u=genOpenSSHEdPub(r);o=null;break}case"ecdsa-sha2-nistp256":o="sha256";s="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":if(o===undefined){o="sha384";s="1.3.132.0.34"}case"ecdsa-sha2-nistp521":{if(o===undefined){o="sha512";s="1.3.132.0.35"}if(!skipFields(t,1))return new Error("Malformed OpenSSH public key");const r=B(t,t._pos||0);if(r===undefined)return new Error("Malformed OpenSSH public key");l=genOpenSSLECDSAPub(s,r);u=genOpenSSHECDSAPub(s,r);break}default:return new Error(`Unsupported OpenSSH public key type: ${r}`)}return new OpenSSH_Public(i,n,l,u,o)}function isSupportedKeyType(t){switch(t){case"ssh-rsa":case"ssh-dss":case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":return true;case"ssh-ed25519":if(w)return true;default:return false}}function isParsedKey(t){if(!t)return false;return typeof t[L]==="boolean"}function parseKey(t,r){if(isParsedKey(t))return t;let n;if(Buffer.isBuffer(t)){n=t;t=t.utf8Slice(0,t.length).trim()}else if(typeof t==="string"){t=t.trim()}else{return new Error("Key data must be a Buffer or string")}if(r!=undefined){if(typeof r==="string")r=Buffer.from(r);else if(!Buffer.isBuffer(r))return new Error("Passphrase must be a string or Buffer when supplied")}let i;if((i=OpenSSH_Private.parse(t,r))!==null)return i;if((i=OpenSSH_Old_Private.parse(t,r))!==null)return i;if((i=PPK_Private.parse(t,r))!==null)return i;if((i=OpenSSH_Public.parse(t))!==null)return i;if((i=RFC4716_Public.parse(t))!==null)return i;if(n){W.init(n,0);const r=W.readString(true);if(r!==undefined){t=W.readRaw();if(t!==undefined){i=parseDER(t,r,"",r);if(i instanceof Error)i=null}}W.clear()}if(i)return i;return new Error("Unsupported key format")}t.exports={isParsedKey:isParsedKey,isSupportedKeyType:isSupportedKeyType,parseDERKey:(t,r)=>parseDER(t,r,"",r),parseKey:parseKey}},7609:(t,r,n)=>{"use strict";const i=n(2357);const{inspect:o}=n(1669);function addNumericalSeparator(t){let r="";let n=t.length;const i=t[0]==="-"?1:0;for(;n>=i+4;n-=3)r=`_${t.slice(n-3,n)}${r}`;return`${t.slice(0,n)}${r}`}function oneOf(t,r){i(typeof r==="string","`thing` has to be of type string");if(Array.isArray(t)){const n=t.length;i(n>0,"At least one expected value needs to be specified");t=t.map((t=>String(t)));if(n>2){return`one of ${r} ${t.slice(0,n-1).join(", ")}, or `+t[n-1]}else if(n===2){return`one of ${r} ${t[0]} or ${t[1]}`}return`of ${r} ${t[0]}`}return`of ${r} ${String(t)}`}r.ERR_INTERNAL_ASSERTION=class ERR_INTERNAL_ASSERTION extends Error{constructor(t){super();Error.captureStackTrace(this,ERR_INTERNAL_ASSERTION);const r="This is caused by either a bug in ssh2 "+"or incorrect usage of ssh2 internals.\n"+"Please open an issue with this stack trace at "+"https://github.com/mscdex/ssh2/issues\n";this.message=t===undefined?r:`${t}\n${r}`}};const s=2**32;const l=(()=>{try{return new Function("return 2n ** 32n")()}catch{}})();r.ERR_OUT_OF_RANGE=class ERR_OUT_OF_RANGE extends RangeError{constructor(t,r,n,u){super();Error.captureStackTrace(this,ERR_OUT_OF_RANGE);i(r,'Missing "range" argument');let h=u?t:`The value of "${t}" is out of range.`;let p;if(Number.isInteger(n)&&Math.abs(n)>s){p=addNumericalSeparator(String(n))}else if(typeof n==="bigint"){p=String(n);if(n>l||n<-l)p=addNumericalSeparator(p);p+="n"}else{p=o(n)}h+=` It must be ${r}. Received ${p}`;this.message=h}};class ERR_INVALID_ARG_TYPE extends TypeError{constructor(t,r,n){super();Error.captureStackTrace(this,ERR_INVALID_ARG_TYPE);i(typeof t==="string",`'name' must be a string`);let o;if(typeof r==="string"&&r.startsWith("not ")){o="must not be";r=r.replace(/^not /,"")}else{o="must be"}let s;if(t.endsWith(" argument")){s=`The ${t} ${o} ${oneOf(r,"type")}`}else{const n=t.includes(".")?"property":"argument";s=`The "${t}" ${n} ${o} ${oneOf(r,"type")}`}s+=`. Received type ${typeof n}`;this.message=s}}r.ERR_INVALID_ARG_TYPE=ERR_INVALID_ARG_TYPE;r.validateNumber=function validateNumber(t,r){if(typeof t!=="number")throw new ERR_INVALID_ARG_TYPE(r,"number",t)}},9475:(t,r,n)=>{"use strict";const i=n(970).Ber;let o;const s=Buffer[Symbol.species];const l=Object.getPrototypeOf(Uint8Array.prototype).fill;function readUInt32BE(t,r){return t[r++]*16777216+t[r++]*65536+t[r++]*256+t[r]}function bufferCopy(t,r,n,i,o){if(!o)o=0;if(i>t.length)i=t.length;let s=i-n;const l=r.length-o;if(s>l)s=l;r.set(new Uint8Array(t.buffer,t.byteOffset+n,s),o);return s}function bufferSlice(t,r,n){if(n===undefined)n=t.length;return new s(t.buffer,t.byteOffset+r,n-r)}function makeBufferParser(){let t=0;let r;const n={init:(n,i)=>{r=n;t=typeof i==="number"?i:0},pos:()=>t,length:()=>r?r.length:0,avail:()=>r&&t<r.length?r.length-t:0,clear:()=>{r=undefined},readUInt32BE:()=>{if(!r||t+3>=r.length)return;return r[t++]*16777216+r[t++]*65536+r[t++]*256+r[t++]},readUInt64BE:n=>{if(!r||t+7>=r.length)return;switch(n){case"always":return BigInt(`0x${r.hexSlice(t,t+=8)}`);case"maybe":if(r[t]>31)return BigInt(`0x${r.hexSlice(t,t+=8)}`);default:return r[t++]*72057594037927940+r[t++]*281474976710656+r[t++]*1099511627776+r[t++]*4294967296+r[t++]*16777216+r[t++]*65536+r[t++]*256+r[t++]}},skip:n=>{if(r&&n>0)t+=n},skipString:()=>{const i=n.readUInt32BE();if(i===undefined)return;t+=i;return t<=r.length?i:undefined},readByte:()=>{if(r&&t<r.length)return r[t++]},readBool:()=>{if(r&&t<r.length)return!!r[t++]},readList:()=>{const t=n.readString(true);if(t===undefined)return;return t?t.split(","):[]},readString:(i,o)=>{if(typeof i==="number"){o=i;i=undefined}const s=n.readUInt32BE();if(s===undefined)return;if(r.length-t<s||typeof o==="number"&&s>o){return}if(i){if(Buffer.isBuffer(i))return bufferCopy(r,i,t,t+=s);return r.utf8Slice(t,t+=s)}return bufferSlice(r,t,t+=s)},readRaw:n=>{if(!r)return;if(typeof n!=="number")return bufferSlice(r,t,t+=r.length-t);if(r.length-t>=n)return bufferSlice(r,t,t+=n)}};return n}function makeError(t,r,n){const i=new Error(t);if(typeof r==="boolean"){n=r;i.level="protocol"}else{i.level=r||"protocol"}i.fatal=!!n;return i}function writeUInt32BE(t,r,n){t[n++]=r>>>24;t[n++]=r>>>16;t[n++]=r>>>8;t[n++]=r;return n}const u=makeBufferParser();t.exports={bufferCopy:bufferCopy,bufferSlice:bufferSlice,FastBuffer:s,bufferFill:(t,r,n,i)=>l.call(t,r,n,i),makeError:makeError,doFatalError:(t,r,i,s)=>{let l;if(o===undefined)({DISCONNECT_REASON:o}=n(9475));if(r instanceof Error){l=r;if(typeof i!=="number")s=o.PROTOCOL_ERROR;else s=i}else{l=makeError(r,i,true)}if(typeof s!=="number")s=o.PROTOCOL_ERROR;t.disconnect(s);t._destruct();t._onError(l);return Infinity},readUInt32BE:readUInt32BE,writeUInt32BE:writeUInt32BE,writeUInt32LE:(t,r,n)=>{t[n++]=r;t[n++]=r>>>8;t[n++]=r>>>16;t[n++]=r>>>24;return n},makeBufferParser:makeBufferParser,bufferParser:makeBufferParser(),readString:(t,r,n,i)=>{if(typeof n==="number"){i=n;n=undefined}if(r===undefined)r=0;const o=t.length-r;if(r<0||r>=t.length||o<4)return;const s=readUInt32BE(t,r);if(o<4+s||typeof i==="number"&&s>i)return;r+=4;const l=r+s;t._pos=l;if(n){if(Buffer.isBuffer(n))return bufferCopy(t,n,r,l);return t.utf8Slice(r,l)}return bufferSlice(t,r,l)},sigSSHToASN1:(t,r)=>{switch(r){case"ssh-dss":{if(t.length>40)return t;const r=new i.Writer;r.startSequence();let n=t.slice(0,20);let o=t.slice(20);if(n[0]&128){const t=Buffer.allocUnsafe(21);t[0]=0;n.copy(t,1);n=t}else if(n[0]===0&&!(n[1]&128)){n=n.slice(1)}if(o[0]&128){const t=Buffer.allocUnsafe(21);t[0]=0;o.copy(t,1);o=t}else if(o[0]===0&&!(o[1]&128)){o=o.slice(1)}r.writeBuffer(n,i.Integer);r.writeBuffer(o,i.Integer);r.endSequence();return r.buffer}case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":{u.init(t,0);const r=u.readString();const n=u.readString();u.clear();if(r===undefined||n===undefined)return;const o=new i.Writer;o.startSequence();o.writeBuffer(r,i.Integer);o.writeBuffer(n,i.Integer);o.endSequence();return o.buffer}default:return t}},convertSignature:(t,r)=>{switch(r){case"ssh-dss":{if(t.length<=40)return t;const r=new i.Reader(t);r.readSequence();let n=r.readString(i.Integer,true);let o=r.readString(i.Integer,true);let s=0;let l=0;if(n.length<20){const t=Buffer.allocUnsafe(20);t.set(n,1);n=t;n[0]=0}if(o.length<20){const t=Buffer.allocUnsafe(20);t.set(o,1);o=t;o[0]=0}if(n.length>20&&n[0]===0)s=1;if(o.length>20&&o[0]===0)l=1;const u=Buffer.allocUnsafe(n.length-s+(o.length-l));bufferCopy(n,u,s,n.length,0);bufferCopy(o,u,l,o.length,n.length-s);return u}case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":{if(t[0]===0)return t;const r=new i.Reader(t);r.readSequence();const n=r.readString(i.Integer,true);const o=r.readString(i.Integer,true);if(n===null||o===null)return;const s=Buffer.allocUnsafe(4+n.length+4+o.length);writeUInt32BE(s,n.length,0);s.set(n,4);writeUInt32BE(s,o.length,4+n.length);s.set(o,4+4+n.length);return s}}return t},sendPacket:(t,r,n)=>{if(!n&&t._kexinit!==undefined){if(t._queue===undefined)t._queue=[];t._queue.push(r);t._debug&&t._debug("Outbound: ... packet queued");return false}t._cipher.encrypt(r);return true}}},6715:(t,r,n)=>{"use strict";const{kMaxLength:i}=n(4293);const{createInflate:o,constants:{DEFLATE:s,INFLATE:l,Z_DEFAULT_CHUNK:u,Z_DEFAULT_COMPRESSION:h,Z_DEFAULT_MEMLEVEL:p,Z_DEFAULT_STRATEGY:g,Z_DEFAULT_WINDOWBITS:m,Z_PARTIAL_FLUSH:_}}=n(8761);const E=o()._handle.constructor;function processCallback(){throw new Error("Should not get here")}function zlibOnError(t,r,n){const i=this._owner;const o=new Error(t);o.errno=r;o.code=n;i._err=o}function _close(t){if(!t._handle)return;t._handle.close();t._handle=null}class Zlib{constructor(t){const r=m;const n=h;const o=p;const s=g;const l=undefined;this._err=undefined;this._writeState=new Uint32Array(2);this._chunkSize=u;this._maxOutputLength=i;this._outBuffer=Buffer.allocUnsafe(this._chunkSize);this._outOffset=0;this._handle=new E(t);this._handle._owner=this;this._handle.onerror=zlibOnError;this._handle.init(r,n,o,s,this._writeState,processCallback,l)}writeSync(t,r){const n=this._handle;if(!n)throw new Error("Invalid Zlib instance");let i=t.length;let o=this._chunkSize-this._outOffset;let s=0;let l;let u;let h;let p=0;const g=this._writeState;let m=this._outBuffer;let E=this._outOffset;const b=this._chunkSize;while(true){n.writeSync(_,t,s,i,m,E,o);if(this._err)throw this._err;l=g[0];u=g[1];const r=i-u;const y=o-l;if(y>0){const t=E===0&&y===m.length?m:m.slice(E,E+y);E+=y;if(!h)h=t;else if(h.push===undefined)h=[h,t];else h.push(t);p+=t.byteLength;if(p>this._maxOutputLength){_close(this);throw new Error(`Output length exceeded maximum of ${this._maxOutputLength}`)}}else if(y!==0){throw new Error("have should not go down")}if(l===0||E>=b){o=b;E=0;m=Buffer.allocUnsafe(b)}if(l===0){s+=r;i=u}else{break}}this._outBuffer=m;this._outOffset=E;if(p===0)h=Buffer.alloc(0);if(r){h.totalLen=p;return h}if(h.push===undefined)return h;const y=Buffer.allocUnsafe(p);for(let t=0,r=0;t<h.length;++t){const n=h[t];y.set(n,r);r+=n.length}return y}}class ZlibPacketWriter{constructor(t){this.allocStart=0;this.allocStartKEX=0;this._protocol=t;this._zlib=new Zlib(s)}cleanup(){if(this._zlib)_close(this._zlib)}alloc(t,r){return Buffer.allocUnsafe(t)}finalize(t,r){if(this._protocol._kexinit===undefined||r){const r=this._zlib.writeSync(t,true);const n=this._protocol._cipher.allocPacket(r.totalLen);if(r.push===undefined){n.set(r,5)}else{for(let t=0,i=5;t<r.length;++t){const o=r[t];n.set(o,i);i+=o.length}}return n}return t}}class PacketWriter{constructor(t){this.allocStart=5;this.allocStartKEX=5;this._protocol=t}cleanup(){}alloc(t,r){if(this._protocol._kexinit===undefined||r)return this._protocol._cipher.allocPacket(t);return Buffer.allocUnsafe(t)}finalize(t,r){return t}}class ZlibPacketReader{constructor(){this._zlib=new Zlib(l)}cleanup(){if(this._zlib)_close(this._zlib)}read(t){return this._zlib.writeSync(t,false)}}class PacketReader{cleanup(){}read(t){return t}}t.exports={PacketReader:PacketReader,PacketWriter:PacketWriter,ZlibPacketReader:ZlibPacketReader,ZlibPacketWriter:ZlibPacketWriter}},2986:(t,r,n)=>{"use strict";const{Server:i}=n(1631);const o=n(8614);const{listenerCount:s}=o;const{CHANNEL_OPEN_FAILURE:l,DEFAULT_CIPHER:u,DEFAULT_COMPRESSION:h,DEFAULT_KEX:p,DEFAULT_MAC:g,DEFAULT_SERVER_HOST_KEY:m,DISCONNECT_REASON:_,DISCONNECT_REASON_BY_VALUE:E,SUPPORTED_CIPHER:b,SUPPORTED_COMPRESSION:y,SUPPORTED_KEX:w,SUPPORTED_MAC:I,SUPPORTED_SERVER_HOST_KEY:C}=n(6832);const{init:R}=n(5708);const{KexInit:B}=n(4126);const{parseKey:k}=n(2218);const v=n(9031);const{SFTP:T}=n(2026);const{writeUInt32BE:P}=n(9475);const{Channel:O,MAX_WINDOW:D,PACKET_SIZE:L,windowAdjust:U,WINDOW_THRESHOLD:W}=n(3204);const{ChannelManager:Q,generateAlgorithmList:q,isWritable:$,onChannelOpenFailure:j,onCHANNEL_CLOSE:G}=n(834);const Y=10;class AuthContext extends o{constructor(t,r,n,i,o){super();this.username=this.user=r;this.service=n;this.method=i;this._initialResponse=false;this._finalResponse=false;this._multistep=false;this._cbfinal=(t,r,n)=>{if(!this._finalResponse){this._finalResponse=true;o(this,t,r,n)}};this._protocol=t}accept(){this._cleanup&&this._cleanup();this._initialResponse=true;this._cbfinal(true)}reject(t,r){this._cleanup&&this._cleanup();this._initialResponse=true;this._cbfinal(false,t,r)}}class KeyboardAuthContext extends AuthContext{constructor(t,r,n,i,o,s){super(t,r,n,i,s);this._multistep=true;this._cb=undefined;this._onInfoResponse=t=>{const r=this._cb;if(r){this._cb=undefined;r(t)}};this.submethods=o;this.on("abort",(()=>{this._cb&&this._cb(new Error("Authentication request aborted"))}))}prompt(t,r,n,i){if(!Array.isArray(t))t=[t];if(typeof r==="function"){i=r;r=n=undefined}else if(typeof n==="function"){i=n;n=undefined}else if(typeof i!=="function"){i=undefined}for(let r=0;r<t.length;++r){if(typeof t[r]==="string"){t[r]={prompt:t[r],echo:true}}}this._cb=i;this._initialResponse=true;this._protocol.authInfoReq(r,n,t)}}class PKAuthContext extends AuthContext{constructor(t,r,n,i,o,s){super(t,r,n,i,s);this.key={algo:o.keyAlgo,data:o.key};this.signature=o.signature;this.blob=o.blob}accept(){if(!this.signature){this._initialResponse=true;this._protocol.authPKOK(this.key.algo,this.key.data)}else{AuthContext.prototype.accept.call(this)}}}class HostbasedAuthContext extends AuthContext{constructor(t,r,n,i,o,s){super(t,r,n,i,s);this.key={algo:o.keyAlgo,data:o.key};this.signature=o.signature;this.blob=o.blob;this.localHostname=o.localHostname;this.localUsername=o.localUsername}}class PwdAuthContext extends AuthContext{constructor(t,r,n,i,o,s){super(t,r,n,i,s);this.password=o;this._changeCb=undefined}requestChange(t,r){if(this._changeCb)throw new Error("Change request already in progress");if(typeof t!=="string")throw new Error("prompt argument must be a string");if(typeof r!=="function")throw new Error("Callback argument must be a function");this._changeCb=r;this._protocol.authPasswdChg(t)}}class Session extends o{constructor(t,r,n){super();this.type="session";this.subtype=undefined;this._ending=false;this._channel=undefined;this._chanInfo={type:"session",incoming:{id:n,window:D,packetSize:L,state:"open"},outgoing:{id:r.sender,window:r.window,packetSize:r.packetSize,state:"open"}}}}class Server extends o{constructor(t,r){super();if(typeof t!=="object"||t===null)throw new Error("Missing configuration object");const n=Object.create(null);const o=[];const s=t.hostKeys;if(!Array.isArray(s))throw new Error("hostKeys must be an array");const l=typeof t.algorithms==="object"&&t.algorithms!==null?t.algorithms:{};const _=q(l.serverHostKey,m,C);for(let t=0;t<s.length;++t){let r;if(Buffer.isBuffer(s[t])||typeof s[t]==="string")r=k(s[t]);else r=k(s[t].key,s[t].passphrase);if(r instanceof Error)throw new Error(`Cannot parse privateKey: ${r.message}`);if(Array.isArray(r)){r=r[0]}if(r.getPrivatePEM()===null)throw new Error("privateKey value contains an invalid private key");if(o.includes(r.type))continue;if(r.type==="ssh-rsa"){let t=_.indexOf("ssh-rsa");const i=_.indexOf("rsa-sha2-256");const s=_.indexOf("rsa-sha2-512");if(t===-1){t=Infinity}[t,i,s].sort(compareNumbers).forEach((l=>{if(l===-1)return;let u;switch(l){case t:u="ssh-rsa";break;case i:u="rsa-sha2-256";break;case s:u="rsa-sha2-512";break;default:return}n[u]=r;o.push(u)}))}else{n[r.type]=r;o.push(r.type)}}const E={kex:q(l.kex,p,w),serverHostKey:o,cs:{cipher:q(l.cipher,u,b),mac:q(l.hmac,g,I),compress:q(l.compress,h,y),lang:[]},sc:undefined};E.sc=E.cs;if(typeof r==="function")this.on("connection",r);const R=typeof t.debug==="function"?t.debug:undefined;const v=t.ident?Buffer.from(t.ident):undefined;const T=new B(E);this._srv=new i((r=>{if(this._connections>=this.maxConnections){r.destroy();return}++this._connections;r.once("close",(()=>{--this._connections}));let i;if(R){const t=`[${process.hrtime().join(".")}] `;i=r=>{R(`${t}${r}`)}}new Client(r,n,v,T,i,this,t)})).on("error",(t=>{this.emit("error",t)})).on("listening",(()=>{this.emit("listening")})).on("close",(()=>{this.emit("close")}));this._connections=0;this.maxConnections=Infinity}injectSocket(t){this._srv.emit("connection",t)}listen(...t){this._srv.listen(...t);return this}address(){return this._srv.address()}getConnections(t){this._srv.getConnections(t);return this}close(t){this._srv.close(t);return this}ref(){this._srv.ref();return this}unref(){this._srv.unref();return this}}Server.KEEPALIVE_CLIENT_INTERVAL=15e3;Server.KEEPALIVE_CLIENT_COUNT_MAX=3;class Client extends o{constructor(t,r,n,i,o,u,h){super();let p=0;let g=false;let m=[];let b;let y;let w;const I=[];this._sock=t;this._chanMgr=new Q(this);this._debug=o;this.noMoreSessions=false;this.authenticated=false;function onClientPreHeaderError(t){}this.on("error",onClientPreHeaderError);const C=!o?undefined:(t,r,n)=>{o(`Debug output from client: ${JSON.stringify(n)}`)};const B=typeof h.keepaliveInterval==="number"&&isFinite(h.keepaliveInterval)&&h.keepaliveInterval>0?h.keepaliveInterval:typeof Server.KEEPALIVE_CLIENT_INTERVAL==="number"&&isFinite(Server.KEEPALIVE_CLIENT_INTERVAL)&&Server.KEEPALIVE_CLIENT_INTERVAL>0?Server.KEEPALIVE_CLIENT_INTERVAL:-1;const k=typeof h.keepaliveCountMax==="number"&&isFinite(h.keepaliveCountMax)&&h.keepaliveCountMax>=0?h.keepaliveCountMax:typeof Server.KEEPALIVE_CLIENT_COUNT_MAX==="number"&&isFinite(Server.KEEPALIVE_CLIENT_COUNT_MAX)&&Server.KEEPALIVE_CLIENT_COUNT_MAX>=0?Server.KEEPALIVE_CLIENT_COUNT_MAX:-1;let q=0;if(B!==-1&&k!==-1){this.once("ready",(()=>{const onClose=()=>{clearInterval(y)};this.on("close",onClose).on("end",onClose);y=setInterval((()=>{if(++q>k){clearInterval(y);const t=new Error("Keepalive timeout");t.level="client-timeout";this.emit("error",t);this.end()}else{z.ping()}}),B)}));w=()=>{y&&y.refresh();q=0}}const z=this._protocol=new v({server:true,hostKeys:r,ident:n,offer:i,onPacket:w,greeting:h.greeting,banner:h.banner,onWrite:r=>{if($(t))t.write(r)},onError:r=>{if(!z._destruct)t.removeAllListeners("data");this.emit("error",r);try{t.end()}catch{}},onHeader:r=>{this.removeListener("error",onClientPreHeaderError);const n={ip:t.remoteAddress,family:t.remoteFamily,port:t.remotePort,header:r};if(!u.emit("connection",this,n)){z.disconnect(_.BY_APPLICATION);t.end();return}if(r.greeting)this.emit("greeting",r.greeting)},onHandshakeComplete:t=>{if(++p>1)this.emit("rekey");this.emit("handshake",t)},debug:o,messageHandlers:{DEBUG:C,DISCONNECT:(r,n,i)=>{if(n!==_.BY_APPLICATION){if(!i){i=E[n];if(i===undefined)i=`Unexpected disconnection reason: ${n}`}const t=new Error(i);t.code=n;this.emit("error",t)}t.end()},CHANNEL_OPEN:(t,r)=>{if(r.type==="session"&&this.noMoreSessions||!this.authenticated){const t=l.ADMINISTRATIVELY_PROHIBITED;return z.channelOpenFail(r.sender,t)}let n=-1;let i;let u=false;let h;const reject=()=>{if(u)return;u=true;if(i===undefined){if(n===-1)i=l.RESOURCE_SHORTAGE;else i=l.CONNECT_FAILED}z.channelOpenFail(r.sender,i,"")};const reserveChannel=()=>{n=this._chanMgr.add();if(n===-1){i=l.RESOURCE_SHORTAGE;if(o){o("Automatic rejection of incoming channel open: "+"no channels available")}}return n!==-1};const p=r.data;switch(r.type){case"session":if(s(this,"session")&&reserveChannel()){h=()=>{if(u)return;u=true;const t=new Session(this,r,n);this._chanMgr.update(n,t);z.channelOpenConfirm(r.sender,n,D,L);return t};this.emit("session",h,reject);return}break;case"direct-tcpip":if(s(this,"tcpip")&&reserveChannel()){h=()=>{if(u)return;u=true;const t={type:undefined,incoming:{id:n,window:D,packetSize:L,state:"open"},outgoing:{id:r.sender,window:r.window,packetSize:r.packetSize,state:"open"}};const i=new O(this,t,{server:true});this._chanMgr.update(n,i);z.channelOpenConfirm(r.sender,n,D,L);return i};this.emit("tcpip",h,reject,p);return}break;case"direct-streamlocal@openssh.com":if(s(this,"openssh.streamlocal")&&reserveChannel()){h=()=>{if(u)return;u=true;const t={type:undefined,incoming:{id:n,window:D,packetSize:L,state:"open"},outgoing:{id:r.sender,window:r.window,packetSize:r.packetSize,state:"open"}};const i=new O(this,t,{server:true});this._chanMgr.update(n,i);z.channelOpenConfirm(r.sender,n,D,L);return i};this.emit("openssh.streamlocal",h,reject,p);return}break;default:i=l.UNKNOWN_CHANNEL_TYPE;if(o){o("Automatic rejection of unsupported incoming channel open"+` type: ${r.type}`)}}if(i===undefined){i=l.ADMINISTRATIVELY_PROHIBITED;if(o){o("Automatic rejection of unexpected incoming channel open"+` for: ${r.type}`)}}reject()},CHANNEL_OPEN_CONFIRMATION:(t,r)=>{const n=this._chanMgr.get(r.recipient);if(typeof n!=="function")return;const i={type:n.type,incoming:{id:r.recipient,window:D,packetSize:L,state:"open"},outgoing:{id:r.sender,window:r.window,packetSize:r.packetSize,state:"open"}};const o=new O(this,i,{server:true});this._chanMgr.update(r.recipient,o);n(undefined,o)},CHANNEL_OPEN_FAILURE:(t,r,n,i)=>{const o=this._chanMgr.get(r);if(typeof o!=="function")return;const s={reason:n,description:i};j(this,r,s,o)},CHANNEL_DATA:(t,r,n)=>{let i=this._chanMgr.get(r);if(typeof i!=="object"||i===null)return;if(i.constructor===Session){i=i._channel;if(!i)return}if(i.incoming.window===0)return;i.incoming.window-=n.length;if(i.push(n)===false){i._waitChanDrain=true;return}if(i.incoming.window<=W)U(i)},CHANNEL_EXTENDED_DATA:(t,r,n,i)=>{},CHANNEL_WINDOW_ADJUST:(t,r,n)=>{let i=this._chanMgr.get(r);if(typeof i!=="object"||i===null)return;if(i.constructor===Session){i=i._channel;if(!i)return}i.outgoing.window+=n;if(i._waitWindow){i._waitWindow=false;if(i._chunk){i._write(i._chunk,null,i._chunkcb)}else if(i._chunkcb){i._chunkcb()}else if(i._chunkErr){i.stderr._write(i._chunkErr,null,i._chunkcbErr)}else if(i._chunkcbErr){i._chunkcbErr()}}},CHANNEL_SUCCESS:(t,r)=>{let n=this._chanMgr.get(r);if(typeof n!=="object"||n===null)return;if(n.constructor===Session){n=n._channel;if(!n)return}if(n._callbacks.length)n._callbacks.shift()(false)},CHANNEL_FAILURE:(t,r)=>{let n=this._chanMgr.get(r);if(typeof n!=="object"||n===null)return;if(n.constructor===Session){n=n._channel;if(!n)return}if(n._callbacks.length)n._callbacks.shift()(true)},CHANNEL_REQUEST:(t,r,n,i,l)=>{const u=this._chanMgr.get(r);if(typeof u!=="object"||u===null)return;let h=false;let p;let g;if(u.constructor!==Session){if(i)z.channelFailure(u.outgoing.id);return}if(i){if(n!=="shell"&&n!=="exec"&&n!=="subsystem"){p=()=>{if(h||u._ending||u._channel)return;h=true;z.channelSuccess(u._chanInfo.outgoing.id)}}g=()=>{if(h||u._ending||u._channel)return;h=true;z.channelFailure(u._chanInfo.outgoing.id)}}if(u._ending){g&&g();return}switch(n){case"env":if(s(u,"env")){u.emit("env",p,g,{key:l.name,val:l.value});return}break;case"pty-req":if(s(u,"pty")){u.emit("pty",p,g,l);return}break;case"window-change":if(s(u,"window-change"))u.emit("window-change",p,g,l);else g&&g();break;case"x11-req":if(s(u,"x11")){u.emit("x11",p,g,l);return}break;case"signal":if(s(u,"signal")){u.emit("signal",p,g,{name:l});return}break;case"auth-agent-req@openssh.com":if(s(u,"auth-agent")){u.emit("auth-agent",p,g);return}break;case"shell":if(s(u,"shell")){p=()=>{if(h||u._ending||u._channel)return;h=true;if(i)z.channelSuccess(u._chanInfo.outgoing.id);const t=new O(this,u._chanInfo,{server:true});t.subtype=u.subtype=n;u._channel=t;return t};u.emit("shell",p,g);return}break;case"exec":if(s(u,"exec")){p=()=>{if(h||u._ending||u._channel)return;h=true;if(i)z.channelSuccess(u._chanInfo.outgoing.id);const t=new O(this,u._chanInfo,{server:true});t.subtype=u.subtype=n;u._channel=t;return t};u.emit("exec",p,g,{command:l});return}break;case"subsystem":{let t=l==="sftp";p=()=>{if(h||u._ending||u._channel)return;h=true;if(i)z.channelSuccess(u._chanInfo.outgoing.id);let r;if(t){r=new T(this,u._chanInfo,{server:true,debug:o})}else{r=new O(this,u._chanInfo,{server:true});r.subtype=u.subtype=`${n}:${l}`}u._channel=r;return r};if(l==="sftp"){if(s(u,"sftp")){u.emit("sftp",p,g);return}t=false}if(s(u,"subsystem")){u.emit("subsystem",p,g,{name:l});return}break}}o&&o(`Automatic rejection of incoming channel request: ${n}`);g&&g()},CHANNEL_EOF:(t,r)=>{let n=this._chanMgr.get(r);if(typeof n!=="object"||n===null)return;if(n.constructor===Session){if(!n._ending){n._ending=true;n.emit("eof");n.emit("end")}n=n._channel;if(!n)return}if(n.incoming.state!=="open")return;n.incoming.state="eof";if(n.readable)n.push(null)},CHANNEL_CLOSE:(t,r)=>{let n=this._chanMgr.get(r);if(typeof n!=="object"||n===null)return;if(n.constructor===Session){n._ending=true;n.emit("close");n=n._channel;if(!n)return}G(this,r,n)},SERVICE_REQUEST:(r,n)=>{if(p===0||g||this.authenticated||n!=="ssh-userauth"){z.disconnect(_.SERVICE_NOT_AVAILABLE);t.end();return}g=true;z.serviceAccept(n)},USERAUTH_REQUEST:(r,n,i,o,l)=>{if(p===0||this.authenticated||b&&(b.username!==n||b.service!==i)||o!=="password"&&o!=="publickey"&&o!=="hostbased"&&o!=="keyboard-interactive"&&o!=="none"||m.length===Y){z.disconnect(_.PROTOCOL_ERROR);t.end();return}else if(i!=="ssh-connection"){z.disconnect(_.SERVICE_NOT_AVAILABLE);t.end();return}let u;switch(o){case"keyboard-interactive":u=new KeyboardAuthContext(z,n,i,o,l,onAuthDecide);break;case"publickey":u=new PKAuthContext(z,n,i,o,l,onAuthDecide);break;case"hostbased":u=new HostbasedAuthContext(z,n,i,o,l,onAuthDecide);break;case"password":if(b&&b instanceof PwdAuthContext&&b._changeCb){const t=b._changeCb;b._changeCb=undefined;t(l.newPassword);return}u=new PwdAuthContext(z,n,i,o,l,onAuthDecide);break;case"none":u=new AuthContext(z,n,i,o,onAuthDecide);break}if(b){if(!b._initialResponse){return m.push(u)}else if(b._multistep&&!b._finalResponse){b._cleanup&&b._cleanup();b.emit("abort")}}b=u;if(s(this,"authentication"))this.emit("authentication",b);else b.reject()},USERAUTH_INFO_RESPONSE:(t,r)=>{if(b&&b instanceof KeyboardAuthContext)b._onInfoResponse(r)},GLOBAL_REQUEST:(t,r,n,i)=>{const o={type:null,buf:null};function setReply(t,r){o.type=t;o.buf=r;sendReplies()}if(n)I.push(o);if((r==="tcpip-forward"||r==="cancel-tcpip-forward"||r==="no-more-sessions@openssh.com"||r==="streamlocal-forward@openssh.com"||r==="cancel-streamlocal-forward@openssh.com")&&s(this,"request")&&this.authenticated){let t;let o;if(n){let n=false;t=t=>{if(n)return;n=true;let o;if(r==="tcpip-forward"&&i.bindPort===0&&typeof t==="number"){o=Buffer.allocUnsafe(4);P(o,t,0)}setReply("SUCCESS",o)};o=()=>{if(n)return;n=true;setReply("FAILURE")}}if(r==="no-more-sessions@openssh.com"){this.noMoreSessions=true;t&&t();return}this.emit("request",t,o,r,i)}else if(n){setReply("FAILURE")}}}});t.pause();R.then((()=>{t.on("data",(r=>{try{z.parse(r,0,r.length)}catch(r){this.emit("error",r);try{if($(t))t.end()}catch{}}}));t.resume()})).catch((r=>{this.emit("error",r);try{if($(t))t.end()}catch{}}));t.on("error",(t=>{t.level="socket";this.emit("error",t)})).once("end",(()=>{o&&o("Socket ended");z.cleanup();this.emit("end")})).once("close",(()=>{o&&o("Socket closed");z.cleanup();this.emit("close");const t=new Error("No response from server");this._chanMgr.cleanup(t)}));const onAuthDecide=(t,r,n,i)=>{if(b===t&&!this.authenticated){if(r){b=undefined;this.authenticated=true;z.authSuccess();m=[];this.emit("ready")}else{z.authFailure(n,i);if(m.length){b=m.pop();if(s(this,"authentication"))this.emit("authentication",b);else b.reject()}}}};function sendReplies(){while(I.length>0&&I[0].type){const t=I.shift();if(t.type==="SUCCESS")z.requestSuccess(t.buf);if(t.type==="FAILURE")z.requestFailure()}}}end(){if(this._sock&&$(this._sock)){this._protocol.disconnect(_.BY_APPLICATION);this._sock.end()}return this}x11(t,r,n){const i={originAddr:t,originPort:r};openChannel(this,"x11",i,n);return this}forwardOut(t,r,n,i,o){const s={boundAddr:t,boundPort:r,remoteAddr:n,remotePort:i};openChannel(this,"forwarded-tcpip",s,o);return this}openssh_forwardOutStreamLocal(t,r){const n={socketPath:t};openChannel(this,"forwarded-streamlocal@openssh.com",n,r);return this}rekey(t){let r;try{this._protocol.rekey()}catch(t){r=t}if(typeof t==="function"){if(r)process.nextTick(t,r);else this.once("rekey",t)}}}function openChannel(t,r,n,i){const o=D;const s=L;if(typeof n==="function"){i=n;n={}}const wrapper=(t,r)=>{i(t,r)};wrapper.type=r;const l=t._chanMgr.add(wrapper);if(l===-1){i(new Error("No free channels available"));return}switch(r){case"forwarded-tcpip":t._protocol.forwardedTcpip(l,o,s,n);break;case"x11":t._protocol.x11(l,o,s,n);break;case"forwarded-streamlocal@openssh.com":t._protocol.openssh_forwardedStreamLocal(l,o,s,n);break;default:throw new Error(`Unsupported channel type: ${r}`)}}function compareNumbers(t,r){return t-r}t.exports=Server;t.exports.IncomingClient=Client},834:(t,r,n)=>{"use strict";const{SFTP:i}=n(2026);const o=2**32-1;function onChannelOpenFailure(t,r,n,i){t._chanMgr.remove(r);if(typeof i!=="function")return;let o;if(n instanceof Error){o=n}else if(typeof n==="object"&&n!==null){o=new Error(`(SSH) Channel open failure: ${n.description}`);o.reason=n.reason}else{o=new Error("(SSH) Channel open failure: server closed channel unexpectedly");o.reason=""}i(o)}function onCHANNEL_CLOSE(t,r,n,o,s){if(typeof n==="function"){onChannelOpenFailure(t,r,o,n);return}if(typeof n!=="object"||n===null||n.incoming.state==="closed"){return}n.incoming.state="closed";if(n.readable)n.push(null);if(n.server){if(n.stderr.writable)n.stderr.end()}else if(n.stderr.readable){n.stderr.push(null)}if(n.constructor!==i&&(n.outgoing.state==="open"||n.outgoing.state==="eof")&&!s){n.close()}if(n.outgoing.state==="closing")n.outgoing.state="closed";t._chanMgr.remove(r);const l=n._readableState;const u=n._writableState;if(u&&!u.ending&&!u.finished&&!s)n.end();const h=n._callbacks;n._callbacks=[];for(let t=0;t<h.length;++t)h[t](true);if(n.server){if(!n.readable||n.destroyed||l&&l.endEmitted){n.emit("close")}else{n.once("end",(()=>n.emit("close")))}}else{let t;switch(n.type){case"direct-streamlocal@openssh.com":case"direct-tcpip":t=()=>n.emit("close");break;default:{const r=n._exit;t=()=>{if(r.code===null)n.emit("close",r.code,r.signal,r.dump,r.desc);else n.emit("close",r.code)}}}if(!n.readable||n.destroyed||l&&l.endEmitted){t()}else{n.once("end",t)}const r=n.stderr._readableState;if(!n.stderr.readable||n.stderr.destroyed||r&&r.endEmitted){n.stderr.emit("close")}else{n.stderr.once("end",(()=>n.stderr.emit("close")))}}}class ChannelManager{constructor(t){this._client=t;this._channels={};this._cur=-1;this._count=0}add(t){let r;if(this._cur<o){r=++this._cur}else if(this._count===0){this._cur=0;r=0}else{const t=this._channels;for(let n=0;n<o;++n){if(t[n]===undefined){r=n;break}}}if(r===undefined)return-1;this._channels[r]=t||true;++this._count;return r}update(t,r){if(typeof t!=="number"||t<0||t>=o||!isFinite(t))throw new Error(`Invalid channel id: ${t}`);if(r&&this._channels[t])this._channels[t]=r}get(t){if(typeof t!=="number"||t<0||t>=o||!isFinite(t))throw new Error(`Invalid channel id: ${t}`);return this._channels[t]}remove(t){if(typeof t!=="number"||t<0||t>=o||!isFinite(t))throw new Error(`Invalid channel id: ${t}`);if(this._channels[t]){delete this._channels[t];if(this._count)--this._count}}cleanup(t){const r=this._channels;this._channels={};this._cur=-1;this._count=0;const n=Object.keys(r);const i=this._client;for(let o=0;o<n.length;++o){const s=+n[o];const l=r[s];onCHANNEL_CLOSE(i,s,l._channel||l,t,true)}}}const s=(()=>{const t=Object.prototype.toString;return r=>t.call(r)==="[object RegExp]"})();function generateAlgorithmList(t,r,n){if(Array.isArray(t)&&t.length>0){for(let r=0;r<t.length;++r){if(n.indexOf(t[r])===-1)throw new Error(`Unsupported algorithm: ${t[r]}`)}return t}if(typeof t==="object"&&t!==null){const i=Object.keys(t);let o=r;for(let l=0;l<i.length;++l){const u=i[l];let h=t[u];switch(u){case"append":if(!Array.isArray(h))h=[h];if(Array.isArray(h)){for(let t=0;t<h.length;++t){const i=h[t];if(typeof i==="string"){if(!i||o.indexOf(i)!==-1)continue;if(n.indexOf(i)===-1)throw new Error(`Unsupported algorithm: ${i}`);if(o===r)o=o.slice();o.push(i)}else if(s(i)){for(let t=0;t<n.length;++t){const s=n[t];if(i.test(s)){if(o.indexOf(s)!==-1)continue;if(o===r)o=o.slice();o.push(s)}}}}}break;case"prepend":if(!Array.isArray(h))h=[h];if(Array.isArray(h)){for(let t=h.length;t>=0;--t){const i=h[t];if(typeof i==="string"){if(!i||o.indexOf(i)!==-1)continue;if(n.indexOf(i)===-1)throw new Error(`Unsupported algorithm: ${i}`);if(o===r)o=o.slice();o.unshift(i)}else if(s(i)){for(let t=n.length;t>=0;--t){const s=n[t];if(i.test(s)){if(o.indexOf(s)!==-1)continue;if(o===r)o=o.slice();o.unshift(s)}}}}}break;case"remove":if(!Array.isArray(h))h=[h];if(Array.isArray(h)){for(let t=0;t<h.length;++t){const n=h[t];if(typeof n==="string"){if(!n)continue;const t=o.indexOf(n);if(t===-1)continue;if(o===r)o=o.slice();o.splice(t,1)}else if(s(n)){for(let t=0;t<o.length;++t){if(n.test(o[t])){if(o===r)o=o.slice();o.splice(t,1);--t}}}}}break}}return o}return r}t.exports={ChannelManager:ChannelManager,generateAlgorithmList:generateAlgorithmList,onChannelOpenFailure:onChannelOpenFailure,onCHANNEL_CLOSE:onCHANNEL_CLOSE,isWritable:t=>t&&t.writable&&t._readableState&&t._readableState.ended===false}},4294:(t,r,n)=>{t.exports=n(4219)},4219:(t,r,n)=>{"use strict";var i=n(1631);var o=n(4016);var s=n(8605);var l=n(7211);var u=n(8614);var h=n(2357);var p=n(1669);r.httpOverHttp=httpOverHttp;r.httpsOverHttp=httpsOverHttp;r.httpOverHttps=httpOverHttps;r.httpsOverHttps=httpsOverHttps;function httpOverHttp(t){var r=new TunnelingAgent(t);r.request=s.request;return r}function httpsOverHttp(t){var r=new TunnelingAgent(t);r.request=s.request;r.createSocket=createSecureSocket;r.defaultPort=443;return r}function httpOverHttps(t){var r=new TunnelingAgent(t);r.request=l.request;return r}function httpsOverHttps(t){var r=new TunnelingAgent(t);r.request=l.request;r.createSocket=createSecureSocket;r.defaultPort=443;return r}function TunnelingAgent(t){var r=this;r.options=t||{};r.proxyOptions=r.options.proxy||{};r.maxSockets=r.options.maxSockets||s.Agent.defaultMaxSockets;r.requests=[];r.sockets=[];r.on("free",(function onFree(t,n,i,o){var s=toOptions(n,i,o);for(var l=0,u=r.requests.length;l<u;++l){var h=r.requests[l];if(h.host===s.host&&h.port===s.port){r.requests.splice(l,1);h.request.onSocket(t);return}}t.destroy();r.removeSocket(t)}))}p.inherits(TunnelingAgent,u.EventEmitter);TunnelingAgent.prototype.addRequest=function addRequest(t,r,n,i){var o=this;var s=mergeOptions({request:t},o.options,toOptions(r,n,i));if(o.sockets.length>=this.maxSockets){o.requests.push(s);return}o.createSocket(s,(function(r){r.on("free",onFree);r.on("close",onCloseOrRemove);r.on("agentRemove",onCloseOrRemove);t.onSocket(r);function onFree(){o.emit("free",r,s)}function onCloseOrRemove(t){o.removeSocket(r);r.removeListener("free",onFree);r.removeListener("close",onCloseOrRemove);r.removeListener("agentRemove",onCloseOrRemove)}}))};TunnelingAgent.prototype.createSocket=function createSocket(t,r){var n=this;var i={};n.sockets.push(i);var o=mergeOptions({},n.proxyOptions,{method:"CONNECT",path:t.host+":"+t.port,agent:false,headers:{host:t.host+":"+t.port}});if(t.localAddress){o.localAddress=t.localAddress}if(o.proxyAuth){o.headers=o.headers||{};o.headers["Proxy-Authorization"]="Basic "+new Buffer(o.proxyAuth).toString("base64")}g("making CONNECT request");var s=n.request(o);s.useChunkedEncodingByDefault=false;s.once("response",onResponse);s.once("upgrade",onUpgrade);s.once("connect",onConnect);s.once("error",onError);s.end();function onResponse(t){t.upgrade=true}function onUpgrade(t,r,n){process.nextTick((function(){onConnect(t,r,n)}))}function onConnect(o,l,u){s.removeAllListeners();l.removeAllListeners();if(o.statusCode!==200){g("tunneling socket could not be established, statusCode=%d",o.statusCode);l.destroy();var h=new Error("tunneling socket could not be established, "+"statusCode="+o.statusCode);h.code="ECONNRESET";t.request.emit("error",h);n.removeSocket(i);return}if(u.length>0){g("got illegal response body from proxy");l.destroy();var h=new Error("got illegal response body from proxy");h.code="ECONNRESET";t.request.emit("error",h);n.removeSocket(i);return}g("tunneling connection has established");n.sockets[n.sockets.indexOf(i)]=l;return r(l)}function onError(r){s.removeAllListeners();g("tunneling socket could not be established, cause=%s\n",r.message,r.stack);var o=new Error("tunneling socket could not be established, "+"cause="+r.message);o.code="ECONNRESET";t.request.emit("error",o);n.removeSocket(i)}};TunnelingAgent.prototype.removeSocket=function removeSocket(t){var r=this.sockets.indexOf(t);if(r===-1){return}this.sockets.splice(r,1);var n=this.requests.shift();if(n){this.createSocket(n,(function(t){n.request.onSocket(t)}))}};function createSecureSocket(t,r){var n=this;TunnelingAgent.prototype.createSocket.call(n,t,(function(i){var s=t.request.getHeader("host");var l=mergeOptions({},n.options,{socket:i,servername:s?s.replace(/:.*$/,""):t.host});var u=o.connect(0,l);n.sockets[n.sockets.indexOf(i)]=u;r(u)}))}function toOptions(t,r,n){if(typeof t==="string"){return{host:t,port:r,localAddress:n}}return t}function mergeOptions(t){for(var r=1,n=arguments.length;r<n;++r){var i=arguments[r];if(typeof i==="object"){var o=Object.keys(i);for(var s=0,l=o.length;s<l;++s){var u=o[s];if(i[u]!==undefined){t[u]=i[u]}}}}return t}var g;if(process.env.NODE_DEBUG&&/\btunnel\b/.test(process.env.NODE_DEBUG)){g=function(){var t=Array.prototype.slice.call(arguments);if(typeof t[0]==="string"){t[0]="TUNNEL: "+t[0]}else{t.unshift("TUNNEL:")}console.error.apply(console,t)}}else{g=function(){}}r.debug=g},8729:(t,r,n)=>{(function(t){"use strict";var gf=function(t){var r,n=new Float64Array(16);if(t)for(r=0;r<t.length;r++)n[r]=t[r];return n};var randombytes=function(){throw new Error("no PRNG")};var r=new Uint8Array(16);var i=new Uint8Array(32);i[0]=9;var o=gf(),s=gf([1]),l=gf([56129,1]),u=gf([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),h=gf([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),p=gf([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),g=gf([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),m=gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function ts64(t,r,n,i){t[r]=n>>24&255;t[r+1]=n>>16&255;t[r+2]=n>>8&255;t[r+3]=n&255;t[r+4]=i>>24&255;t[r+5]=i>>16&255;t[r+6]=i>>8&255;t[r+7]=i&255}function vn(t,r,n,i,o){var s,l=0;for(s=0;s<o;s++)l|=t[r+s]^n[i+s];return(1&l-1>>>8)-1}function crypto_verify_16(t,r,n,i){return vn(t,r,n,i,16)}function crypto_verify_32(t,r,n,i){return vn(t,r,n,i,32)}function core_salsa20(t,r,n,i){var o=i[0]&255|(i[1]&255)<<8|(i[2]&255)<<16|(i[3]&255)<<24,s=n[0]&255|(n[1]&255)<<8|(n[2]&255)<<16|(n[3]&255)<<24,l=n[4]&255|(n[5]&255)<<8|(n[6]&255)<<16|(n[7]&255)<<24,u=n[8]&255|(n[9]&255)<<8|(n[10]&255)<<16|(n[11]&255)<<24,h=n[12]&255|(n[13]&255)<<8|(n[14]&255)<<16|(n[15]&255)<<24,p=i[4]&255|(i[5]&255)<<8|(i[6]&255)<<16|(i[7]&255)<<24,g=r[0]&255|(r[1]&255)<<8|(r[2]&255)<<16|(r[3]&255)<<24,m=r[4]&255|(r[5]&255)<<8|(r[6]&255)<<16|(r[7]&255)<<24,_=r[8]&255|(r[9]&255)<<8|(r[10]&255)<<16|(r[11]&255)<<24,E=r[12]&255|(r[13]&255)<<8|(r[14]&255)<<16|(r[15]&255)<<24,b=i[8]&255|(i[9]&255)<<8|(i[10]&255)<<16|(i[11]&255)<<24,y=n[16]&255|(n[17]&255)<<8|(n[18]&255)<<16|(n[19]&255)<<24,w=n[20]&255|(n[21]&255)<<8|(n[22]&255)<<16|(n[23]&255)<<24,I=n[24]&255|(n[25]&255)<<8|(n[26]&255)<<16|(n[27]&255)<<24,C=n[28]&255|(n[29]&255)<<8|(n[30]&255)<<16|(n[31]&255)<<24,R=i[12]&255|(i[13]&255)<<8|(i[14]&255)<<16|(i[15]&255)<<24;var B=o,k=s,v=l,T=u,P=h,O=p,D=g,L=m,U=_,W=E,Q=b,q=y,$=w,j=I,G=C,Y=R,z;for(var V=0;V<20;V+=2){z=B+$|0;P^=z<<7|z>>>32-7;z=P+B|0;U^=z<<9|z>>>32-9;z=U+P|0;$^=z<<13|z>>>32-13;z=$+U|0;B^=z<<18|z>>>32-18;z=O+k|0;W^=z<<7|z>>>32-7;z=W+O|0;j^=z<<9|z>>>32-9;z=j+W|0;k^=z<<13|z>>>32-13;z=k+j|0;O^=z<<18|z>>>32-18;z=Q+D|0;G^=z<<7|z>>>32-7;z=G+Q|0;v^=z<<9|z>>>32-9;z=v+G|0;D^=z<<13|z>>>32-13;z=D+v|0;Q^=z<<18|z>>>32-18;z=Y+q|0;T^=z<<7|z>>>32-7;z=T+Y|0;L^=z<<9|z>>>32-9;z=L+T|0;q^=z<<13|z>>>32-13;z=q+L|0;Y^=z<<18|z>>>32-18;z=B+T|0;k^=z<<7|z>>>32-7;z=k+B|0;v^=z<<9|z>>>32-9;z=v+k|0;T^=z<<13|z>>>32-13;z=T+v|0;B^=z<<18|z>>>32-18;z=O+P|0;D^=z<<7|z>>>32-7;z=D+O|0;L^=z<<9|z>>>32-9;z=L+D|0;P^=z<<13|z>>>32-13;z=P+L|0;O^=z<<18|z>>>32-18;z=Q+W|0;q^=z<<7|z>>>32-7;z=q+Q|0;U^=z<<9|z>>>32-9;z=U+q|0;W^=z<<13|z>>>32-13;z=W+U|0;Q^=z<<18|z>>>32-18;z=Y+G|0;$^=z<<7|z>>>32-7;z=$+Y|0;j^=z<<9|z>>>32-9;z=j+$|0;G^=z<<13|z>>>32-13;z=G+j|0;Y^=z<<18|z>>>32-18}B=B+o|0;k=k+s|0;v=v+l|0;T=T+u|0;P=P+h|0;O=O+p|0;D=D+g|0;L=L+m|0;U=U+_|0;W=W+E|0;Q=Q+b|0;q=q+y|0;$=$+w|0;j=j+I|0;G=G+C|0;Y=Y+R|0;t[0]=B>>>0&255;t[1]=B>>>8&255;t[2]=B>>>16&255;t[3]=B>>>24&255;t[4]=k>>>0&255;t[5]=k>>>8&255;t[6]=k>>>16&255;t[7]=k>>>24&255;t[8]=v>>>0&255;t[9]=v>>>8&255;t[10]=v>>>16&255;t[11]=v>>>24&255;t[12]=T>>>0&255;t[13]=T>>>8&255;t[14]=T>>>16&255;t[15]=T>>>24&255;t[16]=P>>>0&255;t[17]=P>>>8&255;t[18]=P>>>16&255;t[19]=P>>>24&255;t[20]=O>>>0&255;t[21]=O>>>8&255;t[22]=O>>>16&255;t[23]=O>>>24&255;t[24]=D>>>0&255;t[25]=D>>>8&255;t[26]=D>>>16&255;t[27]=D>>>24&255;t[28]=L>>>0&255;t[29]=L>>>8&255;t[30]=L>>>16&255;t[31]=L>>>24&255;t[32]=U>>>0&255;t[33]=U>>>8&255;t[34]=U>>>16&255;t[35]=U>>>24&255;t[36]=W>>>0&255;t[37]=W>>>8&255;t[38]=W>>>16&255;t[39]=W>>>24&255;t[40]=Q>>>0&255;t[41]=Q>>>8&255;t[42]=Q>>>16&255;t[43]=Q>>>24&255;t[44]=q>>>0&255;t[45]=q>>>8&255;t[46]=q>>>16&255;t[47]=q>>>24&255;t[48]=$>>>0&255;t[49]=$>>>8&255;t[50]=$>>>16&255;t[51]=$>>>24&255;t[52]=j>>>0&255;t[53]=j>>>8&255;t[54]=j>>>16&255;t[55]=j>>>24&255;t[56]=G>>>0&255;t[57]=G>>>8&255;t[58]=G>>>16&255;t[59]=G>>>24&255;t[60]=Y>>>0&255;t[61]=Y>>>8&255;t[62]=Y>>>16&255;t[63]=Y>>>24&255}function core_hsalsa20(t,r,n,i){var o=i[0]&255|(i[1]&255)<<8|(i[2]&255)<<16|(i[3]&255)<<24,s=n[0]&255|(n[1]&255)<<8|(n[2]&255)<<16|(n[3]&255)<<24,l=n[4]&255|(n[5]&255)<<8|(n[6]&255)<<16|(n[7]&255)<<24,u=n[8]&255|(n[9]&255)<<8|(n[10]&255)<<16|(n[11]&255)<<24,h=n[12]&255|(n[13]&255)<<8|(n[14]&255)<<16|(n[15]&255)<<24,p=i[4]&255|(i[5]&255)<<8|(i[6]&255)<<16|(i[7]&255)<<24,g=r[0]&255|(r[1]&255)<<8|(r[2]&255)<<16|(r[3]&255)<<24,m=r[4]&255|(r[5]&255)<<8|(r[6]&255)<<16|(r[7]&255)<<24,_=r[8]&255|(r[9]&255)<<8|(r[10]&255)<<16|(r[11]&255)<<24,E=r[12]&255|(r[13]&255)<<8|(r[14]&255)<<16|(r[15]&255)<<24,b=i[8]&255|(i[9]&255)<<8|(i[10]&255)<<16|(i[11]&255)<<24,y=n[16]&255|(n[17]&255)<<8|(n[18]&255)<<16|(n[19]&255)<<24,w=n[20]&255|(n[21]&255)<<8|(n[22]&255)<<16|(n[23]&255)<<24,I=n[24]&255|(n[25]&255)<<8|(n[26]&255)<<16|(n[27]&255)<<24,C=n[28]&255|(n[29]&255)<<8|(n[30]&255)<<16|(n[31]&255)<<24,R=i[12]&255|(i[13]&255)<<8|(i[14]&255)<<16|(i[15]&255)<<24;var B=o,k=s,v=l,T=u,P=h,O=p,D=g,L=m,U=_,W=E,Q=b,q=y,$=w,j=I,G=C,Y=R,z;for(var V=0;V<20;V+=2){z=B+$|0;P^=z<<7|z>>>32-7;z=P+B|0;U^=z<<9|z>>>32-9;z=U+P|0;$^=z<<13|z>>>32-13;z=$+U|0;B^=z<<18|z>>>32-18;z=O+k|0;W^=z<<7|z>>>32-7;z=W+O|0;j^=z<<9|z>>>32-9;z=j+W|0;k^=z<<13|z>>>32-13;z=k+j|0;O^=z<<18|z>>>32-18;z=Q+D|0;G^=z<<7|z>>>32-7;z=G+Q|0;v^=z<<9|z>>>32-9;z=v+G|0;D^=z<<13|z>>>32-13;z=D+v|0;Q^=z<<18|z>>>32-18;z=Y+q|0;T^=z<<7|z>>>32-7;z=T+Y|0;L^=z<<9|z>>>32-9;z=L+T|0;q^=z<<13|z>>>32-13;z=q+L|0;Y^=z<<18|z>>>32-18;z=B+T|0;k^=z<<7|z>>>32-7;z=k+B|0;v^=z<<9|z>>>32-9;z=v+k|0;T^=z<<13|z>>>32-13;z=T+v|0;B^=z<<18|z>>>32-18;z=O+P|0;D^=z<<7|z>>>32-7;z=D+O|0;L^=z<<9|z>>>32-9;z=L+D|0;P^=z<<13|z>>>32-13;z=P+L|0;O^=z<<18|z>>>32-18;z=Q+W|0;q^=z<<7|z>>>32-7;z=q+Q|0;U^=z<<9|z>>>32-9;z=U+q|0;W^=z<<13|z>>>32-13;z=W+U|0;Q^=z<<18|z>>>32-18;z=Y+G|0;$^=z<<7|z>>>32-7;z=$+Y|0;j^=z<<9|z>>>32-9;z=j+$|0;G^=z<<13|z>>>32-13;z=G+j|0;Y^=z<<18|z>>>32-18}t[0]=B>>>0&255;t[1]=B>>>8&255;t[2]=B>>>16&255;t[3]=B>>>24&255;t[4]=O>>>0&255;t[5]=O>>>8&255;t[6]=O>>>16&255;t[7]=O>>>24&255;t[8]=Q>>>0&255;t[9]=Q>>>8&255;t[10]=Q>>>16&255;t[11]=Q>>>24&255;t[12]=Y>>>0&255;t[13]=Y>>>8&255;t[14]=Y>>>16&255;t[15]=Y>>>24&255;t[16]=D>>>0&255;t[17]=D>>>8&255;t[18]=D>>>16&255;t[19]=D>>>24&255;t[20]=L>>>0&255;t[21]=L>>>8&255;t[22]=L>>>16&255;t[23]=L>>>24&255;t[24]=U>>>0&255;t[25]=U>>>8&255;t[26]=U>>>16&255;t[27]=U>>>24&255;t[28]=W>>>0&255;t[29]=W>>>8&255;t[30]=W>>>16&255;t[31]=W>>>24&255}function crypto_core_salsa20(t,r,n,i){core_salsa20(t,r,n,i)}function crypto_core_hsalsa20(t,r,n,i){core_hsalsa20(t,r,n,i)}var _=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function crypto_stream_salsa20_xor(t,r,n,i,o,s,l){var u=new Uint8Array(16),h=new Uint8Array(64);var p,g;for(g=0;g<16;g++)u[g]=0;for(g=0;g<8;g++)u[g]=s[g];while(o>=64){crypto_core_salsa20(h,u,l,_);for(g=0;g<64;g++)t[r+g]=n[i+g]^h[g];p=1;for(g=8;g<16;g++){p=p+(u[g]&255)|0;u[g]=p&255;p>>>=8}o-=64;r+=64;i+=64}if(o>0){crypto_core_salsa20(h,u,l,_);for(g=0;g<o;g++)t[r+g]=n[i+g]^h[g]}return 0}function crypto_stream_salsa20(t,r,n,i,o){var s=new Uint8Array(16),l=new Uint8Array(64);var u,h;for(h=0;h<16;h++)s[h]=0;for(h=0;h<8;h++)s[h]=i[h];while(n>=64){crypto_core_salsa20(l,s,o,_);for(h=0;h<64;h++)t[r+h]=l[h];u=1;for(h=8;h<16;h++){u=u+(s[h]&255)|0;s[h]=u&255;u>>>=8}n-=64;r+=64}if(n>0){crypto_core_salsa20(l,s,o,_);for(h=0;h<n;h++)t[r+h]=l[h]}return 0}function crypto_stream(t,r,n,i,o){var s=new Uint8Array(32);crypto_core_hsalsa20(s,i,o,_);var l=new Uint8Array(8);for(var u=0;u<8;u++)l[u]=i[u+16];return crypto_stream_salsa20(t,r,n,l,s)}function crypto_stream_xor(t,r,n,i,o,s,l){var u=new Uint8Array(32);crypto_core_hsalsa20(u,s,l,_);var h=new Uint8Array(8);for(var p=0;p<8;p++)h[p]=s[p+16];return crypto_stream_salsa20_xor(t,r,n,i,o,h,u)}var poly1305=function(t){this.buffer=new Uint8Array(16);this.r=new Uint16Array(10);this.h=new Uint16Array(10);this.pad=new Uint16Array(8);this.leftover=0;this.fin=0;var r,n,i,o,s,l,u,h;r=t[0]&255|(t[1]&255)<<8;this.r[0]=r&8191;n=t[2]&255|(t[3]&255)<<8;this.r[1]=(r>>>13|n<<3)&8191;i=t[4]&255|(t[5]&255)<<8;this.r[2]=(n>>>10|i<<6)&7939;o=t[6]&255|(t[7]&255)<<8;this.r[3]=(i>>>7|o<<9)&8191;s=t[8]&255|(t[9]&255)<<8;this.r[4]=(o>>>4|s<<12)&255;this.r[5]=s>>>1&8190;l=t[10]&255|(t[11]&255)<<8;this.r[6]=(s>>>14|l<<2)&8191;u=t[12]&255|(t[13]&255)<<8;this.r[7]=(l>>>11|u<<5)&8065;h=t[14]&255|(t[15]&255)<<8;this.r[8]=(u>>>8|h<<8)&8191;this.r[9]=h>>>5&127;this.pad[0]=t[16]&255|(t[17]&255)<<8;this.pad[1]=t[18]&255|(t[19]&255)<<8;this.pad[2]=t[20]&255|(t[21]&255)<<8;this.pad[3]=t[22]&255|(t[23]&255)<<8;this.pad[4]=t[24]&255|(t[25]&255)<<8;this.pad[5]=t[26]&255|(t[27]&255)<<8;this.pad[6]=t[28]&255|(t[29]&255)<<8;this.pad[7]=t[30]&255|(t[31]&255)<<8};poly1305.prototype.blocks=function(t,r,n){var i=this.fin?0:1<<11;var o,s,l,u,h,p,g,m,_;var E,b,y,w,I,C,R,B,k,v;var T=this.h[0],P=this.h[1],O=this.h[2],D=this.h[3],L=this.h[4],U=this.h[5],W=this.h[6],Q=this.h[7],q=this.h[8],$=this.h[9];var j=this.r[0],G=this.r[1],Y=this.r[2],z=this.r[3],V=this.r[4],J=this.r[5],ee=this.r[6],te=this.r[7],re=this.r[8],ne=this.r[9];while(n>=16){o=t[r+0]&255|(t[r+1]&255)<<8;T+=o&8191;s=t[r+2]&255|(t[r+3]&255)<<8;P+=(o>>>13|s<<3)&8191;l=t[r+4]&255|(t[r+5]&255)<<8;O+=(s>>>10|l<<6)&8191;u=t[r+6]&255|(t[r+7]&255)<<8;D+=(l>>>7|u<<9)&8191;h=t[r+8]&255|(t[r+9]&255)<<8;L+=(u>>>4|h<<12)&8191;U+=h>>>1&8191;p=t[r+10]&255|(t[r+11]&255)<<8;W+=(h>>>14|p<<2)&8191;g=t[r+12]&255|(t[r+13]&255)<<8;Q+=(p>>>11|g<<5)&8191;m=t[r+14]&255|(t[r+15]&255)<<8;q+=(g>>>8|m<<8)&8191;$+=m>>>5|i;_=0;E=_;E+=T*j;E+=P*(5*ne);E+=O*(5*re);E+=D*(5*te);E+=L*(5*ee);_=E>>>13;E&=8191;E+=U*(5*J);E+=W*(5*V);E+=Q*(5*z);E+=q*(5*Y);E+=$*(5*G);_+=E>>>13;E&=8191;b=_;b+=T*G;b+=P*j;b+=O*(5*ne);b+=D*(5*re);b+=L*(5*te);_=b>>>13;b&=8191;b+=U*(5*ee);b+=W*(5*J);b+=Q*(5*V);b+=q*(5*z);b+=$*(5*Y);_+=b>>>13;b&=8191;y=_;y+=T*Y;y+=P*G;y+=O*j;y+=D*(5*ne);y+=L*(5*re);_=y>>>13;y&=8191;y+=U*(5*te);y+=W*(5*ee);y+=Q*(5*J);y+=q*(5*V);y+=$*(5*z);_+=y>>>13;y&=8191;w=_;w+=T*z;w+=P*Y;w+=O*G;w+=D*j;w+=L*(5*ne);_=w>>>13;w&=8191;w+=U*(5*re);w+=W*(5*te);w+=Q*(5*ee);w+=q*(5*J);w+=$*(5*V);_+=w>>>13;w&=8191;I=_;I+=T*V;I+=P*z;I+=O*Y;I+=D*G;I+=L*j;_=I>>>13;I&=8191;I+=U*(5*ne);I+=W*(5*re);I+=Q*(5*te);I+=q*(5*ee);I+=$*(5*J);_+=I>>>13;I&=8191;C=_;C+=T*J;C+=P*V;C+=O*z;C+=D*Y;C+=L*G;_=C>>>13;C&=8191;C+=U*j;C+=W*(5*ne);C+=Q*(5*re);C+=q*(5*te);C+=$*(5*ee);_+=C>>>13;C&=8191;R=_;R+=T*ee;R+=P*J;R+=O*V;R+=D*z;R+=L*Y;_=R>>>13;R&=8191;R+=U*G;R+=W*j;R+=Q*(5*ne);R+=q*(5*re);R+=$*(5*te);_+=R>>>13;R&=8191;B=_;B+=T*te;B+=P*ee;B+=O*J;B+=D*V;B+=L*z;_=B>>>13;B&=8191;B+=U*Y;B+=W*G;B+=Q*j;B+=q*(5*ne);B+=$*(5*re);_+=B>>>13;B&=8191;k=_;k+=T*re;k+=P*te;k+=O*ee;k+=D*J;k+=L*V;_=k>>>13;k&=8191;k+=U*z;k+=W*Y;k+=Q*G;k+=q*j;k+=$*(5*ne);_+=k>>>13;k&=8191;v=_;v+=T*ne;v+=P*re;v+=O*te;v+=D*ee;v+=L*J;_=v>>>13;v&=8191;v+=U*V;v+=W*z;v+=Q*Y;v+=q*G;v+=$*j;_+=v>>>13;v&=8191;_=(_<<2)+_|0;_=_+E|0;E=_&8191;_=_>>>13;b+=_;T=E;P=b;O=y;D=w;L=I;U=C;W=R;Q=B;q=k;$=v;r+=16;n-=16}this.h[0]=T;this.h[1]=P;this.h[2]=O;this.h[3]=D;this.h[4]=L;this.h[5]=U;this.h[6]=W;this.h[7]=Q;this.h[8]=q;this.h[9]=$};poly1305.prototype.finish=function(t,r){var n=new Uint16Array(10);var i,o,s,l;if(this.leftover){l=this.leftover;this.buffer[l++]=1;for(;l<16;l++)this.buffer[l]=0;this.fin=1;this.blocks(this.buffer,0,16)}i=this.h[1]>>>13;this.h[1]&=8191;for(l=2;l<10;l++){this.h[l]+=i;i=this.h[l]>>>13;this.h[l]&=8191}this.h[0]+=i*5;i=this.h[0]>>>13;this.h[0]&=8191;this.h[1]+=i;i=this.h[1]>>>13;this.h[1]&=8191;this.h[2]+=i;n[0]=this.h[0]+5;i=n[0]>>>13;n[0]&=8191;for(l=1;l<10;l++){n[l]=this.h[l]+i;i=n[l]>>>13;n[l]&=8191}n[9]-=1<<13;o=(i^1)-1;for(l=0;l<10;l++)n[l]&=o;o=~o;for(l=0;l<10;l++)this.h[l]=this.h[l]&o|n[l];this.h[0]=(this.h[0]|this.h[1]<<13)&65535;this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535;this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535;this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535;this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535;this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535;this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535;this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535;s=this.h[0]+this.pad[0];this.h[0]=s&65535;for(l=1;l<8;l++){s=(this.h[l]+this.pad[l]|0)+(s>>>16)|0;this.h[l]=s&65535}t[r+0]=this.h[0]>>>0&255;t[r+1]=this.h[0]>>>8&255;t[r+2]=this.h[1]>>>0&255;t[r+3]=this.h[1]>>>8&255;t[r+4]=this.h[2]>>>0&255;t[r+5]=this.h[2]>>>8&255;t[r+6]=this.h[3]>>>0&255;t[r+7]=this.h[3]>>>8&255;t[r+8]=this.h[4]>>>0&255;t[r+9]=this.h[4]>>>8&255;t[r+10]=this.h[5]>>>0&255;t[r+11]=this.h[5]>>>8&255;t[r+12]=this.h[6]>>>0&255;t[r+13]=this.h[6]>>>8&255;t[r+14]=this.h[7]>>>0&255;t[r+15]=this.h[7]>>>8&255};poly1305.prototype.update=function(t,r,n){var i,o;if(this.leftover){o=16-this.leftover;if(o>n)o=n;for(i=0;i<o;i++)this.buffer[this.leftover+i]=t[r+i];n-=o;r+=o;this.leftover+=o;if(this.leftover<16)return;this.blocks(this.buffer,0,16);this.leftover=0}if(n>=16){o=n-n%16;this.blocks(t,r,o);r+=o;n-=o}if(n){for(i=0;i<n;i++)this.buffer[this.leftover+i]=t[r+i];this.leftover+=n}};function crypto_onetimeauth(t,r,n,i,o,s){var l=new poly1305(s);l.update(n,i,o);l.finish(t,r);return 0}function crypto_onetimeauth_verify(t,r,n,i,o,s){var l=new Uint8Array(16);crypto_onetimeauth(l,0,n,i,o,s);return crypto_verify_16(t,r,l,0)}function crypto_secretbox(t,r,n,i,o){var s;if(n<32)return-1;crypto_stream_xor(t,0,r,0,n,i,o);crypto_onetimeauth(t,16,t,32,n-32,t);for(s=0;s<16;s++)t[s]=0;return 0}function crypto_secretbox_open(t,r,n,i,o){var s;var l=new Uint8Array(32);if(n<32)return-1;crypto_stream(l,0,32,i,o);if(crypto_onetimeauth_verify(r,16,r,32,n-32,l)!==0)return-1;crypto_stream_xor(t,0,r,0,n,i,o);for(s=0;s<32;s++)t[s]=0;return 0}function set25519(t,r){var n;for(n=0;n<16;n++)t[n]=r[n]|0}function car25519(t){var r,n,i=1;for(r=0;r<16;r++){n=t[r]+i+65535;i=Math.floor(n/65536);t[r]=n-i*65536}t[0]+=i-1+37*(i-1)}function sel25519(t,r,n){var i,o=~(n-1);for(var s=0;s<16;s++){i=o&(t[s]^r[s]);t[s]^=i;r[s]^=i}}function pack25519(t,r){var n,i,o;var s=gf(),l=gf();for(n=0;n<16;n++)l[n]=r[n];car25519(l);car25519(l);car25519(l);for(i=0;i<2;i++){s[0]=l[0]-65517;for(n=1;n<15;n++){s[n]=l[n]-65535-(s[n-1]>>16&1);s[n-1]&=65535}s[15]=l[15]-32767-(s[14]>>16&1);o=s[15]>>16&1;s[14]&=65535;sel25519(l,s,1-o)}for(n=0;n<16;n++){t[2*n]=l[n]&255;t[2*n+1]=l[n]>>8}}function neq25519(t,r){var n=new Uint8Array(32),i=new Uint8Array(32);pack25519(n,t);pack25519(i,r);return crypto_verify_32(n,0,i,0)}function par25519(t){var r=new Uint8Array(32);pack25519(r,t);return r[0]&1}function unpack25519(t,r){var n;for(n=0;n<16;n++)t[n]=r[2*n]+(r[2*n+1]<<8);t[15]&=32767}function A(t,r,n){for(var i=0;i<16;i++)t[i]=r[i]+n[i]}function Z(t,r,n){for(var i=0;i<16;i++)t[i]=r[i]-n[i]}function M(t,r,n){var i,o,s=0,l=0,u=0,h=0,p=0,g=0,m=0,_=0,E=0,b=0,y=0,w=0,I=0,C=0,R=0,B=0,k=0,v=0,T=0,P=0,O=0,D=0,L=0,U=0,W=0,Q=0,q=0,$=0,j=0,G=0,Y=0,z=n[0],V=n[1],J=n[2],ee=n[3],te=n[4],re=n[5],ne=n[6],ie=n[7],oe=n[8],se=n[9],ae=n[10],le=n[11],ce=n[12],ue=n[13],fe=n[14],de=n[15];i=r[0];s+=i*z;l+=i*V;u+=i*J;h+=i*ee;p+=i*te;g+=i*re;m+=i*ne;_+=i*ie;E+=i*oe;b+=i*se;y+=i*ae;w+=i*le;I+=i*ce;C+=i*ue;R+=i*fe;B+=i*de;i=r[1];l+=i*z;u+=i*V;h+=i*J;p+=i*ee;g+=i*te;m+=i*re;_+=i*ne;E+=i*ie;b+=i*oe;y+=i*se;w+=i*ae;I+=i*le;C+=i*ce;R+=i*ue;B+=i*fe;k+=i*de;i=r[2];u+=i*z;h+=i*V;p+=i*J;g+=i*ee;m+=i*te;_+=i*re;E+=i*ne;b+=i*ie;y+=i*oe;w+=i*se;I+=i*ae;C+=i*le;R+=i*ce;B+=i*ue;k+=i*fe;v+=i*de;i=r[3];h+=i*z;p+=i*V;g+=i*J;m+=i*ee;_+=i*te;E+=i*re;b+=i*ne;y+=i*ie;w+=i*oe;I+=i*se;C+=i*ae;R+=i*le;B+=i*ce;k+=i*ue;v+=i*fe;T+=i*de;i=r[4];p+=i*z;g+=i*V;m+=i*J;_+=i*ee;E+=i*te;b+=i*re;y+=i*ne;w+=i*ie;I+=i*oe;C+=i*se;R+=i*ae;B+=i*le;k+=i*ce;v+=i*ue;T+=i*fe;P+=i*de;i=r[5];g+=i*z;m+=i*V;_+=i*J;E+=i*ee;b+=i*te;y+=i*re;w+=i*ne;I+=i*ie;C+=i*oe;R+=i*se;B+=i*ae;k+=i*le;v+=i*ce;T+=i*ue;P+=i*fe;O+=i*de;i=r[6];m+=i*z;_+=i*V;E+=i*J;b+=i*ee;y+=i*te;w+=i*re;I+=i*ne;C+=i*ie;R+=i*oe;B+=i*se;k+=i*ae;v+=i*le;T+=i*ce;P+=i*ue;O+=i*fe;D+=i*de;i=r[7];_+=i*z;E+=i*V;b+=i*J;y+=i*ee;w+=i*te;I+=i*re;C+=i*ne;R+=i*ie;B+=i*oe;k+=i*se;v+=i*ae;T+=i*le;P+=i*ce;O+=i*ue;D+=i*fe;L+=i*de;i=r[8];E+=i*z;b+=i*V;y+=i*J;w+=i*ee;I+=i*te;C+=i*re;R+=i*ne;B+=i*ie;k+=i*oe;v+=i*se;T+=i*ae;P+=i*le;O+=i*ce;D+=i*ue;L+=i*fe;U+=i*de;i=r[9];b+=i*z;y+=i*V;w+=i*J;I+=i*ee;C+=i*te;R+=i*re;B+=i*ne;k+=i*ie;v+=i*oe;T+=i*se;P+=i*ae;O+=i*le;D+=i*ce;L+=i*ue;U+=i*fe;W+=i*de;i=r[10];y+=i*z;w+=i*V;I+=i*J;C+=i*ee;R+=i*te;B+=i*re;k+=i*ne;v+=i*ie;T+=i*oe;P+=i*se;O+=i*ae;D+=i*le;L+=i*ce;U+=i*ue;W+=i*fe;Q+=i*de;i=r[11];w+=i*z;I+=i*V;C+=i*J;R+=i*ee;B+=i*te;k+=i*re;v+=i*ne;T+=i*ie;P+=i*oe;O+=i*se;D+=i*ae;L+=i*le;U+=i*ce;W+=i*ue;Q+=i*fe;q+=i*de;i=r[12];I+=i*z;C+=i*V;R+=i*J;B+=i*ee;k+=i*te;v+=i*re;T+=i*ne;P+=i*ie;O+=i*oe;D+=i*se;L+=i*ae;U+=i*le;W+=i*ce;Q+=i*ue;q+=i*fe;$+=i*de;i=r[13];C+=i*z;R+=i*V;B+=i*J;k+=i*ee;v+=i*te;T+=i*re;P+=i*ne;O+=i*ie;D+=i*oe;L+=i*se;U+=i*ae;W+=i*le;Q+=i*ce;q+=i*ue;$+=i*fe;j+=i*de;i=r[14];R+=i*z;B+=i*V;k+=i*J;v+=i*ee;T+=i*te;P+=i*re;O+=i*ne;D+=i*ie;L+=i*oe;U+=i*se;W+=i*ae;Q+=i*le;q+=i*ce;$+=i*ue;j+=i*fe;G+=i*de;i=r[15];B+=i*z;k+=i*V;v+=i*J;T+=i*ee;P+=i*te;O+=i*re;D+=i*ne;L+=i*ie;U+=i*oe;W+=i*se;Q+=i*ae;q+=i*le;$+=i*ce;j+=i*ue;G+=i*fe;Y+=i*de;s+=38*k;l+=38*v;u+=38*T;h+=38*P;p+=38*O;g+=38*D;m+=38*L;_+=38*U;E+=38*W;b+=38*Q;y+=38*q;w+=38*$;I+=38*j;C+=38*G;R+=38*Y;o=1;i=s+o+65535;o=Math.floor(i/65536);s=i-o*65536;i=l+o+65535;o=Math.floor(i/65536);l=i-o*65536;i=u+o+65535;o=Math.floor(i/65536);u=i-o*65536;i=h+o+65535;o=Math.floor(i/65536);h=i-o*65536;i=p+o+65535;o=Math.floor(i/65536);p=i-o*65536;i=g+o+65535;o=Math.floor(i/65536);g=i-o*65536;i=m+o+65535;o=Math.floor(i/65536);m=i-o*65536;i=_+o+65535;o=Math.floor(i/65536);_=i-o*65536;i=E+o+65535;o=Math.floor(i/65536);E=i-o*65536;i=b+o+65535;o=Math.floor(i/65536);b=i-o*65536;i=y+o+65535;o=Math.floor(i/65536);y=i-o*65536;i=w+o+65535;o=Math.floor(i/65536);w=i-o*65536;i=I+o+65535;o=Math.floor(i/65536);I=i-o*65536;i=C+o+65535;o=Math.floor(i/65536);C=i-o*65536;i=R+o+65535;o=Math.floor(i/65536);R=i-o*65536;i=B+o+65535;o=Math.floor(i/65536);B=i-o*65536;s+=o-1+37*(o-1);o=1;i=s+o+65535;o=Math.floor(i/65536);s=i-o*65536;i=l+o+65535;o=Math.floor(i/65536);l=i-o*65536;i=u+o+65535;o=Math.floor(i/65536);u=i-o*65536;i=h+o+65535;o=Math.floor(i/65536);h=i-o*65536;i=p+o+65535;o=Math.floor(i/65536);p=i-o*65536;i=g+o+65535;o=Math.floor(i/65536);g=i-o*65536;i=m+o+65535;o=Math.floor(i/65536);m=i-o*65536;i=_+o+65535;o=Math.floor(i/65536);_=i-o*65536;i=E+o+65535;o=Math.floor(i/65536);E=i-o*65536;i=b+o+65535;o=Math.floor(i/65536);b=i-o*65536;i=y+o+65535;o=Math.floor(i/65536);y=i-o*65536;i=w+o+65535;o=Math.floor(i/65536);w=i-o*65536;i=I+o+65535;o=Math.floor(i/65536);I=i-o*65536;i=C+o+65535;o=Math.floor(i/65536);C=i-o*65536;i=R+o+65535;o=Math.floor(i/65536);R=i-o*65536;i=B+o+65535;o=Math.floor(i/65536);B=i-o*65536;s+=o-1+37*(o-1);t[0]=s;t[1]=l;t[2]=u;t[3]=h;t[4]=p;t[5]=g;t[6]=m;t[7]=_;t[8]=E;t[9]=b;t[10]=y;t[11]=w;t[12]=I;t[13]=C;t[14]=R;t[15]=B}function S(t,r){M(t,r,r)}function inv25519(t,r){var n=gf();var i;for(i=0;i<16;i++)n[i]=r[i];for(i=253;i>=0;i--){S(n,n);if(i!==2&&i!==4)M(n,n,r)}for(i=0;i<16;i++)t[i]=n[i]}function pow2523(t,r){var n=gf();var i;for(i=0;i<16;i++)n[i]=r[i];for(i=250;i>=0;i--){S(n,n);if(i!==1)M(n,n,r)}for(i=0;i<16;i++)t[i]=n[i]}function crypto_scalarmult(t,r,n){var i=new Uint8Array(32);var o=new Float64Array(80),s,u;var h=gf(),p=gf(),g=gf(),m=gf(),_=gf(),E=gf();for(u=0;u<31;u++)i[u]=r[u];i[31]=r[31]&127|64;i[0]&=248;unpack25519(o,n);for(u=0;u<16;u++){p[u]=o[u];m[u]=h[u]=g[u]=0}h[0]=m[0]=1;for(u=254;u>=0;--u){s=i[u>>>3]>>>(u&7)&1;sel25519(h,p,s);sel25519(g,m,s);A(_,h,g);Z(h,h,g);A(g,p,m);Z(p,p,m);S(m,_);S(E,h);M(h,g,h);M(g,p,_);A(_,h,g);Z(h,h,g);S(p,h);Z(g,m,E);M(h,g,l);A(h,h,m);M(g,g,h);M(h,m,E);M(m,p,o);S(p,_);sel25519(h,p,s);sel25519(g,m,s)}for(u=0;u<16;u++){o[u+16]=h[u];o[u+32]=g[u];o[u+48]=p[u];o[u+64]=m[u]}var b=o.subarray(32);var y=o.subarray(16);inv25519(b,b);M(y,y,b);pack25519(t,y);return 0}function crypto_scalarmult_base(t,r){return crypto_scalarmult(t,r,i)}function crypto_box_keypair(t,r){randombytes(r,32);return crypto_scalarmult_base(t,r)}function crypto_box_beforenm(t,n,i){var o=new Uint8Array(32);crypto_scalarmult(o,i,n);return crypto_core_hsalsa20(t,r,o,_)}var E=crypto_secretbox;var b=crypto_secretbox_open;function crypto_box(t,r,n,i,o,s){var l=new Uint8Array(32);crypto_box_beforenm(l,o,s);return E(t,r,n,i,l)}function crypto_box_open(t,r,n,i,o,s){var l=new Uint8Array(32);crypto_box_beforenm(l,o,s);return b(t,r,n,i,l)}var y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function crypto_hashblocks_hl(t,r,n,i){var o=new Int32Array(16),s=new Int32Array(16),l,u,h,p,g,m,_,E,b,w,I,C,R,B,k,v,T,P,O,D,L,U,W,Q,q,$;var j=t[0],G=t[1],Y=t[2],z=t[3],V=t[4],J=t[5],ee=t[6],te=t[7],re=r[0],ne=r[1],ie=r[2],oe=r[3],se=r[4],ae=r[5],le=r[6],ce=r[7];var ue=0;while(i>=128){for(O=0;O<16;O++){D=8*O+ue;o[O]=n[D+0]<<24|n[D+1]<<16|n[D+2]<<8|n[D+3];s[O]=n[D+4]<<24|n[D+5]<<16|n[D+6]<<8|n[D+7]}for(O=0;O<80;O++){l=j;u=G;h=Y;p=z;g=V;m=J;_=ee;E=te;b=re;w=ne;I=ie;C=oe;R=se;B=ae;k=le;v=ce;L=te;U=ce;W=U&65535;Q=U>>>16;q=L&65535;$=L>>>16;L=(V>>>14|se<<32-14)^(V>>>18|se<<32-18)^(se>>>41-32|V<<32-(41-32));U=(se>>>14|V<<32-14)^(se>>>18|V<<32-18)^(V>>>41-32|se<<32-(41-32));W+=U&65535;Q+=U>>>16;q+=L&65535;$+=L>>>16;L=V&J^~V&ee;U=se&ae^~se&le;W+=U&65535;Q+=U>>>16;q+=L&65535;$+=L>>>16;L=y[O*2];U=y[O*2+1];W+=U&65535;Q+=U>>>16;q+=L&65535;$+=L>>>16;L=o[O%16];U=s[O%16];W+=U&65535;Q+=U>>>16;q+=L&65535;$+=L>>>16;Q+=W>>>16;q+=Q>>>16;$+=q>>>16;T=q&65535|$<<16;P=W&65535|Q<<16;L=T;U=P;W=U&65535;Q=U>>>16;q=L&65535;$=L>>>16;L=(j>>>28|re<<32-28)^(re>>>34-32|j<<32-(34-32))^(re>>>39-32|j<<32-(39-32));U=(re>>>28|j<<32-28)^(j>>>34-32|re<<32-(34-32))^(j>>>39-32|re<<32-(39-32));W+=U&65535;Q+=U>>>16;q+=L&65535;$+=L>>>16;L=j&G^j&Y^G&Y;U=re&ne^re&ie^ne&ie;W+=U&65535;Q+=U>>>16;q+=L&65535;$+=L>>>16;Q+=W>>>16;q+=Q>>>16;$+=q>>>16;E=q&65535|$<<16;v=W&65535|Q<<16;L=p;U=C;W=U&65535;Q=U>>>16;q=L&65535;$=L>>>16;L=T;U=P;W+=U&65535;Q+=U>>>16;q+=L&65535;$+=L>>>16;Q+=W>>>16;q+=Q>>>16;$+=q>>>16;p=q&65535|$<<16;C=W&65535|Q<<16;G=l;Y=u;z=h;V=p;J=g;ee=m;te=_;j=E;ne=b;ie=w;oe=I;se=C;ae=R;le=B;ce=k;re=v;if(O%16===15){for(D=0;D<16;D++){L=o[D];U=s[D];W=U&65535;Q=U>>>16;q=L&65535;$=L>>>16;L=o[(D+9)%16];U=s[(D+9)%16];W+=U&65535;Q+=U>>>16;q+=L&65535;$+=L>>>16;T=o[(D+1)%16];P=s[(D+1)%16];L=(T>>>1|P<<32-1)^(T>>>8|P<<32-8)^T>>>7;U=(P>>>1|T<<32-1)^(P>>>8|T<<32-8)^(P>>>7|T<<32-7);W+=U&65535;Q+=U>>>16;q+=L&65535;$+=L>>>16;T=o[(D+14)%16];P=s[(D+14)%16];L=(T>>>19|P<<32-19)^(P>>>61-32|T<<32-(61-32))^T>>>6;U=(P>>>19|T<<32-19)^(T>>>61-32|P<<32-(61-32))^(P>>>6|T<<32-6);W+=U&65535;Q+=U>>>16;q+=L&65535;$+=L>>>16;Q+=W>>>16;q+=Q>>>16;$+=q>>>16;o[D]=q&65535|$<<16;s[D]=W&65535|Q<<16}}}L=j;U=re;W=U&65535;Q=U>>>16;q=L&65535;$=L>>>16;L=t[0];U=r[0];W+=U&65535;Q+=U>>>16;q+=L&65535;$+=L>>>16;Q+=W>>>16;q+=Q>>>16;$+=q>>>16;t[0]=j=q&65535|$<<16;r[0]=re=W&65535|Q<<16;L=G;U=ne;W=U&65535;Q=U>>>16;q=L&65535;$=L>>>16;L=t[1];U=r[1];W+=U&65535;Q+=U>>>16;q+=L&65535;$+=L>>>16;Q+=W>>>16;q+=Q>>>16;$+=q>>>16;t[1]=G=q&65535|$<<16;r[1]=ne=W&65535|Q<<16;L=Y;U=ie;W=U&65535;Q=U>>>16;q=L&65535;$=L>>>16;L=t[2];U=r[2];W+=U&65535;Q+=U>>>16;q+=L&65535;$+=L>>>16;Q+=W>>>16;q+=Q>>>16;$+=q>>>16;t[2]=Y=q&65535|$<<16;r[2]=ie=W&65535|Q<<16;L=z;U=oe;W=U&65535;Q=U>>>16;q=L&65535;$=L>>>16;L=t[3];U=r[3];W+=U&65535;Q+=U>>>16;q+=L&65535;$+=L>>>16;Q+=W>>>16;q+=Q>>>16;$+=q>>>16;t[3]=z=q&65535|$<<16;r[3]=oe=W&65535|Q<<16;L=V;U=se;W=U&65535;Q=U>>>16;q=L&65535;$=L>>>16;L=t[4];U=r[4];W+=U&65535;Q+=U>>>16;q+=L&65535;$+=L>>>16;Q+=W>>>16;q+=Q>>>16;$+=q>>>16;t[4]=V=q&65535|$<<16;r[4]=se=W&65535|Q<<16;L=J;U=ae;W=U&65535;Q=U>>>16;q=L&65535;$=L>>>16;L=t[5];U=r[5];W+=U&65535;Q+=U>>>16;q+=L&65535;$+=L>>>16;Q+=W>>>16;q+=Q>>>16;$+=q>>>16;t[5]=J=q&65535|$<<16;r[5]=ae=W&65535|Q<<16;L=ee;U=le;W=U&65535;Q=U>>>16;q=L&65535;$=L>>>16;L=t[6];U=r[6];W+=U&65535;Q+=U>>>16;q+=L&65535;$+=L>>>16;Q+=W>>>16;q+=Q>>>16;$+=q>>>16;t[6]=ee=q&65535|$<<16;r[6]=le=W&65535|Q<<16;L=te;U=ce;W=U&65535;Q=U>>>16;q=L&65535;$=L>>>16;L=t[7];U=r[7];W+=U&65535;Q+=U>>>16;q+=L&65535;$+=L>>>16;Q+=W>>>16;q+=Q>>>16;$+=q>>>16;t[7]=te=q&65535|$<<16;r[7]=ce=W&65535|Q<<16;ue+=128;i-=128}return i}function crypto_hash(t,r,n){var i=new Int32Array(8),o=new Int32Array(8),s=new Uint8Array(256),l,u=n;i[0]=1779033703;i[1]=3144134277;i[2]=1013904242;i[3]=2773480762;i[4]=1359893119;i[5]=2600822924;i[6]=528734635;i[7]=1541459225;o[0]=4089235720;o[1]=2227873595;o[2]=4271175723;o[3]=1595750129;o[4]=2917565137;o[5]=725511199;o[6]=4215389547;o[7]=327033209;crypto_hashblocks_hl(i,o,r,n);n%=128;for(l=0;l<n;l++)s[l]=r[u-n+l];s[n]=128;n=256-128*(n<112?1:0);s[n-9]=0;ts64(s,n-8,u/536870912|0,u<<3);crypto_hashblocks_hl(i,o,s,n);for(l=0;l<8;l++)ts64(t,8*l,i[l],o[l]);return 0}function add(t,r){var n=gf(),i=gf(),o=gf(),s=gf(),l=gf(),u=gf(),p=gf(),g=gf(),m=gf();Z(n,t[1],t[0]);Z(m,r[1],r[0]);M(n,n,m);A(i,t[0],t[1]);A(m,r[0],r[1]);M(i,i,m);M(o,t[3],r[3]);M(o,o,h);M(s,t[2],r[2]);A(s,s,s);Z(l,i,n);Z(u,s,o);A(p,s,o);A(g,i,n);M(t[0],l,u);M(t[1],g,p);M(t[2],p,u);M(t[3],l,g)}function cswap(t,r,n){var i;for(i=0;i<4;i++){sel25519(t[i],r[i],n)}}function pack(t,r){var n=gf(),i=gf(),o=gf();inv25519(o,r[2]);M(n,r[0],o);M(i,r[1],o);pack25519(t,i);t[31]^=par25519(n)<<7}function scalarmult(t,r,n){var i,l;set25519(t[0],o);set25519(t[1],s);set25519(t[2],s);set25519(t[3],o);for(l=255;l>=0;--l){i=n[l/8|0]>>(l&7)&1;cswap(t,r,i);add(r,t);add(t,t);cswap(t,r,i)}}function scalarbase(t,r){var n=[gf(),gf(),gf(),gf()];set25519(n[0],p);set25519(n[1],g);set25519(n[2],s);M(n[3],p,g);scalarmult(t,n,r)}function crypto_sign_keypair(t,r,n){var i=new Uint8Array(64);var o=[gf(),gf(),gf(),gf()];var s;if(!n)randombytes(r,32);crypto_hash(i,r,32);i[0]&=248;i[31]&=127;i[31]|=64;scalarbase(o,i);pack(t,o);for(s=0;s<32;s++)r[s+32]=t[s];return 0}var w=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function modL(t,r){var n,i,o,s;for(i=63;i>=32;--i){n=0;for(o=i-32,s=i-12;o<s;++o){r[o]+=n-16*r[i]*w[o-(i-32)];n=r[o]+128>>8;r[o]-=n*256}r[o]+=n;r[i]=0}n=0;for(o=0;o<32;o++){r[o]+=n-(r[31]>>4)*w[o];n=r[o]>>8;r[o]&=255}for(o=0;o<32;o++)r[o]-=n*w[o];for(i=0;i<32;i++){r[i+1]+=r[i]>>8;t[i]=r[i]&255}}function reduce(t){var r=new Float64Array(64),n;for(n=0;n<64;n++)r[n]=t[n];for(n=0;n<64;n++)t[n]=0;modL(t,r)}function crypto_sign(t,r,n,i){var o=new Uint8Array(64),s=new Uint8Array(64),l=new Uint8Array(64);var u,h,p=new Float64Array(64);var g=[gf(),gf(),gf(),gf()];crypto_hash(o,i,32);o[0]&=248;o[31]&=127;o[31]|=64;var m=n+64;for(u=0;u<n;u++)t[64+u]=r[u];for(u=0;u<32;u++)t[32+u]=o[32+u];crypto_hash(l,t.subarray(32),n+32);reduce(l);scalarbase(g,l);pack(t,g);for(u=32;u<64;u++)t[u]=i[u];crypto_hash(s,t,n+64);reduce(s);for(u=0;u<64;u++)p[u]=0;for(u=0;u<32;u++)p[u]=l[u];for(u=0;u<32;u++){for(h=0;h<32;h++){p[u+h]+=s[u]*o[h]}}modL(t.subarray(32),p);return m}function unpackneg(t,r){var n=gf(),i=gf(),l=gf(),h=gf(),p=gf(),g=gf(),_=gf();set25519(t[2],s);unpack25519(t[1],r);S(l,t[1]);M(h,l,u);Z(l,l,t[2]);A(h,t[2],h);S(p,h);S(g,p);M(_,g,p);M(n,_,l);M(n,n,h);pow2523(n,n);M(n,n,l);M(n,n,h);M(n,n,h);M(t[0],n,h);S(i,t[0]);M(i,i,h);if(neq25519(i,l))M(t[0],t[0],m);S(i,t[0]);M(i,i,h);if(neq25519(i,l))return-1;if(par25519(t[0])===r[31]>>7)Z(t[0],o,t[0]);M(t[3],t[0],t[1]);return 0}function crypto_sign_open(t,r,n,i){var o,s;var l=new Uint8Array(32),u=new Uint8Array(64);var h=[gf(),gf(),gf(),gf()],p=[gf(),gf(),gf(),gf()];s=-1;if(n<64)return-1;if(unpackneg(p,i))return-1;for(o=0;o<n;o++)t[o]=r[o];for(o=0;o<32;o++)t[o+32]=i[o];crypto_hash(u,t,n);reduce(u);scalarmult(h,p,u);scalarbase(p,r.subarray(32));add(h,p);pack(l,h);n-=64;if(crypto_verify_32(r,0,l,0)){for(o=0;o<n;o++)t[o]=0;return-1}for(o=0;o<n;o++)t[o]=r[o+64];s=n;return s}var I=32,C=24,R=32,B=16,k=32,v=32,T=32,P=32,O=32,D=C,L=R,U=B,W=64,Q=32,q=64,$=32,j=64;t.lowlevel={crypto_core_hsalsa20:crypto_core_hsalsa20,crypto_stream_xor:crypto_stream_xor,crypto_stream:crypto_stream,crypto_stream_salsa20_xor:crypto_stream_salsa20_xor,crypto_stream_salsa20:crypto_stream_salsa20,crypto_onetimeauth:crypto_onetimeauth,crypto_onetimeauth_verify:crypto_onetimeauth_verify,crypto_verify_16:crypto_verify_16,crypto_verify_32:crypto_verify_32,crypto_secretbox:crypto_secretbox,crypto_secretbox_open:crypto_secretbox_open,crypto_scalarmult:crypto_scalarmult,crypto_scalarmult_base:crypto_scalarmult_base,crypto_box_beforenm:crypto_box_beforenm,crypto_box_afternm:E,crypto_box:crypto_box,crypto_box_open:crypto_box_open,crypto_box_keypair:crypto_box_keypair,crypto_hash:crypto_hash,crypto_sign:crypto_sign,crypto_sign_keypair:crypto_sign_keypair,crypto_sign_open:crypto_sign_open,crypto_secretbox_KEYBYTES:I,crypto_secretbox_NONCEBYTES:C,crypto_secretbox_ZEROBYTES:R,crypto_secretbox_BOXZEROBYTES:B,crypto_scalarmult_BYTES:k,crypto_scalarmult_SCALARBYTES:v,crypto_box_PUBLICKEYBYTES:T,crypto_box_SECRETKEYBYTES:P,crypto_box_BEFORENMBYTES:O,crypto_box_NONCEBYTES:D,crypto_box_ZEROBYTES:L,crypto_box_BOXZEROBYTES:U,crypto_sign_BYTES:W,crypto_sign_PUBLICKEYBYTES:Q,crypto_sign_SECRETKEYBYTES:q,crypto_sign_SEEDBYTES:$,crypto_hash_BYTES:j};function checkLengths(t,r){if(t.length!==I)throw new Error("bad key size");if(r.length!==C)throw new Error("bad nonce size")}function checkBoxLengths(t,r){if(t.length!==T)throw new Error("bad public key size");if(r.length!==P)throw new Error("bad secret key size")}function checkArrayTypes(){var t,r;for(r=0;r<arguments.length;r++){if((t=Object.prototype.toString.call(arguments[r]))!=="[object Uint8Array]")throw new TypeError("unexpected type "+t+", use Uint8Array")}}function cleanup(t){for(var r=0;r<t.length;r++)t[r]=0}if(!t.util){t.util={};t.util.decodeUTF8=t.util.encodeUTF8=t.util.encodeBase64=t.util.decodeBase64=function(){throw new Error("nacl.util moved into separate package: https://github.com/dchest/tweetnacl-util-js")}}t.randomBytes=function(t){var r=new Uint8Array(t);randombytes(r,t);return r};t.secretbox=function(t,r,n){checkArrayTypes(t,r,n);checkLengths(n,r);var i=new Uint8Array(R+t.length);var o=new Uint8Array(i.length);for(var s=0;s<t.length;s++)i[s+R]=t[s];crypto_secretbox(o,i,i.length,r,n);return o.subarray(B)};t.secretbox.open=function(t,r,n){checkArrayTypes(t,r,n);checkLengths(n,r);var i=new Uint8Array(B+t.length);var o=new Uint8Array(i.length);for(var s=0;s<t.length;s++)i[s+B]=t[s];if(i.length<32)return false;if(crypto_secretbox_open(o,i,i.length,r,n)!==0)return false;return o.subarray(R)};t.secretbox.keyLength=I;t.secretbox.nonceLength=C;t.secretbox.overheadLength=B;t.scalarMult=function(t,r){checkArrayTypes(t,r);if(t.length!==v)throw new Error("bad n size");if(r.length!==k)throw new Error("bad p size");var n=new Uint8Array(k);crypto_scalarmult(n,t,r);return n};t.scalarMult.base=function(t){checkArrayTypes(t);if(t.length!==v)throw new Error("bad n size");var r=new Uint8Array(k);crypto_scalarmult_base(r,t);return r};t.scalarMult.scalarLength=v;t.scalarMult.groupElementLength=k;t.box=function(r,n,i,o){var s=t.box.before(i,o);return t.secretbox(r,n,s)};t.box.before=function(t,r){checkArrayTypes(t,r);checkBoxLengths(t,r);var n=new Uint8Array(O);crypto_box_beforenm(n,t,r);return n};t.box.after=t.secretbox;t.box.open=function(r,n,i,o){var s=t.box.before(i,o);return t.secretbox.open(r,n,s)};t.box.open.after=t.secretbox.open;t.box.keyPair=function(){var t=new Uint8Array(T);var r=new Uint8Array(P);crypto_box_keypair(t,r);return{publicKey:t,secretKey:r}};t.box.keyPair.fromSecretKey=function(t){checkArrayTypes(t);if(t.length!==P)throw new Error("bad secret key size");var r=new Uint8Array(T);crypto_scalarmult_base(r,t);return{publicKey:r,secretKey:new Uint8Array(t)}};t.box.publicKeyLength=T;t.box.secretKeyLength=P;t.box.sharedKeyLength=O;t.box.nonceLength=D;t.box.overheadLength=t.secretbox.overheadLength;t.sign=function(t,r){checkArrayTypes(t,r);if(r.length!==q)throw new Error("bad secret key size");var n=new Uint8Array(W+t.length);crypto_sign(n,t,t.length,r);return n};t.sign.open=function(t,r){if(arguments.length!==2)throw new Error("nacl.sign.open accepts 2 arguments; did you mean to use nacl.sign.detached.verify?");checkArrayTypes(t,r);if(r.length!==Q)throw new Error("bad public key size");var n=new Uint8Array(t.length);var i=crypto_sign_open(n,t,t.length,r);if(i<0)return null;var o=new Uint8Array(i);for(var s=0;s<o.length;s++)o[s]=n[s];return o};t.sign.detached=function(r,n){var i=t.sign(r,n);var o=new Uint8Array(W);for(var s=0;s<o.length;s++)o[s]=i[s];return o};t.sign.detached.verify=function(t,r,n){checkArrayTypes(t,r,n);if(r.length!==W)throw new Error("bad signature size");if(n.length!==Q)throw new Error("bad public key size");var i=new Uint8Array(W+t.length);var o=new Uint8Array(W+t.length);var s;for(s=0;s<W;s++)i[s]=r[s];for(s=0;s<t.length;s++)i[s+W]=t[s];return crypto_sign_open(o,i,i.length,n)>=0};t.sign.keyPair=function(){var t=new Uint8Array(Q);var r=new Uint8Array(q);crypto_sign_keypair(t,r);return{publicKey:t,secretKey:r}};t.sign.keyPair.fromSecretKey=function(t){checkArrayTypes(t);if(t.length!==q)throw new Error("bad secret key size");var r=new Uint8Array(Q);for(var n=0;n<r.length;n++)r[n]=t[32+n];return{publicKey:r,secretKey:new Uint8Array(t)}};t.sign.keyPair.fromSeed=function(t){checkArrayTypes(t);if(t.length!==$)throw new Error("bad seed size");var r=new Uint8Array(Q);var n=new Uint8Array(q);for(var i=0;i<32;i++)n[i]=t[i];crypto_sign_keypair(r,n,true);return{publicKey:r,secretKey:n}};t.sign.publicKeyLength=Q;t.sign.secretKeyLength=q;t.sign.seedLength=$;t.sign.signatureLength=W;t.hash=function(t){checkArrayTypes(t);var r=new Uint8Array(j);crypto_hash(r,t,t.length);return r};t.hash.hashLength=j;t.verify=function(t,r){checkArrayTypes(t,r);if(t.length===0||r.length===0)return false;if(t.length!==r.length)return false;return vn(t,0,r,0,t.length)===0?true:false};t.setPRNG=function(t){randombytes=t};(function(){var r=typeof self!=="undefined"?self.crypto||self.msCrypto:null;if(r&&r.getRandomValues){var i=65536;t.setPRNG((function(t,n){var o,s=new Uint8Array(n);for(o=0;o<n;o+=i){r.getRandomValues(s.subarray(o,o+Math.min(n-o,i)))}for(o=0;o<n;o++)t[o]=s[o];cleanup(s)}))}else if(true){r=n(6417);if(r&&r.randomBytes){t.setPRNG((function(t,n){var i,o=r.randomBytes(n);for(i=0;i<n;i++)t[i]=o[i];cleanup(o)}))}}})()})(true&&t.exports?t.exports:self.nacl=self.nacl||{})},1452:function(t,r){(function(t,n){true?n(r):0})(this,(function(t){"use strict";const r=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?Symbol:t=>`Symbol(${t})`;function noop(){return undefined}function getGlobals(){if(typeof self!=="undefined"){return self}else if(typeof window!=="undefined"){return window}else if(typeof global!=="undefined"){return global}return undefined}const n=getGlobals();function typeIsObject(t){return typeof t==="object"&&t!==null||typeof t==="function"}const i=noop;const o=Promise;const s=Promise.prototype.then;const l=Promise.resolve.bind(o);const u=Promise.reject.bind(o);function newPromise(t){return new o(t)}function promiseResolvedWith(t){return l(t)}function promiseRejectedWith(t){return u(t)}function PerformPromiseThen(t,r,n){return s.call(t,r,n)}function uponPromise(t,r,n){PerformPromiseThen(PerformPromiseThen(t,r,n),undefined,i)}function uponFulfillment(t,r){uponPromise(t,r)}function uponRejection(t,r){uponPromise(t,undefined,r)}function transformPromiseWith(t,r,n){return PerformPromiseThen(t,r,n)}function setPromiseIsHandledToTrue(t){PerformPromiseThen(t,undefined,i)}const h=(()=>{const t=n&&n.queueMicrotask;if(typeof t==="function"){return t}const r=promiseResolvedWith(undefined);return t=>PerformPromiseThen(r,t)})();function reflectCall(t,r,n){if(typeof t!=="function"){throw new TypeError("Argument is not a function")}return Function.prototype.apply.call(t,r,n)}function promiseCall(t,r,n){try{return promiseResolvedWith(reflectCall(t,r,n))}catch(t){return promiseRejectedWith(t)}}const p=16384;class SimpleQueue{constructor(){this._cursor=0;this._size=0;this._front={_elements:[],_next:undefined};this._back=this._front;this._cursor=0;this._size=0}get length(){return this._size}push(t){const r=this._back;let n=r;if(r._elements.length===p-1){n={_elements:[],_next:undefined}}r._elements.push(t);if(n!==r){this._back=n;r._next=n}++this._size}shift(){const t=this._front;let r=t;const n=this._cursor;let i=n+1;const o=t._elements;const s=o[n];if(i===p){r=t._next;i=0}--this._size;this._cursor=i;if(t!==r){this._front=r}o[n]=undefined;return s}forEach(t){let r=this._cursor;let n=this._front;let i=n._elements;while(r!==i.length||n._next!==undefined){if(r===i.length){n=n._next;i=n._elements;r=0;if(i.length===0){break}}t(i[r]);++r}}peek(){const t=this._front;const r=this._cursor;return t._elements[r]}}function ReadableStreamReaderGenericInitialize(t,r){t._ownerReadableStream=r;r._reader=t;if(r._state==="readable"){defaultReaderClosedPromiseInitialize(t)}else if(r._state==="closed"){defaultReaderClosedPromiseInitializeAsResolved(t)}else{defaultReaderClosedPromiseInitializeAsRejected(t,r._storedError)}}function ReadableStreamReaderGenericCancel(t,r){const n=t._ownerReadableStream;return ReadableStreamCancel(n,r)}function ReadableStreamReaderGenericRelease(t){if(t._ownerReadableStream._state==="readable"){defaultReaderClosedPromiseReject(t,new TypeError(`Reader was released and can no longer be used to monitor the stream's closedness`))}else{defaultReaderClosedPromiseResetToRejected(t,new TypeError(`Reader was released and can no longer be used to monitor the stream's closedness`))}t._ownerReadableStream._reader=undefined;t._ownerReadableStream=undefined}function readerLockException(t){return new TypeError("Cannot "+t+" a stream using a released reader")}function defaultReaderClosedPromiseInitialize(t){t._closedPromise=newPromise(((r,n)=>{t._closedPromise_resolve=r;t._closedPromise_reject=n}))}function defaultReaderClosedPromiseInitializeAsRejected(t,r){defaultReaderClosedPromiseInitialize(t);defaultReaderClosedPromiseReject(t,r)}function defaultReaderClosedPromiseInitializeAsResolved(t){defaultReaderClosedPromiseInitialize(t);defaultReaderClosedPromiseResolve(t)}function defaultReaderClosedPromiseReject(t,r){if(t._closedPromise_reject===undefined){return}setPromiseIsHandledToTrue(t._closedPromise);t._closedPromise_reject(r);t._closedPromise_resolve=undefined;t._closedPromise_reject=undefined}function defaultReaderClosedPromiseResetToRejected(t,r){defaultReaderClosedPromiseInitializeAsRejected(t,r)}function defaultReaderClosedPromiseResolve(t){if(t._closedPromise_resolve===undefined){return}t._closedPromise_resolve(undefined);t._closedPromise_resolve=undefined;t._closedPromise_reject=undefined}const g=r("[[AbortSteps]]");const m=r("[[ErrorSteps]]");const _=r("[[CancelSteps]]");const E=r("[[PullSteps]]");const b=Number.isFinite||function(t){return typeof t==="number"&&isFinite(t)};const y=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};function isDictionary(t){return typeof t==="object"||typeof t==="function"}function assertDictionary(t,r){if(t!==undefined&&!isDictionary(t)){throw new TypeError(`${r} is not an object.`)}}function assertFunction(t,r){if(typeof t!=="function"){throw new TypeError(`${r} is not a function.`)}}function isObject(t){return typeof t==="object"&&t!==null||typeof t==="function"}function assertObject(t,r){if(!isObject(t)){throw new TypeError(`${r} is not an object.`)}}function assertRequiredArgument(t,r,n){if(t===undefined){throw new TypeError(`Parameter ${r} is required in '${n}'.`)}}function assertRequiredField(t,r,n){if(t===undefined){throw new TypeError(`${r} is required in '${n}'.`)}}function convertUnrestrictedDouble(t){return Number(t)}function censorNegativeZero(t){return t===0?0:t}function integerPart(t){return censorNegativeZero(y(t))}function convertUnsignedLongLongWithEnforceRange(t,r){const n=0;const i=Number.MAX_SAFE_INTEGER;let o=Number(t);o=censorNegativeZero(o);if(!b(o)){throw new TypeError(`${r} is not a finite number`)}o=integerPart(o);if(o<n||o>i){throw new TypeError(`${r} is outside the accepted range of ${n} to ${i}, inclusive`)}if(!b(o)||o===0){return 0}return o}function assertReadableStream(t,r){if(!IsReadableStream(t)){throw new TypeError(`${r} is not a ReadableStream.`)}}function AcquireReadableStreamDefaultReader(t){return new ReadableStreamDefaultReader(t)}function ReadableStreamAddReadRequest(t,r){t._reader._readRequests.push(r)}function ReadableStreamFulfillReadRequest(t,r,n){const i=t._reader;const o=i._readRequests.shift();if(n){o._closeSteps()}else{o._chunkSteps(r)}}function ReadableStreamGetNumReadRequests(t){return t._reader._readRequests.length}function ReadableStreamHasDefaultReader(t){const r=t._reader;if(r===undefined){return false}if(!IsReadableStreamDefaultReader(r)){return false}return true}class ReadableStreamDefaultReader{constructor(t){assertRequiredArgument(t,1,"ReadableStreamDefaultReader");assertReadableStream(t,"First parameter");if(IsReadableStreamLocked(t)){throw new TypeError("This stream has already been locked for exclusive reading by another reader")}ReadableStreamReaderGenericInitialize(this,t);this._readRequests=new SimpleQueue}get closed(){if(!IsReadableStreamDefaultReader(this)){return promiseRejectedWith(defaultReaderBrandCheckException("closed"))}return this._closedPromise}cancel(t=undefined){if(!IsReadableStreamDefaultReader(this)){return promiseRejectedWith(defaultReaderBrandCheckException("cancel"))}if(this._ownerReadableStream===undefined){return promiseRejectedWith(readerLockException("cancel"))}return ReadableStreamReaderGenericCancel(this,t)}read(){if(!IsReadableStreamDefaultReader(this)){return promiseRejectedWith(defaultReaderBrandCheckException("read"))}if(this._ownerReadableStream===undefined){return promiseRejectedWith(readerLockException("read from"))}let t;let r;const n=newPromise(((n,i)=>{t=n;r=i}));const i={_chunkSteps:r=>t({value:r,done:false}),_closeSteps:()=>t({value:undefined,done:true}),_errorSteps:t=>r(t)};ReadableStreamDefaultReaderRead(this,i);return n}releaseLock(){if(!IsReadableStreamDefaultReader(this)){throw defaultReaderBrandCheckException("releaseLock")}if(this._ownerReadableStream===undefined){return}if(this._readRequests.length>0){throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled")}ReadableStreamReaderGenericRelease(this)}}Object.defineProperties(ReadableStreamDefaultReader.prototype,{cancel:{enumerable:true},read:{enumerable:true},releaseLock:{enumerable:true},closed:{enumerable:true}});if(typeof r.toStringTag==="symbol"){Object.defineProperty(ReadableStreamDefaultReader.prototype,r.toStringTag,{value:"ReadableStreamDefaultReader",configurable:true})}function IsReadableStreamDefaultReader(t){if(!typeIsObject(t)){return false}if(!Object.prototype.hasOwnProperty.call(t,"_readRequests")){return false}return t instanceof ReadableStreamDefaultReader}function ReadableStreamDefaultReaderRead(t,r){const n=t._ownerReadableStream;n._disturbed=true;if(n._state==="closed"){r._closeSteps()}else if(n._state==="errored"){r._errorSteps(n._storedError)}else{n._readableStreamController[E](r)}}function defaultReaderBrandCheckException(t){return new TypeError(`ReadableStreamDefaultReader.prototype.${t} can only be used on a ReadableStreamDefaultReader`)}const w=Object.getPrototypeOf(Object.getPrototypeOf((async function*(){})).prototype);class ReadableStreamAsyncIteratorImpl{constructor(t,r){this._ongoingPromise=undefined;this._isFinished=false;this._reader=t;this._preventCancel=r}next(){const nextSteps=()=>this._nextSteps();this._ongoingPromise=this._ongoingPromise?transformPromiseWith(this._ongoingPromise,nextSteps,nextSteps):nextSteps();return this._ongoingPromise}return(t){const returnSteps=()=>this._returnSteps(t);return this._ongoingPromise?transformPromiseWith(this._ongoingPromise,returnSteps,returnSteps):returnSteps()}_nextSteps(){if(this._isFinished){return Promise.resolve({value:undefined,done:true})}const t=this._reader;if(t._ownerReadableStream===undefined){return promiseRejectedWith(readerLockException("iterate"))}let r;let n;const i=newPromise(((t,i)=>{r=t;n=i}));const o={_chunkSteps:t=>{this._ongoingPromise=undefined;h((()=>r({value:t,done:false})))},_closeSteps:()=>{this._ongoingPromise=undefined;this._isFinished=true;ReadableStreamReaderGenericRelease(t);r({value:undefined,done:true})},_errorSteps:r=>{this._ongoingPromise=undefined;this._isFinished=true;ReadableStreamReaderGenericRelease(t);n(r)}};ReadableStreamDefaultReaderRead(t,o);return i}_returnSteps(t){if(this._isFinished){return Promise.resolve({value:t,done:true})}this._isFinished=true;const r=this._reader;if(r._ownerReadableStream===undefined){return promiseRejectedWith(readerLockException("finish iterating"))}if(!this._preventCancel){const n=ReadableStreamReaderGenericCancel(r,t);ReadableStreamReaderGenericRelease(r);return transformPromiseWith(n,(()=>({value:t,done:true})))}ReadableStreamReaderGenericRelease(r);return promiseResolvedWith({value:t,done:true})}}const I={next(){if(!IsReadableStreamAsyncIterator(this)){return promiseRejectedWith(streamAsyncIteratorBrandCheckException("next"))}return this._asyncIteratorImpl.next()},return(t){if(!IsReadableStreamAsyncIterator(this)){return promiseRejectedWith(streamAsyncIteratorBrandCheckException("return"))}return this._asyncIteratorImpl.return(t)}};if(w!==undefined){Object.setPrototypeOf(I,w)}function AcquireReadableStreamAsyncIterator(t,r){const n=AcquireReadableStreamDefaultReader(t);const i=new ReadableStreamAsyncIteratorImpl(n,r);const o=Object.create(I);o._asyncIteratorImpl=i;return o}function IsReadableStreamAsyncIterator(t){if(!typeIsObject(t)){return false}if(!Object.prototype.hasOwnProperty.call(t,"_asyncIteratorImpl")){return false}try{return t._asyncIteratorImpl instanceof ReadableStreamAsyncIteratorImpl}catch(t){return false}}function streamAsyncIteratorBrandCheckException(t){return new TypeError(`ReadableStreamAsyncIterator.${t} can only be used on a ReadableSteamAsyncIterator`)}const C=Number.isNaN||function(t){return t!==t};function CreateArrayFromList(t){return t.slice()}function CopyDataBlockBytes(t,r,n,i,o){new Uint8Array(t).set(new Uint8Array(n,i,o),r)}function TransferArrayBuffer(t){return t}function IsDetachedBuffer(t){return false}function ArrayBufferSlice(t,r,n){if(t.slice){return t.slice(r,n)}const i=n-r;const o=new ArrayBuffer(i);CopyDataBlockBytes(o,0,t,r,i);return o}function IsNonNegativeNumber(t){if(typeof t!=="number"){return false}if(C(t)){return false}if(t<0){return false}return true}function CloneAsUint8Array(t){const r=ArrayBufferSlice(t.buffer,t.byteOffset,t.byteOffset+t.byteLength);return new Uint8Array(r)}function DequeueValue(t){const r=t._queue.shift();t._queueTotalSize-=r.size;if(t._queueTotalSize<0){t._queueTotalSize=0}return r.value}function EnqueueValueWithSize(t,r,n){if(!IsNonNegativeNumber(n)||n===Infinity){throw new RangeError("Size must be a finite, non-NaN, non-negative number.")}t._queue.push({value:r,size:n});t._queueTotalSize+=n}function PeekQueueValue(t){const r=t._queue.peek();return r.value}function ResetQueue(t){t._queue=new SimpleQueue;t._queueTotalSize=0}class ReadableStreamBYOBRequest{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!IsReadableStreamBYOBRequest(this)){throw byobRequestBrandCheckException("view")}return this._view}respond(t){if(!IsReadableStreamBYOBRequest(this)){throw byobRequestBrandCheckException("respond")}assertRequiredArgument(t,1,"respond");t=convertUnsignedLongLongWithEnforceRange(t,"First parameter");if(this._associatedReadableByteStreamController===undefined){throw new TypeError("This BYOB request has been invalidated")}if(IsDetachedBuffer(this._view.buffer));ReadableByteStreamControllerRespond(this._associatedReadableByteStreamController,t)}respondWithNewView(t){if(!IsReadableStreamBYOBRequest(this)){throw byobRequestBrandCheckException("respondWithNewView")}assertRequiredArgument(t,1,"respondWithNewView");if(!ArrayBuffer.isView(t)){throw new TypeError("You can only respond with array buffer views")}if(this._associatedReadableByteStreamController===undefined){throw new TypeError("This BYOB request has been invalidated")}if(IsDetachedBuffer(t.buffer));ReadableByteStreamControllerRespondWithNewView(this._associatedReadableByteStreamController,t)}}Object.defineProperties(ReadableStreamBYOBRequest.prototype,{respond:{enumerable:true},respondWithNewView:{enumerable:true},view:{enumerable:true}});if(typeof r.toStringTag==="symbol"){Object.defineProperty(ReadableStreamBYOBRequest.prototype,r.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:true})}class ReadableByteStreamController{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!IsReadableByteStreamController(this)){throw byteStreamControllerBrandCheckException("byobRequest")}return ReadableByteStreamControllerGetBYOBRequest(this)}get desiredSize(){if(!IsReadableByteStreamController(this)){throw byteStreamControllerBrandCheckException("desiredSize")}return ReadableByteStreamControllerGetDesiredSize(this)}close(){if(!IsReadableByteStreamController(this)){throw byteStreamControllerBrandCheckException("close")}if(this._closeRequested){throw new TypeError("The stream has already been closed; do not close it again!")}const t=this._controlledReadableByteStream._state;if(t!=="readable"){throw new TypeError(`The stream (in ${t} state) is not in the readable state and cannot be closed`)}ReadableByteStreamControllerClose(this)}enqueue(t){if(!IsReadableByteStreamController(this)){throw byteStreamControllerBrandCheckException("enqueue")}assertRequiredArgument(t,1,"enqueue");if(!ArrayBuffer.isView(t)){throw new TypeError("chunk must be an array buffer view")}if(t.byteLength===0){throw new TypeError("chunk must have non-zero byteLength")}if(t.buffer.byteLength===0){throw new TypeError(`chunk's buffer must have non-zero byteLength`)}if(this._closeRequested){throw new TypeError("stream is closed or draining")}const r=this._controlledReadableByteStream._state;if(r!=="readable"){throw new TypeError(`The stream (in ${r} state) is not in the readable state and cannot be enqueued to`)}ReadableByteStreamControllerEnqueue(this,t)}error(t=undefined){if(!IsReadableByteStreamController(this)){throw byteStreamControllerBrandCheckException("error")}ReadableByteStreamControllerError(this,t)}[_](t){ReadableByteStreamControllerClearPendingPullIntos(this);ResetQueue(this);const r=this._cancelAlgorithm(t);ReadableByteStreamControllerClearAlgorithms(this);return r}[E](t){const r=this._controlledReadableByteStream;if(this._queueTotalSize>0){const r=this._queue.shift();this._queueTotalSize-=r.byteLength;ReadableByteStreamControllerHandleQueueDrain(this);const n=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);t._chunkSteps(n);return}const n=this._autoAllocateChunkSize;if(n!==undefined){let r;try{r=new ArrayBuffer(n)}catch(r){t._errorSteps(r);return}const i={buffer:r,bufferByteLength:n,byteOffset:0,byteLength:n,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(i)}ReadableStreamAddReadRequest(r,t);ReadableByteStreamControllerCallPullIfNeeded(this)}}Object.defineProperties(ReadableByteStreamController.prototype,{close:{enumerable:true},enqueue:{enumerable:true},error:{enumerable:true},byobRequest:{enumerable:true},desiredSize:{enumerable:true}});if(typeof r.toStringTag==="symbol"){Object.defineProperty(ReadableByteStreamController.prototype,r.toStringTag,{value:"ReadableByteStreamController",configurable:true})}function IsReadableByteStreamController(t){if(!typeIsObject(t)){return false}if(!Object.prototype.hasOwnProperty.call(t,"_controlledReadableByteStream")){return false}return t instanceof ReadableByteStreamController}function IsReadableStreamBYOBRequest(t){if(!typeIsObject(t)){return false}if(!Object.prototype.hasOwnProperty.call(t,"_associatedReadableByteStreamController")){return false}return t instanceof ReadableStreamBYOBRequest}function ReadableByteStreamControllerCallPullIfNeeded(t){const r=ReadableByteStreamControllerShouldCallPull(t);if(!r){return}if(t._pulling){t._pullAgain=true;return}t._pulling=true;const n=t._pullAlgorithm();uponPromise(n,(()=>{t._pulling=false;if(t._pullAgain){t._pullAgain=false;ReadableByteStreamControllerCallPullIfNeeded(t)}}),(r=>{ReadableByteStreamControllerError(t,r)}))}function ReadableByteStreamControllerClearPendingPullIntos(t){ReadableByteStreamControllerInvalidateBYOBRequest(t);t._pendingPullIntos=new SimpleQueue}function ReadableByteStreamControllerCommitPullIntoDescriptor(t,r){let n=false;if(t._state==="closed"){n=true}const i=ReadableByteStreamControllerConvertPullIntoDescriptor(r);if(r.readerType==="default"){ReadableStreamFulfillReadRequest(t,i,n)}else{ReadableStreamFulfillReadIntoRequest(t,i,n)}}function ReadableByteStreamControllerConvertPullIntoDescriptor(t){const r=t.bytesFilled;const n=t.elementSize;return new t.viewConstructor(t.buffer,t.byteOffset,r/n)}function ReadableByteStreamControllerEnqueueChunkToQueue(t,r,n,i){t._queue.push({buffer:r,byteOffset:n,byteLength:i});t._queueTotalSize+=i}function ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(t,r){const n=r.elementSize;const i=r.bytesFilled-r.bytesFilled%n;const o=Math.min(t._queueTotalSize,r.byteLength-r.bytesFilled);const s=r.bytesFilled+o;const l=s-s%n;let u=o;let h=false;if(l>i){u=l-r.bytesFilled;h=true}const p=t._queue;while(u>0){const n=p.peek();const i=Math.min(u,n.byteLength);const o=r.byteOffset+r.bytesFilled;CopyDataBlockBytes(r.buffer,o,n.buffer,n.byteOffset,i);if(n.byteLength===i){p.shift()}else{n.byteOffset+=i;n.byteLength-=i}t._queueTotalSize-=i;ReadableByteStreamControllerFillHeadPullIntoDescriptor(t,i,r);u-=i}return h}function ReadableByteStreamControllerFillHeadPullIntoDescriptor(t,r,n){n.bytesFilled+=r}function ReadableByteStreamControllerHandleQueueDrain(t){if(t._queueTotalSize===0&&t._closeRequested){ReadableByteStreamControllerClearAlgorithms(t);ReadableStreamClose(t._controlledReadableByteStream)}else{ReadableByteStreamControllerCallPullIfNeeded(t)}}function ReadableByteStreamControllerInvalidateBYOBRequest(t){if(t._byobRequest===null){return}t._byobRequest._associatedReadableByteStreamController=undefined;t._byobRequest._view=null;t._byobRequest=null}function ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(t){while(t._pendingPullIntos.length>0){if(t._queueTotalSize===0){return}const r=t._pendingPullIntos.peek();if(ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(t,r)){ReadableByteStreamControllerShiftPendingPullInto(t);ReadableByteStreamControllerCommitPullIntoDescriptor(t._controlledReadableByteStream,r)}}}function ReadableByteStreamControllerPullInto(t,r,n){const i=t._controlledReadableByteStream;let o=1;if(r.constructor!==DataView){o=r.constructor.BYTES_PER_ELEMENT}const s=r.constructor;const l=TransferArrayBuffer(r.buffer);const u={buffer:l,bufferByteLength:l.byteLength,byteOffset:r.byteOffset,byteLength:r.byteLength,bytesFilled:0,elementSize:o,viewConstructor:s,readerType:"byob"};if(t._pendingPullIntos.length>0){t._pendingPullIntos.push(u);ReadableStreamAddReadIntoRequest(i,n);return}if(i._state==="closed"){const t=new s(u.buffer,u.byteOffset,0);n._closeSteps(t);return}if(t._queueTotalSize>0){if(ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(t,u)){const r=ReadableByteStreamControllerConvertPullIntoDescriptor(u);ReadableByteStreamControllerHandleQueueDrain(t);n._chunkSteps(r);return}if(t._closeRequested){const r=new TypeError("Insufficient bytes to fill elements in the given buffer");ReadableByteStreamControllerError(t,r);n._errorSteps(r);return}}t._pendingPullIntos.push(u);ReadableStreamAddReadIntoRequest(i,n);ReadableByteStreamControllerCallPullIfNeeded(t)}function ReadableByteStreamControllerRespondInClosedState(t,r){const n=t._controlledReadableByteStream;if(ReadableStreamHasBYOBReader(n)){while(ReadableStreamGetNumReadIntoRequests(n)>0){const r=ReadableByteStreamControllerShiftPendingPullInto(t);ReadableByteStreamControllerCommitPullIntoDescriptor(n,r)}}}function ReadableByteStreamControllerRespondInReadableState(t,r,n){ReadableByteStreamControllerFillHeadPullIntoDescriptor(t,r,n);if(n.bytesFilled<n.elementSize){return}ReadableByteStreamControllerShiftPendingPullInto(t);const i=n.bytesFilled%n.elementSize;if(i>0){const r=n.byteOffset+n.bytesFilled;const o=ArrayBufferSlice(n.buffer,r-i,r);ReadableByteStreamControllerEnqueueChunkToQueue(t,o,0,o.byteLength)}n.bytesFilled-=i;ReadableByteStreamControllerCommitPullIntoDescriptor(t._controlledReadableByteStream,n);ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(t)}function ReadableByteStreamControllerRespondInternal(t,r){const n=t._pendingPullIntos.peek();ReadableByteStreamControllerInvalidateBYOBRequest(t);const i=t._controlledReadableByteStream._state;if(i==="closed"){ReadableByteStreamControllerRespondInClosedState(t)}else{ReadableByteStreamControllerRespondInReadableState(t,r,n)}ReadableByteStreamControllerCallPullIfNeeded(t)}function ReadableByteStreamControllerShiftPendingPullInto(t){const r=t._pendingPullIntos.shift();return r}function ReadableByteStreamControllerShouldCallPull(t){const r=t._controlledReadableByteStream;if(r._state!=="readable"){return false}if(t._closeRequested){return false}if(!t._started){return false}if(ReadableStreamHasDefaultReader(r)&&ReadableStreamGetNumReadRequests(r)>0){return true}if(ReadableStreamHasBYOBReader(r)&&ReadableStreamGetNumReadIntoRequests(r)>0){return true}const n=ReadableByteStreamControllerGetDesiredSize(t);if(n>0){return true}return false}function ReadableByteStreamControllerClearAlgorithms(t){t._pullAlgorithm=undefined;t._cancelAlgorithm=undefined}function ReadableByteStreamControllerClose(t){const r=t._controlledReadableByteStream;if(t._closeRequested||r._state!=="readable"){return}if(t._queueTotalSize>0){t._closeRequested=true;return}if(t._pendingPullIntos.length>0){const r=t._pendingPullIntos.peek();if(r.bytesFilled>0){const r=new TypeError("Insufficient bytes to fill elements in the given buffer");ReadableByteStreamControllerError(t,r);throw r}}ReadableByteStreamControllerClearAlgorithms(t);ReadableStreamClose(r)}function ReadableByteStreamControllerEnqueue(t,r){const n=t._controlledReadableByteStream;if(t._closeRequested||n._state!=="readable"){return}const i=r.buffer;const o=r.byteOffset;const s=r.byteLength;const l=TransferArrayBuffer(i);if(t._pendingPullIntos.length>0){const r=t._pendingPullIntos.peek();if(IsDetachedBuffer(r.buffer));r.buffer=TransferArrayBuffer(r.buffer)}ReadableByteStreamControllerInvalidateBYOBRequest(t);if(ReadableStreamHasDefaultReader(n)){if(ReadableStreamGetNumReadRequests(n)===0){ReadableByteStreamControllerEnqueueChunkToQueue(t,l,o,s)}else{if(t._pendingPullIntos.length>0){ReadableByteStreamControllerShiftPendingPullInto(t)}const r=new Uint8Array(l,o,s);ReadableStreamFulfillReadRequest(n,r,false)}}else if(ReadableStreamHasBYOBReader(n)){ReadableByteStreamControllerEnqueueChunkToQueue(t,l,o,s);ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(t)}else{ReadableByteStreamControllerEnqueueChunkToQueue(t,l,o,s)}ReadableByteStreamControllerCallPullIfNeeded(t)}function ReadableByteStreamControllerError(t,r){const n=t._controlledReadableByteStream;if(n._state!=="readable"){return}ReadableByteStreamControllerClearPendingPullIntos(t);ResetQueue(t);ReadableByteStreamControllerClearAlgorithms(t);ReadableStreamError(n,r)}function ReadableByteStreamControllerGetBYOBRequest(t){if(t._byobRequest===null&&t._pendingPullIntos.length>0){const r=t._pendingPullIntos.peek();const n=new Uint8Array(r.buffer,r.byteOffset+r.bytesFilled,r.byteLength-r.bytesFilled);const i=Object.create(ReadableStreamBYOBRequest.prototype);SetUpReadableStreamBYOBRequest(i,t,n);t._byobRequest=i}return t._byobRequest}function ReadableByteStreamControllerGetDesiredSize(t){const r=t._controlledReadableByteStream._state;if(r==="errored"){return null}if(r==="closed"){return 0}return t._strategyHWM-t._queueTotalSize}function ReadableByteStreamControllerRespond(t,r){const n=t._pendingPullIntos.peek();const i=t._controlledReadableByteStream._state;if(i==="closed"){if(r!==0){throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}}else{if(r===0){throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream")}if(n.bytesFilled+r>n.byteLength){throw new RangeError("bytesWritten out of range")}}n.buffer=TransferArrayBuffer(n.buffer);ReadableByteStreamControllerRespondInternal(t,r)}function ReadableByteStreamControllerRespondWithNewView(t,r){const n=t._pendingPullIntos.peek();const i=t._controlledReadableByteStream._state;if(i==="closed"){if(r.byteLength!==0){throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}}else{if(r.byteLength===0){throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream")}}if(n.byteOffset+n.bytesFilled!==r.byteOffset){throw new RangeError("The region specified by view does not match byobRequest")}if(n.bufferByteLength!==r.buffer.byteLength){throw new RangeError("The buffer of view has different capacity than byobRequest")}if(n.bytesFilled+r.byteLength>n.byteLength){throw new RangeError("The region specified by view is larger than byobRequest")}const o=r.byteLength;n.buffer=TransferArrayBuffer(r.buffer);ReadableByteStreamControllerRespondInternal(t,o)}function SetUpReadableByteStreamController(t,r,n,i,o,s,l){r._controlledReadableByteStream=t;r._pullAgain=false;r._pulling=false;r._byobRequest=null;r._queue=r._queueTotalSize=undefined;ResetQueue(r);r._closeRequested=false;r._started=false;r._strategyHWM=s;r._pullAlgorithm=i;r._cancelAlgorithm=o;r._autoAllocateChunkSize=l;r._pendingPullIntos=new SimpleQueue;t._readableStreamController=r;const u=n();uponPromise(promiseResolvedWith(u),(()=>{r._started=true;ReadableByteStreamControllerCallPullIfNeeded(r)}),(t=>{ReadableByteStreamControllerError(r,t)}))}function SetUpReadableByteStreamControllerFromUnderlyingSource(t,r,n){const i=Object.create(ReadableByteStreamController.prototype);let startAlgorithm=()=>undefined;let pullAlgorithm=()=>promiseResolvedWith(undefined);let cancelAlgorithm=()=>promiseResolvedWith(undefined);if(r.start!==undefined){startAlgorithm=()=>r.start(i)}if(r.pull!==undefined){pullAlgorithm=()=>r.pull(i)}if(r.cancel!==undefined){cancelAlgorithm=t=>r.cancel(t)}const o=r.autoAllocateChunkSize;if(o===0){throw new TypeError("autoAllocateChunkSize must be greater than 0")}SetUpReadableByteStreamController(t,i,startAlgorithm,pullAlgorithm,cancelAlgorithm,n,o)}function SetUpReadableStreamBYOBRequest(t,r,n){t._associatedReadableByteStreamController=r;t._view=n}function byobRequestBrandCheckException(t){return new TypeError(`ReadableStreamBYOBRequest.prototype.${t} can only be used on a ReadableStreamBYOBRequest`)}function byteStreamControllerBrandCheckException(t){return new TypeError(`ReadableByteStreamController.prototype.${t} can only be used on a ReadableByteStreamController`)}function AcquireReadableStreamBYOBReader(t){return new ReadableStreamBYOBReader(t)}function ReadableStreamAddReadIntoRequest(t,r){t._reader._readIntoRequests.push(r)}function ReadableStreamFulfillReadIntoRequest(t,r,n){const i=t._reader;const o=i._readIntoRequests.shift();if(n){o._closeSteps(r)}else{o._chunkSteps(r)}}function ReadableStreamGetNumReadIntoRequests(t){return t._reader._readIntoRequests.length}function ReadableStreamHasBYOBReader(t){const r=t._reader;if(r===undefined){return false}if(!IsReadableStreamBYOBReader(r)){return false}return true}class ReadableStreamBYOBReader{constructor(t){assertRequiredArgument(t,1,"ReadableStreamBYOBReader");assertReadableStream(t,"First parameter");if(IsReadableStreamLocked(t)){throw new TypeError("This stream has already been locked for exclusive reading by another reader")}if(!IsReadableByteStreamController(t._readableStreamController)){throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte "+"source")}ReadableStreamReaderGenericInitialize(this,t);this._readIntoRequests=new SimpleQueue}get closed(){if(!IsReadableStreamBYOBReader(this)){return promiseRejectedWith(byobReaderBrandCheckException("closed"))}return this._closedPromise}cancel(t=undefined){if(!IsReadableStreamBYOBReader(this)){return promiseRejectedWith(byobReaderBrandCheckException("cancel"))}if(this._ownerReadableStream===undefined){return promiseRejectedWith(readerLockException("cancel"))}return ReadableStreamReaderGenericCancel(this,t)}read(t){if(!IsReadableStreamBYOBReader(this)){return promiseRejectedWith(byobReaderBrandCheckException("read"))}if(!ArrayBuffer.isView(t)){return promiseRejectedWith(new TypeError("view must be an array buffer view"))}if(t.byteLength===0){return promiseRejectedWith(new TypeError("view must have non-zero byteLength"))}if(t.buffer.byteLength===0){return promiseRejectedWith(new TypeError(`view's buffer must have non-zero byteLength`))}if(IsDetachedBuffer(t.buffer));if(this._ownerReadableStream===undefined){return promiseRejectedWith(readerLockException("read from"))}let r;let n;const i=newPromise(((t,i)=>{r=t;n=i}));const o={_chunkSteps:t=>r({value:t,done:false}),_closeSteps:t=>r({value:t,done:true}),_errorSteps:t=>n(t)};ReadableStreamBYOBReaderRead(this,t,o);return i}releaseLock(){if(!IsReadableStreamBYOBReader(this)){throw byobReaderBrandCheckException("releaseLock")}if(this._ownerReadableStream===undefined){return}if(this._readIntoRequests.length>0){throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled")}ReadableStreamReaderGenericRelease(this)}}Object.defineProperties(ReadableStreamBYOBReader.prototype,{cancel:{enumerable:true},read:{enumerable:true},releaseLock:{enumerable:true},closed:{enumerable:true}});if(typeof r.toStringTag==="symbol"){Object.defineProperty(ReadableStreamBYOBReader.prototype,r.toStringTag,{value:"ReadableStreamBYOBReader",configurable:true})}function IsReadableStreamBYOBReader(t){if(!typeIsObject(t)){return false}if(!Object.prototype.hasOwnProperty.call(t,"_readIntoRequests")){return false}return t instanceof ReadableStreamBYOBReader}function ReadableStreamBYOBReaderRead(t,r,n){const i=t._ownerReadableStream;i._disturbed=true;if(i._state==="errored"){n._errorSteps(i._storedError)}else{ReadableByteStreamControllerPullInto(i._readableStreamController,r,n)}}function byobReaderBrandCheckException(t){return new TypeError(`ReadableStreamBYOBReader.prototype.${t} can only be used on a ReadableStreamBYOBReader`)}function ExtractHighWaterMark(t,r){const{highWaterMark:n}=t;if(n===undefined){return r}if(C(n)||n<0){throw new RangeError("Invalid highWaterMark")}return n}function ExtractSizeAlgorithm(t){const{size:r}=t;if(!r){return()=>1}return r}function convertQueuingStrategy(t,r){assertDictionary(t,r);const n=t===null||t===void 0?void 0:t.highWaterMark;const i=t===null||t===void 0?void 0:t.size;return{highWaterMark:n===undefined?undefined:convertUnrestrictedDouble(n),size:i===undefined?undefined:convertQueuingStrategySize(i,`${r} has member 'size' that`)}}function convertQueuingStrategySize(t,r){assertFunction(t,r);return r=>convertUnrestrictedDouble(t(r))}function convertUnderlyingSink(t,r){assertDictionary(t,r);const n=t===null||t===void 0?void 0:t.abort;const i=t===null||t===void 0?void 0:t.close;const o=t===null||t===void 0?void 0:t.start;const s=t===null||t===void 0?void 0:t.type;const l=t===null||t===void 0?void 0:t.write;return{abort:n===undefined?undefined:convertUnderlyingSinkAbortCallback(n,t,`${r} has member 'abort' that`),close:i===undefined?undefined:convertUnderlyingSinkCloseCallback(i,t,`${r} has member 'close' that`),start:o===undefined?undefined:convertUnderlyingSinkStartCallback(o,t,`${r} has member 'start' that`),write:l===undefined?undefined:convertUnderlyingSinkWriteCallback(l,t,`${r} has member 'write' that`),type:s}}function convertUnderlyingSinkAbortCallback(t,r,n){assertFunction(t,n);return n=>promiseCall(t,r,[n])}function convertUnderlyingSinkCloseCallback(t,r,n){assertFunction(t,n);return()=>promiseCall(t,r,[])}function convertUnderlyingSinkStartCallback(t,r,n){assertFunction(t,n);return n=>reflectCall(t,r,[n])}function convertUnderlyingSinkWriteCallback(t,r,n){assertFunction(t,n);return(n,i)=>promiseCall(t,r,[n,i])}function assertWritableStream(t,r){if(!IsWritableStream(t)){throw new TypeError(`${r} is not a WritableStream.`)}}function isAbortSignal(t){if(typeof t!=="object"||t===null){return false}try{return typeof t.aborted==="boolean"}catch(t){return false}}const R=typeof AbortController==="function";function createAbortController(){if(R){return new AbortController}return undefined}class WritableStream{constructor(t={},r={}){if(t===undefined){t=null}else{assertObject(t,"First parameter")}const n=convertQueuingStrategy(r,"Second parameter");const i=convertUnderlyingSink(t,"First parameter");InitializeWritableStream(this);const o=i.type;if(o!==undefined){throw new RangeError("Invalid type is specified")}const s=ExtractSizeAlgorithm(n);const l=ExtractHighWaterMark(n,1);SetUpWritableStreamDefaultControllerFromUnderlyingSink(this,i,l,s)}get locked(){if(!IsWritableStream(this)){throw streamBrandCheckException$2("locked")}return IsWritableStreamLocked(this)}abort(t=undefined){if(!IsWritableStream(this)){return promiseRejectedWith(streamBrandCheckException$2("abort"))}if(IsWritableStreamLocked(this)){return promiseRejectedWith(new TypeError("Cannot abort a stream that already has a writer"))}return WritableStreamAbort(this,t)}close(){if(!IsWritableStream(this)){return promiseRejectedWith(streamBrandCheckException$2("close"))}if(IsWritableStreamLocked(this)){return promiseRejectedWith(new TypeError("Cannot close a stream that already has a writer"))}if(WritableStreamCloseQueuedOrInFlight(this)){return promiseRejectedWith(new TypeError("Cannot close an already-closing stream"))}return WritableStreamClose(this)}getWriter(){if(!IsWritableStream(this)){throw streamBrandCheckException$2("getWriter")}return AcquireWritableStreamDefaultWriter(this)}}Object.defineProperties(WritableStream.prototype,{abort:{enumerable:true},close:{enumerable:true},getWriter:{enumerable:true},locked:{enumerable:true}});if(typeof r.toStringTag==="symbol"){Object.defineProperty(WritableStream.prototype,r.toStringTag,{value:"WritableStream",configurable:true})}function AcquireWritableStreamDefaultWriter(t){return new WritableStreamDefaultWriter(t)}function CreateWritableStream(t,r,n,i,o=1,s=(()=>1)){const l=Object.create(WritableStream.prototype);InitializeWritableStream(l);const u=Object.create(WritableStreamDefaultController.prototype);SetUpWritableStreamDefaultController(l,u,t,r,n,i,o,s);return l}function InitializeWritableStream(t){t._state="writable";t._storedError=undefined;t._writer=undefined;t._writableStreamController=undefined;t._writeRequests=new SimpleQueue;t._inFlightWriteRequest=undefined;t._closeRequest=undefined;t._inFlightCloseRequest=undefined;t._pendingAbortRequest=undefined;t._backpressure=false}function IsWritableStream(t){if(!typeIsObject(t)){return false}if(!Object.prototype.hasOwnProperty.call(t,"_writableStreamController")){return false}return t instanceof WritableStream}function IsWritableStreamLocked(t){if(t._writer===undefined){return false}return true}function WritableStreamAbort(t,r){var n;if(t._state==="closed"||t._state==="errored"){return promiseResolvedWith(undefined)}t._writableStreamController._abortReason=r;(n=t._writableStreamController._abortController)===null||n===void 0?void 0:n.abort();const i=t._state;if(i==="closed"||i==="errored"){return promiseResolvedWith(undefined)}if(t._pendingAbortRequest!==undefined){return t._pendingAbortRequest._promise}let o=false;if(i==="erroring"){o=true;r=undefined}const s=newPromise(((n,i)=>{t._pendingAbortRequest={_promise:undefined,_resolve:n,_reject:i,_reason:r,_wasAlreadyErroring:o}}));t._pendingAbortRequest._promise=s;if(!o){WritableStreamStartErroring(t,r)}return s}function WritableStreamClose(t){const r=t._state;if(r==="closed"||r==="errored"){return promiseRejectedWith(new TypeError(`The stream (in ${r} state) is not in the writable state and cannot be closed`))}const n=newPromise(((r,n)=>{const i={_resolve:r,_reject:n};t._closeRequest=i}));const i=t._writer;if(i!==undefined&&t._backpressure&&r==="writable"){defaultWriterReadyPromiseResolve(i)}WritableStreamDefaultControllerClose(t._writableStreamController);return n}function WritableStreamAddWriteRequest(t){const r=newPromise(((r,n)=>{const i={_resolve:r,_reject:n};t._writeRequests.push(i)}));return r}function WritableStreamDealWithRejection(t,r){const n=t._state;if(n==="writable"){WritableStreamStartErroring(t,r);return}WritableStreamFinishErroring(t)}function WritableStreamStartErroring(t,r){const n=t._writableStreamController;t._state="erroring";t._storedError=r;const i=t._writer;if(i!==undefined){WritableStreamDefaultWriterEnsureReadyPromiseRejected(i,r)}if(!WritableStreamHasOperationMarkedInFlight(t)&&n._started){WritableStreamFinishErroring(t)}}function WritableStreamFinishErroring(t){t._state="errored";t._writableStreamController[m]();const r=t._storedError;t._writeRequests.forEach((t=>{t._reject(r)}));t._writeRequests=new SimpleQueue;if(t._pendingAbortRequest===undefined){WritableStreamRejectCloseAndClosedPromiseIfNeeded(t);return}const n=t._pendingAbortRequest;t._pendingAbortRequest=undefined;if(n._wasAlreadyErroring){n._reject(r);WritableStreamRejectCloseAndClosedPromiseIfNeeded(t);return}const i=t._writableStreamController[g](n._reason);uponPromise(i,(()=>{n._resolve();WritableStreamRejectCloseAndClosedPromiseIfNeeded(t)}),(r=>{n._reject(r);WritableStreamRejectCloseAndClosedPromiseIfNeeded(t)}))}function WritableStreamFinishInFlightWrite(t){t._inFlightWriteRequest._resolve(undefined);t._inFlightWriteRequest=undefined}function WritableStreamFinishInFlightWriteWithError(t,r){t._inFlightWriteRequest._reject(r);t._inFlightWriteRequest=undefined;WritableStreamDealWithRejection(t,r)}function WritableStreamFinishInFlightClose(t){t._inFlightCloseRequest._resolve(undefined);t._inFlightCloseRequest=undefined;const r=t._state;if(r==="erroring"){t._storedError=undefined;if(t._pendingAbortRequest!==undefined){t._pendingAbortRequest._resolve();t._pendingAbortRequest=undefined}}t._state="closed";const n=t._writer;if(n!==undefined){defaultWriterClosedPromiseResolve(n)}}function WritableStreamFinishInFlightCloseWithError(t,r){t._inFlightCloseRequest._reject(r);t._inFlightCloseRequest=undefined;if(t._pendingAbortRequest!==undefined){t._pendingAbortRequest._reject(r);t._pendingAbortRequest=undefined}WritableStreamDealWithRejection(t,r)}function WritableStreamCloseQueuedOrInFlight(t){if(t._closeRequest===undefined&&t._inFlightCloseRequest===undefined){return false}return true}function WritableStreamHasOperationMarkedInFlight(t){if(t._inFlightWriteRequest===undefined&&t._inFlightCloseRequest===undefined){return false}return true}function WritableStreamMarkCloseRequestInFlight(t){t._inFlightCloseRequest=t._closeRequest;t._closeRequest=undefined}function WritableStreamMarkFirstWriteRequestInFlight(t){t._inFlightWriteRequest=t._writeRequests.shift()}function WritableStreamRejectCloseAndClosedPromiseIfNeeded(t){if(t._closeRequest!==undefined){t._closeRequest._reject(t._storedError);t._closeRequest=undefined}const r=t._writer;if(r!==undefined){defaultWriterClosedPromiseReject(r,t._storedError)}}function WritableStreamUpdateBackpressure(t,r){const n=t._writer;if(n!==undefined&&r!==t._backpressure){if(r){defaultWriterReadyPromiseReset(n)}else{defaultWriterReadyPromiseResolve(n)}}t._backpressure=r}class WritableStreamDefaultWriter{constructor(t){assertRequiredArgument(t,1,"WritableStreamDefaultWriter");assertWritableStream(t,"First parameter");if(IsWritableStreamLocked(t)){throw new TypeError("This stream has already been locked for exclusive writing by another writer")}this._ownerWritableStream=t;t._writer=this;const r=t._state;if(r==="writable"){if(!WritableStreamCloseQueuedOrInFlight(t)&&t._backpressure){defaultWriterReadyPromiseInitialize(this)}else{defaultWriterReadyPromiseInitializeAsResolved(this)}defaultWriterClosedPromiseInitialize(this)}else if(r==="erroring"){defaultWriterReadyPromiseInitializeAsRejected(this,t._storedError);defaultWriterClosedPromiseInitialize(this)}else if(r==="closed"){defaultWriterReadyPromiseInitializeAsResolved(this);defaultWriterClosedPromiseInitializeAsResolved(this)}else{const r=t._storedError;defaultWriterReadyPromiseInitializeAsRejected(this,r);defaultWriterClosedPromiseInitializeAsRejected(this,r)}}get closed(){if(!IsWritableStreamDefaultWriter(this)){return promiseRejectedWith(defaultWriterBrandCheckException("closed"))}return this._closedPromise}get desiredSize(){if(!IsWritableStreamDefaultWriter(this)){throw defaultWriterBrandCheckException("desiredSize")}if(this._ownerWritableStream===undefined){throw defaultWriterLockException("desiredSize")}return WritableStreamDefaultWriterGetDesiredSize(this)}get ready(){if(!IsWritableStreamDefaultWriter(this)){return promiseRejectedWith(defaultWriterBrandCheckException("ready"))}return this._readyPromise}abort(t=undefined){if(!IsWritableStreamDefaultWriter(this)){return promiseRejectedWith(defaultWriterBrandCheckException("abort"))}if(this._ownerWritableStream===undefined){return promiseRejectedWith(defaultWriterLockException("abort"))}return WritableStreamDefaultWriterAbort(this,t)}close(){if(!IsWritableStreamDefaultWriter(this)){return promiseRejectedWith(defaultWriterBrandCheckException("close"))}const t=this._ownerWritableStream;if(t===undefined){return promiseRejectedWith(defaultWriterLockException("close"))}if(WritableStreamCloseQueuedOrInFlight(t)){return promiseRejectedWith(new TypeError("Cannot close an already-closing stream"))}return WritableStreamDefaultWriterClose(this)}releaseLock(){if(!IsWritableStreamDefaultWriter(this)){throw defaultWriterBrandCheckException("releaseLock")}const t=this._ownerWritableStream;if(t===undefined){return}WritableStreamDefaultWriterRelease(this)}write(t=undefined){if(!IsWritableStreamDefaultWriter(this)){return promiseRejectedWith(defaultWriterBrandCheckException("write"))}if(this._ownerWritableStream===undefined){return promiseRejectedWith(defaultWriterLockException("write to"))}return WritableStreamDefaultWriterWrite(this,t)}}Object.defineProperties(WritableStreamDefaultWriter.prototype,{abort:{enumerable:true},close:{enumerable:true},releaseLock:{enumerable:true},write:{enumerable:true},closed:{enumerable:true},desiredSize:{enumerable:true},ready:{enumerable:true}});if(typeof r.toStringTag==="symbol"){Object.defineProperty(WritableStreamDefaultWriter.prototype,r.toStringTag,{value:"WritableStreamDefaultWriter",configurable:true})}function IsWritableStreamDefaultWriter(t){if(!typeIsObject(t)){return false}if(!Object.prototype.hasOwnProperty.call(t,"_ownerWritableStream")){return false}return t instanceof WritableStreamDefaultWriter}function WritableStreamDefaultWriterAbort(t,r){const n=t._ownerWritableStream;return WritableStreamAbort(n,r)}function WritableStreamDefaultWriterClose(t){const r=t._ownerWritableStream;return WritableStreamClose(r)}function WritableStreamDefaultWriterCloseWithErrorPropagation(t){const r=t._ownerWritableStream;const n=r._state;if(WritableStreamCloseQueuedOrInFlight(r)||n==="closed"){return promiseResolvedWith(undefined)}if(n==="errored"){return promiseRejectedWith(r._storedError)}return WritableStreamDefaultWriterClose(t)}function WritableStreamDefaultWriterEnsureClosedPromiseRejected(t,r){if(t._closedPromiseState==="pending"){defaultWriterClosedPromiseReject(t,r)}else{defaultWriterClosedPromiseResetToRejected(t,r)}}function WritableStreamDefaultWriterEnsureReadyPromiseRejected(t,r){if(t._readyPromiseState==="pending"){defaultWriterReadyPromiseReject(t,r)}else{defaultWriterReadyPromiseResetToRejected(t,r)}}function WritableStreamDefaultWriterGetDesiredSize(t){const r=t._ownerWritableStream;const n=r._state;if(n==="errored"||n==="erroring"){return null}if(n==="closed"){return 0}return WritableStreamDefaultControllerGetDesiredSize(r._writableStreamController)}function WritableStreamDefaultWriterRelease(t){const r=t._ownerWritableStream;const n=new TypeError(`Writer was released and can no longer be used to monitor the stream's closedness`);WritableStreamDefaultWriterEnsureReadyPromiseRejected(t,n);WritableStreamDefaultWriterEnsureClosedPromiseRejected(t,n);r._writer=undefined;t._ownerWritableStream=undefined}function WritableStreamDefaultWriterWrite(t,r){const n=t._ownerWritableStream;const i=n._writableStreamController;const o=WritableStreamDefaultControllerGetChunkSize(i,r);if(n!==t._ownerWritableStream){return promiseRejectedWith(defaultWriterLockException("write to"))}const s=n._state;if(s==="errored"){return promiseRejectedWith(n._storedError)}if(WritableStreamCloseQueuedOrInFlight(n)||s==="closed"){return promiseRejectedWith(new TypeError("The stream is closing or closed and cannot be written to"))}if(s==="erroring"){return promiseRejectedWith(n._storedError)}const l=WritableStreamAddWriteRequest(n);WritableStreamDefaultControllerWrite(i,r,o);return l}const B={};class WritableStreamDefaultController{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!IsWritableStreamDefaultController(this)){throw defaultControllerBrandCheckException$2("abortReason")}return this._abortReason}get signal(){if(!IsWritableStreamDefaultController(this)){throw defaultControllerBrandCheckException$2("signal")}if(this._abortController===undefined){throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported")}return this._abortController.signal}error(t=undefined){if(!IsWritableStreamDefaultController(this)){throw defaultControllerBrandCheckException$2("error")}const r=this._controlledWritableStream._state;if(r!=="writable"){return}WritableStreamDefaultControllerError(this,t)}[g](t){const r=this._abortAlgorithm(t);WritableStreamDefaultControllerClearAlgorithms(this);return r}[m](){ResetQueue(this)}}Object.defineProperties(WritableStreamDefaultController.prototype,{abortReason:{enumerable:true},signal:{enumerable:true},error:{enumerable:true}});if(typeof r.toStringTag==="symbol"){Object.defineProperty(WritableStreamDefaultController.prototype,r.toStringTag,{value:"WritableStreamDefaultController",configurable:true})}function IsWritableStreamDefaultController(t){if(!typeIsObject(t)){return false}if(!Object.prototype.hasOwnProperty.call(t,"_controlledWritableStream")){return false}return t instanceof WritableStreamDefaultController}function SetUpWritableStreamDefaultController(t,r,n,i,o,s,l,u){r._controlledWritableStream=t;t._writableStreamController=r;r._queue=undefined;r._queueTotalSize=undefined;ResetQueue(r);r._abortReason=undefined;r._abortController=createAbortController();r._started=false;r._strategySizeAlgorithm=u;r._strategyHWM=l;r._writeAlgorithm=i;r._closeAlgorithm=o;r._abortAlgorithm=s;const h=WritableStreamDefaultControllerGetBackpressure(r);WritableStreamUpdateBackpressure(t,h);const p=n();const g=promiseResolvedWith(p);uponPromise(g,(()=>{r._started=true;WritableStreamDefaultControllerAdvanceQueueIfNeeded(r)}),(n=>{r._started=true;WritableStreamDealWithRejection(t,n)}))}function SetUpWritableStreamDefaultControllerFromUnderlyingSink(t,r,n,i){const o=Object.create(WritableStreamDefaultController.prototype);let startAlgorithm=()=>undefined;let writeAlgorithm=()=>promiseResolvedWith(undefined);let closeAlgorithm=()=>promiseResolvedWith(undefined);let abortAlgorithm=()=>promiseResolvedWith(undefined);if(r.start!==undefined){startAlgorithm=()=>r.start(o)}if(r.write!==undefined){writeAlgorithm=t=>r.write(t,o)}if(r.close!==undefined){closeAlgorithm=()=>r.close()}if(r.abort!==undefined){abortAlgorithm=t=>r.abort(t)}SetUpWritableStreamDefaultController(t,o,startAlgorithm,writeAlgorithm,closeAlgorithm,abortAlgorithm,n,i)}function WritableStreamDefaultControllerClearAlgorithms(t){t._writeAlgorithm=undefined;t._closeAlgorithm=undefined;t._abortAlgorithm=undefined;t._strategySizeAlgorithm=undefined}function WritableStreamDefaultControllerClose(t){EnqueueValueWithSize(t,B,0);WritableStreamDefaultControllerAdvanceQueueIfNeeded(t)}function WritableStreamDefaultControllerGetChunkSize(t,r){try{return t._strategySizeAlgorithm(r)}catch(r){WritableStreamDefaultControllerErrorIfNeeded(t,r);return 1}}function WritableStreamDefaultControllerGetDesiredSize(t){return t._strategyHWM-t._queueTotalSize}function WritableStreamDefaultControllerWrite(t,r,n){try{EnqueueValueWithSize(t,r,n)}catch(r){WritableStreamDefaultControllerErrorIfNeeded(t,r);return}const i=t._controlledWritableStream;if(!WritableStreamCloseQueuedOrInFlight(i)&&i._state==="writable"){const r=WritableStreamDefaultControllerGetBackpressure(t);WritableStreamUpdateBackpressure(i,r)}WritableStreamDefaultControllerAdvanceQueueIfNeeded(t)}function WritableStreamDefaultControllerAdvanceQueueIfNeeded(t){const r=t._controlledWritableStream;if(!t._started){return}if(r._inFlightWriteRequest!==undefined){return}const n=r._state;if(n==="erroring"){WritableStreamFinishErroring(r);return}if(t._queue.length===0){return}const i=PeekQueueValue(t);if(i===B){WritableStreamDefaultControllerProcessClose(t)}else{WritableStreamDefaultControllerProcessWrite(t,i)}}function WritableStreamDefaultControllerErrorIfNeeded(t,r){if(t._controlledWritableStream._state==="writable"){WritableStreamDefaultControllerError(t,r)}}function WritableStreamDefaultControllerProcessClose(t){const r=t._controlledWritableStream;WritableStreamMarkCloseRequestInFlight(r);DequeueValue(t);const n=t._closeAlgorithm();WritableStreamDefaultControllerClearAlgorithms(t);uponPromise(n,(()=>{WritableStreamFinishInFlightClose(r)}),(t=>{WritableStreamFinishInFlightCloseWithError(r,t)}))}function WritableStreamDefaultControllerProcessWrite(t,r){const n=t._controlledWritableStream;WritableStreamMarkFirstWriteRequestInFlight(n);const i=t._writeAlgorithm(r);uponPromise(i,(()=>{WritableStreamFinishInFlightWrite(n);const r=n._state;DequeueValue(t);if(!WritableStreamCloseQueuedOrInFlight(n)&&r==="writable"){const r=WritableStreamDefaultControllerGetBackpressure(t);WritableStreamUpdateBackpressure(n,r)}WritableStreamDefaultControllerAdvanceQueueIfNeeded(t)}),(r=>{if(n._state==="writable"){WritableStreamDefaultControllerClearAlgorithms(t)}WritableStreamFinishInFlightWriteWithError(n,r)}))}function WritableStreamDefaultControllerGetBackpressure(t){const r=WritableStreamDefaultControllerGetDesiredSize(t);return r<=0}function WritableStreamDefaultControllerError(t,r){const n=t._controlledWritableStream;WritableStreamDefaultControllerClearAlgorithms(t);WritableStreamStartErroring(n,r)}function streamBrandCheckException$2(t){return new TypeError(`WritableStream.prototype.${t} can only be used on a WritableStream`)}function defaultControllerBrandCheckException$2(t){return new TypeError(`WritableStreamDefaultController.prototype.${t} can only be used on a WritableStreamDefaultController`)}function defaultWriterBrandCheckException(t){return new TypeError(`WritableStreamDefaultWriter.prototype.${t} can only be used on a WritableStreamDefaultWriter`)}function defaultWriterLockException(t){return new TypeError("Cannot "+t+" a stream using a released writer")}function defaultWriterClosedPromiseInitialize(t){t._closedPromise=newPromise(((r,n)=>{t._closedPromise_resolve=r;t._closedPromise_reject=n;t._closedPromiseState="pending"}))}function defaultWriterClosedPromiseInitializeAsRejected(t,r){defaultWriterClosedPromiseInitialize(t);defaultWriterClosedPromiseReject(t,r)}function defaultWriterClosedPromiseInitializeAsResolved(t){defaultWriterClosedPromiseInitialize(t);defaultWriterClosedPromiseResolve(t)}function defaultWriterClosedPromiseReject(t,r){if(t._closedPromise_reject===undefined){return}setPromiseIsHandledToTrue(t._closedPromise);t._closedPromise_reject(r);t._closedPromise_resolve=undefined;t._closedPromise_reject=undefined;t._closedPromiseState="rejected"}function defaultWriterClosedPromiseResetToRejected(t,r){defaultWriterClosedPromiseInitializeAsRejected(t,r)}function defaultWriterClosedPromiseResolve(t){if(t._closedPromise_resolve===undefined){return}t._closedPromise_resolve(undefined);t._closedPromise_resolve=undefined;t._closedPromise_reject=undefined;t._closedPromiseState="resolved"}function defaultWriterReadyPromiseInitialize(t){t._readyPromise=newPromise(((r,n)=>{t._readyPromise_resolve=r;t._readyPromise_reject=n}));t._readyPromiseState="pending"}function defaultWriterReadyPromiseInitializeAsRejected(t,r){defaultWriterReadyPromiseInitialize(t);defaultWriterReadyPromiseReject(t,r)}function defaultWriterReadyPromiseInitializeAsResolved(t){defaultWriterReadyPromiseInitialize(t);defaultWriterReadyPromiseResolve(t)}function defaultWriterReadyPromiseReject(t,r){if(t._readyPromise_reject===undefined){return}setPromiseIsHandledToTrue(t._readyPromise);t._readyPromise_reject(r);t._readyPromise_resolve=undefined;t._readyPromise_reject=undefined;t._readyPromiseState="rejected"}function defaultWriterReadyPromiseReset(t){defaultWriterReadyPromiseInitialize(t)}function defaultWriterReadyPromiseResetToRejected(t,r){defaultWriterReadyPromiseInitializeAsRejected(t,r)}function defaultWriterReadyPromiseResolve(t){if(t._readyPromise_resolve===undefined){return}t._readyPromise_resolve(undefined);t._readyPromise_resolve=undefined;t._readyPromise_reject=undefined;t._readyPromiseState="fulfilled"}const k=typeof DOMException!=="undefined"?DOMException:undefined;function isDOMExceptionConstructor(t){if(!(typeof t==="function"||typeof t==="object")){return false}try{new t;return true}catch(t){return false}}function createDOMExceptionPolyfill(){const t=function DOMException(t,r){this.message=t||"";this.name=r||"Error";if(Error.captureStackTrace){Error.captureStackTrace(this,this.constructor)}};t.prototype=Object.create(Error.prototype);Object.defineProperty(t.prototype,"constructor",{value:t,writable:true,configurable:true});return t}const v=isDOMExceptionConstructor(k)?k:createDOMExceptionPolyfill();function ReadableStreamPipeTo(t,r,n,i,o,s){const l=AcquireReadableStreamDefaultReader(t);const u=AcquireWritableStreamDefaultWriter(r);t._disturbed=true;let h=false;let p=promiseResolvedWith(undefined);return newPromise(((g,m)=>{let _;if(s!==undefined){_=()=>{const n=new v("Aborted","AbortError");const s=[];if(!i){s.push((()=>{if(r._state==="writable"){return WritableStreamAbort(r,n)}return promiseResolvedWith(undefined)}))}if(!o){s.push((()=>{if(t._state==="readable"){return ReadableStreamCancel(t,n)}return promiseResolvedWith(undefined)}))}shutdownWithAction((()=>Promise.all(s.map((t=>t())))),true,n)};if(s.aborted){_();return}s.addEventListener("abort",_)}function pipeLoop(){return newPromise(((t,r)=>{function next(n){if(n){t()}else{PerformPromiseThen(pipeStep(),next,r)}}next(false)}))}function pipeStep(){if(h){return promiseResolvedWith(true)}return PerformPromiseThen(u._readyPromise,(()=>newPromise(((t,r)=>{ReadableStreamDefaultReaderRead(l,{_chunkSteps:r=>{p=PerformPromiseThen(WritableStreamDefaultWriterWrite(u,r),undefined,noop);t(false)},_closeSteps:()=>t(true),_errorSteps:r})}))))}isOrBecomesErrored(t,l._closedPromise,(t=>{if(!i){shutdownWithAction((()=>WritableStreamAbort(r,t)),true,t)}else{shutdown(true,t)}}));isOrBecomesErrored(r,u._closedPromise,(r=>{if(!o){shutdownWithAction((()=>ReadableStreamCancel(t,r)),true,r)}else{shutdown(true,r)}}));isOrBecomesClosed(t,l._closedPromise,(()=>{if(!n){shutdownWithAction((()=>WritableStreamDefaultWriterCloseWithErrorPropagation(u)))}else{shutdown()}}));if(WritableStreamCloseQueuedOrInFlight(r)||r._state==="closed"){const r=new TypeError("the destination writable stream closed before all data could be piped to it");if(!o){shutdownWithAction((()=>ReadableStreamCancel(t,r)),true,r)}else{shutdown(true,r)}}setPromiseIsHandledToTrue(pipeLoop());function waitForWritesToFinish(){const t=p;return PerformPromiseThen(p,(()=>t!==p?waitForWritesToFinish():undefined))}function isOrBecomesErrored(t,r,n){if(t._state==="errored"){n(t._storedError)}else{uponRejection(r,n)}}function isOrBecomesClosed(t,r,n){if(t._state==="closed"){n()}else{uponFulfillment(r,n)}}function shutdownWithAction(t,n,i){if(h){return}h=true;if(r._state==="writable"&&!WritableStreamCloseQueuedOrInFlight(r)){uponFulfillment(waitForWritesToFinish(),doTheRest)}else{doTheRest()}function doTheRest(){uponPromise(t(),(()=>finalize(n,i)),(t=>finalize(true,t)))}}function shutdown(t,n){if(h){return}h=true;if(r._state==="writable"&&!WritableStreamCloseQueuedOrInFlight(r)){uponFulfillment(waitForWritesToFinish(),(()=>finalize(t,n)))}else{finalize(t,n)}}function finalize(t,r){WritableStreamDefaultWriterRelease(u);ReadableStreamReaderGenericRelease(l);if(s!==undefined){s.removeEventListener("abort",_)}if(t){m(r)}else{g(undefined)}}}))}class ReadableStreamDefaultController{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!IsReadableStreamDefaultController(this)){throw defaultControllerBrandCheckException$1("desiredSize")}return ReadableStreamDefaultControllerGetDesiredSize(this)}close(){if(!IsReadableStreamDefaultController(this)){throw defaultControllerBrandCheckException$1("close")}if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(this)){throw new TypeError("The stream is not in a state that permits close")}ReadableStreamDefaultControllerClose(this)}enqueue(t=undefined){if(!IsReadableStreamDefaultController(this)){throw defaultControllerBrandCheckException$1("enqueue")}if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(this)){throw new TypeError("The stream is not in a state that permits enqueue")}return ReadableStreamDefaultControllerEnqueue(this,t)}error(t=undefined){if(!IsReadableStreamDefaultController(this)){throw defaultControllerBrandCheckException$1("error")}ReadableStreamDefaultControllerError(this,t)}[_](t){ResetQueue(this);const r=this._cancelAlgorithm(t);ReadableStreamDefaultControllerClearAlgorithms(this);return r}[E](t){const r=this._controlledReadableStream;if(this._queue.length>0){const n=DequeueValue(this);if(this._closeRequested&&this._queue.length===0){ReadableStreamDefaultControllerClearAlgorithms(this);ReadableStreamClose(r)}else{ReadableStreamDefaultControllerCallPullIfNeeded(this)}t._chunkSteps(n)}else{ReadableStreamAddReadRequest(r,t);ReadableStreamDefaultControllerCallPullIfNeeded(this)}}}Object.defineProperties(ReadableStreamDefaultController.prototype,{close:{enumerable:true},enqueue:{enumerable:true},error:{enumerable:true},desiredSize:{enumerable:true}});if(typeof r.toStringTag==="symbol"){Object.defineProperty(ReadableStreamDefaultController.prototype,r.toStringTag,{value:"ReadableStreamDefaultController",configurable:true})}function IsReadableStreamDefaultController(t){if(!typeIsObject(t)){return false}if(!Object.prototype.hasOwnProperty.call(t,"_controlledReadableStream")){return false}return t instanceof ReadableStreamDefaultController}function ReadableStreamDefaultControllerCallPullIfNeeded(t){const r=ReadableStreamDefaultControllerShouldCallPull(t);if(!r){return}if(t._pulling){t._pullAgain=true;return}t._pulling=true;const n=t._pullAlgorithm();uponPromise(n,(()=>{t._pulling=false;if(t._pullAgain){t._pullAgain=false;ReadableStreamDefaultControllerCallPullIfNeeded(t)}}),(r=>{ReadableStreamDefaultControllerError(t,r)}))}function ReadableStreamDefaultControllerShouldCallPull(t){const r=t._controlledReadableStream;if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(t)){return false}if(!t._started){return false}if(IsReadableStreamLocked(r)&&ReadableStreamGetNumReadRequests(r)>0){return true}const n=ReadableStreamDefaultControllerGetDesiredSize(t);if(n>0){return true}return false}function ReadableStreamDefaultControllerClearAlgorithms(t){t._pullAlgorithm=undefined;t._cancelAlgorithm=undefined;t._strategySizeAlgorithm=undefined}function ReadableStreamDefaultControllerClose(t){if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(t)){return}const r=t._controlledReadableStream;t._closeRequested=true;if(t._queue.length===0){ReadableStreamDefaultControllerClearAlgorithms(t);ReadableStreamClose(r)}}function ReadableStreamDefaultControllerEnqueue(t,r){if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(t)){return}const n=t._controlledReadableStream;if(IsReadableStreamLocked(n)&&ReadableStreamGetNumReadRequests(n)>0){ReadableStreamFulfillReadRequest(n,r,false)}else{let n;try{n=t._strategySizeAlgorithm(r)}catch(r){ReadableStreamDefaultControllerError(t,r);throw r}try{EnqueueValueWithSize(t,r,n)}catch(r){ReadableStreamDefaultControllerError(t,r);throw r}}ReadableStreamDefaultControllerCallPullIfNeeded(t)}function ReadableStreamDefaultControllerError(t,r){const n=t._controlledReadableStream;if(n._state!=="readable"){return}ResetQueue(t);ReadableStreamDefaultControllerClearAlgorithms(t);ReadableStreamError(n,r)}function ReadableStreamDefaultControllerGetDesiredSize(t){const r=t._controlledReadableStream._state;if(r==="errored"){return null}if(r==="closed"){return 0}return t._strategyHWM-t._queueTotalSize}function ReadableStreamDefaultControllerHasBackpressure(t){if(ReadableStreamDefaultControllerShouldCallPull(t)){return false}return true}function ReadableStreamDefaultControllerCanCloseOrEnqueue(t){const r=t._controlledReadableStream._state;if(!t._closeRequested&&r==="readable"){return true}return false}function SetUpReadableStreamDefaultController(t,r,n,i,o,s,l){r._controlledReadableStream=t;r._queue=undefined;r._queueTotalSize=undefined;ResetQueue(r);r._started=false;r._closeRequested=false;r._pullAgain=false;r._pulling=false;r._strategySizeAlgorithm=l;r._strategyHWM=s;r._pullAlgorithm=i;r._cancelAlgorithm=o;t._readableStreamController=r;const u=n();uponPromise(promiseResolvedWith(u),(()=>{r._started=true;ReadableStreamDefaultControllerCallPullIfNeeded(r)}),(t=>{ReadableStreamDefaultControllerError(r,t)}))}function SetUpReadableStreamDefaultControllerFromUnderlyingSource(t,r,n,i){const o=Object.create(ReadableStreamDefaultController.prototype);let startAlgorithm=()=>undefined;let pullAlgorithm=()=>promiseResolvedWith(undefined);let cancelAlgorithm=()=>promiseResolvedWith(undefined);if(r.start!==undefined){startAlgorithm=()=>r.start(o)}if(r.pull!==undefined){pullAlgorithm=()=>r.pull(o)}if(r.cancel!==undefined){cancelAlgorithm=t=>r.cancel(t)}SetUpReadableStreamDefaultController(t,o,startAlgorithm,pullAlgorithm,cancelAlgorithm,n,i)}function defaultControllerBrandCheckException$1(t){return new TypeError(`ReadableStreamDefaultController.prototype.${t} can only be used on a ReadableStreamDefaultController`)}function ReadableStreamTee(t,r){if(IsReadableByteStreamController(t._readableStreamController)){return ReadableByteStreamTee(t)}return ReadableStreamDefaultTee(t)}function ReadableStreamDefaultTee(t,r){const n=AcquireReadableStreamDefaultReader(t);let i=false;let o=false;let s=false;let l=false;let u;let p;let g;let m;let _;const E=newPromise((t=>{_=t}));function pullAlgorithm(){if(i){o=true;return promiseResolvedWith(undefined)}i=true;const t={_chunkSteps:t=>{h((()=>{o=false;const r=t;const n=t;if(!s){ReadableStreamDefaultControllerEnqueue(g._readableStreamController,r)}if(!l){ReadableStreamDefaultControllerEnqueue(m._readableStreamController,n)}i=false;if(o){pullAlgorithm()}}))},_closeSteps:()=>{i=false;if(!s){ReadableStreamDefaultControllerClose(g._readableStreamController)}if(!l){ReadableStreamDefaultControllerClose(m._readableStreamController)}if(!s||!l){_(undefined)}},_errorSteps:()=>{i=false}};ReadableStreamDefaultReaderRead(n,t);return promiseResolvedWith(undefined)}function cancel1Algorithm(r){s=true;u=r;if(l){const r=CreateArrayFromList([u,p]);const n=ReadableStreamCancel(t,r);_(n)}return E}function cancel2Algorithm(r){l=true;p=r;if(s){const r=CreateArrayFromList([u,p]);const n=ReadableStreamCancel(t,r);_(n)}return E}function startAlgorithm(){}g=CreateReadableStream(startAlgorithm,pullAlgorithm,cancel1Algorithm);m=CreateReadableStream(startAlgorithm,pullAlgorithm,cancel2Algorithm);uponRejection(n._closedPromise,(t=>{ReadableStreamDefaultControllerError(g._readableStreamController,t);ReadableStreamDefaultControllerError(m._readableStreamController,t);if(!s||!l){_(undefined)}}));return[g,m]}function ReadableByteStreamTee(t){let r=AcquireReadableStreamDefaultReader(t);let n=false;let i=false;let o=false;let s=false;let l=false;let u;let p;let g;let m;let _;const E=newPromise((t=>{_=t}));function forwardReaderError(t){uponRejection(t._closedPromise,(n=>{if(t!==r){return}ReadableByteStreamControllerError(g._readableStreamController,n);ReadableByteStreamControllerError(m._readableStreamController,n);if(!s||!l){_(undefined)}}))}function pullWithDefaultReader(){if(IsReadableStreamBYOBReader(r)){ReadableStreamReaderGenericRelease(r);r=AcquireReadableStreamDefaultReader(t);forwardReaderError(r)}const u={_chunkSteps:r=>{h((()=>{i=false;o=false;const u=r;let h=r;if(!s&&!l){try{h=CloneAsUint8Array(r)}catch(r){ReadableByteStreamControllerError(g._readableStreamController,r);ReadableByteStreamControllerError(m._readableStreamController,r);_(ReadableStreamCancel(t,r));return}}if(!s){ReadableByteStreamControllerEnqueue(g._readableStreamController,u)}if(!l){ReadableByteStreamControllerEnqueue(m._readableStreamController,h)}n=false;if(i){pull1Algorithm()}else if(o){pull2Algorithm()}}))},_closeSteps:()=>{n=false;if(!s){ReadableByteStreamControllerClose(g._readableStreamController)}if(!l){ReadableByteStreamControllerClose(m._readableStreamController)}if(g._readableStreamController._pendingPullIntos.length>0){ReadableByteStreamControllerRespond(g._readableStreamController,0)}if(m._readableStreamController._pendingPullIntos.length>0){ReadableByteStreamControllerRespond(m._readableStreamController,0)}if(!s||!l){_(undefined)}},_errorSteps:()=>{n=false}};ReadableStreamDefaultReaderRead(r,u)}function pullWithBYOBReader(u,p){if(IsReadableStreamDefaultReader(r)){ReadableStreamReaderGenericRelease(r);r=AcquireReadableStreamBYOBReader(t);forwardReaderError(r)}const E=p?m:g;const b=p?g:m;const y={_chunkSteps:r=>{h((()=>{i=false;o=false;const u=p?l:s;const h=p?s:l;if(!h){let n;try{n=CloneAsUint8Array(r)}catch(r){ReadableByteStreamControllerError(E._readableStreamController,r);ReadableByteStreamControllerError(b._readableStreamController,r);_(ReadableStreamCancel(t,r));return}if(!u){ReadableByteStreamControllerRespondWithNewView(E._readableStreamController,r)}ReadableByteStreamControllerEnqueue(b._readableStreamController,n)}else if(!u){ReadableByteStreamControllerRespondWithNewView(E._readableStreamController,r)}n=false;if(i){pull1Algorithm()}else if(o){pull2Algorithm()}}))},_closeSteps:t=>{n=false;const r=p?l:s;const i=p?s:l;if(!r){ReadableByteStreamControllerClose(E._readableStreamController)}if(!i){ReadableByteStreamControllerClose(b._readableStreamController)}if(t!==undefined){if(!r){ReadableByteStreamControllerRespondWithNewView(E._readableStreamController,t)}if(!i&&b._readableStreamController._pendingPullIntos.length>0){ReadableByteStreamControllerRespond(b._readableStreamController,0)}}if(!r||!i){_(undefined)}},_errorSteps:()=>{n=false}};ReadableStreamBYOBReaderRead(r,u,y)}function pull1Algorithm(){if(n){i=true;return promiseResolvedWith(undefined)}n=true;const t=ReadableByteStreamControllerGetBYOBRequest(g._readableStreamController);if(t===null){pullWithDefaultReader()}else{pullWithBYOBReader(t._view,false)}return promiseResolvedWith(undefined)}function pull2Algorithm(){if(n){o=true;return promiseResolvedWith(undefined)}n=true;const t=ReadableByteStreamControllerGetBYOBRequest(m._readableStreamController);if(t===null){pullWithDefaultReader()}else{pullWithBYOBReader(t._view,true)}return promiseResolvedWith(undefined)}function cancel1Algorithm(r){s=true;u=r;if(l){const r=CreateArrayFromList([u,p]);const n=ReadableStreamCancel(t,r);_(n)}return E}function cancel2Algorithm(r){l=true;p=r;if(s){const r=CreateArrayFromList([u,p]);const n=ReadableStreamCancel(t,r);_(n)}return E}function startAlgorithm(){return}g=CreateReadableByteStream(startAlgorithm,pull1Algorithm,cancel1Algorithm);m=CreateReadableByteStream(startAlgorithm,pull2Algorithm,cancel2Algorithm);forwardReaderError(r);return[g,m]}function convertUnderlyingDefaultOrByteSource(t,r){assertDictionary(t,r);const n=t;const i=n===null||n===void 0?void 0:n.autoAllocateChunkSize;const o=n===null||n===void 0?void 0:n.cancel;const s=n===null||n===void 0?void 0:n.pull;const l=n===null||n===void 0?void 0:n.start;const u=n===null||n===void 0?void 0:n.type;return{autoAllocateChunkSize:i===undefined?undefined:convertUnsignedLongLongWithEnforceRange(i,`${r} has member 'autoAllocateChunkSize' that`),cancel:o===undefined?undefined:convertUnderlyingSourceCancelCallback(o,n,`${r} has member 'cancel' that`),pull:s===undefined?undefined:convertUnderlyingSourcePullCallback(s,n,`${r} has member 'pull' that`),start:l===undefined?undefined:convertUnderlyingSourceStartCallback(l,n,`${r} has member 'start' that`),type:u===undefined?undefined:convertReadableStreamType(u,`${r} has member 'type' that`)}}function convertUnderlyingSourceCancelCallback(t,r,n){assertFunction(t,n);return n=>promiseCall(t,r,[n])}function convertUnderlyingSourcePullCallback(t,r,n){assertFunction(t,n);return n=>promiseCall(t,r,[n])}function convertUnderlyingSourceStartCallback(t,r,n){assertFunction(t,n);return n=>reflectCall(t,r,[n])}function convertReadableStreamType(t,r){t=`${t}`;if(t!=="bytes"){throw new TypeError(`${r} '${t}' is not a valid enumeration value for ReadableStreamType`)}return t}function convertReaderOptions(t,r){assertDictionary(t,r);const n=t===null||t===void 0?void 0:t.mode;return{mode:n===undefined?undefined:convertReadableStreamReaderMode(n,`${r} has member 'mode' that`)}}function convertReadableStreamReaderMode(t,r){t=`${t}`;if(t!=="byob"){throw new TypeError(`${r} '${t}' is not a valid enumeration value for ReadableStreamReaderMode`)}return t}function convertIteratorOptions(t,r){assertDictionary(t,r);const n=t===null||t===void 0?void 0:t.preventCancel;return{preventCancel:Boolean(n)}}function convertPipeOptions(t,r){assertDictionary(t,r);const n=t===null||t===void 0?void 0:t.preventAbort;const i=t===null||t===void 0?void 0:t.preventCancel;const o=t===null||t===void 0?void 0:t.preventClose;const s=t===null||t===void 0?void 0:t.signal;if(s!==undefined){assertAbortSignal(s,`${r} has member 'signal' that`)}return{preventAbort:Boolean(n),preventCancel:Boolean(i),preventClose:Boolean(o),signal:s}}function assertAbortSignal(t,r){if(!isAbortSignal(t)){throw new TypeError(`${r} is not an AbortSignal.`)}}function convertReadableWritablePair(t,r){assertDictionary(t,r);const n=t===null||t===void 0?void 0:t.readable;assertRequiredField(n,"readable","ReadableWritablePair");assertReadableStream(n,`${r} has member 'readable' that`);const i=t===null||t===void 0?void 0:t.writable;assertRequiredField(i,"writable","ReadableWritablePair");assertWritableStream(i,`${r} has member 'writable' that`);return{readable:n,writable:i}}class ReadableStream{constructor(t={},r={}){if(t===undefined){t=null}else{assertObject(t,"First parameter")}const n=convertQueuingStrategy(r,"Second parameter");const i=convertUnderlyingDefaultOrByteSource(t,"First parameter");InitializeReadableStream(this);if(i.type==="bytes"){if(n.size!==undefined){throw new RangeError("The strategy for a byte stream cannot have a size function")}const t=ExtractHighWaterMark(n,0);SetUpReadableByteStreamControllerFromUnderlyingSource(this,i,t)}else{const t=ExtractSizeAlgorithm(n);const r=ExtractHighWaterMark(n,1);SetUpReadableStreamDefaultControllerFromUnderlyingSource(this,i,r,t)}}get locked(){if(!IsReadableStream(this)){throw streamBrandCheckException$1("locked")}return IsReadableStreamLocked(this)}cancel(t=undefined){if(!IsReadableStream(this)){return promiseRejectedWith(streamBrandCheckException$1("cancel"))}if(IsReadableStreamLocked(this)){return promiseRejectedWith(new TypeError("Cannot cancel a stream that already has a reader"))}return ReadableStreamCancel(this,t)}getReader(t=undefined){if(!IsReadableStream(this)){throw streamBrandCheckException$1("getReader")}const r=convertReaderOptions(t,"First parameter");if(r.mode===undefined){return AcquireReadableStreamDefaultReader(this)}return AcquireReadableStreamBYOBReader(this)}pipeThrough(t,r={}){if(!IsReadableStream(this)){throw streamBrandCheckException$1("pipeThrough")}assertRequiredArgument(t,1,"pipeThrough");const n=convertReadableWritablePair(t,"First parameter");const i=convertPipeOptions(r,"Second parameter");if(IsReadableStreamLocked(this)){throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream")}if(IsWritableStreamLocked(n.writable)){throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream")}const o=ReadableStreamPipeTo(this,n.writable,i.preventClose,i.preventAbort,i.preventCancel,i.signal);setPromiseIsHandledToTrue(o);return n.readable}pipeTo(t,r={}){if(!IsReadableStream(this)){return promiseRejectedWith(streamBrandCheckException$1("pipeTo"))}if(t===undefined){return promiseRejectedWith(`Parameter 1 is required in 'pipeTo'.`)}if(!IsWritableStream(t)){return promiseRejectedWith(new TypeError(`ReadableStream.prototype.pipeTo's first argument must be a WritableStream`))}let n;try{n=convertPipeOptions(r,"Second parameter")}catch(t){return promiseRejectedWith(t)}if(IsReadableStreamLocked(this)){return promiseRejectedWith(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream"))}if(IsWritableStreamLocked(t)){return promiseRejectedWith(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream"))}return ReadableStreamPipeTo(this,t,n.preventClose,n.preventAbort,n.preventCancel,n.signal)}tee(){if(!IsReadableStream(this)){throw streamBrandCheckException$1("tee")}const t=ReadableStreamTee(this);return CreateArrayFromList(t)}values(t=undefined){if(!IsReadableStream(this)){throw streamBrandCheckException$1("values")}const r=convertIteratorOptions(t,"First parameter");return AcquireReadableStreamAsyncIterator(this,r.preventCancel)}}Object.defineProperties(ReadableStream.prototype,{cancel:{enumerable:true},getReader:{enumerable:true},pipeThrough:{enumerable:true},pipeTo:{enumerable:true},tee:{enumerable:true},values:{enumerable:true},locked:{enumerable:true}});if(typeof r.toStringTag==="symbol"){Object.defineProperty(ReadableStream.prototype,r.toStringTag,{value:"ReadableStream",configurable:true})}if(typeof r.asyncIterator==="symbol"){Object.defineProperty(ReadableStream.prototype,r.asyncIterator,{value:ReadableStream.prototype.values,writable:true,configurable:true})}function CreateReadableStream(t,r,n,i=1,o=(()=>1)){const s=Object.create(ReadableStream.prototype);InitializeReadableStream(s);const l=Object.create(ReadableStreamDefaultController.prototype);SetUpReadableStreamDefaultController(s,l,t,r,n,i,o);return s}function CreateReadableByteStream(t,r,n){const i=Object.create(ReadableStream.prototype);InitializeReadableStream(i);const o=Object.create(ReadableByteStreamController.prototype);SetUpReadableByteStreamController(i,o,t,r,n,0,undefined);return i}function InitializeReadableStream(t){t._state="readable";t._reader=undefined;t._storedError=undefined;t._disturbed=false}function IsReadableStream(t){if(!typeIsObject(t)){return false}if(!Object.prototype.hasOwnProperty.call(t,"_readableStreamController")){return false}return t instanceof ReadableStream}function IsReadableStreamLocked(t){if(t._reader===undefined){return false}return true}function ReadableStreamCancel(t,r){t._disturbed=true;if(t._state==="closed"){return promiseResolvedWith(undefined)}if(t._state==="errored"){return promiseRejectedWith(t._storedError)}ReadableStreamClose(t);const n=t._reader;if(n!==undefined&&IsReadableStreamBYOBReader(n)){n._readIntoRequests.forEach((t=>{t._closeSteps(undefined)}));n._readIntoRequests=new SimpleQueue}const i=t._readableStreamController[_](r);return transformPromiseWith(i,noop)}function ReadableStreamClose(t){t._state="closed";const r=t._reader;if(r===undefined){return}defaultReaderClosedPromiseResolve(r);if(IsReadableStreamDefaultReader(r)){r._readRequests.forEach((t=>{t._closeSteps()}));r._readRequests=new SimpleQueue}}function ReadableStreamError(t,r){t._state="errored";t._storedError=r;const n=t._reader;if(n===undefined){return}defaultReaderClosedPromiseReject(n,r);if(IsReadableStreamDefaultReader(n)){n._readRequests.forEach((t=>{t._errorSteps(r)}));n._readRequests=new SimpleQueue}else{n._readIntoRequests.forEach((t=>{t._errorSteps(r)}));n._readIntoRequests=new SimpleQueue}}function streamBrandCheckException$1(t){return new TypeError(`ReadableStream.prototype.${t} can only be used on a ReadableStream`)}function convertQueuingStrategyInit(t,r){assertDictionary(t,r);const n=t===null||t===void 0?void 0:t.highWaterMark;assertRequiredField(n,"highWaterMark","QueuingStrategyInit");return{highWaterMark:convertUnrestrictedDouble(n)}}const byteLengthSizeFunction=t=>t.byteLength;Object.defineProperty(byteLengthSizeFunction,"name",{value:"size",configurable:true});class ByteLengthQueuingStrategy{constructor(t){assertRequiredArgument(t,1,"ByteLengthQueuingStrategy");t=convertQueuingStrategyInit(t,"First parameter");this._byteLengthQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!IsByteLengthQueuingStrategy(this)){throw byteLengthBrandCheckException("highWaterMark")}return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!IsByteLengthQueuingStrategy(this)){throw byteLengthBrandCheckException("size")}return byteLengthSizeFunction}}Object.defineProperties(ByteLengthQueuingStrategy.prototype,{highWaterMark:{enumerable:true},size:{enumerable:true}});if(typeof r.toStringTag==="symbol"){Object.defineProperty(ByteLengthQueuingStrategy.prototype,r.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:true})}function byteLengthBrandCheckException(t){return new TypeError(`ByteLengthQueuingStrategy.prototype.${t} can only be used on a ByteLengthQueuingStrategy`)}function IsByteLengthQueuingStrategy(t){if(!typeIsObject(t)){return false}if(!Object.prototype.hasOwnProperty.call(t,"_byteLengthQueuingStrategyHighWaterMark")){return false}return t instanceof ByteLengthQueuingStrategy}const countSizeFunction=()=>1;Object.defineProperty(countSizeFunction,"name",{value:"size",configurable:true});class CountQueuingStrategy{constructor(t){assertRequiredArgument(t,1,"CountQueuingStrategy");t=convertQueuingStrategyInit(t,"First parameter");this._countQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!IsCountQueuingStrategy(this)){throw countBrandCheckException("highWaterMark")}return this._countQueuingStrategyHighWaterMark}get size(){if(!IsCountQueuingStrategy(this)){throw countBrandCheckException("size")}return countSizeFunction}}Object.defineProperties(CountQueuingStrategy.prototype,{highWaterMark:{enumerable:true},size:{enumerable:true}});if(typeof r.toStringTag==="symbol"){Object.defineProperty(CountQueuingStrategy.prototype,r.toStringTag,{value:"CountQueuingStrategy",configurable:true})}function countBrandCheckException(t){return new TypeError(`CountQueuingStrategy.prototype.${t} can only be used on a CountQueuingStrategy`)}function IsCountQueuingStrategy(t){if(!typeIsObject(t)){return false}if(!Object.prototype.hasOwnProperty.call(t,"_countQueuingStrategyHighWaterMark")){return false}return t instanceof CountQueuingStrategy}function convertTransformer(t,r){assertDictionary(t,r);const n=t===null||t===void 0?void 0:t.flush;const i=t===null||t===void 0?void 0:t.readableType;const o=t===null||t===void 0?void 0:t.start;const s=t===null||t===void 0?void 0:t.transform;const l=t===null||t===void 0?void 0:t.writableType;return{flush:n===undefined?undefined:convertTransformerFlushCallback(n,t,`${r} has member 'flush' that`),readableType:i,start:o===undefined?undefined:convertTransformerStartCallback(o,t,`${r} has member 'start' that`),transform:s===undefined?undefined:convertTransformerTransformCallback(s,t,`${r} has member 'transform' that`),writableType:l}}function convertTransformerFlushCallback(t,r,n){assertFunction(t,n);return n=>promiseCall(t,r,[n])}function convertTransformerStartCallback(t,r,n){assertFunction(t,n);return n=>reflectCall(t,r,[n])}function convertTransformerTransformCallback(t,r,n){assertFunction(t,n);return(n,i)=>promiseCall(t,r,[n,i])}class TransformStream{constructor(t={},r={},n={}){if(t===undefined){t=null}const i=convertQueuingStrategy(r,"Second parameter");const o=convertQueuingStrategy(n,"Third parameter");const s=convertTransformer(t,"First parameter");if(s.readableType!==undefined){throw new RangeError("Invalid readableType specified")}if(s.writableType!==undefined){throw new RangeError("Invalid writableType specified")}const l=ExtractHighWaterMark(o,0);const u=ExtractSizeAlgorithm(o);const h=ExtractHighWaterMark(i,1);const p=ExtractSizeAlgorithm(i);let g;const m=newPromise((t=>{g=t}));InitializeTransformStream(this,m,h,p,l,u);SetUpTransformStreamDefaultControllerFromTransformer(this,s);if(s.start!==undefined){g(s.start(this._transformStreamController))}else{g(undefined)}}get readable(){if(!IsTransformStream(this)){throw streamBrandCheckException("readable")}return this._readable}get writable(){if(!IsTransformStream(this)){throw streamBrandCheckException("writable")}return this._writable}}Object.defineProperties(TransformStream.prototype,{readable:{enumerable:true},writable:{enumerable:true}});if(typeof r.toStringTag==="symbol"){Object.defineProperty(TransformStream.prototype,r.toStringTag,{value:"TransformStream",configurable:true})}function InitializeTransformStream(t,r,n,i,o,s){function startAlgorithm(){return r}function writeAlgorithm(r){return TransformStreamDefaultSinkWriteAlgorithm(t,r)}function abortAlgorithm(r){return TransformStreamDefaultSinkAbortAlgorithm(t,r)}function closeAlgorithm(){return TransformStreamDefaultSinkCloseAlgorithm(t)}t._writable=CreateWritableStream(startAlgorithm,writeAlgorithm,closeAlgorithm,abortAlgorithm,n,i);function pullAlgorithm(){return TransformStreamDefaultSourcePullAlgorithm(t)}function cancelAlgorithm(r){TransformStreamErrorWritableAndUnblockWrite(t,r);return promiseResolvedWith(undefined)}t._readable=CreateReadableStream(startAlgorithm,pullAlgorithm,cancelAlgorithm,o,s);t._backpressure=undefined;t._backpressureChangePromise=undefined;t._backpressureChangePromise_resolve=undefined;TransformStreamSetBackpressure(t,true);t._transformStreamController=undefined}function IsTransformStream(t){if(!typeIsObject(t)){return false}if(!Object.prototype.hasOwnProperty.call(t,"_transformStreamController")){return false}return t instanceof TransformStream}function TransformStreamError(t,r){ReadableStreamDefaultControllerError(t._readable._readableStreamController,r);TransformStreamErrorWritableAndUnblockWrite(t,r)}function TransformStreamErrorWritableAndUnblockWrite(t,r){TransformStreamDefaultControllerClearAlgorithms(t._transformStreamController);WritableStreamDefaultControllerErrorIfNeeded(t._writable._writableStreamController,r);if(t._backpressure){TransformStreamSetBackpressure(t,false)}}function TransformStreamSetBackpressure(t,r){if(t._backpressureChangePromise!==undefined){t._backpressureChangePromise_resolve()}t._backpressureChangePromise=newPromise((r=>{t._backpressureChangePromise_resolve=r}));t._backpressure=r}class TransformStreamDefaultController{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!IsTransformStreamDefaultController(this)){throw defaultControllerBrandCheckException("desiredSize")}const t=this._controlledTransformStream._readable._readableStreamController;return ReadableStreamDefaultControllerGetDesiredSize(t)}enqueue(t=undefined){if(!IsTransformStreamDefaultController(this)){throw defaultControllerBrandCheckException("enqueue")}TransformStreamDefaultControllerEnqueue(this,t)}error(t=undefined){if(!IsTransformStreamDefaultController(this)){throw defaultControllerBrandCheckException("error")}TransformStreamDefaultControllerError(this,t)}terminate(){if(!IsTransformStreamDefaultController(this)){throw defaultControllerBrandCheckException("terminate")}TransformStreamDefaultControllerTerminate(this)}}Object.defineProperties(TransformStreamDefaultController.prototype,{enqueue:{enumerable:true},error:{enumerable:true},terminate:{enumerable:true},desiredSize:{enumerable:true}});if(typeof r.toStringTag==="symbol"){Object.defineProperty(TransformStreamDefaultController.prototype,r.toStringTag,{value:"TransformStreamDefaultController",configurable:true})}function IsTransformStreamDefaultController(t){if(!typeIsObject(t)){return false}if(!Object.prototype.hasOwnProperty.call(t,"_controlledTransformStream")){return false}return t instanceof TransformStreamDefaultController}function SetUpTransformStreamDefaultController(t,r,n,i){r._controlledTransformStream=t;t._transformStreamController=r;r._transformAlgorithm=n;r._flushAlgorithm=i}function SetUpTransformStreamDefaultControllerFromTransformer(t,r){const n=Object.create(TransformStreamDefaultController.prototype);let transformAlgorithm=t=>{try{TransformStreamDefaultControllerEnqueue(n,t);return promiseResolvedWith(undefined)}catch(t){return promiseRejectedWith(t)}};let flushAlgorithm=()=>promiseResolvedWith(undefined);if(r.transform!==undefined){transformAlgorithm=t=>r.transform(t,n)}if(r.flush!==undefined){flushAlgorithm=()=>r.flush(n)}SetUpTransformStreamDefaultController(t,n,transformAlgorithm,flushAlgorithm)}function TransformStreamDefaultControllerClearAlgorithms(t){t._transformAlgorithm=undefined;t._flushAlgorithm=undefined}function TransformStreamDefaultControllerEnqueue(t,r){const n=t._controlledTransformStream;const i=n._readable._readableStreamController;if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(i)){throw new TypeError("Readable side is not in a state that permits enqueue")}try{ReadableStreamDefaultControllerEnqueue(i,r)}catch(t){TransformStreamErrorWritableAndUnblockWrite(n,t);throw n._readable._storedError}const o=ReadableStreamDefaultControllerHasBackpressure(i);if(o!==n._backpressure){TransformStreamSetBackpressure(n,true)}}function TransformStreamDefaultControllerError(t,r){TransformStreamError(t._controlledTransformStream,r)}function TransformStreamDefaultControllerPerformTransform(t,r){const n=t._transformAlgorithm(r);return transformPromiseWith(n,undefined,(r=>{TransformStreamError(t._controlledTransformStream,r);throw r}))}function TransformStreamDefaultControllerTerminate(t){const r=t._controlledTransformStream;const n=r._readable._readableStreamController;ReadableStreamDefaultControllerClose(n);const i=new TypeError("TransformStream terminated");TransformStreamErrorWritableAndUnblockWrite(r,i)}function TransformStreamDefaultSinkWriteAlgorithm(t,r){const n=t._transformStreamController;if(t._backpressure){const i=t._backpressureChangePromise;return transformPromiseWith(i,(()=>{const i=t._writable;const o=i._state;if(o==="erroring"){throw i._storedError}return TransformStreamDefaultControllerPerformTransform(n,r)}))}return TransformStreamDefaultControllerPerformTransform(n,r)}function TransformStreamDefaultSinkAbortAlgorithm(t,r){TransformStreamError(t,r);return promiseResolvedWith(undefined)}function TransformStreamDefaultSinkCloseAlgorithm(t){const r=t._readable;const n=t._transformStreamController;const i=n._flushAlgorithm();TransformStreamDefaultControllerClearAlgorithms(n);return transformPromiseWith(i,(()=>{if(r._state==="errored"){throw r._storedError}ReadableStreamDefaultControllerClose(r._readableStreamController)}),(n=>{TransformStreamError(t,n);throw r._storedError}))}function TransformStreamDefaultSourcePullAlgorithm(t){TransformStreamSetBackpressure(t,false);return t._backpressureChangePromise}function defaultControllerBrandCheckException(t){return new TypeError(`TransformStreamDefaultController.prototype.${t} can only be used on a TransformStreamDefaultController`)}function streamBrandCheckException(t){return new TypeError(`TransformStream.prototype.${t} can only be used on a TransformStream`)}t.ByteLengthQueuingStrategy=ByteLengthQueuingStrategy;t.CountQueuingStrategy=CountQueuingStrategy;t.ReadableByteStreamController=ReadableByteStreamController;t.ReadableStream=ReadableStream;t.ReadableStreamBYOBReader=ReadableStreamBYOBReader;t.ReadableStreamBYOBRequest=ReadableStreamBYOBRequest;t.ReadableStreamDefaultController=ReadableStreamDefaultController;t.ReadableStreamDefaultReader=ReadableStreamDefaultReader;t.TransformStream=TransformStream;t.TransformStreamDefaultController=TransformStreamDefaultController;t.WritableStream=WritableStream;t.WritableStreamDefaultController=WritableStreamDefaultController;t.WritableStreamDefaultWriter=WritableStreamDefaultWriter;Object.defineProperty(t,"__esModule",{value:true})}))},2821:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:true});r.dockerCompose=r.nginx_main_wildcard_config=r.nginx_main_config=r.node_server_dockerfile=r.nginx_static_dockerfile=void 0;r.nginx_static_dockerfile=`FROM node:16.14-alpine as builder\n\nWORKDIR /app\n\nCOPY ./files .\n\nRUN apk update\n\nRUN yarn install\n\n%ENVIRONMENT_VARS%\n\nRUN NODE_ENV=production yarn build\nRUN $BUILD_COMMAND\n\nFROM nginx:alpine\n\nCOPY --from=builder /app/dist /usr/share/nginx/html\n\nEXPOSE 80\n\nCMD ["nginx", "-g", "daemon off;"]`;r.node_server_dockerfile=`FROM node:16.14-alpine\n\nRUN apk update\n\nWORKDIR /app\n\nCOPY . .\n\nRUN yarn install\n\nRUN yarn build\n\nCMD $COMMAND\n`;const n=`server_name %SERVER_NAME%;\n\nlocation / {\n    gzip on;\n    gzip_disable "msie6";\n    gzip_vary on;\n    gzip_proxied any;\n    gzip_comp_level 6;\n    gzip_buffers 16 8k;\n    gzip_http_version 1.1;\n    gzip_min_length 256;\n    gzip_types text/plain text/css application/json application/x-javascript application/javascript text/xml application/xml application/xml+rss text/javascript application/vnd.ms-fontobject application/x-font-ttf font/opentype image/svg+xml image/x-icon;\n    proxy_pass %SERVER_URL%;\n    proxy_redirect off;\n    proxy_http_version 1.1;\n    proxy_cache_bypass $http_upgrade;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection 'upgrade';\n    proxy_set_header Host $host;\n    proxy_set_header 'Access-Control-Allow-Origin' '*';\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header 'Cache-Control' 'no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0';\n    expires off;\n}`;r.nginx_main_config=`server {\n    listen 80;\n    listen [::]:80;\n    listen 443 ssl;\n\n    add_header Strict-Transport-Security max-age=31536000;\n    add_header X-Content-Type-Options nosniff;\n    add_header X-Frame-Options "SAMEORIGIN";\n    #add_header Content-Security-Policy "default-src 'self';" always;\n    add_header "X-XSS-Protection" "1; mode=block";\n\n    access_log\t\t\t\t\t\t/var/log/nginx/%SERVER_NAME%.access.log;\n    error_log             /var/log/nginx/%SERVER_NAME%.error.log;\n\n    ${n}\n\n    location /robots.txt {\n      return 200 "User-agent: *\n        Allow: /\n      ";\n    }\n}`;r.nginx_main_wildcard_config=`server {\n  listen 80;\n  server_name ~^(.*).%DOMAIN%$;\n  set $servername $1;\n  rewrite ^(.*)$ https://$servername.%DOMAIN%/$1;\n}\n\nserver {\n    listen 443 ssl;\n\n    add_header Strict-Transport-Security max-age=31536000;\n    add_header X-Content-Type-Options nosniff;\n    add_header X-Frame-Options "SAMEORIGIN";\n    #add_header Content-Security-Policy "default-src 'self';" always;\n    add_header "X-XSS-Protection" "1; mode=block";\n\n    access_log\t\t\t\t\t\t/var/log/nginx/%SERVER_NAME%.access.log;\n    error_log             /var/log/nginx/%SERVER_NAME%.error.log;\n\n    ssl_certificate    \t\t/etc/letsencrypt/live/%SERVER_NAME%/fullchain.pem;\n    ssl_certificate_key\t\t/etc/letsencrypt/live/%SERVER_NAME%/privkey.pem;\n\n    ${n}\n\n    location /robots.txt {\n      return 200 "User-agent: *\n        Allow: /\n      ";\n    }\n}`;r.dockerCompose=`version: '3'\nservices:\n  %SERVICE_NAME%:\n    container_name: %CONTAINER_NAME%\n    image: %IMAGE_NAME%\n    build:\n      context: %DOCKERFILE_FILE_CONTEXT%\n      dockerfile: %DOCKERFILE_FILE_NAME%\n      args:\n        - %ARGS%\n    ports:\n      - %PORT%\n    environment:\n      - %ENVIRONMENT%\n`},7833:function(t,r,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,r,n,i){if(i===undefined)i=n;Object.defineProperty(t,i,{enumerable:true,get:function(){return r[n]}})}:function(t,r,n,i){if(i===undefined)i=n;t[i]=r[n]});var o=this&&this.__setModuleDefault||(Object.create?function(t,r){Object.defineProperty(t,"default",{enumerable:true,value:r})}:function(t,r){t["default"]=r});var s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var r={};if(t!=null)for(var n in t)if(n!=="default"&&Object.prototype.hasOwnProperty.call(t,n))i(r,t,n);o(r,t);return r};var l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:true});r.Deploy=void 0;const u=l(n(7894));const h=s(n(2186));const p=l(n(5747));const g=n(2821);const{GITHUB_WORKSPACE:m,INPUT_DOCKERFILE:_,INPUT_ENV:E,GITHUB_REPOSITORY:b,INPUT_REPO_TOKEN:y,INPUT_RUN_COMMAND:w="yarn start",INPUT_BUILD_COMMAND:I="yarn build",INPUT_STATIC:C="false",INPUT_WILDCARD_SSL:R="false",INPUT_APP_HOST:B="",INPUT_APP_PORTS:k="80"}=process.env;const toBoolean=t=>{if(typeof t==="boolean")return t;const r=t.toLowerCase()==="true";const n=t.toLowerCase()==="false";return n?false:r};class Deploy{constructor(){}static create(t){if(!Deploy.instance&&t){Deploy.ssh=t;Deploy.instance=new Deploy}return Deploy.instance}async getRepositoryID(){const[t,r]=(b===null||b===void 0?void 0:b.split("/"))||[];if(!t||!r)return null;const n={Accept:"application/vnd.github.v3+json"};if(y){n["Authorization"]=`token ${y}`}const i=await(0,u.default)(`https://api.github.com/repos/${t}/${r}`,{headers:n}).then((async t=>t.json()));return i===null||i===void 0?void 0:i.id}async getContainersIDByAppName(t){console.log("getContainersIDByAppName [app]",t);return new Promise(((r,n)=>{const i=`docker ps --format="{{.Names}} {{.ID}}" | grep '${t}'`;console.log("getContainersIDByAppName [command]",i);Deploy.ssh.execCommand(i).then((t=>{console.log("getContainersIDByAppName [result.stdout]",t.stdout);const n=t.stdout.split(/\n/gm).map((t=>t.trim())).filter((t=>t)).map((t=>{const[r,n]=t.split(" ");const[,i,o,s,l,u]=r.match(/^.*?(\d+)\.(.+?\.\w{2,})\.(\d+)\.([^\.]+)\.([^\._]+)/);return{name:o,id:n,repoId:i,timestamp:s,hash:l,env:u}}));console.log("getContainersIDByAppName [r]",n);r(n)})).catch((t=>{this.close();n(t)}))}))}async getImagesIDByAppName(t){return new Promise(((r,n)=>{Deploy.ssh.execCommand(`docker images --format="{{.Repository}} {{.ID}}" | grep '${t}'`).then((t=>{const n=t.stdout.split(/\n/gm).map((t=>t.trim())).filter((t=>t)).map((t=>{const[r,n]=t.split(" ");const[,i,o,s,l,u]=r.match(/^.*?(\d+)\.(.+?\.\w{2,})\.(\d+)\.([^\.]+)\.([^\._]+)/);return{name:o,repoId:i,id:n,timestamp:s,hash:l,env:u}}));r(n)})).catch((t=>{this.close();n(t)}))}))}async createFolder(t){return new Promise(((r,n)=>{Deploy.ssh.execCommand(`mkdir -p ${t}`).then((i=>{if(i.stderr){console.log("[LOG]: result.stderr",i.stderr);this.close();n(i.stderr)}console.log("[LOG]: dir",t);r(t)}))}))}async dirExists(t){return new Promise(((r,n)=>{const i=`if [ -d "${t}" ]; then echo "true"; else echo "false"; fi`;Deploy.ssh.execCommand(i).then((t=>{if(t.stderr){this.close();n(t.stderr)}r(JSON.parse(t.stdout))}))}))}async deleteFiles(t){const r=`rm -Rf ${t}`;await Deploy.ssh.execCommand(r)}async uploadFiles(t,r){return new Promise(((n,i)=>{const o=[];const s=[];Deploy.ssh.putDirectory(t,`${r}`,{recursive:true,concurrency:10,validate:()=>true,tick:function(t,r,n){if(n){o.push(t)}else{s.push(t)}}}).then((t=>{console.log("The Directory thing is done");console.log("the directory transfer was",t?"successful":"unsuccessful");if(o.length){console.log("failed transfers",o.join(", "))}else{console.log("successful transfers")}n(null)}),(t=>{this.close();console.log("Something's wrong");console.log(t);i(t)}))}))}async buildImageByDockerCompose(t,r){let n=`cd ${t} && docker-compose build --no-cache`;console.log("docker build command",n);return new Promise((async(t,i)=>{try{await Deploy.ssh.execCommand(n).then((async n=>{console.log("result.stderr",n.stderr);console.log("result.stdout",n.stdout);const o=await this.getImageIDByImageName(r);if(o){return t(o)}i(null)}))}catch(t){console.log("errerr",t);i(null);this.close()}}))}async runContainerByDockerCompose(t){const r=`cd ${t} && docker-compose up`;return new Promise((async(t,n)=>{try{await Deploy.ssh.execCommand(r).then((r=>{if(r.stderr){this.close();n(r.stderr)}t(null)}))}catch{this.close()}}))}async createAndUploadDockerComposeFile(t,{imageName:r,containerName:n,appName:i}){let o=g.dockerCompose;o=o.replace("%SERVICE_NAME%",i).replace("%IMAGE_NAME%",r).replace("%CONTAINER_NAME%",n);if(_){const t=_.split("/");const r=t.pop();o=o.replace("%DOCKERFILE_FILE_CONTEXT%",`./files/${t.join("/")}`).replace("%DOCKERFILE_FILE_NAME%",r)}else{o=o.replace("%DOCKERFILE_FILE_CONTEXT%","./").replace("%DOCKERFILE_FILE_NAME%","Dockerfile")}const s=k||"80";if(s){const[t]=o.match(/^.*?-\s\%PORT\%/gm)||[];const r=s.split(",").map((t=>t.trim())).map((r=>t.replace("%PORT%",`${r}`))).join("\n");o=o.replace(/^.*?-\s\%PORT\%/gm,r)}if(E){const[t]=o.match(/^.*?-\s\%ENVIRONMENT\%/gm)||[];if(t){const r=E===null||E===void 0?void 0:E.split(/\n/).filter((t=>t)).map((r=>t.replace("%ENVIRONMENT%",`${r}`))).join("\n");o=o.replace(/^.*?-\s\%ENVIRONMENT\%/gm,r)}const[r]=o.match(/^.*?-\s\%ARGS\%/gm)||[];if(r){const t=E===null||E===void 0?void 0:E.split(/\n/).filter((t=>t)).map((t=>r.replace("%ARGS%",`${t}`))).join("\n");o=o.replace(/^.*?-\s\%ARGS\%/gm,t)}}p.default.writeFileSync(`${m}/docker-compose.yml`,o);return new Promise(((r,n)=>{Deploy.ssh.putFile(`${m}/docker-compose.yml`,`${t}/docker-compose.yml`).then((()=>{console.log("The docker-compose config is done");r(null)}),(t=>{this.close();console.log("Something's wrong");console.log(t);n(t)}))}))}async uploadDockerfile(t){if(_==="."){h.error("Maybe you want to say './'");this.close();return false}if(_)return Promise.resolve(null);h.info("Creating default Dockerfile");let r=toBoolean(C)?g.nginx_static_dockerfile:g.node_server_dockerfile.replace("$COMMAND",w);let n="";if(E){n=E===null||E===void 0?void 0:E.split(/\n/).filter((t=>t)).map((t=>t.trim())).map((t=>{const[r]=t.split("=");return`ARG ${r}\nENV ${r} $${r}`})).join("\n")}r=r.replace("%ENVIRONMENT_VARS%",n);h.info(`Dockerfile: ${r}`);p.default.writeFileSync(`${m}/Dockerfile`,r);return new Promise(((r,n)=>{Deploy.ssh.putFile(`${m}/Dockerfile`,`${t}/Dockerfile`).then((()=>{console.log("The Directory thing is done");r(null)}),(t=>{this.close();console.log("Something's wrong");console.log(t);n(t)}))}))}async uploadEnvVars(t){let r="";if(E){r=E===null||E===void 0?void 0:E.split(/\n/).filter((t=>t)).join("\n");p.default.writeFileSync(`${m}/.__env`,r);h.info("Creating environment vars");return new Promise(((r,n)=>{Deploy.ssh.putFile(`${m}/.__env`,`${t}/.__env`).then((()=>{console.log("The Directory thing is done");r(null)}),(t=>{this.close();console.log("Something's wrong");console.log(t);n(t)}))}))}return Promise.resolve(null)}async uploadNginxConfig(t,r){p.default.writeFileSync(`${m}/nginx`,t);return new Promise(((t,n)=>{Deploy.ssh.putFile(`${m}/nginx`,r).then((()=>{t(null)}),(t=>{this.close();h.error("Something's wrong");console.log(t);n(t)}))}))}dockerfileExists(t){return p.default.existsSync(t)}async createImage(t,r){console.log(`[LOG]: Creating docker image`);let n="";if(E){n=E===null||E===void 0?void 0:E.split(/\n/).filter((t=>t)).map((t=>`--build-arg ${t}`)).join(" ")}let i=`cd ${t} && docker build --no-cache -t ${r} ${n}`;if(_){if(_==="./"){if(!this.dockerfileExists(`${m}/Dockerfile`)){this.close();h.error("Dockerfile doesn't exists.");return false}i+=` -f ${_}Dockerfile .`}else if(/\.\/.+?/.test(_)){if(!this.dockerfileExists(`${m}/${_}`)){this.close();h.error("Dockerfile doesn't exists.");return false}i+=` -f ${_} .`}}else{i+=` -f ./__Dockerfile .`}return new Promise((async(t,n)=>{try{console.log("COMMAND",i);await Deploy.ssh.execCommand(i).then((t=>{if(t.stderr){this.close();n(t.stderr)}}));const o=await this.getImageIDByImageName(r);t(o)}catch(t){this.close();n(t)}}))}async getImageIDByImageName(t){return new Promise(((r,n)=>{const i=`docker images --format="{{.Repository}} {{.ID}}" | grep '${t}' | grep -Po '\\s(.*?$)'`;Deploy.ssh.execCommand(i).then((t=>{if(t.stderr){this.close();n(t.stderr)}r(t.stdout)}))}))}async getContainerIDByContainerName(t){return new Promise(((r,n)=>{const i=`docker ps --format="{{.Names}} {{.ID}}" | grep '${t}' | grep -Po '\\s(.*?$)'`;console.log("getImageIDByImageName [command]",i);Deploy.ssh.execCommand(i).then((t=>{console.log("getContainerIDByContainerName [result.stderr]",t.stderr);console.log("getContainerIDByContainerName [result.stdout]",t.stdout);if(t.stderr){this.close();n(t.stderr)}r(t.stdout)})).catch((t=>{this.close();console.log("getContainerIDByContainerName [err]");n(t)}))}))}async getContainerIPByContainerId(t){return new Promise(((r,n)=>{const i=`docker inspect -f '{{range.NetworkSettings.Networks}}{{.IPAddress}}{{end}}' ${t}`;Deploy.ssh.execCommand(i).then((t=>{r(t.stdout)})).catch((t=>{this.close();n(t)}))}))}async getContainerPortByContainerName(t){return new Promise(((r,n)=>{const i=`docker container ls | grep '${t}' | grep -Po '\\d+/tcp' | grep -Po '\\d+'`;Deploy.ssh.execCommand(i).then((t=>{r(t.stdout)})).catch((t=>{this.close();n(t)}))}))}async containerExists(t){return new Promise((async r=>{const n=await this.getContainerIDByContainerName(t);r(!!n.trim())}))}async volumeExists(t){return new Promise(((r,n)=>{const i=`docker volume ls --format="{{.Name}}" | grep "${t}"`;Deploy.ssh.execCommand(i).then((t=>{if(t.stderr){this.close();console.log(t.stderr);n(false)}const i=!!t.stdout.trim();r(i)}))}))}async createVolume(t){return new Promise(((r,n)=>{const i=`docker volume create ${t}`;Deploy.ssh.execCommand(i).then((t=>{if(t.stderr){this.close();console.log(t.stderr);n(false)}const i=!!t.stdout.trim();r(i)}))}))}async removeVolume(t){return new Promise(((r,n)=>{const i=`docker volume rm -f ${t}`;Deploy.ssh.execCommand(i).then((t=>{if(t.stderr){this.close();console.log(t.stderr);n(false)}r(true)}))}))}async imageExists(t){return new Promise((async r=>{const n=await this.getImageIDByImageName(t);r(!!n.trim())}))}async stopContainerByName(t){console.log("stopContainerByName [appName]",t);const stop=async t=>new Promise(((r,n)=>{const i=`cd ${t} && docker-compose down && docker-compose rm`;console.log("stopContainerByName [command]",i);Deploy.ssh.execCommand(i).then((()=>{r(true)})).catch((t=>{h.error(t);this.close();n(false)}))}));if(!t.length){h.error(`Container name/id is mandatory.`);return false}const r=t;const n=r.length===1;console.log("stopContainerByName [isSingle]",n);if(n){const r=`${t[0].repoId}.${t[0].name}.${t[0].timestamp}.${t[0].hash}`;const n=await this.containerExists(r);console.log("stopContainerByName [exists]",n);if(n){const r=`/var/www/${t[0].name}/${t[0].env}/${t[0].timestamp}.${t[0].hash}`;await stop(r);h.info(`Container ${r} has been stopped.`);return true}h.error(`Container ${t[0].name} doesn't exists.`)}else if(!n){for(const n of r){const r=`/var/www/${n.name}/${t[0].env}/${n.timestamp}.${n.hash}`;const i=await stop(r);if(i){h.info(`Container ${n.name} has been stopped.`)}}}return false}async deleteContainerByName(t){const remove=async t=>new Promise(((r,n)=>{const i=`docker rm -f ${t}`;Deploy.ssh.execCommand(i).then((t=>{if(t.stderr){h.error(t.stderr);this.close();n(false)}r(true)}))}));if(!t){h.error(`Container name/id is mandatory.`);return false}const r=t.split(" ");const n=r.length===1;if(n){const r=await this.containerExists(t);if(r){await remove(t);h.info(`Container ${t} has been deleted.`);return true}h.error(`Container ${t} doesn't exists.`)}else if(!n){for(const n of r){const r=await remove(n);if(r){h.info(`Container ${t} has been deleted.`)}else{h.error(`Container ${t} not deleted.`)}}}return false}async removeImagesByName(t){const remove=async t=>new Promise(((r,n)=>{const i=`docker rmi -f ${t}`;Deploy.ssh.execCommand(i).then((t=>{if(t.stderr){h.error(t.stderr);this.close();n(false)}r(true)}))}));if(!t.length){h.error(`Image id is mandatory.`);return false}const r=t;const n=r.length===1;if(n){const r=`${t[0].repoId}.${t[0].name}.${t[0].timestamp}.${t[0].hash}.${t[0].env}.image`;const n=await this.imageExists(t[0].id);if(n){await remove(r);h.info(`Image ${r} has been deleted.`);return true}h.error(`Image ${r} doesn't exists.`)}else if(!n){for(const t of r){const r=`${t.repoId}.${t.name}.${t.timestamp}.${t.hash}.${t.env}.image`;const n=await remove(t.id);if(n){h.info(`Image ${r} has been deleted.`)}else{h.error(`Image ${r} not deleted.`)}}}return false}async restartNginx(){return new Promise((t=>{const r=`nginx -t && systemctl restart nginx`;Deploy.ssh.execCommand(r).then((r=>{t(r.stdout)}))}))}async runContainer(t,{container:r,appName:n}){console.log(`Running container ${r}`);return new Promise((async(r,i)=>{const o=`cd ${t} && docker-compose up -d`;await Deploy.ssh.execCommand(o);const s=await this.getContainerIDByContainerName(n);console.log("runContainer [containerID]",s);if(!s)i(null);const l=await this.getContainerIPByContainerId(s);console.log("runContainer [containerIP]",l);const u=await this.getContainerPortByContainerName(s);console.log("runContainer [containerPort]",u);r({containerID:s,containerIP:l,containerPort:u})}))}async getNginxConfig(t,r){if(toBoolean(R)){g.nginx_main_wildcard_config.replace(/\%DOMAIN\%/g,B).replace(/\%SERVER_NAME\%/g,t).replace("%SERVER_URL%",r)}return g.nginx_main_config.replace(/\%SERVER_NAME\%/g,t).replace("%SERVER_URL%",r)}close(){Deploy.ssh.dispose()}}r.Deploy=Deploy},5930:function(t,r,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,r,n,i){if(i===undefined)i=n;Object.defineProperty(t,i,{enumerable:true,get:function(){return r[n]}})}:function(t,r,n,i){if(i===undefined)i=n;t[i]=r[n]});var o=this&&this.__setModuleDefault||(Object.create?function(t,r){Object.defineProperty(t,"default",{enumerable:true,value:r})}:function(t,r){t["default"]=r});var s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var r={};if(t!=null)for(var n in t)if(n!=="default"&&Object.prototype.hasOwnProperty.call(t,n))i(r,t,n);o(r,t);return r};Object.defineProperty(r,"__esModule",{value:true});r.deploy=void 0;const l=s(n(2186));const u=n(5845);const h=n(7833);const{GITHUB_WORKSPACE:p,GITHUB_SHA:g}=process.env;const m=new u.NodeSSH;const deploy=async t=>{l.info("🚀 Deploy");const r=(new Date).getTime();const{server_ip:n,user:i,ssh_private_key:o,app_name:s,app_host:u,env_name:_}=t;const{INPUT_APP_NAME:E}=process.env;l.info(`ℹ️ ${E}`);await m.connect({host:n,username:i,privateKey:o});l.info("🚀 Deploy: connecting by SSH");const b=h.Deploy.create(m);const y=await b.getRepositoryID();if(!y){l.error("🚀 Deploy: This repository is private, please use repo_token with value ${{ secrets.GITHUB_TOKEN }}");b.close();return}const w=_;const I=`${s}.${u}`;l.info(`🚀 Deploy: REPO_ID ${y}`);const C=await b.getContainersIDByAppName(`${y}.`);console.log("CONTAINER_IDs",C);const R=await b.getImagesIDByAppName(`${y}.`);const B=`${y}.${I}.${r}.${g}.${w}`;const k=`${r}.${g}`;const v=`/var/www/${I}/${w}`;const T=`${B}.container`;const P=`${B}.image`;const O=`${I}.volume`;l.info("🚀 Deploy: application directory");const D=await b.dirExists(v);if(!D){await b.createFolder(v)}l.info("🚀 Deploy: application version directory");const L=`${v}/${k}`;const U=await b.dirExists(L);if(!U){await b.createFolder(L)}const W=`${L}/files`;const Q=await b.dirExists(W);if(!Q){await b.createFolder(W)}l.info("🚀 Deploy: uploading files");await b.uploadFiles(`${p}`,W);l.info("🚀 Deploy: setting docker config");await b.uploadDockerfile(L);l.info("🚀 Deploy: setting docker config");await b.createAndUploadDockerComposeFile(L,{imageName:P,containerName:T,appName:B});l.info("🚀 Deploy: creating run image");const q=await b.buildImageByDockerCompose(L,P);l.info(`🚀 Deploy: IMAGE_ID > ${q}`);if(!q){l.error("🚀 Deploy: no image created");b.close();return}const $=await b.volumeExists(O);if(!$){await b.createVolume(O)}l.info("🚀 Deploy: running container");const j=await b.runContainer(L,{container:T,appName:B});l.info(`ℹ️ Deploy: container info ${JSON.stringify(j)}`);if(!j.containerID){l.error("🚀 Deploy: some error has been occurred. Container is not running");b.close();return}let G="";l.info("🚀 Deploy: container created");l.info("🚀 Deploy: setting nginx config");G=await b.getNginxConfig(`${s}.${u}`,`http://${j.containerIP}:${j.containerPort}`);if(G){l.info("🚀 Deploy: test and restarting NGINX");await b.uploadNginxConfig(G,`/etc/nginx/sites-enabled/${I}`);await b.restartNginx()}if(C.length){l.info(`🚀 Deploy: Removing old containers... ${C.join(" ")}`);await b.stopContainerByName(C)}if(R.length){l.info(`🚀 Deploy: Removing old images...`);await b.removeImagesByName(R)}b.close()};r.deploy=deploy;r.default=r.deploy},399:function(t,r,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,r,n,i){if(i===undefined)i=n;Object.defineProperty(t,i,{enumerable:true,get:function(){return r[n]}})}:function(t,r,n,i){if(i===undefined)i=n;t[i]=r[n]});var o=this&&this.__setModuleDefault||(Object.create?function(t,r){Object.defineProperty(t,"default",{enumerable:true,value:r})}:function(t,r){t["default"]=r});var s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var r={};if(t!=null)for(var n in t)if(n!=="default"&&Object.prototype.hasOwnProperty.call(t,n))i(r,t,n);o(r,t);return r};var l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:true});const u=s(n(2186));const h=l(n(5930));async function run(){try{const t={server_ip:u.getInput("server_ip",{required:true}),user:u.getInput("user",{required:true}),ssh_private_key:u.getInput("ssh_private_key",{required:true}),app_host:u.getInput("app_host",{required:true}),app_name:u.getInput("app_name",{required:true}),source:u.getInput("source")||"dist",dockerfile:u.getInput("dockerfile")||null,env:u.getInput("env")||"",env_name:u.getInput("env_name")||"production",static:u.getBooleanInput("static")||false,run_command:u.getInput("run_command")||null,build_command:u.getInput("build_command")||null,repo_token:u.getInput("repo_token")||null,app_ports:u.getInput("app_ports")||"8080"};await(0,h.default)(t)}catch(t){u.setFailed(t)}}run()},9041:(t,r,n)=>{t.exports=require(n.ab+"lib/protocol/crypto/build/Release/sshcrypto.node")},7295:module=>{module.exports=eval("require")("cpu-features")},8010:(t,r,n)=>{const i=65536;if(!globalThis.ReadableStream){try{const t=n(8760);const{emitWarning:r}=t;try{t.emitWarning=()=>{};Object.assign(globalThis,n(9435));t.emitWarning=r}catch(n){t.emitWarning=r;throw n}}catch(t){Object.assign(globalThis,n(1452))}}try{const{Blob:t}=n(4293);if(t&&!t.prototype.stream){t.prototype.stream=function name(t){let r=0;const n=this;return new ReadableStream({type:"bytes",async pull(t){const o=n.slice(r,Math.min(n.size,r+i));const s=await o.arrayBuffer();r+=s.byteLength;t.enqueue(new Uint8Array(s));if(r===n.size){t.close()}}})}}}catch(t){}},6447:t=>{"use strict";t.exports={i8:"1.4.0"}},2357:t=>{"use strict";t.exports=require("assert")},4293:t=>{"use strict";t.exports=require("buffer")},3129:t=>{"use strict";t.exports=require("child_process")},6417:t=>{"use strict";t.exports=require("crypto")},881:t=>{"use strict";t.exports=require("dns")},8614:t=>{"use strict";t.exports=require("events")},5747:t=>{"use strict";t.exports=require("fs")},8605:t=>{"use strict";t.exports=require("http")},7211:t=>{"use strict";t.exports=require("https")},1631:t=>{"use strict";t.exports=require("net")},3994:t=>{"use strict";t.exports=require("node:fs")},2049:t=>{"use strict";t.exports=require("node:path")},8760:t=>{"use strict";t.exports=require("node:process")},9435:t=>{"use strict";t.exports=require("node:stream/web")},9585:t=>{"use strict";t.exports=require("node:worker_threads")},2087:t=>{"use strict";t.exports=require("os")},5622:t=>{"use strict";t.exports=require("path")},2413:t=>{"use strict";t.exports=require("stream")},4016:t=>{"use strict";t.exports=require("tls")},1669:t=>{"use strict";t.exports=require("util")},8761:t=>{"use strict";t.exports=require("zlib")}};var __webpack_module_cache__={};function __nccwpck_require__(t){var r=__webpack_module_cache__[t];if(r!==undefined){return r.exports}var n=__webpack_module_cache__[t]={exports:{}};var i=true;try{__webpack_modules__[t].call(n.exports,n,n.exports,__nccwpck_require__);i=false}finally{if(i)delete __webpack_module_cache__[t]}return n.exports}__nccwpck_require__.m=__webpack_modules__;(()=>{__nccwpck_require__.d=(t,r)=>{for(var n in r){if(__nccwpck_require__.o(r,n)&&!__nccwpck_require__.o(t,n)){Object.defineProperty(t,n,{enumerable:true,get:r[n]})}}}})();(()=>{__nccwpck_require__.f={};__nccwpck_require__.e=t=>Promise.all(Object.keys(__nccwpck_require__.f).reduce(((r,n)=>{__nccwpck_require__.f[n](t,r);return r}),[]))})();(()=>{__nccwpck_require__.u=t=>""+t+".index.js"})();(()=>{__nccwpck_require__.o=(t,r)=>Object.prototype.hasOwnProperty.call(t,r)})();(()=>{__nccwpck_require__.r=t=>{if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(t,"__esModule",{value:true})}})();if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";(()=>{var t={179:1};var installChunk=r=>{var n=r.modules,i=r.ids,o=r.runtime;for(var s in n){if(__nccwpck_require__.o(n,s)){__nccwpck_require__.m[s]=n[s]}}if(o)o(__nccwpck_require__);for(var l=0;l<i.length;l++)t[i[l]]=1};__nccwpck_require__.f.require=(r,n)=>{if(!t[r]){if(true){installChunk(require("./"+__nccwpck_require__.u(r)))}else t[r]=1}}})();var __webpack_exports__=__nccwpck_require__(399);module.exports=__webpack_exports__})();